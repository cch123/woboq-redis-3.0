<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>redis.c source code [redis/src/redis.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="main "/>
<link rel="stylesheet" href="../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'redis/src/redis.c'; var root_path = '../..'; var data_path = '../../../data';</script>
<script src='../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='..'>redis</a>/<a href='./'>src</a>/<a href='redis.c.html'>redis.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * Copyright (c) 2009-2012, Salvatore Sanfilippo &lt;antirez at gmail dot com&gt;</i></td></tr>
<tr><th id="3">3</th><td><i> * All rights reserved.</i></td></tr>
<tr><th id="4">4</th><td><i> *</i></td></tr>
<tr><th id="5">5</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="6">6</th><td><i> * modification, are permitted provided that the following conditions are met:</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> *   * Redistributions of source code must retain the above copyright notice,</i></td></tr>
<tr><th id="9">9</th><td><i> *     this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="10">10</th><td><i> *   * Redistributions in binary form must reproduce the above copyright</i></td></tr>
<tr><th id="11">11</th><td><i> *     notice, this list of conditions and the following disclaimer in the</i></td></tr>
<tr><th id="12">12</th><td><i> *     documentation and/or other materials provided with the distribution.</i></td></tr>
<tr><th id="13">13</th><td><i> *   * Neither the name of Redis nor the names of its contributors may be used</i></td></tr>
<tr><th id="14">14</th><td><i> *     to endorse or promote products derived from this software without</i></td></tr>
<tr><th id="15">15</th><td><i> *     specific prior written permission.</i></td></tr>
<tr><th id="16">16</th><td><i> *</i></td></tr>
<tr><th id="17">17</th><td><i> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</i></td></tr>
<tr><th id="18">18</th><td><i> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</i></td></tr>
<tr><th id="19">19</th><td><i> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</i></td></tr>
<tr><th id="20">20</th><td><i> * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</i></td></tr>
<tr><th id="21">21</th><td><i> * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</i></td></tr>
<tr><th id="22">22</th><td><i> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</i></td></tr>
<tr><th id="23">23</th><td><i> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</i></td></tr>
<tr><th id="24">24</th><td><i> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</i></td></tr>
<tr><th id="25">25</th><td><i> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</i></td></tr>
<tr><th id="26">26</th><td><i> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</i></td></tr>
<tr><th id="27">27</th><td><i> * POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="28">28</th><td><i> */</i></td></tr>
<tr><th id="29">29</th><td></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="redis.h.html">"redis.h"</a></u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="cluster.h.html">"cluster.h"</a></u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="slowlog.h.html">"slowlog.h"</a></u></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="bio.h.html">"bio.h"</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="latency.h.html">"latency.h"</a></u></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="../../include/time.h.html">&lt;time.h&gt;</a></u></td></tr>
<tr><th id="37">37</th><td><u>#include <a href="../../include/signal.h.html">&lt;signal.h&gt;</a></u></td></tr>
<tr><th id="38">38</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/wait.h.html">&lt;sys/wait.h&gt;</a></u></td></tr>
<tr><th id="39">39</th><td><u>#include <a href="../../include/errno.h.html">&lt;errno.h&gt;</a></u></td></tr>
<tr><th id="40">40</th><td><u>#include <a href="../../include/assert.h.html">&lt;assert.h&gt;</a></u></td></tr>
<tr><th id="41">41</th><td><u>#include <a href="../../include/ctype.h.html">&lt;ctype.h&gt;</a></u></td></tr>
<tr><th id="42">42</th><td><u>#include &lt;stdarg.h&gt;</u></td></tr>
<tr><th id="43">43</th><td><u>#include <a href="../../include/arpa/inet.h.html">&lt;arpa/inet.h&gt;</a></u></td></tr>
<tr><th id="44">44</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/stat.h.html">&lt;sys/stat.h&gt;</a></u></td></tr>
<tr><th id="45">45</th><td><u>#include <a href="../../include/fcntl.h.html">&lt;fcntl.h&gt;</a></u></td></tr>
<tr><th id="46">46</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/time.h.html">&lt;sys/time.h&gt;</a></u></td></tr>
<tr><th id="47">47</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/resource.h.html">&lt;sys/resource.h&gt;</a></u></td></tr>
<tr><th id="48">48</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/uio.h.html">&lt;sys/uio.h&gt;</a></u></td></tr>
<tr><th id="49">49</th><td><u>#include &lt;limits.h&gt;</u></td></tr>
<tr><th id="50">50</th><td><u>#include &lt;float.h&gt;</u></td></tr>
<tr><th id="51">51</th><td><u>#include <a href="../../include/math.h.html">&lt;math.h&gt;</a></u></td></tr>
<tr><th id="52">52</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/resource.h.html">&lt;sys/resource.h&gt;</a></u></td></tr>
<tr><th id="53">53</th><td><u>#include <a href="../../include/x86_64-linux-gnu/sys/utsname.h.html">&lt;sys/utsname.h&gt;</a></u></td></tr>
<tr><th id="54">54</th><td><u>#include <a href="../../include/locale.h.html">&lt;locale.h&gt;</a></u></td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td><i>/* Our shared "common" objects */</i></td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><b>struct</b> <a class="type" href="redis.h.html#sharedObjectsStruct" title='sharedObjectsStruct' data-ref="sharedObjectsStruct">sharedObjectsStruct</a> <dfn class="decl def" id="shared" title='shared' data-ref="shared">shared</dfn>;</td></tr>
<tr><th id="59">59</th><td></td></tr>
<tr><th id="60">60</th><td><i>/* Global vars that are actually used as constants. The following double</i></td></tr>
<tr><th id="61">61</th><td><i> * values are used for double on-disk serialization, and are initialized</i></td></tr>
<tr><th id="62">62</th><td><i> * at runtime to avoid strange compiler optimizations. */</i></td></tr>
<tr><th id="63">63</th><td></td></tr>
<tr><th id="64">64</th><td><em>double</em> <dfn class="decl def" id="R_Zero" title='R_Zero' data-ref="R_Zero">R_Zero</dfn>, <dfn class="decl def" id="R_PosInf" title='R_PosInf' data-ref="R_PosInf">R_PosInf</dfn>, <dfn class="decl def" id="R_NegInf" title='R_NegInf' data-ref="R_NegInf">R_NegInf</dfn>, <dfn class="decl def" id="R_Nan" title='R_Nan' data-ref="R_Nan">R_Nan</dfn>;</td></tr>
<tr><th id="65">65</th><td></td></tr>
<tr><th id="66">66</th><td><i>/*================================= Globals ================================= */</i></td></tr>
<tr><th id="67">67</th><td></td></tr>
<tr><th id="68">68</th><td><i>/* Global vars */</i></td></tr>
<tr><th id="69">69</th><td><b>struct</b> <a class="type" href="redis.h.html#redisServer" title='redisServer' data-ref="redisServer">redisServer</a> <dfn class="decl def" id="server" title='server' data-ref="server">server</dfn>; <i>/* server global state */</i></td></tr>
<tr><th id="70">70</th><td></td></tr>
<tr><th id="71">71</th><td><i>/* Our command table.</i></td></tr>
<tr><th id="72">72</th><td><i> *</i></td></tr>
<tr><th id="73">73</th><td><i> * Every entry is composed of the following fields:</i></td></tr>
<tr><th id="74">74</th><td><i> *</i></td></tr>
<tr><th id="75">75</th><td><i> * name: a string representing the command name.</i></td></tr>
<tr><th id="76">76</th><td><i> * function: pointer to the C function implementing the command.</i></td></tr>
<tr><th id="77">77</th><td><i> * arity: number of arguments, it is possible to use -N to say &gt;= N</i></td></tr>
<tr><th id="78">78</th><td><i> * sflags: command flags as string. See below for a table of flags.</i></td></tr>
<tr><th id="79">79</th><td><i> * flags: flags as bitmask. Computed by Redis using the 'sflags' field.</i></td></tr>
<tr><th id="80">80</th><td><i> * get_keys_proc: an optional function to get key arguments from a command.</i></td></tr>
<tr><th id="81">81</th><td><i> *                This is only used when the following three fields are not</i></td></tr>
<tr><th id="82">82</th><td><i> *                enough to specify what arguments are keys.</i></td></tr>
<tr><th id="83">83</th><td><i> * first_key_index: first argument that is a key</i></td></tr>
<tr><th id="84">84</th><td><i> * last_key_index: last argument that is a key</i></td></tr>
<tr><th id="85">85</th><td><i> * key_step: step to get all the keys from first to last argument. For instance</i></td></tr>
<tr><th id="86">86</th><td><i> *           in MSET the step is two since arguments are key,val,key,val,...</i></td></tr>
<tr><th id="87">87</th><td><i> * microseconds: microseconds of total execution time for this command.</i></td></tr>
<tr><th id="88">88</th><td><i> * calls: total number of calls of this command.</i></td></tr>
<tr><th id="89">89</th><td><i> *</i></td></tr>
<tr><th id="90">90</th><td><i> * The flags, microseconds and calls fields are computed by Redis and should</i></td></tr>
<tr><th id="91">91</th><td><i> * always be set to zero.</i></td></tr>
<tr><th id="92">92</th><td><i> *</i></td></tr>
<tr><th id="93">93</th><td><i> * Command flags are expressed using strings where every character represents</i></td></tr>
<tr><th id="94">94</th><td><i> * a flag. Later the populateCommandTable() function will take care of</i></td></tr>
<tr><th id="95">95</th><td><i> * populating the real 'flags' field using this characters.</i></td></tr>
<tr><th id="96">96</th><td><i> *</i></td></tr>
<tr><th id="97">97</th><td><i> * This is the meaning of the flags:</i></td></tr>
<tr><th id="98">98</th><td><i> *</i></td></tr>
<tr><th id="99">99</th><td><i> * w: write command (may modify the key space).</i></td></tr>
<tr><th id="100">100</th><td><i> * r: read command  (will never modify the key space).</i></td></tr>
<tr><th id="101">101</th><td><i> * m: may increase memory usage once called. Don't allow if out of memory.</i></td></tr>
<tr><th id="102">102</th><td><i> * a: admin command, like SAVE or SHUTDOWN.</i></td></tr>
<tr><th id="103">103</th><td><i> * p: Pub/Sub related command.</i></td></tr>
<tr><th id="104">104</th><td><i> * f: force replication of this command, regardless of server.dirty.</i></td></tr>
<tr><th id="105">105</th><td><i> * s: command not allowed in scripts.</i></td></tr>
<tr><th id="106">106</th><td><i> * R: random command. Command is not deterministic, that is, the same command</i></td></tr>
<tr><th id="107">107</th><td><i> *    with the same arguments, with the same key space, may have different</i></td></tr>
<tr><th id="108">108</th><td><i> *    results. For instance SPOP and RANDOMKEY are two random commands.</i></td></tr>
<tr><th id="109">109</th><td><i> * S: Sort command output array if called from script, so that the output</i></td></tr>
<tr><th id="110">110</th><td><i> *    is deterministic.</i></td></tr>
<tr><th id="111">111</th><td><i> * l: Allow command while loading the database.</i></td></tr>
<tr><th id="112">112</th><td><i> * t: Allow command while a slave has stale data but is not allowed to</i></td></tr>
<tr><th id="113">113</th><td><i> *    server this data. Normally no command is accepted in this condition</i></td></tr>
<tr><th id="114">114</th><td><i> *    but just a few.</i></td></tr>
<tr><th id="115">115</th><td><i> * M: Do not automatically propagate the command on MONITOR.</i></td></tr>
<tr><th id="116">116</th><td><i> * k: Perform an implicit ASKING for this command, so the command will be</i></td></tr>
<tr><th id="117">117</th><td><i> *    accepted in cluster mode if the slot is marked as 'importing'.</i></td></tr>
<tr><th id="118">118</th><td><i> * F: Fast command: O(1) or O(log(N)) command that should never delay</i></td></tr>
<tr><th id="119">119</th><td><i> *    its execution as long as the kernel scheduler is giving us time.</i></td></tr>
<tr><th id="120">120</th><td><i> *    Note that commands that may trigger a DEL as a side effect (like SET)</i></td></tr>
<tr><th id="121">121</th><td><i> *    are not fast commands.</i></td></tr>
<tr><th id="122">122</th><td><i> */</i></td></tr>
<tr><th id="123">123</th><td><b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> <dfn class="decl def" id="redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</dfn>[] = {</td></tr>
<tr><th id="124">124</th><td>    {<q>"get"</q>,<a class="ref fn" href="redis.h.html#getCommand" title='getCommand' data-ref="getCommand">getCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="125">125</th><td>    {<q>"set"</q>,<a class="ref fn" href="redis.h.html#setCommand" title='setCommand' data-ref="setCommand">setCommand</a>,-<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="126">126</th><td>    {<q>"setnx"</q>,<a class="ref fn" href="redis.h.html#setnxCommand" title='setnxCommand' data-ref="setnxCommand">setnxCommand</a>,<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="127">127</th><td>    {<q>"setex"</q>,<a class="ref fn" href="redis.h.html#setexCommand" title='setexCommand' data-ref="setexCommand">setexCommand</a>,<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="128">128</th><td>    {<q>"psetex"</q>,<a class="ref fn" href="redis.h.html#psetexCommand" title='psetexCommand' data-ref="psetexCommand">psetexCommand</a>,<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="129">129</th><td>    {<q>"append"</q>,<a class="ref fn" href="redis.h.html#appendCommand" title='appendCommand' data-ref="appendCommand">appendCommand</a>,<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="130">130</th><td>    {<q>"strlen"</q>,<a class="ref fn" href="redis.h.html#strlenCommand" title='strlenCommand' data-ref="strlenCommand">strlenCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="131">131</th><td>    {<q>"del"</q>,<a class="ref fn" href="redis.h.html#delCommand" title='delCommand' data-ref="delCommand">delCommand</a>,-<var>2</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="132">132</th><td>    {<q>"exists"</q>,<a class="ref fn" href="redis.h.html#existsCommand" title='existsCommand' data-ref="existsCommand">existsCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="133">133</th><td>    {<q>"setbit"</q>,<a class="ref fn" href="redis.h.html#setbitCommand" title='setbitCommand' data-ref="setbitCommand">setbitCommand</a>,<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="134">134</th><td>    {<q>"getbit"</q>,<a class="ref fn" href="redis.h.html#getbitCommand" title='getbitCommand' data-ref="getbitCommand">getbitCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="135">135</th><td>    {<q>"setrange"</q>,<a class="ref fn" href="redis.h.html#setrangeCommand" title='setrangeCommand' data-ref="setrangeCommand">setrangeCommand</a>,<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="136">136</th><td>    {<q>"getrange"</q>,<a class="ref fn" href="redis.h.html#getrangeCommand" title='getrangeCommand' data-ref="getrangeCommand">getrangeCommand</a>,<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="137">137</th><td>    {<q>"substr"</q>,<a class="ref fn" href="redis.h.html#getrangeCommand" title='getrangeCommand' data-ref="getrangeCommand">getrangeCommand</a>,<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="138">138</th><td>    {<q>"incr"</q>,<a class="ref fn" href="redis.h.html#incrCommand" title='incrCommand' data-ref="incrCommand">incrCommand</a>,<var>2</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="139">139</th><td>    {<q>"decr"</q>,<a class="ref fn" href="redis.h.html#decrCommand" title='decrCommand' data-ref="decrCommand">decrCommand</a>,<var>2</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="140">140</th><td>    {<q>"mget"</q>,<a class="ref fn" href="redis.h.html#mgetCommand" title='mgetCommand' data-ref="mgetCommand">mgetCommand</a>,-<var>2</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="141">141</th><td>    {<q>"rpush"</q>,<a class="ref fn" href="redis.h.html#rpushCommand" title='rpushCommand' data-ref="rpushCommand">rpushCommand</a>,-<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="142">142</th><td>    {<q>"lpush"</q>,<a class="ref fn" href="redis.h.html#lpushCommand" title='lpushCommand' data-ref="lpushCommand">lpushCommand</a>,-<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="143">143</th><td>    {<q>"rpushx"</q>,<a class="ref fn" href="redis.h.html#rpushxCommand" title='rpushxCommand' data-ref="rpushxCommand">rpushxCommand</a>,<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="144">144</th><td>    {<q>"lpushx"</q>,<a class="ref fn" href="redis.h.html#lpushxCommand" title='lpushxCommand' data-ref="lpushxCommand">lpushxCommand</a>,<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="145">145</th><td>    {<q>"linsert"</q>,<a class="ref fn" href="redis.h.html#linsertCommand" title='linsertCommand' data-ref="linsertCommand">linsertCommand</a>,<var>5</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="146">146</th><td>    {<q>"rpop"</q>,<a class="ref fn" href="redis.h.html#rpopCommand" title='rpopCommand' data-ref="rpopCommand">rpopCommand</a>,<var>2</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="147">147</th><td>    {<q>"lpop"</q>,<a class="ref fn" href="redis.h.html#lpopCommand" title='lpopCommand' data-ref="lpopCommand">lpopCommand</a>,<var>2</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="148">148</th><td>    {<q>"brpop"</q>,<a class="ref fn" href="redis.h.html#brpopCommand" title='brpopCommand' data-ref="brpopCommand">brpopCommand</a>,-<var>3</var>,<q>"ws"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="149">149</th><td>    {<q>"brpoplpush"</q>,<a class="ref fn" href="redis.h.html#brpoplpushCommand" title='brpoplpushCommand' data-ref="brpoplpushCommand">brpoplpushCommand</a>,<var>4</var>,<q>"wms"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>2</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="150">150</th><td>    {<q>"blpop"</q>,<a class="ref fn" href="redis.h.html#blpopCommand" title='blpopCommand' data-ref="blpopCommand">blpopCommand</a>,-<var>3</var>,<q>"ws"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>2</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="151">151</th><td>    {<q>"llen"</q>,<a class="ref fn" href="redis.h.html#llenCommand" title='llenCommand' data-ref="llenCommand">llenCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="152">152</th><td>    {<q>"lindex"</q>,<a class="ref fn" href="redis.h.html#lindexCommand" title='lindexCommand' data-ref="lindexCommand">lindexCommand</a>,<var>3</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="153">153</th><td>    {<q>"lset"</q>,<a class="ref fn" href="redis.h.html#lsetCommand" title='lsetCommand' data-ref="lsetCommand">lsetCommand</a>,<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="154">154</th><td>    {<q>"lrange"</q>,<a class="ref fn" href="redis.h.html#lrangeCommand" title='lrangeCommand' data-ref="lrangeCommand">lrangeCommand</a>,<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="155">155</th><td>    {<q>"ltrim"</q>,<a class="ref fn" href="redis.h.html#ltrimCommand" title='ltrimCommand' data-ref="ltrimCommand">ltrimCommand</a>,<var>4</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="156">156</th><td>    {<q>"lrem"</q>,<a class="ref fn" href="redis.h.html#lremCommand" title='lremCommand' data-ref="lremCommand">lremCommand</a>,<var>4</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="157">157</th><td>    {<q>"rpoplpush"</q>,<a class="ref fn" href="redis.h.html#rpoplpushCommand" title='rpoplpushCommand' data-ref="rpoplpushCommand">rpoplpushCommand</a>,<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>2</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="158">158</th><td>    {<q>"sadd"</q>,<a class="ref fn" href="redis.h.html#saddCommand" title='saddCommand' data-ref="saddCommand">saddCommand</a>,-<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="159">159</th><td>    {<q>"srem"</q>,<a class="ref fn" href="redis.h.html#sremCommand" title='sremCommand' data-ref="sremCommand">sremCommand</a>,-<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="160">160</th><td>    {<q>"smove"</q>,<a class="ref fn" href="redis.h.html#smoveCommand" title='smoveCommand' data-ref="smoveCommand">smoveCommand</a>,<var>4</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>2</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="161">161</th><td>    {<q>"sismember"</q>,<a class="ref fn" href="redis.h.html#sismemberCommand" title='sismemberCommand' data-ref="sismemberCommand">sismemberCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="162">162</th><td>    {<q>"scard"</q>,<a class="ref fn" href="redis.h.html#scardCommand" title='scardCommand' data-ref="scardCommand">scardCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="163">163</th><td>    {<q>"spop"</q>,<a class="ref fn" href="redis.h.html#spopCommand" title='spopCommand' data-ref="spopCommand">spopCommand</a>,<var>2</var>,<q>"wRsF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="164">164</th><td>    {<q>"srandmember"</q>,<a class="ref fn" href="redis.h.html#srandmemberCommand" title='srandmemberCommand' data-ref="srandmemberCommand">srandmemberCommand</a>,-<var>2</var>,<q>"rR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="165">165</th><td>    {<q>"sinter"</q>,<a class="ref fn" href="redis.h.html#sinterCommand" title='sinterCommand' data-ref="sinterCommand">sinterCommand</a>,-<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="166">166</th><td>    {<q>"sinterstore"</q>,<a class="ref fn" href="redis.h.html#sinterstoreCommand" title='sinterstoreCommand' data-ref="sinterstoreCommand">sinterstoreCommand</a>,-<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="167">167</th><td>    {<q>"sunion"</q>,<a class="ref fn" href="redis.h.html#sunionCommand" title='sunionCommand' data-ref="sunionCommand">sunionCommand</a>,-<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="168">168</th><td>    {<q>"sunionstore"</q>,<a class="ref fn" href="redis.h.html#sunionstoreCommand" title='sunionstoreCommand' data-ref="sunionstoreCommand">sunionstoreCommand</a>,-<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="169">169</th><td>    {<q>"sdiff"</q>,<a class="ref fn" href="redis.h.html#sdiffCommand" title='sdiffCommand' data-ref="sdiffCommand">sdiffCommand</a>,-<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="170">170</th><td>    {<q>"sdiffstore"</q>,<a class="ref fn" href="redis.h.html#sdiffstoreCommand" title='sdiffstoreCommand' data-ref="sdiffstoreCommand">sdiffstoreCommand</a>,-<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="171">171</th><td>    {<q>"smembers"</q>,<a class="ref fn" href="redis.h.html#sinterCommand" title='sinterCommand' data-ref="sinterCommand">sinterCommand</a>,<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="172">172</th><td>    {<q>"sscan"</q>,<a class="ref fn" href="redis.h.html#sscanCommand" title='sscanCommand' data-ref="sscanCommand">sscanCommand</a>,-<var>3</var>,<q>"rR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="173">173</th><td>    {<q>"zadd"</q>,<a class="ref fn" href="redis.h.html#zaddCommand" title='zaddCommand' data-ref="zaddCommand">zaddCommand</a>,-<var>4</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="174">174</th><td>    {<q>"zincrby"</q>,<a class="ref fn" href="redis.h.html#zincrbyCommand" title='zincrbyCommand' data-ref="zincrbyCommand">zincrbyCommand</a>,<var>4</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="175">175</th><td>    {<q>"zrem"</q>,<a class="ref fn" href="redis.h.html#zremCommand" title='zremCommand' data-ref="zremCommand">zremCommand</a>,-<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="176">176</th><td>    {<q>"zremrangebyscore"</q>,<a class="ref fn" href="redis.h.html#zremrangebyscoreCommand" title='zremrangebyscoreCommand' data-ref="zremrangebyscoreCommand">zremrangebyscoreCommand</a>,<var>4</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="177">177</th><td>    {<q>"zremrangebyrank"</q>,<a class="ref fn" href="redis.h.html#zremrangebyrankCommand" title='zremrangebyrankCommand' data-ref="zremrangebyrankCommand">zremrangebyrankCommand</a>,<var>4</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="178">178</th><td>    {<q>"zremrangebylex"</q>,<a class="ref fn" href="redis.h.html#zremrangebylexCommand" title='zremrangebylexCommand' data-ref="zremrangebylexCommand">zremrangebylexCommand</a>,<var>4</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="179">179</th><td>    {<q>"zunionstore"</q>,<a class="ref fn" href="redis.h.html#zunionstoreCommand" title='zunionstoreCommand' data-ref="zunionstoreCommand">zunionstoreCommand</a>,-<var>4</var>,<q>"wm"</q>,<var>0</var>,<a class="ref fn" href="redis.h.html#zunionInterGetKeys" title='zunionInterGetKeys' data-ref="zunionInterGetKeys">zunionInterGetKeys</a>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="180">180</th><td>    {<q>"zinterstore"</q>,<a class="ref fn" href="redis.h.html#zinterstoreCommand" title='zinterstoreCommand' data-ref="zinterstoreCommand">zinterstoreCommand</a>,-<var>4</var>,<q>"wm"</q>,<var>0</var>,<a class="ref fn" href="redis.h.html#zunionInterGetKeys" title='zunionInterGetKeys' data-ref="zunionInterGetKeys">zunionInterGetKeys</a>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="181">181</th><td>    {<q>"zrange"</q>,<a class="ref fn" href="redis.h.html#zrangeCommand" title='zrangeCommand' data-ref="zrangeCommand">zrangeCommand</a>,-<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="182">182</th><td>    {<q>"zrangebyscore"</q>,<a class="ref fn" href="redis.h.html#zrangebyscoreCommand" title='zrangebyscoreCommand' data-ref="zrangebyscoreCommand">zrangebyscoreCommand</a>,-<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="183">183</th><td>    {<q>"zrevrangebyscore"</q>,<a class="ref fn" href="redis.h.html#zrevrangebyscoreCommand" title='zrevrangebyscoreCommand' data-ref="zrevrangebyscoreCommand">zrevrangebyscoreCommand</a>,-<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="184">184</th><td>    {<q>"zrangebylex"</q>,<a class="ref fn" href="redis.h.html#zrangebylexCommand" title='zrangebylexCommand' data-ref="zrangebylexCommand">zrangebylexCommand</a>,-<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="185">185</th><td>    {<q>"zrevrangebylex"</q>,<a class="ref fn" href="redis.h.html#zrevrangebylexCommand" title='zrevrangebylexCommand' data-ref="zrevrangebylexCommand">zrevrangebylexCommand</a>,-<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="186">186</th><td>    {<q>"zcount"</q>,<a class="ref fn" href="redis.h.html#zcountCommand" title='zcountCommand' data-ref="zcountCommand">zcountCommand</a>,<var>4</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="187">187</th><td>    {<q>"zlexcount"</q>,<a class="ref fn" href="redis.h.html#zlexcountCommand" title='zlexcountCommand' data-ref="zlexcountCommand">zlexcountCommand</a>,<var>4</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="188">188</th><td>    {<q>"zrevrange"</q>,<a class="ref fn" href="redis.h.html#zrevrangeCommand" title='zrevrangeCommand' data-ref="zrevrangeCommand">zrevrangeCommand</a>,-<var>4</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="189">189</th><td>    {<q>"zcard"</q>,<a class="ref fn" href="redis.h.html#zcardCommand" title='zcardCommand' data-ref="zcardCommand">zcardCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="190">190</th><td>    {<q>"zscore"</q>,<a class="ref fn" href="redis.h.html#zscoreCommand" title='zscoreCommand' data-ref="zscoreCommand">zscoreCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="191">191</th><td>    {<q>"zrank"</q>,<a class="ref fn" href="redis.h.html#zrankCommand" title='zrankCommand' data-ref="zrankCommand">zrankCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="192">192</th><td>    {<q>"zrevrank"</q>,<a class="ref fn" href="redis.h.html#zrevrankCommand" title='zrevrankCommand' data-ref="zrevrankCommand">zrevrankCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="193">193</th><td>    {<q>"zscan"</q>,<a class="ref fn" href="redis.h.html#zscanCommand" title='zscanCommand' data-ref="zscanCommand">zscanCommand</a>,-<var>3</var>,<q>"rR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="194">194</th><td>    {<q>"hset"</q>,<a class="ref fn" href="redis.h.html#hsetCommand" title='hsetCommand' data-ref="hsetCommand">hsetCommand</a>,<var>4</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="195">195</th><td>    {<q>"hsetnx"</q>,<a class="ref fn" href="redis.h.html#hsetnxCommand" title='hsetnxCommand' data-ref="hsetnxCommand">hsetnxCommand</a>,<var>4</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="196">196</th><td>    {<q>"hget"</q>,<a class="ref fn" href="redis.h.html#hgetCommand" title='hgetCommand' data-ref="hgetCommand">hgetCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="197">197</th><td>    {<q>"hmset"</q>,<a class="ref fn" href="redis.h.html#hmsetCommand" title='hmsetCommand' data-ref="hmsetCommand">hmsetCommand</a>,-<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="198">198</th><td>    {<q>"hmget"</q>,<a class="ref fn" href="redis.h.html#hmgetCommand" title='hmgetCommand' data-ref="hmgetCommand">hmgetCommand</a>,-<var>3</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="199">199</th><td>    {<q>"hincrby"</q>,<a class="ref fn" href="redis.h.html#hincrbyCommand" title='hincrbyCommand' data-ref="hincrbyCommand">hincrbyCommand</a>,<var>4</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="200">200</th><td>    {<q>"hincrbyfloat"</q>,<a class="ref fn" href="redis.h.html#hincrbyfloatCommand" title='hincrbyfloatCommand' data-ref="hincrbyfloatCommand">hincrbyfloatCommand</a>,<var>4</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="201">201</th><td>    {<q>"hdel"</q>,<a class="ref fn" href="redis.h.html#hdelCommand" title='hdelCommand' data-ref="hdelCommand">hdelCommand</a>,-<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="202">202</th><td>    {<q>"hlen"</q>,<a class="ref fn" href="redis.h.html#hlenCommand" title='hlenCommand' data-ref="hlenCommand">hlenCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="203">203</th><td>    {<q>"hkeys"</q>,<a class="ref fn" href="redis.h.html#hkeysCommand" title='hkeysCommand' data-ref="hkeysCommand">hkeysCommand</a>,<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="204">204</th><td>    {<q>"hvals"</q>,<a class="ref fn" href="redis.h.html#hvalsCommand" title='hvalsCommand' data-ref="hvalsCommand">hvalsCommand</a>,<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="205">205</th><td>    {<q>"hgetall"</q>,<a class="ref fn" href="redis.h.html#hgetallCommand" title='hgetallCommand' data-ref="hgetallCommand">hgetallCommand</a>,<var>2</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="206">206</th><td>    {<q>"hexists"</q>,<a class="ref fn" href="redis.h.html#hexistsCommand" title='hexistsCommand' data-ref="hexistsCommand">hexistsCommand</a>,<var>3</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="207">207</th><td>    {<q>"hscan"</q>,<a class="ref fn" href="redis.h.html#hscanCommand" title='hscanCommand' data-ref="hscanCommand">hscanCommand</a>,-<var>3</var>,<q>"rR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="208">208</th><td>    {<q>"incrby"</q>,<a class="ref fn" href="redis.h.html#incrbyCommand" title='incrbyCommand' data-ref="incrbyCommand">incrbyCommand</a>,<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="209">209</th><td>    {<q>"decrby"</q>,<a class="ref fn" href="redis.h.html#decrbyCommand" title='decrbyCommand' data-ref="decrbyCommand">decrbyCommand</a>,<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="210">210</th><td>    {<q>"incrbyfloat"</q>,<a class="ref fn" href="redis.h.html#incrbyfloatCommand" title='incrbyfloatCommand' data-ref="incrbyfloatCommand">incrbyfloatCommand</a>,<var>3</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="211">211</th><td>    {<q>"getset"</q>,<a class="ref fn" href="redis.h.html#getsetCommand" title='getsetCommand' data-ref="getsetCommand">getsetCommand</a>,<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="212">212</th><td>    {<q>"mset"</q>,<a class="ref fn" href="redis.h.html#msetCommand" title='msetCommand' data-ref="msetCommand">msetCommand</a>,-<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>2</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="213">213</th><td>    {<q>"msetnx"</q>,<a class="ref fn" href="redis.h.html#msetnxCommand" title='msetnxCommand' data-ref="msetnxCommand">msetnxCommand</a>,-<var>3</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>2</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="214">214</th><td>    {<q>"randomkey"</q>,<a class="ref fn" href="redis.h.html#randomkeyCommand" title='randomkeyCommand' data-ref="randomkeyCommand">randomkeyCommand</a>,<var>1</var>,<q>"rR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="215">215</th><td>    {<q>"select"</q>,<a class="ref fn" href="redis.h.html#selectCommand" title='selectCommand' data-ref="selectCommand">selectCommand</a>,<var>2</var>,<q>"rlF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="216">216</th><td>    {<q>"move"</q>,<a class="ref fn" href="redis.h.html#moveCommand" title='moveCommand' data-ref="moveCommand">moveCommand</a>,<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="217">217</th><td>    {<q>"rename"</q>,<a class="ref fn" href="redis.h.html#renameCommand" title='renameCommand' data-ref="renameCommand">renameCommand</a>,<var>3</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>2</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="218">218</th><td>    {<q>"renamenx"</q>,<a class="ref fn" href="redis.h.html#renamenxCommand" title='renamenxCommand' data-ref="renamenxCommand">renamenxCommand</a>,<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>2</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="219">219</th><td>    {<q>"expire"</q>,<a class="ref fn" href="redis.h.html#expireCommand" title='expireCommand' data-ref="expireCommand">expireCommand</a>,<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="220">220</th><td>    {<q>"expireat"</q>,<a class="ref fn" href="redis.h.html#expireatCommand" title='expireatCommand' data-ref="expireatCommand">expireatCommand</a>,<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="221">221</th><td>    {<q>"pexpire"</q>,<a class="ref fn" href="redis.h.html#pexpireCommand" title='pexpireCommand' data-ref="pexpireCommand">pexpireCommand</a>,<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="222">222</th><td>    {<q>"pexpireat"</q>,<a class="ref fn" href="redis.h.html#pexpireatCommand" title='pexpireatCommand' data-ref="pexpireatCommand">pexpireatCommand</a>,<var>3</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="223">223</th><td>    {<q>"keys"</q>,<a class="ref fn" href="redis.h.html#keysCommand" title='keysCommand' data-ref="keysCommand">keysCommand</a>,<var>2</var>,<q>"rS"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="224">224</th><td>    {<q>"scan"</q>,<a class="ref fn" href="redis.h.html#scanCommand" title='scanCommand' data-ref="scanCommand">scanCommand</a>,-<var>2</var>,<q>"rR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="225">225</th><td>    {<q>"dbsize"</q>,<a class="ref fn" href="redis.h.html#dbsizeCommand" title='dbsizeCommand' data-ref="dbsizeCommand">dbsizeCommand</a>,<var>1</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="226">226</th><td>    {<q>"auth"</q>,<a class="ref fn" href="#authCommand" title='authCommand' data-ref="authCommand">authCommand</a>,<var>2</var>,<q>"rsltF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="227">227</th><td>    {<q>"ping"</q>,<a class="ref fn" href="#pingCommand" title='pingCommand' data-ref="pingCommand">pingCommand</a>,-<var>1</var>,<q>"rtF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="228">228</th><td>    {<q>"echo"</q>,<a class="ref fn" href="#echoCommand" title='echoCommand' data-ref="echoCommand">echoCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="229">229</th><td>    {<q>"save"</q>,<a class="ref fn" href="redis.h.html#saveCommand" title='saveCommand' data-ref="saveCommand">saveCommand</a>,<var>1</var>,<q>"ars"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="230">230</th><td>    {<q>"bgsave"</q>,<a class="ref fn" href="redis.h.html#bgsaveCommand" title='bgsaveCommand' data-ref="bgsaveCommand">bgsaveCommand</a>,<var>1</var>,<q>"ar"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="231">231</th><td>    {<q>"bgrewriteaof"</q>,<a class="ref fn" href="redis.h.html#bgrewriteaofCommand" title='bgrewriteaofCommand' data-ref="bgrewriteaofCommand">bgrewriteaofCommand</a>,<var>1</var>,<q>"ar"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="232">232</th><td>    {<q>"shutdown"</q>,<a class="ref fn" href="redis.h.html#shutdownCommand" title='shutdownCommand' data-ref="shutdownCommand">shutdownCommand</a>,-<var>1</var>,<q>"arlt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="233">233</th><td>    {<q>"lastsave"</q>,<a class="ref fn" href="redis.h.html#lastsaveCommand" title='lastsaveCommand' data-ref="lastsaveCommand">lastsaveCommand</a>,<var>1</var>,<q>"rRF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="234">234</th><td>    {<q>"type"</q>,<a class="ref fn" href="redis.h.html#typeCommand" title='typeCommand' data-ref="typeCommand">typeCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="235">235</th><td>    {<q>"multi"</q>,<a class="ref fn" href="redis.h.html#multiCommand" title='multiCommand' data-ref="multiCommand">multiCommand</a>,<var>1</var>,<q>"rsF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="236">236</th><td>    {<q>"exec"</q>,<a class="ref fn" href="redis.h.html#execCommand" title='execCommand' data-ref="execCommand">execCommand</a>,<var>1</var>,<q>"sM"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="237">237</th><td>    {<q>"discard"</q>,<a class="ref fn" href="redis.h.html#discardCommand" title='discardCommand' data-ref="discardCommand">discardCommand</a>,<var>1</var>,<q>"rsF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="238">238</th><td>    {<q>"sync"</q>,<a class="ref fn" href="redis.h.html#syncCommand" title='syncCommand' data-ref="syncCommand">syncCommand</a>,<var>1</var>,<q>"ars"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="239">239</th><td>    {<q>"psync"</q>,<a class="ref fn" href="redis.h.html#syncCommand" title='syncCommand' data-ref="syncCommand">syncCommand</a>,<var>3</var>,<q>"ars"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="240">240</th><td>    {<q>"replconf"</q>,<a class="ref fn" href="redis.h.html#replconfCommand" title='replconfCommand' data-ref="replconfCommand">replconfCommand</a>,-<var>1</var>,<q>"arslt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="241">241</th><td>    {<q>"flushdb"</q>,<a class="ref fn" href="redis.h.html#flushdbCommand" title='flushdbCommand' data-ref="flushdbCommand">flushdbCommand</a>,<var>1</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="242">242</th><td>    {<q>"flushall"</q>,<a class="ref fn" href="redis.h.html#flushallCommand" title='flushallCommand' data-ref="flushallCommand">flushallCommand</a>,<var>1</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="243">243</th><td>    {<q>"sort"</q>,<a class="ref fn" href="redis.h.html#sortCommand" title='sortCommand' data-ref="sortCommand">sortCommand</a>,-<var>2</var>,<q>"wm"</q>,<var>0</var>,<a class="ref fn" href="redis.h.html#sortGetKeys" title='sortGetKeys' data-ref="sortGetKeys">sortGetKeys</a>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="244">244</th><td>    {<q>"info"</q>,<a class="ref fn" href="#infoCommand" title='infoCommand' data-ref="infoCommand">infoCommand</a>,-<var>1</var>,<q>"rlt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="245">245</th><td>    {<q>"monitor"</q>,<a class="ref fn" href="#monitorCommand" title='monitorCommand' data-ref="monitorCommand">monitorCommand</a>,<var>1</var>,<q>"ars"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="246">246</th><td>    {<q>"ttl"</q>,<a class="ref fn" href="redis.h.html#ttlCommand" title='ttlCommand' data-ref="ttlCommand">ttlCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="247">247</th><td>    {<q>"pttl"</q>,<a class="ref fn" href="redis.h.html#pttlCommand" title='pttlCommand' data-ref="pttlCommand">pttlCommand</a>,<var>2</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="248">248</th><td>    {<q>"persist"</q>,<a class="ref fn" href="redis.h.html#persistCommand" title='persistCommand' data-ref="persistCommand">persistCommand</a>,<var>2</var>,<q>"wF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="249">249</th><td>    {<q>"slaveof"</q>,<a class="ref fn" href="redis.h.html#slaveofCommand" title='slaveofCommand' data-ref="slaveofCommand">slaveofCommand</a>,<var>3</var>,<q>"ast"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="250">250</th><td>    {<q>"role"</q>,<a class="ref fn" href="redis.h.html#roleCommand" title='roleCommand' data-ref="roleCommand">roleCommand</a>,<var>1</var>,<q>"lst"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="251">251</th><td>    {<q>"debug"</q>,<a class="ref fn" href="redis.h.html#debugCommand" title='debugCommand' data-ref="debugCommand">debugCommand</a>,-<var>2</var>,<q>"as"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="252">252</th><td>    {<q>"config"</q>,<a class="ref fn" href="redis.h.html#configCommand" title='configCommand' data-ref="configCommand">configCommand</a>,-<var>2</var>,<q>"art"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="253">253</th><td>    {<q>"subscribe"</q>,<a class="ref fn" href="redis.h.html#subscribeCommand" title='subscribeCommand' data-ref="subscribeCommand">subscribeCommand</a>,-<var>2</var>,<q>"rpslt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="254">254</th><td>    {<q>"unsubscribe"</q>,<a class="ref fn" href="redis.h.html#unsubscribeCommand" title='unsubscribeCommand' data-ref="unsubscribeCommand">unsubscribeCommand</a>,-<var>1</var>,<q>"rpslt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="255">255</th><td>    {<q>"psubscribe"</q>,<a class="ref fn" href="redis.h.html#psubscribeCommand" title='psubscribeCommand' data-ref="psubscribeCommand">psubscribeCommand</a>,-<var>2</var>,<q>"rpslt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="256">256</th><td>    {<q>"punsubscribe"</q>,<a class="ref fn" href="redis.h.html#punsubscribeCommand" title='punsubscribeCommand' data-ref="punsubscribeCommand">punsubscribeCommand</a>,-<var>1</var>,<q>"rpslt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="257">257</th><td>    {<q>"publish"</q>,<a class="ref fn" href="redis.h.html#publishCommand" title='publishCommand' data-ref="publishCommand">publishCommand</a>,<var>3</var>,<q>"pltrF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="258">258</th><td>    {<q>"pubsub"</q>,<a class="ref fn" href="redis.h.html#pubsubCommand" title='pubsubCommand' data-ref="pubsubCommand">pubsubCommand</a>,-<var>2</var>,<q>"pltrR"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="259">259</th><td>    {<q>"watch"</q>,<a class="ref fn" href="redis.h.html#watchCommand" title='watchCommand' data-ref="watchCommand">watchCommand</a>,-<var>2</var>,<q>"rsF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="260">260</th><td>    {<q>"unwatch"</q>,<a class="ref fn" href="redis.h.html#unwatchCommand" title='unwatchCommand' data-ref="unwatchCommand">unwatchCommand</a>,<var>1</var>,<q>"rsF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="261">261</th><td>    {<q>"cluster"</q>,<a class="ref fn" href="redis.h.html#clusterCommand" title='clusterCommand' data-ref="clusterCommand">clusterCommand</a>,-<var>2</var>,<q>"ar"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="262">262</th><td>    {<q>"restore"</q>,<a class="ref fn" href="redis.h.html#restoreCommand" title='restoreCommand' data-ref="restoreCommand">restoreCommand</a>,-<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="263">263</th><td>    {<q>"restore-asking"</q>,<a class="ref fn" href="redis.h.html#restoreCommand" title='restoreCommand' data-ref="restoreCommand">restoreCommand</a>,-<var>4</var>,<q>"wmk"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="264">264</th><td>    {<q>"migrate"</q>,<a class="ref fn" href="redis.h.html#migrateCommand" title='migrateCommand' data-ref="migrateCommand">migrateCommand</a>,-<var>6</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="265">265</th><td>    {<q>"asking"</q>,<a class="ref fn" href="redis.h.html#askingCommand" title='askingCommand' data-ref="askingCommand">askingCommand</a>,<var>1</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="266">266</th><td>    {<q>"readonly"</q>,<a class="ref fn" href="redis.h.html#readonlyCommand" title='readonlyCommand' data-ref="readonlyCommand">readonlyCommand</a>,<var>1</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="267">267</th><td>    {<q>"readwrite"</q>,<a class="ref fn" href="redis.h.html#readwriteCommand" title='readwriteCommand' data-ref="readwriteCommand">readwriteCommand</a>,<var>1</var>,<q>"rF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="268">268</th><td>    {<q>"dump"</q>,<a class="ref fn" href="redis.h.html#dumpCommand" title='dumpCommand' data-ref="dumpCommand">dumpCommand</a>,<var>2</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="269">269</th><td>    {<q>"object"</q>,<a class="ref fn" href="redis.h.html#objectCommand" title='objectCommand' data-ref="objectCommand">objectCommand</a>,<var>3</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>2</var>,<var>2</var>,<var>2</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="270">270</th><td>    {<q>"client"</q>,<a class="ref fn" href="redis.h.html#clientCommand" title='clientCommand' data-ref="clientCommand">clientCommand</a>,-<var>2</var>,<q>"rs"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="271">271</th><td>    {<q>"eval"</q>,<a class="ref fn" href="redis.h.html#evalCommand" title='evalCommand' data-ref="evalCommand">evalCommand</a>,-<var>3</var>,<q>"s"</q>,<var>0</var>,<a class="ref fn" href="redis.h.html#evalGetKeys" title='evalGetKeys' data-ref="evalGetKeys">evalGetKeys</a>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="272">272</th><td>    {<q>"evalsha"</q>,<a class="ref fn" href="redis.h.html#evalShaCommand" title='evalShaCommand' data-ref="evalShaCommand">evalShaCommand</a>,-<var>3</var>,<q>"s"</q>,<var>0</var>,<a class="ref fn" href="redis.h.html#evalGetKeys" title='evalGetKeys' data-ref="evalGetKeys">evalGetKeys</a>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="273">273</th><td>    {<q>"slowlog"</q>,<a class="ref fn" href="slowlog.h.html#slowlogCommand" title='slowlogCommand' data-ref="slowlogCommand">slowlogCommand</a>,-<var>2</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="274">274</th><td>    {<q>"script"</q>,<a class="ref fn" href="redis.h.html#scriptCommand" title='scriptCommand' data-ref="scriptCommand">scriptCommand</a>,-<var>2</var>,<q>"rs"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="275">275</th><td>    {<q>"time"</q>,<a class="ref fn" href="#timeCommand" title='timeCommand' data-ref="timeCommand">timeCommand</a>,<var>1</var>,<q>"rRF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="276">276</th><td>    {<q>"bitop"</q>,<a class="ref fn" href="redis.h.html#bitopCommand" title='bitopCommand' data-ref="bitopCommand">bitopCommand</a>,-<var>4</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>2</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="277">277</th><td>    {<q>"bitcount"</q>,<a class="ref fn" href="redis.h.html#bitcountCommand" title='bitcountCommand' data-ref="bitcountCommand">bitcountCommand</a>,-<var>2</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="278">278</th><td>    {<q>"bitpos"</q>,<a class="ref fn" href="redis.h.html#bitposCommand" title='bitposCommand' data-ref="bitposCommand">bitposCommand</a>,-<var>3</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="279">279</th><td>    {<q>"wait"</q>,<a class="ref fn" href="redis.h.html#waitCommand" title='waitCommand' data-ref="waitCommand">waitCommand</a>,<var>3</var>,<q>"rs"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="280">280</th><td>    {<q>"command"</q>,<a class="ref fn" href="#commandCommand" title='commandCommand' data-ref="commandCommand">commandCommand</a>,<var>0</var>,<q>"rlt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="281">281</th><td>    {<q>"pfselftest"</q>,<a class="ref fn" href="redis.h.html#pfselftestCommand" title='pfselftestCommand' data-ref="pfselftestCommand">pfselftestCommand</a>,<var>1</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="282">282</th><td>    {<q>"pfadd"</q>,<a class="ref fn" href="redis.h.html#pfaddCommand" title='pfaddCommand' data-ref="pfaddCommand">pfaddCommand</a>,-<var>2</var>,<q>"wmF"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="283">283</th><td>    {<q>"pfcount"</q>,<a class="ref fn" href="redis.h.html#pfcountCommand" title='pfcountCommand' data-ref="pfcountCommand">pfcountCommand</a>,-<var>2</var>,<q>"r"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="284">284</th><td>    {<q>"pfmerge"</q>,<a class="ref fn" href="redis.h.html#pfmergeCommand" title='pfmergeCommand' data-ref="pfmergeCommand">pfmergeCommand</a>,-<var>2</var>,<q>"wm"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>1</var>,-<var>1</var>,<var>1</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="285">285</th><td>    {<q>"pfdebug"</q>,<a class="ref fn" href="redis.h.html#pfdebugCommand" title='pfdebugCommand' data-ref="pfdebugCommand">pfdebugCommand</a>,-<var>3</var>,<q>"w"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>},</td></tr>
<tr><th id="286">286</th><td>    {<q>"latency"</q>,<a class="ref fn" href="redis.h.html#latencyCommand" title='latencyCommand' data-ref="latencyCommand">latencyCommand</a>,-<var>2</var>,<q>"arslt"</q>,<var>0</var>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>,<var>0</var>}</td></tr>
<tr><th id="287">287</th><td>};</td></tr>
<tr><th id="288">288</th><td></td></tr>
<tr><th id="289">289</th><td><b>struct</b> <a class="type" href="redis.h.html#evictionPoolEntry" title='evictionPoolEntry' data-ref="evictionPoolEntry">evictionPoolEntry</a> *<a class="decl fn" href="#evictionPoolAlloc" title='evictionPoolAlloc' data-ref="evictionPoolAlloc">evictionPoolAlloc</a>(<em>void</em>);</td></tr>
<tr><th id="290">290</th><td></td></tr>
<tr><th id="291">291</th><td><i>/*============================ Utility functions ============================ */</i></td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td><i>/* Low level logging. To use only for very big messages, otherwise</i></td></tr>
<tr><th id="294">294</th><td><i> * redisLog() is to prefer. */</i></td></tr>
<tr><th id="295">295</th><td><em>void</em> <dfn class="decl def fn" id="redisLogRaw" title='redisLogRaw' data-ref="redisLogRaw">redisLogRaw</dfn>(<em>int</em> <dfn class="local col6 decl" id="6level" title='level' data-type='int' data-ref="6level">level</dfn>, <em>const</em> <em>char</em> *<dfn class="local col7 decl" id="7msg" title='msg' data-type='const char *' data-ref="7msg">msg</dfn>) {</td></tr>
<tr><th id="296">296</th><td>    <em>const</em> <em>int</em> <dfn class="local col8 decl" id="8syslogLevelMap" title='syslogLevelMap' data-type='const int [4]' data-ref="8syslogLevelMap">syslogLevelMap</dfn>[] = { <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#58" title="7" data-ref="_M/LOG_DEBUG">LOG_DEBUG</a>, <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#57" title="6" data-ref="_M/LOG_INFO">LOG_INFO</a>, <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#56" title="5" data-ref="_M/LOG_NOTICE">LOG_NOTICE</a>, <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#55" title="4" data-ref="_M/LOG_WARNING">LOG_WARNING</a> };</td></tr>
<tr><th id="297">297</th><td>    <em>const</em> <em>char</em> *<dfn class="local col9 decl" id="9c" title='c' data-type='const char *' data-ref="9c">c</dfn> = <q>".-*#"</q>;</td></tr>
<tr><th id="298">298</th><td>    <a class="typedef" href="../../include/stdio.h.html#FILE" title='FILE' data-type='struct _IO_FILE' data-ref="FILE">FILE</a> *<dfn class="local col0 decl" id="10fp" title='fp' data-type='FILE *' data-ref="10fp">fp</dfn>;</td></tr>
<tr><th id="299">299</th><td>    <em>char</em> <dfn class="local col1 decl" id="11buf" title='buf' data-type='char [64]' data-ref="11buf">buf</dfn>[<var>64</var>];</td></tr>
<tr><th id="300">300</th><td>    <em>int</em> <dfn class="local col2 decl" id="12rawmode" title='rawmode' data-type='int' data-ref="12rawmode">rawmode</dfn> = (<a class="local col6 ref" href="#6level" title='level' data-ref="6level">level</a> &amp; <a class="macro" href="redis.h.html#305" title="(1&lt;&lt;10)" data-ref="_M/REDIS_LOG_RAW">REDIS_LOG_RAW</a>);</td></tr>
<tr><th id="301">301</th><td>    <em>int</em> <dfn class="local col3 decl" id="13log_to_stdout" title='log_to_stdout' data-type='int' data-ref="13log_to_stdout">log_to_stdout</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::logfile" title='redisServer::logfile' data-ref="redisServer::logfile">logfile</a>[<var>0</var>] == <kbd>'\0'</kbd>;</td></tr>
<tr><th id="302">302</th><td></td></tr>
<tr><th id="303">303</th><td>    <a class="local col6 ref" href="#6level" title='level' data-ref="6level">level</a> &amp;= <var>0xff</var>; <i>/* clear flags */</i></td></tr>
<tr><th id="304">304</th><td>    <b>if</b> (<a class="local col6 ref" href="#6level" title='level' data-ref="6level">level</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::verbosity" title='redisServer::verbosity' data-ref="redisServer::verbosity">verbosity</a>) <b>return</b>;</td></tr>
<tr><th id="305">305</th><td></td></tr>
<tr><th id="306">306</th><td>    <a class="local col0 ref" href="#10fp" title='fp' data-ref="10fp">fp</a> = <a class="local col3 ref" href="#13log_to_stdout" title='log_to_stdout' data-ref="13log_to_stdout">log_to_stdout</a> ? <a class="macro" href="../../include/stdio.h.html#173" title="stdout" data-ref="_M/stdout">stdout</a> : <a class="ref fn" href="../../include/stdio.h.html#283" title='fopen' data-ref="fopen64">fopen</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::logfile" title='redisServer::logfile' data-ref="redisServer::logfile">logfile</a>,<q>"a"</q>);</td></tr>
<tr><th id="307">307</th><td>    <b>if</b> (!<a class="local col0 ref" href="#10fp" title='fp' data-ref="10fp">fp</a>) <b>return</b>;</td></tr>
<tr><th id="308">308</th><td></td></tr>
<tr><th id="309">309</th><td>    <b>if</b> (<a class="local col2 ref" href="#12rawmode" title='rawmode' data-ref="12rawmode">rawmode</a>) {</td></tr>
<tr><th id="310">310</th><td>        <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="local col0 ref" href="#10fp" title='fp' data-ref="10fp">fp</a>,<q>"%s"</q>,<a class="local col7 ref" href="#7msg" title='msg' data-ref="7msg">msg</a>);</td></tr>
<tr><th id="311">311</th><td>    } <b>else</b> {</td></tr>
<tr><th id="312">312</th><td>        <em>int</em> <dfn class="local col4 decl" id="14off" title='off' data-type='int' data-ref="14off">off</dfn>;</td></tr>
<tr><th id="313">313</th><td>        <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval" title='timeval' data-ref="timeval">timeval</a> <dfn class="local col5 decl" id="15tv" title='tv' data-type='struct timeval' data-ref="15tv">tv</dfn>;</td></tr>
<tr><th id="314">314</th><td>        <em>int</em> <dfn class="local col6 decl" id="16role_char" title='role_char' data-type='int' data-ref="16role_char">role_char</dfn>;</td></tr>
<tr><th id="315">315</th><td>        <a class="typedef" href="../../include/x86_64-linux-gnu/sys/types.h.html#pid_t" title='pid_t' data-type='__pid_t' data-ref="pid_t">pid_t</a> <dfn class="local col7 decl" id="17pid" title='pid' data-type='pid_t' data-ref="17pid">pid</dfn> = <a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>();</td></tr>
<tr><th id="316">316</th><td></td></tr>
<tr><th id="317">317</th><td>        <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/time.h.html#gettimeofday" title='gettimeofday' data-ref="gettimeofday">gettimeofday</a>(&amp;<a class="local col5 ref" href="#15tv" title='tv' data-ref="15tv">tv</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="318">318</th><td>        <a class="local col4 ref" href="#14off" title='off' data-ref="14off">off</a> = <a class="ref fn" href="../../include/time.h.html#strftime" title='strftime' data-ref="strftime">strftime</a>(<a class="local col1 ref" href="#11buf" title='buf' data-ref="11buf">buf</a>,<b>sizeof</b>(<a class="local col1 ref" href="#11buf" title='buf' data-ref="11buf">buf</a>),<q>"%d %b %H:%M:%S."</q>,<a class="ref fn" href="../../include/time.h.html#localtime" title='localtime' data-ref="localtime">localtime</a>(&amp;<a class="local col5 ref" href="#15tv" title='tv' data-ref="15tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>));</td></tr>
<tr><th id="319">319</th><td>        <a class="ref fn" href="../../include/stdio.h.html#snprintf" title='snprintf' data-ref="snprintf">snprintf</a>(<a class="local col1 ref" href="#11buf" title='buf' data-ref="11buf">buf</a>+<a class="local col4 ref" href="#14off" title='off' data-ref="14off">off</a>,<b>sizeof</b>(<a class="local col1 ref" href="#11buf" title='buf' data-ref="11buf">buf</a>)-<a class="local col4 ref" href="#14off" title='off' data-ref="14off">off</a>,<q>"%03d"</q>,(<em>int</em>)<a class="local col5 ref" href="#15tv" title='tv' data-ref="15tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>/<var>1000</var>);</td></tr>
<tr><th id="320">320</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) {</td></tr>
<tr><th id="321">321</th><td>            <a class="local col6 ref" href="#16role_char" title='role_char' data-ref="16role_char">role_char</a> = <kbd>'X'</kbd>; <i>/* Sentinel. */</i></td></tr>
<tr><th id="322">322</th><td>        } <b>else</b> <b>if</b> (<a class="local col7 ref" href="#17pid" title='pid' data-ref="17pid">pid</a> != <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pid" title='redisServer::pid' data-ref="redisServer::pid">pid</a>) {</td></tr>
<tr><th id="323">323</th><td>            <a class="local col6 ref" href="#16role_char" title='role_char' data-ref="16role_char">role_char</a> = <kbd>'C'</kbd>; <i>/* RDB / AOF writing child. */</i></td></tr>
<tr><th id="324">324</th><td>        } <b>else</b> {</td></tr>
<tr><th id="325">325</th><td>            <a class="local col6 ref" href="#16role_char" title='role_char' data-ref="16role_char">role_char</a> = (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> ? <kbd>'S'</kbd>:<kbd>'M'</kbd>); <i>/* Slave or Master. */</i></td></tr>
<tr><th id="326">326</th><td>        }</td></tr>
<tr><th id="327">327</th><td>        <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="local col0 ref" href="#10fp" title='fp' data-ref="10fp">fp</a>,<q>"%d:%c %s %c %s\n"</q>,</td></tr>
<tr><th id="328">328</th><td>            (<em>int</em>)<a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>(),<a class="local col6 ref" href="#16role_char" title='role_char' data-ref="16role_char">role_char</a>, <a class="local col1 ref" href="#11buf" title='buf' data-ref="11buf">buf</a>,<a class="local col9 ref" href="#9c" title='c' data-ref="9c">c</a>[<a class="local col6 ref" href="#6level" title='level' data-ref="6level">level</a>],<a class="local col7 ref" href="#7msg" title='msg' data-ref="7msg">msg</a>);</td></tr>
<tr><th id="329">329</th><td>    }</td></tr>
<tr><th id="330">330</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fflush" title='fflush' data-ref="fflush">fflush</a>(<a class="local col0 ref" href="#10fp" title='fp' data-ref="10fp">fp</a>);</td></tr>
<tr><th id="331">331</th><td></td></tr>
<tr><th id="332">332</th><td>    <b>if</b> (!<a class="local col3 ref" href="#13log_to_stdout" title='log_to_stdout' data-ref="13log_to_stdout">log_to_stdout</a>) <a class="ref fn" href="../../include/stdio.h.html#fclose" title='fclose' data-ref="fclose">fclose</a>(<a class="local col0 ref" href="#10fp" title='fp' data-ref="10fp">fp</a>);</td></tr>
<tr><th id="333">333</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_enabled" title='redisServer::syslog_enabled' data-ref="redisServer::syslog_enabled">syslog_enabled</a>) <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#syslog" title='syslog' data-ref="syslog">syslog</a>(<a class="local col8 ref" href="#8syslogLevelMap" title='syslogLevelMap' data-ref="8syslogLevelMap">syslogLevelMap</a>[<a class="local col6 ref" href="#6level" title='level' data-ref="6level">level</a>], <q>"%s"</q>, <a class="local col7 ref" href="#7msg" title='msg' data-ref="7msg">msg</a>);</td></tr>
<tr><th id="334">334</th><td>}</td></tr>
<tr><th id="335">335</th><td></td></tr>
<tr><th id="336">336</th><td><i>/* Like redisLogRaw() but with printf-alike support. This is the function that</i></td></tr>
<tr><th id="337">337</th><td><i> * is used across the code. The raw version is only used in order to dump</i></td></tr>
<tr><th id="338">338</th><td><i> * the INFO output on crash. */</i></td></tr>
<tr><th id="339">339</th><td><em>void</em> <dfn class="decl def fn" id="redisLog" title='redisLog' data-ref="redisLog">redisLog</dfn>(<em>int</em> <dfn class="local col8 decl" id="18level" title='level' data-type='int' data-ref="18level">level</dfn>, <em>const</em> <em>char</em> *<dfn class="local col9 decl" id="19fmt" title='fmt' data-type='const char *' data-ref="19fmt">fmt</dfn>, ...) {</td></tr>
<tr><th id="340">340</th><td>    <span class='typedef' title='va_list' data-type='__gnuc_va_list' data-ref="va_list">va_list</span> <dfn class="local col0 decl" id="20ap" title='ap' data-type='va_list' data-ref="20ap">ap</dfn>;</td></tr>
<tr><th id="341">341</th><td>    <em>char</em> <dfn class="local col1 decl" id="21msg" title='msg' data-type='char [1024]' data-ref="21msg">msg</dfn>[<a class="macro" href="redis.h.html#84" title="1024" data-ref="_M/REDIS_MAX_LOGMSG_LEN">REDIS_MAX_LOGMSG_LEN</a>];</td></tr>
<tr><th id="342">342</th><td></td></tr>
<tr><th id="343">343</th><td>    <b>if</b> ((<a class="local col8 ref" href="#18level" title='level' data-ref="18level">level</a>&amp;<var>0xff</var>) &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::verbosity" title='redisServer::verbosity' data-ref="redisServer::verbosity">verbosity</a>) <b>return</b>;</td></tr>
<tr><th id="344">344</th><td></td></tr>
<tr><th id="345">345</th><td>    <span class="macro" title="__builtin_va_start(ap, fmt)" data-ref="_M/va_start">va_start</span>(<a class="local col0 ref" href="#20ap" title='ap' data-ref="20ap">ap</a>, <a class="local col9 ref" href="#19fmt" title='fmt' data-ref="19fmt">fmt</a>);</td></tr>
<tr><th id="346">346</th><td>    <a class="ref fn" href="../../include/stdio.h.html#vsnprintf" title='vsnprintf' data-ref="vsnprintf">vsnprintf</a>(<a class="local col1 ref" href="#21msg" title='msg' data-ref="21msg">msg</a>, <b>sizeof</b>(<a class="local col1 ref" href="#21msg" title='msg' data-ref="21msg">msg</a>), <a class="local col9 ref" href="#19fmt" title='fmt' data-ref="19fmt">fmt</a>, <a class="local col0 ref" href="#20ap" title='ap' data-ref="20ap">ap</a>);</td></tr>
<tr><th id="347">347</th><td>    <span class="macro" title="__builtin_va_end(ap)" data-ref="_M/va_end">va_end</span>(<a class="local col0 ref" href="#20ap" title='ap' data-ref="20ap">ap</a>);</td></tr>
<tr><th id="348">348</th><td></td></tr>
<tr><th id="349">349</th><td>    <a class="ref fn" href="#redisLogRaw" title='redisLogRaw' data-ref="redisLogRaw">redisLogRaw</a>(<a class="local col8 ref" href="#18level" title='level' data-ref="18level">level</a>,<a class="local col1 ref" href="#21msg" title='msg' data-ref="21msg">msg</a>);</td></tr>
<tr><th id="350">350</th><td>}</td></tr>
<tr><th id="351">351</th><td></td></tr>
<tr><th id="352">352</th><td><i>/* Log a fixed message without printf-alike capabilities, in a way that is</i></td></tr>
<tr><th id="353">353</th><td><i> * safe to call from a signal handler.</i></td></tr>
<tr><th id="354">354</th><td><i> *</i></td></tr>
<tr><th id="355">355</th><td><i> * We actually use this only for signals that are not fatal from the point</i></td></tr>
<tr><th id="356">356</th><td><i> * of view of Redis. Signals that are going to kill the server anyway and</i></td></tr>
<tr><th id="357">357</th><td><i> * where we need printf-alike features are served by redisLog(). */</i></td></tr>
<tr><th id="358">358</th><td><em>void</em> <dfn class="decl def fn" id="redisLogFromHandler" title='redisLogFromHandler' data-ref="redisLogFromHandler">redisLogFromHandler</dfn>(<em>int</em> <dfn class="local col2 decl" id="22level" title='level' data-type='int' data-ref="22level">level</dfn>, <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="23msg" title='msg' data-type='const char *' data-ref="23msg">msg</dfn>) {</td></tr>
<tr><th id="359">359</th><td>    <em>int</em> <dfn class="local col4 decl" id="24fd" title='fd' data-type='int' data-ref="24fd">fd</dfn>;</td></tr>
<tr><th id="360">360</th><td>    <em>int</em> <dfn class="local col5 decl" id="25log_to_stdout" title='log_to_stdout' data-type='int' data-ref="25log_to_stdout">log_to_stdout</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::logfile" title='redisServer::logfile' data-ref="redisServer::logfile">logfile</a>[<var>0</var>] == <kbd>'\0'</kbd>;</td></tr>
<tr><th id="361">361</th><td>    <em>char</em> <dfn class="local col6 decl" id="26buf" title='buf' data-type='char [64]' data-ref="26buf">buf</dfn>[<var>64</var>];</td></tr>
<tr><th id="362">362</th><td></td></tr>
<tr><th id="363">363</th><td>    <b>if</b> ((<a class="local col2 ref" href="#22level" title='level' data-ref="22level">level</a>&amp;<var>0xff</var>) &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::verbosity" title='redisServer::verbosity' data-ref="redisServer::verbosity">verbosity</a> || (<a class="local col5 ref" href="#25log_to_stdout" title='log_to_stdout' data-ref="25log_to_stdout">log_to_stdout</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::daemonize" title='redisServer::daemonize' data-ref="redisServer::daemonize">daemonize</a>))</td></tr>
<tr><th id="364">364</th><td>        <b>return</b>;</td></tr>
<tr><th id="365">365</th><td>    <a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a> = <a class="local col5 ref" href="#25log_to_stdout" title='log_to_stdout' data-ref="25log_to_stdout">log_to_stdout</a> ? <a class="macro" href="../../include/unistd.h.html#214" title="1" data-ref="_M/STDOUT_FILENO">STDOUT_FILENO</a> :</td></tr>
<tr><th id="366">366</th><td>                         <a class="ref fn" href="../../include/fcntl.h.html#159" title='open' data-ref="open64">open</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::logfile" title='redisServer::logfile' data-ref="redisServer::logfile">logfile</a>, <a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#59" title="02000" data-ref="_M/O_APPEND">O_APPEND</a>|<a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#47" title="0100" data-ref="_M/O_CREAT">O_CREAT</a>|<a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#44" title="01" data-ref="_M/O_WRONLY">O_WRONLY</a>, <var>0644</var>);</td></tr>
<tr><th id="367">367</th><td>    <b>if</b> (<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a> == -<var>1</var>) <b>return</b>;</td></tr>
<tr><th id="368">368</th><td>    <a class="ref fn" href="util.h.html#ll2string" title='ll2string' data-ref="ll2string">ll2string</a>(<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>,<b>sizeof</b>(<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>),<a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>());</td></tr>
<tr><th id="369">369</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>,<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>,<a class="ref fn" href="../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>)) == -<var>1</var>) <b>goto</b> <a class="lbl" href="#27err" data-ref="27err">err</a>;</td></tr>
<tr><th id="370">370</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>,<q>":signal-handler ("</q>,<var>17</var>) == -<var>1</var>) <b>goto</b> <a class="lbl" href="#27err" data-ref="27err">err</a>;</td></tr>
<tr><th id="371">371</th><td>    <a class="ref fn" href="util.h.html#ll2string" title='ll2string' data-ref="ll2string">ll2string</a>(<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>,<b>sizeof</b>(<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>),<a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>));</td></tr>
<tr><th id="372">372</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>,<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>,<a class="ref fn" href="../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col6 ref" href="#26buf" title='buf' data-ref="26buf">buf</a>)) == -<var>1</var>) <b>goto</b> <a class="lbl" href="#27err" data-ref="27err">err</a>;</td></tr>
<tr><th id="373">373</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>,<q>") "</q>,<var>2</var>) == -<var>1</var>) <b>goto</b> <a class="lbl" href="#27err" data-ref="27err">err</a>;</td></tr>
<tr><th id="374">374</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>,<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>,<a class="ref fn" href="../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col3 ref" href="#23msg" title='msg' data-ref="23msg">msg</a>)) == -<var>1</var>) <b>goto</b> <a class="lbl" href="#27err" data-ref="27err">err</a>;</td></tr>
<tr><th id="375">375</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#write" title='write' data-ref="write">write</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>,<q>"\n"</q>,<var>1</var>) == -<var>1</var>) <b>goto</b> <a class="lbl" href="#27err" data-ref="27err">err</a>;</td></tr>
<tr><th id="376">376</th><td><dfn class="lbl" id="27err" data-ref="27err">err</dfn>:</td></tr>
<tr><th id="377">377</th><td>    <b>if</b> (!<a class="local col5 ref" href="#25log_to_stdout" title='log_to_stdout' data-ref="25log_to_stdout">log_to_stdout</a>) <a class="ref fn" href="../../include/unistd.h.html#close" title='close' data-ref="close">close</a>(<a class="local col4 ref" href="#24fd" title='fd' data-ref="24fd">fd</a>);</td></tr>
<tr><th id="378">378</th><td>}</td></tr>
<tr><th id="379">379</th><td></td></tr>
<tr><th id="380">380</th><td><i>/* Return the UNIX time in microseconds */</i></td></tr>
<tr><th id="381">381</th><td><em>long</em> <em>long</em> <dfn class="decl def fn" id="ustime" title='ustime' data-ref="ustime">ustime</dfn>(<em>void</em>) {</td></tr>
<tr><th id="382">382</th><td>    <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval" title='timeval' data-ref="timeval">timeval</a> <dfn class="local col8 decl" id="28tv" title='tv' data-type='struct timeval' data-ref="28tv">tv</dfn>;</td></tr>
<tr><th id="383">383</th><td>    <em>long</em> <em>long</em> <dfn class="local col9 decl" id="29ust" title='ust' data-type='long long' data-ref="29ust">ust</dfn>;</td></tr>
<tr><th id="384">384</th><td></td></tr>
<tr><th id="385">385</th><td>    <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/time.h.html#gettimeofday" title='gettimeofday' data-ref="gettimeofday">gettimeofday</a>(&amp;<a class="local col8 ref" href="#28tv" title='tv' data-ref="28tv">tv</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="386">386</th><td>    <a class="local col9 ref" href="#29ust" title='ust' data-ref="29ust">ust</a> = ((<em>long</em> <em>long</em>)<a class="local col8 ref" href="#28tv" title='tv' data-ref="28tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>)*<var>1000000</var>;</td></tr>
<tr><th id="387">387</th><td>    <a class="local col9 ref" href="#29ust" title='ust' data-ref="29ust">ust</a> += <a class="local col8 ref" href="#28tv" title='tv' data-ref="28tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>;</td></tr>
<tr><th id="388">388</th><td>    <b>return</b> <a class="local col9 ref" href="#29ust" title='ust' data-ref="29ust">ust</a>;</td></tr>
<tr><th id="389">389</th><td>}</td></tr>
<tr><th id="390">390</th><td></td></tr>
<tr><th id="391">391</th><td><i>/* Return the UNIX time in milliseconds */</i></td></tr>
<tr><th id="392">392</th><td><em>long</em> <em>long</em> <dfn class="decl def fn" id="mstime" title='mstime' data-ref="mstime">mstime</dfn>(<em>void</em>) {</td></tr>
<tr><th id="393">393</th><td>    <b>return</b> <a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>()/<var>1000</var>;</td></tr>
<tr><th id="394">394</th><td>}</td></tr>
<tr><th id="395">395</th><td></td></tr>
<tr><th id="396">396</th><td><i>/* After an RDB dump or AOF rewrite we exit from children using _exit() instead of</i></td></tr>
<tr><th id="397">397</th><td><i> * exit(), because the latter may interact with the same file objects used by</i></td></tr>
<tr><th id="398">398</th><td><i> * the parent process. However if we are testing the coverage normal exit() is</i></td></tr>
<tr><th id="399">399</th><td><i> * used in order to obtain the right coverage information. */</i></td></tr>
<tr><th id="400">400</th><td><em>void</em> <dfn class="decl def fn" id="exitFromChild" title='exitFromChild' data-ref="exitFromChild">exitFromChild</dfn>(<em>int</em> <dfn class="local col0 decl" id="30retcode" title='retcode' data-type='int' data-ref="30retcode">retcode</dfn>) {</td></tr>
<tr><th id="401">401</th><td><u>#<span data-ppcond="401">ifdef</span> <span class="macro" data-ref="_M/COVERAGE_TEST">COVERAGE_TEST</span></u></td></tr>
<tr><th id="402">402</th><td>    exit(retcode);</td></tr>
<tr><th id="403">403</th><td><u>#<span data-ppcond="401">else</span></u></td></tr>
<tr><th id="404">404</th><td>    <a class="ref fn" href="../../include/unistd.h.html#_exit" title='_exit' data-ref="_exit">_exit</a>(<a class="local col0 ref" href="#30retcode" title='retcode' data-ref="30retcode">retcode</a>);</td></tr>
<tr><th id="405">405</th><td><u>#<span data-ppcond="401">endif</span></u></td></tr>
<tr><th id="406">406</th><td>}</td></tr>
<tr><th id="407">407</th><td></td></tr>
<tr><th id="408">408</th><td><i>/*====================== Hash table type implementation  ==================== */</i></td></tr>
<tr><th id="409">409</th><td></td></tr>
<tr><th id="410">410</th><td><i>/* This is a hash table type that uses the SDS dynamic strings library as</i></td></tr>
<tr><th id="411">411</th><td><i> * keys and redis objects as values (objects can hold SDS strings,</i></td></tr>
<tr><th id="412">412</th><td><i> * lists, sets). */</i></td></tr>
<tr><th id="413">413</th><td></td></tr>
<tr><th id="414">414</th><td><em>void</em> <dfn class="decl def fn" id="dictVanillaFree" title='dictVanillaFree' data-ref="dictVanillaFree">dictVanillaFree</dfn>(<em>void</em> *<dfn class="local col1 decl" id="31privdata" title='privdata' data-type='void *' data-ref="31privdata">privdata</dfn>, <em>void</em> *<dfn class="local col2 decl" id="32val" title='val' data-type='void *' data-ref="32val">val</dfn>)</td></tr>
<tr><th id="415">415</th><td>{</td></tr>
<tr><th id="416">416</th><td>    <a class="macro" href="dict.h.html#45" title="((void) privdata)" data-ref="_M/DICT_NOTUSED">DICT_NOTUSED</a>(<a class="local col1 ref" href="#31privdata" title='privdata' data-ref="31privdata">privdata</a>);</td></tr>
<tr><th id="417">417</th><td>    <a class="ref fn" href="zmalloc.h.html#zfree" title='zfree' data-ref="zfree">zfree</a>(<a class="local col2 ref" href="#32val" title='val' data-ref="32val">val</a>);</td></tr>
<tr><th id="418">418</th><td>}</td></tr>
<tr><th id="419">419</th><td></td></tr>
<tr><th id="420">420</th><td><em>void</em> <dfn class="decl def fn" id="dictListDestructor" title='dictListDestructor' data-ref="dictListDestructor">dictListDestructor</dfn>(<em>void</em> *<dfn class="local col3 decl" id="33privdata" title='privdata' data-type='void *' data-ref="33privdata">privdata</dfn>, <em>void</em> *<dfn class="local col4 decl" id="34val" title='val' data-type='void *' data-ref="34val">val</dfn>)</td></tr>
<tr><th id="421">421</th><td>{</td></tr>
<tr><th id="422">422</th><td>    <a class="macro" href="dict.h.html#45" title="((void) privdata)" data-ref="_M/DICT_NOTUSED">DICT_NOTUSED</a>(<a class="local col3 ref" href="#33privdata" title='privdata' data-ref="33privdata">privdata</a>);</td></tr>
<tr><th id="423">423</th><td>    <a class="ref fn" href="adlist.h.html#listRelease" title='listRelease' data-ref="listRelease">listRelease</a>((<a class="typedef" href="adlist.h.html#list" title='list' data-type='struct list' data-ref="list">list</a>*)<a class="local col4 ref" href="#34val" title='val' data-ref="34val">val</a>);</td></tr>
<tr><th id="424">424</th><td>}</td></tr>
<tr><th id="425">425</th><td></td></tr>
<tr><th id="426">426</th><td><em>int</em> <dfn class="decl def fn" id="dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</dfn>(<em>void</em> *<dfn class="local col5 decl" id="35privdata" title='privdata' data-type='void *' data-ref="35privdata">privdata</dfn>, <em>const</em> <em>void</em> *<dfn class="local col6 decl" id="36key1" title='key1' data-type='const void *' data-ref="36key1">key1</dfn>,</td></tr>
<tr><th id="427">427</th><td>        <em>const</em> <em>void</em> *<dfn class="local col7 decl" id="37key2" title='key2' data-type='const void *' data-ref="37key2">key2</dfn>)</td></tr>
<tr><th id="428">428</th><td>{</td></tr>
<tr><th id="429">429</th><td>    <em>int</em> <dfn class="local col8 decl" id="38l1" title='l1' data-type='int' data-ref="38l1">l1</dfn>,<dfn class="local col9 decl" id="39l2" title='l2' data-type='int' data-ref="39l2">l2</dfn>;</td></tr>
<tr><th id="430">430</th><td>    <a class="macro" href="dict.h.html#45" title="((void) privdata)" data-ref="_M/DICT_NOTUSED">DICT_NOTUSED</a>(<a class="local col5 ref" href="#35privdata" title='privdata' data-ref="35privdata">privdata</a>);</td></tr>
<tr><th id="431">431</th><td></td></tr>
<tr><th id="432">432</th><td>    <a class="local col8 ref" href="#38l1" title='l1' data-ref="38l1">l1</a> = <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a>)<a class="local col6 ref" href="#36key1" title='key1' data-ref="36key1">key1</a>);</td></tr>
<tr><th id="433">433</th><td>    <a class="local col9 ref" href="#39l2" title='l2' data-ref="39l2">l2</a> = <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a>)<a class="local col7 ref" href="#37key2" title='key2' data-ref="37key2">key2</a>);</td></tr>
<tr><th id="434">434</th><td>    <b>if</b> (<a class="local col8 ref" href="#38l1" title='l1' data-ref="38l1">l1</a> != <a class="local col9 ref" href="#39l2" title='l2' data-ref="39l2">l2</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="435">435</th><td>    <b>return</b> <a class="ref fn" href="../../include/string.h.html#memcmp" title='memcmp' data-ref="memcmp">memcmp</a>(<a class="local col6 ref" href="#36key1" title='key1' data-ref="36key1">key1</a>, <a class="local col7 ref" href="#37key2" title='key2' data-ref="37key2">key2</a>, <a class="local col8 ref" href="#38l1" title='l1' data-ref="38l1">l1</a>) == <var>0</var>;</td></tr>
<tr><th id="436">436</th><td>}</td></tr>
<tr><th id="437">437</th><td></td></tr>
<tr><th id="438">438</th><td><i>/* A case insensitive version used for the command lookup table and other</i></td></tr>
<tr><th id="439">439</th><td><i> * places where case insensitive non binary-safe comparison is needed. */</i></td></tr>
<tr><th id="440">440</th><td><em>int</em> <dfn class="decl def fn" id="dictSdsKeyCaseCompare" title='dictSdsKeyCaseCompare' data-ref="dictSdsKeyCaseCompare">dictSdsKeyCaseCompare</dfn>(<em>void</em> *<dfn class="local col0 decl" id="40privdata" title='privdata' data-type='void *' data-ref="40privdata">privdata</dfn>, <em>const</em> <em>void</em> *<dfn class="local col1 decl" id="41key1" title='key1' data-type='const void *' data-ref="41key1">key1</dfn>,</td></tr>
<tr><th id="441">441</th><td>        <em>const</em> <em>void</em> *<dfn class="local col2 decl" id="42key2" title='key2' data-type='const void *' data-ref="42key2">key2</dfn>)</td></tr>
<tr><th id="442">442</th><td>{</td></tr>
<tr><th id="443">443</th><td>    <a class="macro" href="dict.h.html#45" title="((void) privdata)" data-ref="_M/DICT_NOTUSED">DICT_NOTUSED</a>(<a class="local col0 ref" href="#40privdata" title='privdata' data-ref="40privdata">privdata</a>);</td></tr>
<tr><th id="444">444</th><td></td></tr>
<tr><th id="445">445</th><td>    <b>return</b> <a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col1 ref" href="#41key1" title='key1' data-ref="41key1">key1</a>, <a class="local col2 ref" href="#42key2" title='key2' data-ref="42key2">key2</a>) == <var>0</var>;</td></tr>
<tr><th id="446">446</th><td>}</td></tr>
<tr><th id="447">447</th><td></td></tr>
<tr><th id="448">448</th><td><em>void</em> <dfn class="decl def fn" id="dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</dfn>(<em>void</em> *<dfn class="local col3 decl" id="43privdata" title='privdata' data-type='void *' data-ref="43privdata">privdata</dfn>, <em>void</em> *<dfn class="local col4 decl" id="44val" title='val' data-type='void *' data-ref="44val">val</dfn>)</td></tr>
<tr><th id="449">449</th><td>{</td></tr>
<tr><th id="450">450</th><td>    <a class="macro" href="dict.h.html#45" title="((void) privdata)" data-ref="_M/DICT_NOTUSED">DICT_NOTUSED</a>(<a class="local col3 ref" href="#43privdata" title='privdata' data-ref="43privdata">privdata</a>);</td></tr>
<tr><th id="451">451</th><td></td></tr>
<tr><th id="452">452</th><td>    <b>if</b> (<a class="local col4 ref" href="#44val" title='val' data-ref="44val">val</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) <b>return</b>; <i>/* Values of swapped out keys as set to NULL */</i></td></tr>
<tr><th id="453">453</th><td>    <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col4 ref" href="#44val" title='val' data-ref="44val">val</a>);</td></tr>
<tr><th id="454">454</th><td>}</td></tr>
<tr><th id="455">455</th><td></td></tr>
<tr><th id="456">456</th><td><em>void</em> <dfn class="decl def fn" id="dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</dfn>(<em>void</em> *<dfn class="local col5 decl" id="45privdata" title='privdata' data-type='void *' data-ref="45privdata">privdata</dfn>, <em>void</em> *<dfn class="local col6 decl" id="46val" title='val' data-type='void *' data-ref="46val">val</dfn>)</td></tr>
<tr><th id="457">457</th><td>{</td></tr>
<tr><th id="458">458</th><td>    <a class="macro" href="dict.h.html#45" title="((void) privdata)" data-ref="_M/DICT_NOTUSED">DICT_NOTUSED</a>(<a class="local col5 ref" href="#45privdata" title='privdata' data-ref="45privdata">privdata</a>);</td></tr>
<tr><th id="459">459</th><td></td></tr>
<tr><th id="460">460</th><td>    <a class="ref fn" href="sds.h.html#sdsfree" title='sdsfree' data-ref="sdsfree">sdsfree</a>(<a class="local col6 ref" href="#46val" title='val' data-ref="46val">val</a>);</td></tr>
<tr><th id="461">461</th><td>}</td></tr>
<tr><th id="462">462</th><td></td></tr>
<tr><th id="463">463</th><td><em>int</em> <dfn class="decl def fn" id="dictObjKeyCompare" title='dictObjKeyCompare' data-ref="dictObjKeyCompare">dictObjKeyCompare</dfn>(<em>void</em> *<dfn class="local col7 decl" id="47privdata" title='privdata' data-type='void *' data-ref="47privdata">privdata</dfn>, <em>const</em> <em>void</em> *<dfn class="local col8 decl" id="48key1" title='key1' data-type='const void *' data-ref="48key1">key1</dfn>,</td></tr>
<tr><th id="464">464</th><td>        <em>const</em> <em>void</em> *<dfn class="local col9 decl" id="49key2" title='key2' data-type='const void *' data-ref="49key2">key2</dfn>)</td></tr>
<tr><th id="465">465</th><td>{</td></tr>
<tr><th id="466">466</th><td>    <em>const</em> <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col0 decl" id="50o1" title='o1' data-type='const robj *' data-ref="50o1">o1</dfn> = <a class="local col8 ref" href="#48key1" title='key1' data-ref="48key1">key1</a>, *<dfn class="local col1 decl" id="51o2" title='o2' data-type='const robj *' data-ref="51o2">o2</dfn> = <a class="local col9 ref" href="#49key2" title='key2' data-ref="49key2">key2</a>;</td></tr>
<tr><th id="467">467</th><td>    <b>return</b> <a class="ref fn" href="#dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</a>(<a class="local col7 ref" href="#47privdata" title='privdata' data-ref="47privdata">privdata</a>,<a class="local col0 ref" href="#50o1" title='o1' data-ref="50o1">o1</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>,<a class="local col1 ref" href="#51o2" title='o2' data-ref="51o2">o2</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>);</td></tr>
<tr><th id="468">468</th><td>}</td></tr>
<tr><th id="469">469</th><td></td></tr>
<tr><th id="470">470</th><td><em>unsigned</em> <em>int</em> <dfn class="decl def fn" id="dictObjHash" title='dictObjHash' data-ref="dictObjHash">dictObjHash</dfn>(<em>const</em> <em>void</em> *<dfn class="local col2 decl" id="52key" title='key' data-type='const void *' data-ref="52key">key</dfn>) {</td></tr>
<tr><th id="471">471</th><td>    <em>const</em> <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col3 decl" id="53o" title='o' data-type='const robj *' data-ref="53o">o</dfn> = <a class="local col2 ref" href="#52key" title='key' data-ref="52key">key</a>;</td></tr>
<tr><th id="472">472</th><td>    <b>return</b> <a class="ref fn" href="dict.h.html#dictGenHashFunction" title='dictGenHashFunction' data-ref="dictGenHashFunction">dictGenHashFunction</a>(<a class="local col3 ref" href="#53o" title='o' data-ref="53o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>, <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a>)<a class="local col3 ref" href="#53o" title='o' data-ref="53o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>));</td></tr>
<tr><th id="473">473</th><td>}</td></tr>
<tr><th id="474">474</th><td></td></tr>
<tr><th id="475">475</th><td><em>unsigned</em> <em>int</em> <dfn class="decl def fn" id="dictSdsHash" title='dictSdsHash' data-ref="dictSdsHash">dictSdsHash</dfn>(<em>const</em> <em>void</em> *<dfn class="local col4 decl" id="54key" title='key' data-type='const void *' data-ref="54key">key</dfn>) {</td></tr>
<tr><th id="476">476</th><td>    <b>return</b> <a class="ref fn" href="dict.h.html#dictGenHashFunction" title='dictGenHashFunction' data-ref="dictGenHashFunction">dictGenHashFunction</a>((<em>unsigned</em> <em>char</em>*)<a class="local col4 ref" href="#54key" title='key' data-ref="54key">key</a>, <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<em>char</em>*)<a class="local col4 ref" href="#54key" title='key' data-ref="54key">key</a>));</td></tr>
<tr><th id="477">477</th><td>}</td></tr>
<tr><th id="478">478</th><td></td></tr>
<tr><th id="479">479</th><td><em>unsigned</em> <em>int</em> <dfn class="decl def fn" id="dictSdsCaseHash" title='dictSdsCaseHash' data-ref="dictSdsCaseHash">dictSdsCaseHash</dfn>(<em>const</em> <em>void</em> *<dfn class="local col5 decl" id="55key" title='key' data-type='const void *' data-ref="55key">key</dfn>) {</td></tr>
<tr><th id="480">480</th><td>    <b>return</b> <a class="ref fn" href="dict.h.html#dictGenCaseHashFunction" title='dictGenCaseHashFunction' data-ref="dictGenCaseHashFunction">dictGenCaseHashFunction</a>((<em>unsigned</em> <em>char</em>*)<a class="local col5 ref" href="#55key" title='key' data-ref="55key">key</a>, <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<em>char</em>*)<a class="local col5 ref" href="#55key" title='key' data-ref="55key">key</a>));</td></tr>
<tr><th id="481">481</th><td>}</td></tr>
<tr><th id="482">482</th><td></td></tr>
<tr><th id="483">483</th><td><em>int</em> <dfn class="decl def fn" id="dictEncObjKeyCompare" title='dictEncObjKeyCompare' data-ref="dictEncObjKeyCompare">dictEncObjKeyCompare</dfn>(<em>void</em> *<dfn class="local col6 decl" id="56privdata" title='privdata' data-type='void *' data-ref="56privdata">privdata</dfn>, <em>const</em> <em>void</em> *<dfn class="local col7 decl" id="57key1" title='key1' data-type='const void *' data-ref="57key1">key1</dfn>,</td></tr>
<tr><th id="484">484</th><td>        <em>const</em> <em>void</em> *<dfn class="local col8 decl" id="58key2" title='key2' data-type='const void *' data-ref="58key2">key2</dfn>)</td></tr>
<tr><th id="485">485</th><td>{</td></tr>
<tr><th id="486">486</th><td>    <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col9 decl" id="59o1" title='o1' data-type='robj *' data-ref="59o1">o1</dfn> = (<a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a>*) <a class="local col7 ref" href="#57key1" title='key1' data-ref="57key1">key1</a>, *<dfn class="local col0 decl" id="60o2" title='o2' data-type='robj *' data-ref="60o2">o2</dfn> = (<a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a>*) <a class="local col8 ref" href="#58key2" title='key2' data-ref="58key2">key2</a>;</td></tr>
<tr><th id="487">487</th><td>    <em>int</em> <dfn class="local col1 decl" id="61cmp" title='cmp' data-type='int' data-ref="61cmp">cmp</dfn>;</td></tr>
<tr><th id="488">488</th><td></td></tr>
<tr><th id="489">489</th><td>    <b>if</b> (<a class="local col9 ref" href="#59o1" title='o1' data-ref="59o1">o1</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::encoding" title='redisObject::encoding' data-ref="redisObject::encoding">encoding</a> == <a class="macro" href="redis.h.html#190" title="1" data-ref="_M/REDIS_ENCODING_INT">REDIS_ENCODING_INT</a> &amp;&amp;</td></tr>
<tr><th id="490">490</th><td>        <a class="local col0 ref" href="#60o2" title='o2' data-ref="60o2">o2</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::encoding" title='redisObject::encoding' data-ref="redisObject::encoding">encoding</a> == <a class="macro" href="redis.h.html#190" title="1" data-ref="_M/REDIS_ENCODING_INT">REDIS_ENCODING_INT</a>)</td></tr>
<tr><th id="491">491</th><td>            <b>return</b> <a class="local col9 ref" href="#59o1" title='o1' data-ref="59o1">o1</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a> == <a class="local col0 ref" href="#60o2" title='o2' data-ref="60o2">o2</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>;</td></tr>
<tr><th id="492">492</th><td></td></tr>
<tr><th id="493">493</th><td>    <a class="local col9 ref" href="#59o1" title='o1' data-ref="59o1">o1</a> = <a class="ref fn" href="redis.h.html#getDecodedObject" title='getDecodedObject' data-ref="getDecodedObject">getDecodedObject</a>(<a class="local col9 ref" href="#59o1" title='o1' data-ref="59o1">o1</a>);</td></tr>
<tr><th id="494">494</th><td>    <a class="local col0 ref" href="#60o2" title='o2' data-ref="60o2">o2</a> = <a class="ref fn" href="redis.h.html#getDecodedObject" title='getDecodedObject' data-ref="getDecodedObject">getDecodedObject</a>(<a class="local col0 ref" href="#60o2" title='o2' data-ref="60o2">o2</a>);</td></tr>
<tr><th id="495">495</th><td>    <a class="local col1 ref" href="#61cmp" title='cmp' data-ref="61cmp">cmp</a> = <a class="ref fn" href="#dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</a>(<a class="local col6 ref" href="#56privdata" title='privdata' data-ref="56privdata">privdata</a>,<a class="local col9 ref" href="#59o1" title='o1' data-ref="59o1">o1</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>,<a class="local col0 ref" href="#60o2" title='o2' data-ref="60o2">o2</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>);</td></tr>
<tr><th id="496">496</th><td>    <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col9 ref" href="#59o1" title='o1' data-ref="59o1">o1</a>);</td></tr>
<tr><th id="497">497</th><td>    <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col0 ref" href="#60o2" title='o2' data-ref="60o2">o2</a>);</td></tr>
<tr><th id="498">498</th><td>    <b>return</b> <a class="local col1 ref" href="#61cmp" title='cmp' data-ref="61cmp">cmp</a>;</td></tr>
<tr><th id="499">499</th><td>}</td></tr>
<tr><th id="500">500</th><td></td></tr>
<tr><th id="501">501</th><td><em>unsigned</em> <em>int</em> <dfn class="decl def fn" id="dictEncObjHash" title='dictEncObjHash' data-ref="dictEncObjHash">dictEncObjHash</dfn>(<em>const</em> <em>void</em> *<dfn class="local col2 decl" id="62key" title='key' data-type='const void *' data-ref="62key">key</dfn>) {</td></tr>
<tr><th id="502">502</th><td>    <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col3 decl" id="63o" title='o' data-type='robj *' data-ref="63o">o</dfn> = (<a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a>*) <a class="local col2 ref" href="#62key" title='key' data-ref="62key">key</a>;</td></tr>
<tr><th id="503">503</th><td></td></tr>
<tr><th id="504">504</th><td>    <b>if</b> (<a class="macro" href="redis.h.html#1146" title="(o-&gt;encoding == 0 || o-&gt;encoding == 8)" data-ref="_M/sdsEncodedObject">sdsEncodedObject</a>(<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>)) {</td></tr>
<tr><th id="505">505</th><td>        <b>return</b> <a class="ref fn" href="dict.h.html#dictGenHashFunction" title='dictGenHashFunction' data-ref="dictGenHashFunction">dictGenHashFunction</a>(<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>, <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a>)<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>));</td></tr>
<tr><th id="506">506</th><td>    } <b>else</b> {</td></tr>
<tr><th id="507">507</th><td>        <b>if</b> (<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::encoding" title='redisObject::encoding' data-ref="redisObject::encoding">encoding</a> == <a class="macro" href="redis.h.html#190" title="1" data-ref="_M/REDIS_ENCODING_INT">REDIS_ENCODING_INT</a>) {</td></tr>
<tr><th id="508">508</th><td>            <em>char</em> <dfn class="local col4 decl" id="64buf" title='buf' data-type='char [32]' data-ref="64buf">buf</dfn>[<var>32</var>];</td></tr>
<tr><th id="509">509</th><td>            <em>int</em> <dfn class="local col5 decl" id="65len" title='len' data-type='int' data-ref="65len">len</dfn>;</td></tr>
<tr><th id="510">510</th><td></td></tr>
<tr><th id="511">511</th><td>            <a class="local col5 ref" href="#65len" title='len' data-ref="65len">len</a> = <a class="ref fn" href="util.h.html#ll2string" title='ll2string' data-ref="ll2string">ll2string</a>(<a class="local col4 ref" href="#64buf" title='buf' data-ref="64buf">buf</a>,<var>32</var>,(<em>long</em>)<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>);</td></tr>
<tr><th id="512">512</th><td>            <b>return</b> <a class="ref fn" href="dict.h.html#dictGenHashFunction" title='dictGenHashFunction' data-ref="dictGenHashFunction">dictGenHashFunction</a>((<em>unsigned</em> <em>char</em>*)<a class="local col4 ref" href="#64buf" title='buf' data-ref="64buf">buf</a>, <a class="local col5 ref" href="#65len" title='len' data-ref="65len">len</a>);</td></tr>
<tr><th id="513">513</th><td>        } <b>else</b> {</td></tr>
<tr><th id="514">514</th><td>            <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="66hash" title='hash' data-type='unsigned int' data-ref="66hash">hash</dfn>;</td></tr>
<tr><th id="515">515</th><td></td></tr>
<tr><th id="516">516</th><td>            <a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a> = <a class="ref fn" href="redis.h.html#getDecodedObject" title='getDecodedObject' data-ref="getDecodedObject">getDecodedObject</a>(<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>);</td></tr>
<tr><th id="517">517</th><td>            <a class="local col6 ref" href="#66hash" title='hash' data-ref="66hash">hash</a> = <a class="ref fn" href="dict.h.html#dictGenHashFunction" title='dictGenHashFunction' data-ref="dictGenHashFunction">dictGenHashFunction</a>(<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>, <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>((<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a>)<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>));</td></tr>
<tr><th id="518">518</th><td>            <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col3 ref" href="#63o" title='o' data-ref="63o">o</a>);</td></tr>
<tr><th id="519">519</th><td>            <b>return</b> <a class="local col6 ref" href="#66hash" title='hash' data-ref="66hash">hash</a>;</td></tr>
<tr><th id="520">520</th><td>        }</td></tr>
<tr><th id="521">521</th><td>    }</td></tr>
<tr><th id="522">522</th><td>}</td></tr>
<tr><th id="523">523</th><td></td></tr>
<tr><th id="524">524</th><td><i>/* Sets type hash table */</i></td></tr>
<tr><th id="525">525</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="setDictType" title='setDictType' data-ref="setDictType">setDictType</dfn> = {</td></tr>
<tr><th id="526">526</th><td>    <a class="ref fn" href="#dictEncObjHash" title='dictEncObjHash' data-ref="dictEncObjHash">dictEncObjHash</a>,            <i>/* hash function */</i></td></tr>
<tr><th id="527">527</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* key dup */</i></td></tr>
<tr><th id="528">528</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* val dup */</i></td></tr>
<tr><th id="529">529</th><td>    <a class="ref fn" href="#dictEncObjKeyCompare" title='dictEncObjKeyCompare' data-ref="dictEncObjKeyCompare">dictEncObjKeyCompare</a>,      <i>/* key compare */</i></td></tr>
<tr><th id="530">530</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>, <i>/* key destructor */</i></td></tr>
<tr><th id="531">531</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                       <i>/* val destructor */</i></td></tr>
<tr><th id="532">532</th><td>};</td></tr>
<tr><th id="533">533</th><td></td></tr>
<tr><th id="534">534</th><td><i>/* Sorted sets hash (note: a skiplist is used in addition to the hash table) */</i></td></tr>
<tr><th id="535">535</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="zsetDictType" title='zsetDictType' data-ref="zsetDictType">zsetDictType</dfn> = {</td></tr>
<tr><th id="536">536</th><td>    <a class="ref fn" href="#dictEncObjHash" title='dictEncObjHash' data-ref="dictEncObjHash">dictEncObjHash</a>,            <i>/* hash function */</i></td></tr>
<tr><th id="537">537</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* key dup */</i></td></tr>
<tr><th id="538">538</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* val dup */</i></td></tr>
<tr><th id="539">539</th><td>    <a class="ref fn" href="#dictEncObjKeyCompare" title='dictEncObjKeyCompare' data-ref="dictEncObjKeyCompare">dictEncObjKeyCompare</a>,      <i>/* key compare */</i></td></tr>
<tr><th id="540">540</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>, <i>/* key destructor */</i></td></tr>
<tr><th id="541">541</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                       <i>/* val destructor */</i></td></tr>
<tr><th id="542">542</th><td>};</td></tr>
<tr><th id="543">543</th><td></td></tr>
<tr><th id="544">544</th><td><i>/* Db-&gt;dict, keys are sds strings, vals are Redis objects. */</i></td></tr>
<tr><th id="545">545</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="dbDictType" title='dbDictType' data-ref="dbDictType">dbDictType</dfn> = {</td></tr>
<tr><th id="546">546</th><td>    <a class="ref fn" href="#dictSdsHash" title='dictSdsHash' data-ref="dictSdsHash">dictSdsHash</a>,                <i>/* hash function */</i></td></tr>
<tr><th id="547">547</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="548">548</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="549">549</th><td>    <a class="ref fn" href="#dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</a>,          <i>/* key compare */</i></td></tr>
<tr><th id="550">550</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,          <i>/* key destructor */</i></td></tr>
<tr><th id="551">551</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>   <i>/* val destructor */</i></td></tr>
<tr><th id="552">552</th><td>};</td></tr>
<tr><th id="553">553</th><td></td></tr>
<tr><th id="554">554</th><td><i>/* server.lua_scripts sha (as sds string) -&gt; scripts (as robj) cache. */</i></td></tr>
<tr><th id="555">555</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="shaScriptObjectDictType" title='shaScriptObjectDictType' data-ref="shaScriptObjectDictType">shaScriptObjectDictType</dfn> = {</td></tr>
<tr><th id="556">556</th><td>    <a class="ref fn" href="#dictSdsCaseHash" title='dictSdsCaseHash' data-ref="dictSdsCaseHash">dictSdsCaseHash</a>,            <i>/* hash function */</i></td></tr>
<tr><th id="557">557</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="558">558</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="559">559</th><td>    <a class="ref fn" href="#dictSdsKeyCaseCompare" title='dictSdsKeyCaseCompare' data-ref="dictSdsKeyCaseCompare">dictSdsKeyCaseCompare</a>,      <i>/* key compare */</i></td></tr>
<tr><th id="560">560</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,          <i>/* key destructor */</i></td></tr>
<tr><th id="561">561</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>   <i>/* val destructor */</i></td></tr>
<tr><th id="562">562</th><td>};</td></tr>
<tr><th id="563">563</th><td></td></tr>
<tr><th id="564">564</th><td><i>/* Db-&gt;expires */</i></td></tr>
<tr><th id="565">565</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="keyptrDictType" title='keyptrDictType' data-ref="keyptrDictType">keyptrDictType</dfn> = {</td></tr>
<tr><th id="566">566</th><td>    <a class="ref fn" href="#dictSdsHash" title='dictSdsHash' data-ref="dictSdsHash">dictSdsHash</a>,               <i>/* hash function */</i></td></tr>
<tr><th id="567">567</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* key dup */</i></td></tr>
<tr><th id="568">568</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* val dup */</i></td></tr>
<tr><th id="569">569</th><td>    <a class="ref fn" href="#dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</a>,         <i>/* key compare */</i></td></tr>
<tr><th id="570">570</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* key destructor */</i></td></tr>
<tr><th id="571">571</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                       <i>/* val destructor */</i></td></tr>
<tr><th id="572">572</th><td>};</td></tr>
<tr><th id="573">573</th><td></td></tr>
<tr><th id="574">574</th><td><i>/* Command table. sds string -&gt; command struct pointer. */</i></td></tr>
<tr><th id="575">575</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="commandTableDictType" title='commandTableDictType' data-ref="commandTableDictType">commandTableDictType</dfn> = {</td></tr>
<tr><th id="576">576</th><td>    <a class="ref fn" href="#dictSdsCaseHash" title='dictSdsCaseHash' data-ref="dictSdsCaseHash">dictSdsCaseHash</a>,           <i>/* hash function */</i></td></tr>
<tr><th id="577">577</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* key dup */</i></td></tr>
<tr><th id="578">578</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                      <i>/* val dup */</i></td></tr>
<tr><th id="579">579</th><td>    <a class="ref fn" href="#dictSdsKeyCaseCompare" title='dictSdsKeyCaseCompare' data-ref="dictSdsKeyCaseCompare">dictSdsKeyCaseCompare</a>,     <i>/* key compare */</i></td></tr>
<tr><th id="580">580</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,         <i>/* key destructor */</i></td></tr>
<tr><th id="581">581</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                       <i>/* val destructor */</i></td></tr>
<tr><th id="582">582</th><td>};</td></tr>
<tr><th id="583">583</th><td></td></tr>
<tr><th id="584">584</th><td><i>/* Hash type hash table (note that small hashes are represented with ziplists) */</i></td></tr>
<tr><th id="585">585</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="hashDictType" title='hashDictType' data-ref="hashDictType">hashDictType</dfn> = {</td></tr>
<tr><th id="586">586</th><td>    <a class="ref fn" href="#dictEncObjHash" title='dictEncObjHash' data-ref="dictEncObjHash">dictEncObjHash</a>,             <i>/* hash function */</i></td></tr>
<tr><th id="587">587</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="588">588</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="589">589</th><td>    <a class="ref fn" href="#dictEncObjKeyCompare" title='dictEncObjKeyCompare' data-ref="dictEncObjKeyCompare">dictEncObjKeyCompare</a>,       <i>/* key compare */</i></td></tr>
<tr><th id="590">590</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>,  <i>/* key destructor */</i></td></tr>
<tr><th id="591">591</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>   <i>/* val destructor */</i></td></tr>
<tr><th id="592">592</th><td>};</td></tr>
<tr><th id="593">593</th><td></td></tr>
<tr><th id="594">594</th><td><i>/* Keylist hash table type has unencoded redis objects as keys and</i></td></tr>
<tr><th id="595">595</th><td><i> * lists as values. It's used for blocking operations (BLPOP) and to</i></td></tr>
<tr><th id="596">596</th><td><i> * map swapped keys to a list of clients waiting for this keys to be loaded. */</i></td></tr>
<tr><th id="597">597</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="keylistDictType" title='keylistDictType' data-ref="keylistDictType">keylistDictType</dfn> = {</td></tr>
<tr><th id="598">598</th><td>    <a class="ref fn" href="#dictObjHash" title='dictObjHash' data-ref="dictObjHash">dictObjHash</a>,                <i>/* hash function */</i></td></tr>
<tr><th id="599">599</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="600">600</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="601">601</th><td>    <a class="ref fn" href="#dictObjKeyCompare" title='dictObjKeyCompare' data-ref="dictObjKeyCompare">dictObjKeyCompare</a>,          <i>/* key compare */</i></td></tr>
<tr><th id="602">602</th><td>    <a class="ref fn" href="#dictRedisObjectDestructor" title='dictRedisObjectDestructor' data-ref="dictRedisObjectDestructor">dictRedisObjectDestructor</a>,  <i>/* key destructor */</i></td></tr>
<tr><th id="603">603</th><td>    <a class="ref fn" href="#dictListDestructor" title='dictListDestructor' data-ref="dictListDestructor">dictListDestructor</a>          <i>/* val destructor */</i></td></tr>
<tr><th id="604">604</th><td>};</td></tr>
<tr><th id="605">605</th><td></td></tr>
<tr><th id="606">606</th><td><i>/* Cluster nodes hash table, mapping nodes addresses 1.2.3.4:6379 to</i></td></tr>
<tr><th id="607">607</th><td><i> * clusterNode structures. */</i></td></tr>
<tr><th id="608">608</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="clusterNodesDictType" title='clusterNodesDictType' data-ref="clusterNodesDictType">clusterNodesDictType</dfn> = {</td></tr>
<tr><th id="609">609</th><td>    <a class="ref fn" href="#dictSdsHash" title='dictSdsHash' data-ref="dictSdsHash">dictSdsHash</a>,                <i>/* hash function */</i></td></tr>
<tr><th id="610">610</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="611">611</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="612">612</th><td>    <a class="ref fn" href="#dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</a>,          <i>/* key compare */</i></td></tr>
<tr><th id="613">613</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,          <i>/* key destructor */</i></td></tr>
<tr><th id="614">614</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                        <i>/* val destructor */</i></td></tr>
<tr><th id="615">615</th><td>};</td></tr>
<tr><th id="616">616</th><td></td></tr>
<tr><th id="617">617</th><td><i>/* Cluster re-addition blacklist. This maps node IDs to the time</i></td></tr>
<tr><th id="618">618</th><td><i> * we can re-add this node. The goal is to avoid readding a removed</i></td></tr>
<tr><th id="619">619</th><td><i> * node for some time. */</i></td></tr>
<tr><th id="620">620</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="clusterNodesBlackListDictType" title='clusterNodesBlackListDictType' data-ref="clusterNodesBlackListDictType">clusterNodesBlackListDictType</dfn> = {</td></tr>
<tr><th id="621">621</th><td>    <a class="ref fn" href="#dictSdsCaseHash" title='dictSdsCaseHash' data-ref="dictSdsCaseHash">dictSdsCaseHash</a>,            <i>/* hash function */</i></td></tr>
<tr><th id="622">622</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="623">623</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="624">624</th><td>    <a class="ref fn" href="#dictSdsKeyCaseCompare" title='dictSdsKeyCaseCompare' data-ref="dictSdsKeyCaseCompare">dictSdsKeyCaseCompare</a>,      <i>/* key compare */</i></td></tr>
<tr><th id="625">625</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,          <i>/* key destructor */</i></td></tr>
<tr><th id="626">626</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                        <i>/* val destructor */</i></td></tr>
<tr><th id="627">627</th><td>};</td></tr>
<tr><th id="628">628</th><td></td></tr>
<tr><th id="629">629</th><td><i>/* Migrate cache dict type. */</i></td></tr>
<tr><th id="630">630</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="migrateCacheDictType" title='migrateCacheDictType' data-ref="migrateCacheDictType">migrateCacheDictType</dfn> = {</td></tr>
<tr><th id="631">631</th><td>    <a class="ref fn" href="#dictSdsHash" title='dictSdsHash' data-ref="dictSdsHash">dictSdsHash</a>,                <i>/* hash function */</i></td></tr>
<tr><th id="632">632</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="633">633</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="634">634</th><td>    <a class="ref fn" href="#dictSdsKeyCompare" title='dictSdsKeyCompare' data-ref="dictSdsKeyCompare">dictSdsKeyCompare</a>,          <i>/* key compare */</i></td></tr>
<tr><th id="635">635</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,          <i>/* key destructor */</i></td></tr>
<tr><th id="636">636</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                        <i>/* val destructor */</i></td></tr>
<tr><th id="637">637</th><td>};</td></tr>
<tr><th id="638">638</th><td></td></tr>
<tr><th id="639">639</th><td><i>/* Replication cached script dict (server.repl_scriptcache_dict).</i></td></tr>
<tr><th id="640">640</th><td><i> * Keys are sds SHA1 strings, while values are not used at all in the current</i></td></tr>
<tr><th id="641">641</th><td><i> * implementation. */</i></td></tr>
<tr><th id="642">642</th><td><a class="typedef" href="dict.h.html#dictType" title='dictType' data-type='struct dictType' data-ref="dictType">dictType</a> <dfn class="decl def" id="replScriptCacheDictType" title='replScriptCacheDictType' data-ref="replScriptCacheDictType">replScriptCacheDictType</dfn> = {</td></tr>
<tr><th id="643">643</th><td>    <a class="ref fn" href="#dictSdsCaseHash" title='dictSdsCaseHash' data-ref="dictSdsCaseHash">dictSdsCaseHash</a>,            <i>/* hash function */</i></td></tr>
<tr><th id="644">644</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* key dup */</i></td></tr>
<tr><th id="645">645</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,                       <i>/* val dup */</i></td></tr>
<tr><th id="646">646</th><td>    <a class="ref fn" href="#dictSdsKeyCaseCompare" title='dictSdsKeyCaseCompare' data-ref="dictSdsKeyCaseCompare">dictSdsKeyCaseCompare</a>,      <i>/* key compare */</i></td></tr>
<tr><th id="647">647</th><td>    <a class="ref fn" href="#dictSdsDestructor" title='dictSdsDestructor' data-ref="dictSdsDestructor">dictSdsDestructor</a>,          <i>/* key destructor */</i></td></tr>
<tr><th id="648">648</th><td>    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>                        <i>/* val destructor */</i></td></tr>
<tr><th id="649">649</th><td>};</td></tr>
<tr><th id="650">650</th><td></td></tr>
<tr><th id="651">651</th><td><em>int</em> <dfn class="decl def fn" id="htNeedsResize" title='htNeedsResize' data-ref="htNeedsResize">htNeedsResize</dfn>(<a class="typedef" href="dict.h.html#dict" title='dict' data-type='struct dict' data-ref="dict">dict</a> *<dfn class="local col7 decl" id="67dict" title='dict' data-type='dict *' data-ref="67dict">dict</dfn>) {</td></tr>
<tr><th id="652">652</th><td>    <em>long</em> <em>long</em> <dfn class="local col8 decl" id="68size" title='size' data-type='long long' data-ref="68size">size</dfn>, <dfn class="local col9 decl" id="69used" title='used' data-type='long long' data-ref="69used">used</dfn>;</td></tr>
<tr><th id="653">653</th><td></td></tr>
<tr><th id="654">654</th><td>    <a class="local col8 ref" href="#68size" title='size' data-ref="68size">size</a> = <a class="macro" href="dict.h.html#145" title="((dict)-&gt;ht[0].size+(dict)-&gt;ht[1].size)" data-ref="_M/dictSlots">dictSlots</a>(<a class="local col7 ref" href="#67dict" title='dict' data-ref="67dict">dict</a>);</td></tr>
<tr><th id="655">655</th><td>    <a class="local col9 ref" href="#69used" title='used' data-ref="69used">used</a> = <a class="macro" href="dict.h.html#146" title="((dict)-&gt;ht[0].used+(dict)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="local col7 ref" href="#67dict" title='dict' data-ref="67dict">dict</a>);</td></tr>
<tr><th id="656">656</th><td>    <b>return</b> (<a class="local col8 ref" href="#68size" title='size' data-ref="68size">size</a> &amp;&amp; <a class="local col9 ref" href="#69used" title='used' data-ref="69used">used</a> &amp;&amp; <a class="local col8 ref" href="#68size" title='size' data-ref="68size">size</a> &gt; <a class="macro" href="dict.h.html#100" title="4" data-ref="_M/DICT_HT_INITIAL_SIZE">DICT_HT_INITIAL_SIZE</a> &amp;&amp;</td></tr>
<tr><th id="657">657</th><td>            (<a class="local col9 ref" href="#69used" title='used' data-ref="69used">used</a>*<var>100</var>/<a class="local col8 ref" href="#68size" title='size' data-ref="68size">size</a> &lt; <a class="macro" href="redis.h.html#160" title="10" data-ref="_M/REDIS_HT_MINFILL">REDIS_HT_MINFILL</a>));</td></tr>
<tr><th id="658">658</th><td>}</td></tr>
<tr><th id="659">659</th><td></td></tr>
<tr><th id="660">660</th><td><i>/* If the percentage of used slots in the HT reaches REDIS_HT_MINFILL</i></td></tr>
<tr><th id="661">661</th><td><i> * we resize the hash table to save memory */</i></td></tr>
<tr><th id="662">662</th><td><em>void</em> <dfn class="decl def fn" id="tryResizeHashTables" title='tryResizeHashTables' data-ref="tryResizeHashTables">tryResizeHashTables</dfn>(<em>int</em> <dfn class="local col0 decl" id="70dbid" title='dbid' data-type='int' data-ref="70dbid">dbid</dfn>) {</td></tr>
<tr><th id="663">663</th><td>    <b>if</b> (<a class="ref fn" href="#htNeedsResize" title='htNeedsResize' data-ref="htNeedsResize">htNeedsResize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#70dbid" title='dbid' data-ref="70dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>))</td></tr>
<tr><th id="664">664</th><td>        <a class="ref fn" href="dict.h.html#dictResize" title='dictResize' data-ref="dictResize">dictResize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#70dbid" title='dbid' data-ref="70dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>);</td></tr>
<tr><th id="665">665</th><td>    <b>if</b> (<a class="ref fn" href="#htNeedsResize" title='htNeedsResize' data-ref="htNeedsResize">htNeedsResize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#70dbid" title='dbid' data-ref="70dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>))</td></tr>
<tr><th id="666">666</th><td>        <a class="ref fn" href="dict.h.html#dictResize" title='dictResize' data-ref="dictResize">dictResize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#70dbid" title='dbid' data-ref="70dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>);</td></tr>
<tr><th id="667">667</th><td>}</td></tr>
<tr><th id="668">668</th><td></td></tr>
<tr><th id="669">669</th><td><i>/* Our hash table implementation performs rehashing incrementally while</i></td></tr>
<tr><th id="670">670</th><td><i> * we write/read from the hash table. Still if the server is idle, the hash</i></td></tr>
<tr><th id="671">671</th><td><i> * table will use two tables for a long time. So we try to use 1 millisecond</i></td></tr>
<tr><th id="672">672</th><td><i> * of CPU time at every call of this function to perform some rehahsing.</i></td></tr>
<tr><th id="673">673</th><td><i> *</i></td></tr>
<tr><th id="674">674</th><td><i> * The function returns 1 if some rehashing was performed, otherwise 0</i></td></tr>
<tr><th id="675">675</th><td><i> * is returned. */</i></td></tr>
<tr><th id="676">676</th><td><em>int</em> <dfn class="decl def fn" id="incrementallyRehash" title='incrementallyRehash' data-ref="incrementallyRehash">incrementallyRehash</dfn>(<em>int</em> <dfn class="local col1 decl" id="71dbid" title='dbid' data-type='int' data-ref="71dbid">dbid</dfn>) {</td></tr>
<tr><th id="677">677</th><td>    <i>/* Keys dictionary */</i></td></tr>
<tr><th id="678">678</th><td>    <b>if</b> (<a class="macro" href="dict.h.html#147" title="((server.db[dbid].dict)-&gt;rehashidx != -1)" data-ref="_M/dictIsRehashing">dictIsRehashing</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col1 ref" href="#71dbid" title='dbid' data-ref="71dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>)) {</td></tr>
<tr><th id="679">679</th><td>        <a class="ref fn" href="dict.h.html#dictRehashMilliseconds" title='dictRehashMilliseconds' data-ref="dictRehashMilliseconds">dictRehashMilliseconds</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col1 ref" href="#71dbid" title='dbid' data-ref="71dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>,<var>1</var>);</td></tr>
<tr><th id="680">680</th><td>        <b>return</b> <var>1</var>; <i>/* already used our millisecond for this loop... */</i></td></tr>
<tr><th id="681">681</th><td>    }</td></tr>
<tr><th id="682">682</th><td>    <i>/* Expires */</i></td></tr>
<tr><th id="683">683</th><td>    <b>if</b> (<a class="macro" href="dict.h.html#147" title="((server.db[dbid].expires)-&gt;rehashidx != -1)" data-ref="_M/dictIsRehashing">dictIsRehashing</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col1 ref" href="#71dbid" title='dbid' data-ref="71dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>)) {</td></tr>
<tr><th id="684">684</th><td>        <a class="ref fn" href="dict.h.html#dictRehashMilliseconds" title='dictRehashMilliseconds' data-ref="dictRehashMilliseconds">dictRehashMilliseconds</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col1 ref" href="#71dbid" title='dbid' data-ref="71dbid">dbid</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>,<var>1</var>);</td></tr>
<tr><th id="685">685</th><td>        <b>return</b> <var>1</var>; <i>/* already used our millisecond for this loop... */</i></td></tr>
<tr><th id="686">686</th><td>    }</td></tr>
<tr><th id="687">687</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="688">688</th><td>}</td></tr>
<tr><th id="689">689</th><td></td></tr>
<tr><th id="690">690</th><td><i>/* This function is called once a background process of some kind terminates,</i></td></tr>
<tr><th id="691">691</th><td><i> * as we want to avoid resizing the hash tables when there is a child in order</i></td></tr>
<tr><th id="692">692</th><td><i> * to play well with copy-on-write (otherwise when a resize happens lots of</i></td></tr>
<tr><th id="693">693</th><td><i> * memory pages are copied). The goal of this function is to update the ability</i></td></tr>
<tr><th id="694">694</th><td><i> * for dict.c to resize the hash tables accordingly to the fact we have o not</i></td></tr>
<tr><th id="695">695</th><td><i> * running childs. */</i></td></tr>
<tr><th id="696">696</th><td><em>void</em> <dfn class="decl def fn" id="updateDictResizePolicy" title='updateDictResizePolicy' data-ref="updateDictResizePolicy">updateDictResizePolicy</dfn>(<em>void</em>) {</td></tr>
<tr><th id="697">697</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> == -<var>1</var> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> == -<var>1</var>)</td></tr>
<tr><th id="698">698</th><td>        <a class="ref fn" href="dict.h.html#dictEnableResize" title='dictEnableResize' data-ref="dictEnableResize">dictEnableResize</a>();</td></tr>
<tr><th id="699">699</th><td>    <b>else</b></td></tr>
<tr><th id="700">700</th><td>        <a class="ref fn" href="dict.h.html#dictDisableResize" title='dictDisableResize' data-ref="dictDisableResize">dictDisableResize</a>();</td></tr>
<tr><th id="701">701</th><td>}</td></tr>
<tr><th id="702">702</th><td></td></tr>
<tr><th id="703">703</th><td><i>/* ======================= Cron: called every 100 ms ======================== */</i></td></tr>
<tr><th id="704">704</th><td></td></tr>
<tr><th id="705">705</th><td><i>/* Helper function for the activeExpireCycle() function.</i></td></tr>
<tr><th id="706">706</th><td><i> * This function will try to expire the key that is stored in the hash table</i></td></tr>
<tr><th id="707">707</th><td><i> * entry 'de' of the 'expires' hash table of a Redis database.</i></td></tr>
<tr><th id="708">708</th><td><i> *</i></td></tr>
<tr><th id="709">709</th><td><i> * If the key is found to be expired, it is removed from the database and</i></td></tr>
<tr><th id="710">710</th><td><i> * 1 is returned. Otherwise no operation is performed and 0 is returned.</i></td></tr>
<tr><th id="711">711</th><td><i> *</i></td></tr>
<tr><th id="712">712</th><td><i> * When a key is expired, server.stat_expiredkeys is incremented.</i></td></tr>
<tr><th id="713">713</th><td><i> *</i></td></tr>
<tr><th id="714">714</th><td><i> * The parameter 'now' is the current time in milliseconds as is passed</i></td></tr>
<tr><th id="715">715</th><td><i> * to the function to avoid too many gettimeofday() syscalls. */</i></td></tr>
<tr><th id="716">716</th><td><em>int</em> <dfn class="decl def fn" id="activeExpireCycleTryExpire" title='activeExpireCycleTryExpire' data-ref="activeExpireCycleTryExpire">activeExpireCycleTryExpire</dfn>(<a class="typedef" href="redis.h.html#redisDb" title='redisDb' data-type='struct redisDb' data-ref="redisDb">redisDb</a> *<dfn class="local col2 decl" id="72db" title='db' data-type='redisDb *' data-ref="72db">db</dfn>, <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> *<dfn class="local col3 decl" id="73de" title='de' data-type='dictEntry *' data-ref="73de">de</dfn>, <em>long</em> <em>long</em> <dfn class="local col4 decl" id="74now" title='now' data-type='long long' data-ref="74now">now</dfn>) {</td></tr>
<tr><th id="717">717</th><td>    <em>long</em> <em>long</em> <dfn class="local col5 decl" id="75t" title='t' data-type='long long' data-ref="75t">t</dfn> = <a class="macro" href="dict.h.html#142" title="((de)-&gt;v.s64)" data-ref="_M/dictGetSignedIntegerVal">dictGetSignedIntegerVal</a>(<a class="local col3 ref" href="#73de" title='de' data-ref="73de">de</a>);</td></tr>
<tr><th id="718">718</th><td>    <b>if</b> (<a class="local col4 ref" href="#74now" title='now' data-ref="74now">now</a> &gt; <a class="local col5 ref" href="#75t" title='t' data-ref="75t">t</a>) {</td></tr>
<tr><th id="719">719</th><td>        <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col6 decl" id="76key" title='key' data-type='sds' data-ref="76key">key</dfn> = <a class="macro" href="dict.h.html#140" title="((de)-&gt;key)" data-ref="_M/dictGetKey">dictGetKey</a>(<a class="local col3 ref" href="#73de" title='de' data-ref="73de">de</a>);</td></tr>
<tr><th id="720">720</th><td>        <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col7 decl" id="77keyobj" title='keyobj' data-type='robj *' data-ref="77keyobj">keyobj</dfn> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<a class="local col6 ref" href="#76key" title='key' data-ref="76key">key</a>,<a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>(<a class="local col6 ref" href="#76key" title='key' data-ref="76key">key</a>));</td></tr>
<tr><th id="721">721</th><td></td></tr>
<tr><th id="722">722</th><td>        <a class="ref fn" href="redis.h.html#propagateExpire" title='propagateExpire' data-ref="propagateExpire">propagateExpire</a>(<a class="local col2 ref" href="#72db" title='db' data-ref="72db">db</a>,<a class="local col7 ref" href="#77keyobj" title='keyobj' data-ref="77keyobj">keyobj</a>);</td></tr>
<tr><th id="723">723</th><td>        <a class="ref fn" href="redis.h.html#dbDelete" title='dbDelete' data-ref="dbDelete">dbDelete</a>(<a class="local col2 ref" href="#72db" title='db' data-ref="72db">db</a>,<a class="local col7 ref" href="#77keyobj" title='keyobj' data-ref="77keyobj">keyobj</a>);</td></tr>
<tr><th id="724">724</th><td>        <a class="ref fn" href="redis.h.html#notifyKeyspaceEvent" title='notifyKeyspaceEvent' data-ref="notifyKeyspaceEvent">notifyKeyspaceEvent</a>(<a class="macro" href="redis.h.html#385" title="(1&lt;&lt;8)" data-ref="_M/REDIS_NOTIFY_EXPIRED">REDIS_NOTIFY_EXPIRED</a>,</td></tr>
<tr><th id="725">725</th><td>            <q>"expired"</q>,<a class="local col7 ref" href="#77keyobj" title='keyobj' data-ref="77keyobj">keyobj</a>,<a class="local col2 ref" href="#72db" title='db' data-ref="72db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::id" title='redisDb::id' data-ref="redisDb::id">id</a>);</td></tr>
<tr><th id="726">726</th><td>        <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col7 ref" href="#77keyobj" title='keyobj' data-ref="77keyobj">keyobj</a>);</td></tr>
<tr><th id="727">727</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_expiredkeys" title='redisServer::stat_expiredkeys' data-ref="redisServer::stat_expiredkeys">stat_expiredkeys</a>++;</td></tr>
<tr><th id="728">728</th><td>        <b>return</b> <var>1</var>;</td></tr>
<tr><th id="729">729</th><td>    } <b>else</b> {</td></tr>
<tr><th id="730">730</th><td>        <b>return</b> <var>0</var>;</td></tr>
<tr><th id="731">731</th><td>    }</td></tr>
<tr><th id="732">732</th><td>}</td></tr>
<tr><th id="733">733</th><td></td></tr>
<tr><th id="734">734</th><td><i>/* Try to expire a few timed out keys. The algorithm used is adaptive and</i></td></tr>
<tr><th id="735">735</th><td><i> * will use few CPU cycles if there are few expiring keys, otherwise</i></td></tr>
<tr><th id="736">736</th><td><i> * it will get more aggressive to avoid that too much memory is used by</i></td></tr>
<tr><th id="737">737</th><td><i> * keys that can be removed from the keyspace.</i></td></tr>
<tr><th id="738">738</th><td><i> *</i></td></tr>
<tr><th id="739">739</th><td><i> * No more than REDIS_DBCRON_DBS_PER_CALL databases are tested at every</i></td></tr>
<tr><th id="740">740</th><td><i> * iteration.</i></td></tr>
<tr><th id="741">741</th><td><i> *</i></td></tr>
<tr><th id="742">742</th><td><i> * This kind of call is used when Redis detects that timelimit_exit is</i></td></tr>
<tr><th id="743">743</th><td><i> * true, so there is more work to do, and we do it more incrementally from</i></td></tr>
<tr><th id="744">744</th><td><i> * the beforeSleep() function of the event loop.</i></td></tr>
<tr><th id="745">745</th><td><i> *</i></td></tr>
<tr><th id="746">746</th><td><i> * Expire cycle type:</i></td></tr>
<tr><th id="747">747</th><td><i> *</i></td></tr>
<tr><th id="748">748</th><td><i> * If type is ACTIVE_EXPIRE_CYCLE_FAST the function will try to run a</i></td></tr>
<tr><th id="749">749</th><td><i> * "fast" expire cycle that takes no longer than EXPIRE_FAST_CYCLE_DURATION</i></td></tr>
<tr><th id="750">750</th><td><i> * microseconds, and is not repeated again before the same amount of time.</i></td></tr>
<tr><th id="751">751</th><td><i> *</i></td></tr>
<tr><th id="752">752</th><td><i> * If type is ACTIVE_EXPIRE_CYCLE_SLOW, that normal expire cycle is</i></td></tr>
<tr><th id="753">753</th><td><i> * executed, where the time limit is a percentage of the REDIS_HZ period</i></td></tr>
<tr><th id="754">754</th><td><i> * as specified by the REDIS_EXPIRELOOKUPS_TIME_PERC define. */</i></td></tr>
<tr><th id="755">755</th><td></td></tr>
<tr><th id="756">756</th><td><em>void</em> <dfn class="decl def fn" id="activeExpireCycle" title='activeExpireCycle' data-ref="activeExpireCycle">activeExpireCycle</dfn>(<em>int</em> <dfn class="local col8 decl" id="78type" title='type' data-type='int' data-ref="78type">type</dfn>) {</td></tr>
<tr><th id="757">757</th><td>    <i>/* This function has some global state in order to continue the work</i></td></tr>
<tr><th id="758">758</th><td><i>     * incrementally across calls. */</i></td></tr>
<tr><th id="759">759</th><td>    <em>static</em> <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="79current_db" title='current_db' data-type='unsigned int' data-ref="79current_db">current_db</dfn> = <var>0</var>; <i>/* Last DB tested. */</i></td></tr>
<tr><th id="760">760</th><td>    <em>static</em> <em>int</em> <dfn class="local col0 decl" id="80timelimit_exit" title='timelimit_exit' data-type='int' data-ref="80timelimit_exit">timelimit_exit</dfn> = <var>0</var>;      <i>/* Time limit hit in previous call? */</i></td></tr>
<tr><th id="761">761</th><td>    <em>static</em> <em>long</em> <em>long</em> <dfn class="local col1 decl" id="81last_fast_cycle" title='last_fast_cycle' data-type='long long' data-ref="81last_fast_cycle">last_fast_cycle</dfn> = <var>0</var>; <i>/* When last fast cycle ran. */</i></td></tr>
<tr><th id="762">762</th><td></td></tr>
<tr><th id="763">763</th><td>    <em>int</em> <dfn class="local col2 decl" id="82j" title='j' data-type='int' data-ref="82j">j</dfn>, <dfn class="local col3 decl" id="83iteration" title='iteration' data-type='int' data-ref="83iteration">iteration</dfn> = <var>0</var>;</td></tr>
<tr><th id="764">764</th><td>    <em>int</em> <dfn class="local col4 decl" id="84dbs_per_call" title='dbs_per_call' data-type='int' data-ref="84dbs_per_call">dbs_per_call</dfn> = <a class="macro" href="redis.h.html#79" title="16" data-ref="_M/REDIS_DBCRON_DBS_PER_CALL">REDIS_DBCRON_DBS_PER_CALL</a>;</td></tr>
<tr><th id="765">765</th><td>    <em>long</em> <em>long</em> <dfn class="local col5 decl" id="85start" title='start' data-type='long long' data-ref="85start">start</dfn> = <a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>(), <dfn class="local col6 decl" id="86timelimit" title='timelimit' data-type='long long' data-ref="86timelimit">timelimit</dfn>;</td></tr>
<tr><th id="766">766</th><td></td></tr>
<tr><th id="767">767</th><td>    <b>if</b> (<a class="local col8 ref" href="#78type" title='type' data-ref="78type">type</a> == <a class="macro" href="redis.h.html#137" title="1" data-ref="_M/ACTIVE_EXPIRE_CYCLE_FAST">ACTIVE_EXPIRE_CYCLE_FAST</a>) {</td></tr>
<tr><th id="768">768</th><td>        <i>/* Don't start a fast cycle if the previous cycle did not exited</i></td></tr>
<tr><th id="769">769</th><td><i>         * for time limt. Also don't repeat a fast cycle for the same period</i></td></tr>
<tr><th id="770">770</th><td><i>         * as the fast cycle total duration itself. */</i></td></tr>
<tr><th id="771">771</th><td>        <b>if</b> (!<a class="local col0 ref" href="#80timelimit_exit" title='timelimit_exit' data-ref="80timelimit_exit">timelimit_exit</a>) <b>return</b>;</td></tr>
<tr><th id="772">772</th><td>        <b>if</b> (<a class="local col5 ref" href="#85start" title='start' data-ref="85start">start</a> &lt; <a class="local col1 ref" href="#81last_fast_cycle" title='last_fast_cycle' data-ref="81last_fast_cycle">last_fast_cycle</a> + <a class="macro" href="redis.h.html#134" title="1000" data-ref="_M/ACTIVE_EXPIRE_CYCLE_FAST_DURATION">ACTIVE_EXPIRE_CYCLE_FAST_DURATION</a>*<var>2</var>) <b>return</b>;</td></tr>
<tr><th id="773">773</th><td>        <a class="local col1 ref" href="#81last_fast_cycle" title='last_fast_cycle' data-ref="81last_fast_cycle">last_fast_cycle</a> = <a class="local col5 ref" href="#85start" title='start' data-ref="85start">start</a>;</td></tr>
<tr><th id="774">774</th><td>    }</td></tr>
<tr><th id="775">775</th><td></td></tr>
<tr><th id="776">776</th><td>    <i>/* We usually should test REDIS_DBCRON_DBS_PER_CALL per iteration, with</i></td></tr>
<tr><th id="777">777</th><td><i>     * two exceptions:</i></td></tr>
<tr><th id="778">778</th><td><i>     *</i></td></tr>
<tr><th id="779">779</th><td><i>     * 1) Don't test more DBs than we have.</i></td></tr>
<tr><th id="780">780</th><td><i>     * 2) If last time we hit the time limit, we want to scan all DBs</i></td></tr>
<tr><th id="781">781</th><td><i>     * in this iteration, as there is work to do in some DB and we don't want</i></td></tr>
<tr><th id="782">782</th><td><i>     * expired keys to use memory for too much time. */</i></td></tr>
<tr><th id="783">783</th><td>    <b>if</b> (<a class="local col4 ref" href="#84dbs_per_call" title='dbs_per_call' data-ref="84dbs_per_call">dbs_per_call</a> &gt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a> || <a class="local col0 ref" href="#80timelimit_exit" title='timelimit_exit' data-ref="80timelimit_exit">timelimit_exit</a>)</td></tr>
<tr><th id="784">784</th><td>        <a class="local col4 ref" href="#84dbs_per_call" title='dbs_per_call' data-ref="84dbs_per_call">dbs_per_call</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>;</td></tr>
<tr><th id="785">785</th><td></td></tr>
<tr><th id="786">786</th><td>    <i>/* We can use at max ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC percentage of CPU time</i></td></tr>
<tr><th id="787">787</th><td><i>     * per iteration. Since this function gets called with a frequency of</i></td></tr>
<tr><th id="788">788</th><td><i>     * server.hz times per second, the following is the max amount of</i></td></tr>
<tr><th id="789">789</th><td><i>     * microseconds we can spend in this function. */</i></td></tr>
<tr><th id="790">790</th><td>    <a class="local col6 ref" href="#86timelimit" title='timelimit' data-ref="86timelimit">timelimit</a> = <var>1000000</var>*<a class="macro" href="redis.h.html#135" title="25" data-ref="_M/ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC">ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC</a>/<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hz" title='redisServer::hz' data-ref="redisServer::hz">hz</a>/<var>100</var>;</td></tr>
<tr><th id="791">791</th><td>    <a class="local col0 ref" href="#80timelimit_exit" title='timelimit_exit' data-ref="80timelimit_exit">timelimit_exit</a> = <var>0</var>;</td></tr>
<tr><th id="792">792</th><td>    <b>if</b> (<a class="local col6 ref" href="#86timelimit" title='timelimit' data-ref="86timelimit">timelimit</a> &lt;= <var>0</var>) <a class="local col6 ref" href="#86timelimit" title='timelimit' data-ref="86timelimit">timelimit</a> = <var>1</var>;</td></tr>
<tr><th id="793">793</th><td></td></tr>
<tr><th id="794">794</th><td>    <b>if</b> (<a class="local col8 ref" href="#78type" title='type' data-ref="78type">type</a> == <a class="macro" href="redis.h.html#137" title="1" data-ref="_M/ACTIVE_EXPIRE_CYCLE_FAST">ACTIVE_EXPIRE_CYCLE_FAST</a>)</td></tr>
<tr><th id="795">795</th><td>        <a class="local col6 ref" href="#86timelimit" title='timelimit' data-ref="86timelimit">timelimit</a> = <a class="macro" href="redis.h.html#134" title="1000" data-ref="_M/ACTIVE_EXPIRE_CYCLE_FAST_DURATION">ACTIVE_EXPIRE_CYCLE_FAST_DURATION</a>; <i>/* in microseconds. */</i></td></tr>
<tr><th id="796">796</th><td></td></tr>
<tr><th id="797">797</th><td>    <b>for</b> (<a class="local col2 ref" href="#82j" title='j' data-ref="82j">j</a> = <var>0</var>; <a class="local col2 ref" href="#82j" title='j' data-ref="82j">j</a> &lt; <a class="local col4 ref" href="#84dbs_per_call" title='dbs_per_call' data-ref="84dbs_per_call">dbs_per_call</a>; <a class="local col2 ref" href="#82j" title='j' data-ref="82j">j</a>++) {</td></tr>
<tr><th id="798">798</th><td>        <em>int</em> <dfn class="local col7 decl" id="87expired" title='expired' data-type='int' data-ref="87expired">expired</dfn>;</td></tr>
<tr><th id="799">799</th><td>        <a class="typedef" href="redis.h.html#redisDb" title='redisDb' data-type='struct redisDb' data-ref="redisDb">redisDb</a> *<dfn class="local col8 decl" id="88db" title='db' data-type='redisDb *' data-ref="88db">db</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>+(<a class="local col9 ref" href="#79current_db" title='current_db' data-ref="79current_db">current_db</a> % <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>);</td></tr>
<tr><th id="800">800</th><td></td></tr>
<tr><th id="801">801</th><td>        <i>/* Increment the DB now so we are sure if we run out of time</i></td></tr>
<tr><th id="802">802</th><td><i>         * in the current DB we'll restart from the next. This allows to</i></td></tr>
<tr><th id="803">803</th><td><i>         * distribute the time evenly across DBs. */</i></td></tr>
<tr><th id="804">804</th><td>        <a class="local col9 ref" href="#79current_db" title='current_db' data-ref="79current_db">current_db</a>++;</td></tr>
<tr><th id="805">805</th><td></td></tr>
<tr><th id="806">806</th><td>        <i>/* Continue to expire if at the end of the cycle more than 25%</i></td></tr>
<tr><th id="807">807</th><td><i>         * of the keys were expired. */</i></td></tr>
<tr><th id="808">808</th><td>        <b>do</b> {</td></tr>
<tr><th id="809">809</th><td>            <em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="89num" title='num' data-type='unsigned long' data-ref="89num">num</dfn>, <dfn class="local col0 decl" id="90slots" title='slots' data-type='unsigned long' data-ref="90slots">slots</dfn>;</td></tr>
<tr><th id="810">810</th><td>            <em>long</em> <em>long</em> <dfn class="local col1 decl" id="91now" title='now' data-type='long long' data-ref="91now">now</dfn>, <dfn class="local col2 decl" id="92ttl_sum" title='ttl_sum' data-type='long long' data-ref="92ttl_sum">ttl_sum</dfn>;</td></tr>
<tr><th id="811">811</th><td>            <em>int</em> <dfn class="local col3 decl" id="93ttl_samples" title='ttl_samples' data-type='int' data-ref="93ttl_samples">ttl_samples</dfn>;</td></tr>
<tr><th id="812">812</th><td></td></tr>
<tr><th id="813">813</th><td>            <i>/* If there is nothing to expire try next DB ASAP. */</i></td></tr>
<tr><th id="814">814</th><td>            <b>if</b> ((<a class="local col9 ref" href="#89num" title='num' data-ref="89num">num</a> = <a class="macro" href="dict.h.html#146" title="((db-&gt;expires)-&gt;ht[0].used+(db-&gt;expires)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>)) == <var>0</var>) {</td></tr>
<tr><th id="815">815</th><td>                <a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a> = <var>0</var>;</td></tr>
<tr><th id="816">816</th><td>                <b>break</b>;</td></tr>
<tr><th id="817">817</th><td>            }</td></tr>
<tr><th id="818">818</th><td>            <a class="local col0 ref" href="#90slots" title='slots' data-ref="90slots">slots</a> = <a class="macro" href="dict.h.html#145" title="((db-&gt;expires)-&gt;ht[0].size+(db-&gt;expires)-&gt;ht[1].size)" data-ref="_M/dictSlots">dictSlots</a>(<a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>);</td></tr>
<tr><th id="819">819</th><td>            <a class="local col1 ref" href="#91now" title='now' data-ref="91now">now</a> = <a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>();</td></tr>
<tr><th id="820">820</th><td></td></tr>
<tr><th id="821">821</th><td>            <i>/* When there are less than 1% filled slots getting random</i></td></tr>
<tr><th id="822">822</th><td><i>             * keys is expensive, so stop here waiting for better times...</i></td></tr>
<tr><th id="823">823</th><td><i>             * The dictionary will be resized asap. */</i></td></tr>
<tr><th id="824">824</th><td>            <b>if</b> (<a class="local col9 ref" href="#89num" title='num' data-ref="89num">num</a> &amp;&amp; <a class="local col0 ref" href="#90slots" title='slots' data-ref="90slots">slots</a> &gt; <a class="macro" href="dict.h.html#100" title="4" data-ref="_M/DICT_HT_INITIAL_SIZE">DICT_HT_INITIAL_SIZE</a> &amp;&amp;</td></tr>
<tr><th id="825">825</th><td>                (<a class="local col9 ref" href="#89num" title='num' data-ref="89num">num</a>*<var>100</var>/<a class="local col0 ref" href="#90slots" title='slots' data-ref="90slots">slots</a> &lt; <var>1</var>)) <b>break</b>;</td></tr>
<tr><th id="826">826</th><td></td></tr>
<tr><th id="827">827</th><td>            <i>/* The main collection cycle. Sample random keys among keys</i></td></tr>
<tr><th id="828">828</th><td><i>             * with an expire set, checking for expired ones. */</i></td></tr>
<tr><th id="829">829</th><td>            <a class="local col7 ref" href="#87expired" title='expired' data-ref="87expired">expired</a> = <var>0</var>;</td></tr>
<tr><th id="830">830</th><td>            <a class="local col2 ref" href="#92ttl_sum" title='ttl_sum' data-ref="92ttl_sum">ttl_sum</a> = <var>0</var>;</td></tr>
<tr><th id="831">831</th><td>            <a class="local col3 ref" href="#93ttl_samples" title='ttl_samples' data-ref="93ttl_samples">ttl_samples</a> = <var>0</var>;</td></tr>
<tr><th id="832">832</th><td></td></tr>
<tr><th id="833">833</th><td>            <b>if</b> (<a class="local col9 ref" href="#89num" title='num' data-ref="89num">num</a> &gt; <a class="macro" href="redis.h.html#133" title="20" data-ref="_M/ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP">ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP</a>)</td></tr>
<tr><th id="834">834</th><td>                <a class="local col9 ref" href="#89num" title='num' data-ref="89num">num</a> = <a class="macro" href="redis.h.html#133" title="20" data-ref="_M/ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP">ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP</a>;</td></tr>
<tr><th id="835">835</th><td></td></tr>
<tr><th id="836">836</th><td>            <b>while</b> (<a class="local col9 ref" href="#89num" title='num' data-ref="89num">num</a>--) {</td></tr>
<tr><th id="837">837</th><td>                <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> *<dfn class="local col4 decl" id="94de" title='de' data-type='dictEntry *' data-ref="94de">de</dfn>;</td></tr>
<tr><th id="838">838</th><td>                <em>long</em> <em>long</em> <dfn class="local col5 decl" id="95ttl" title='ttl' data-type='long long' data-ref="95ttl">ttl</dfn>;</td></tr>
<tr><th id="839">839</th><td></td></tr>
<tr><th id="840">840</th><td>                <b>if</b> ((<a class="local col4 ref" href="#94de" title='de' data-ref="94de">de</a> = <a class="ref fn" href="dict.h.html#dictGetRandomKey" title='dictGetRandomKey' data-ref="dictGetRandomKey">dictGetRandomKey</a>(<a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>)) == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) <b>break</b>;</td></tr>
<tr><th id="841">841</th><td>                <a class="local col5 ref" href="#95ttl" title='ttl' data-ref="95ttl">ttl</a> = <a class="macro" href="dict.h.html#142" title="((de)-&gt;v.s64)" data-ref="_M/dictGetSignedIntegerVal">dictGetSignedIntegerVal</a>(<a class="local col4 ref" href="#94de" title='de' data-ref="94de">de</a>)-<a class="local col1 ref" href="#91now" title='now' data-ref="91now">now</a>;</td></tr>
<tr><th id="842">842</th><td>                <b>if</b> (<a class="ref fn" href="#activeExpireCycleTryExpire" title='activeExpireCycleTryExpire' data-ref="activeExpireCycleTryExpire">activeExpireCycleTryExpire</a>(<a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>,<a class="local col4 ref" href="#94de" title='de' data-ref="94de">de</a>,<a class="local col1 ref" href="#91now" title='now' data-ref="91now">now</a>)) <a class="local col7 ref" href="#87expired" title='expired' data-ref="87expired">expired</a>++;</td></tr>
<tr><th id="843">843</th><td>                <b>if</b> (<a class="local col5 ref" href="#95ttl" title='ttl' data-ref="95ttl">ttl</a> &lt; <var>0</var>) <a class="local col5 ref" href="#95ttl" title='ttl' data-ref="95ttl">ttl</a> = <var>0</var>;</td></tr>
<tr><th id="844">844</th><td>                <a class="local col2 ref" href="#92ttl_sum" title='ttl_sum' data-ref="92ttl_sum">ttl_sum</a> += <a class="local col5 ref" href="#95ttl" title='ttl' data-ref="95ttl">ttl</a>;</td></tr>
<tr><th id="845">845</th><td>                <a class="local col3 ref" href="#93ttl_samples" title='ttl_samples' data-ref="93ttl_samples">ttl_samples</a>++;</td></tr>
<tr><th id="846">846</th><td>            }</td></tr>
<tr><th id="847">847</th><td></td></tr>
<tr><th id="848">848</th><td>            <i>/* Update the average TTL stats for this database. */</i></td></tr>
<tr><th id="849">849</th><td>            <b>if</b> (<a class="local col3 ref" href="#93ttl_samples" title='ttl_samples' data-ref="93ttl_samples">ttl_samples</a>) {</td></tr>
<tr><th id="850">850</th><td>                <em>long</em> <em>long</em> <dfn class="local col6 decl" id="96avg_ttl" title='avg_ttl' data-type='long long' data-ref="96avg_ttl">avg_ttl</dfn> = <a class="local col2 ref" href="#92ttl_sum" title='ttl_sum' data-ref="92ttl_sum">ttl_sum</a>/<a class="local col3 ref" href="#93ttl_samples" title='ttl_samples' data-ref="93ttl_samples">ttl_samples</a>;</td></tr>
<tr><th id="851">851</th><td></td></tr>
<tr><th id="852">852</th><td>                <b>if</b> (<a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a> == <var>0</var>) <a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a> = <a class="local col6 ref" href="#96avg_ttl" title='avg_ttl' data-ref="96avg_ttl">avg_ttl</a>;</td></tr>
<tr><th id="853">853</th><td>                <i>/* Smooth the value averaging with the previous one. */</i></td></tr>
<tr><th id="854">854</th><td>                <a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a> = (<a class="local col8 ref" href="#88db" title='db' data-ref="88db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a>+<a class="local col6 ref" href="#96avg_ttl" title='avg_ttl' data-ref="96avg_ttl">avg_ttl</a>)/<var>2</var>;</td></tr>
<tr><th id="855">855</th><td>            }</td></tr>
<tr><th id="856">856</th><td></td></tr>
<tr><th id="857">857</th><td>            <i>/* We can't block forever here even if there are many keys to</i></td></tr>
<tr><th id="858">858</th><td><i>             * expire. So after a given amount of milliseconds return to the</i></td></tr>
<tr><th id="859">859</th><td><i>             * caller waiting for the other active expire cycle. */</i></td></tr>
<tr><th id="860">860</th><td>            <a class="local col3 ref" href="#83iteration" title='iteration' data-ref="83iteration">iteration</a>++;</td></tr>
<tr><th id="861">861</th><td>            <b>if</b> ((<a class="local col3 ref" href="#83iteration" title='iteration' data-ref="83iteration">iteration</a> &amp; <var>0xf</var>) == <var>0</var>) { <i>/* check once every 16 iterations. */</i></td></tr>
<tr><th id="862">862</th><td>                <em>long</em> <em>long</em> <dfn class="local col7 decl" id="97elapsed" title='elapsed' data-type='long long' data-ref="97elapsed">elapsed</dfn> = <a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>()-<a class="local col5 ref" href="#85start" title='start' data-ref="85start">start</a>;</td></tr>
<tr><th id="863">863</th><td></td></tr>
<tr><th id="864">864</th><td>                <a class="macro" href="latency.h.html#84" title="if (server.latency_monitor_threshold &amp;&amp; (elapsed/1000) &gt;= server.latency_monitor_threshold) latencyAddSample((&quot;expire-cycle&quot;),(elapsed/1000));" data-ref="_M/latencyAddSampleIfNeeded">latencyAddSampleIfNeeded</a>(<q>"expire-cycle"</q>,<a class="local col7 ref" href="#97elapsed" title='elapsed' data-ref="97elapsed">elapsed</a>/<var>1000</var>);</td></tr>
<tr><th id="865">865</th><td>                <b>if</b> (<a class="local col7 ref" href="#97elapsed" title='elapsed' data-ref="97elapsed">elapsed</a> &gt; <a class="local col6 ref" href="#86timelimit" title='timelimit' data-ref="86timelimit">timelimit</a>) <a class="local col0 ref" href="#80timelimit_exit" title='timelimit_exit' data-ref="80timelimit_exit">timelimit_exit</a> = <var>1</var>;</td></tr>
<tr><th id="866">866</th><td>            }</td></tr>
<tr><th id="867">867</th><td>            <b>if</b> (<a class="local col0 ref" href="#80timelimit_exit" title='timelimit_exit' data-ref="80timelimit_exit">timelimit_exit</a>) <b>return</b>;</td></tr>
<tr><th id="868">868</th><td>            <i>/* We don't repeat the cycle if there are less than 25% of keys</i></td></tr>
<tr><th id="869">869</th><td><i>             * found expired in the current DB. */</i></td></tr>
<tr><th id="870">870</th><td>        } <b>while</b> (<a class="local col7 ref" href="#87expired" title='expired' data-ref="87expired">expired</a> &gt; <a class="macro" href="redis.h.html#133" title="20" data-ref="_M/ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP">ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP</a>/<var>4</var>);</td></tr>
<tr><th id="871">871</th><td>    }</td></tr>
<tr><th id="872">872</th><td>}</td></tr>
<tr><th id="873">873</th><td></td></tr>
<tr><th id="874">874</th><td><em>unsigned</em> <em>int</em> <dfn class="decl def fn" id="getLRUClock" title='getLRUClock' data-ref="getLRUClock">getLRUClock</dfn>(<em>void</em>) {</td></tr>
<tr><th id="875">875</th><td>    <b>return</b> (<a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>()/<a class="macro" href="redis.h.html#411" title="1000" data-ref="_M/REDIS_LRU_CLOCK_RESOLUTION">REDIS_LRU_CLOCK_RESOLUTION</a>) &amp; <a class="macro" href="redis.h.html#410" title="((1&lt;&lt;24)-1)" data-ref="_M/REDIS_LRU_CLOCK_MAX">REDIS_LRU_CLOCK_MAX</a>;</td></tr>
<tr><th id="876">876</th><td>}</td></tr>
<tr><th id="877">877</th><td></td></tr>
<tr><th id="878">878</th><td><i>/* Add a sample to the operations per second array of samples. */</i></td></tr>
<tr><th id="879">879</th><td><em>void</em> <dfn class="decl def fn" id="trackInstantaneousMetric" title='trackInstantaneousMetric' data-ref="trackInstantaneousMetric">trackInstantaneousMetric</dfn>(<em>int</em> <dfn class="local col8 decl" id="98metric" title='metric' data-type='int' data-ref="98metric">metric</dfn>, <em>long</em> <em>long</em> <dfn class="local col9 decl" id="99current_reading" title='current_reading' data-type='long long' data-ref="99current_reading">current_reading</dfn>) {</td></tr>
<tr><th id="880">880</th><td>    <em>long</em> <em>long</em> <dfn class="local col0 decl" id="100t" title='t' data-type='long long' data-ref="100t">t</dfn> = <a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>() - <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::last_sample_time" title='redisServer::(anonymous struct)::last_sample_time' data-ref="redisServer::(anonymous)::last_sample_time">last_sample_time</a>;</td></tr>
<tr><th id="881">881</th><td>    <em>long</em> <em>long</em> <dfn class="local col1 decl" id="101ops" title='ops' data-type='long long' data-ref="101ops">ops</dfn> = <a class="local col9 ref" href="#99current_reading" title='current_reading' data-ref="99current_reading">current_reading</a> -</td></tr>
<tr><th id="882">882</th><td>                    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::last_sample_count" title='redisServer::(anonymous struct)::last_sample_count' data-ref="redisServer::(anonymous)::last_sample_count">last_sample_count</a>;</td></tr>
<tr><th id="883">883</th><td>    <em>long</em> <em>long</em> <dfn class="local col2 decl" id="102ops_sec" title='ops_sec' data-type='long long' data-ref="102ops_sec">ops_sec</dfn>;</td></tr>
<tr><th id="884">884</th><td></td></tr>
<tr><th id="885">885</th><td>    <a class="local col2 ref" href="#102ops_sec" title='ops_sec' data-ref="102ops_sec">ops_sec</a> = <a class="local col0 ref" href="#100t" title='t' data-ref="100t">t</a> &gt; <var>0</var> ? (<a class="local col1 ref" href="#101ops" title='ops' data-ref="101ops">ops</a>*<var>1000</var>/<a class="local col0 ref" href="#100t" title='t' data-ref="100t">t</a>) : <var>0</var>;</td></tr>
<tr><th id="886">886</th><td></td></tr>
<tr><th id="887">887</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::samples" title='redisServer::(anonymous struct)::samples' data-ref="redisServer::(anonymous)::samples">samples</a>[<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::idx" title='redisServer::(anonymous struct)::idx' data-ref="redisServer::(anonymous)::idx">idx</a>] =</td></tr>
<tr><th id="888">888</th><td>        <a class="local col2 ref" href="#102ops_sec" title='ops_sec' data-ref="102ops_sec">ops_sec</a>;</td></tr>
<tr><th id="889">889</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::idx" title='redisServer::(anonymous struct)::idx' data-ref="redisServer::(anonymous)::idx">idx</a>++;</td></tr>
<tr><th id="890">890</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::idx" title='redisServer::(anonymous struct)::idx' data-ref="redisServer::(anonymous)::idx">idx</a> %= <a class="macro" href="redis.h.html#140" title="16" data-ref="_M/REDIS_METRIC_SAMPLES">REDIS_METRIC_SAMPLES</a>;</td></tr>
<tr><th id="891">891</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::last_sample_time" title='redisServer::(anonymous struct)::last_sample_time' data-ref="redisServer::(anonymous)::last_sample_time">last_sample_time</a> = <a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>();</td></tr>
<tr><th id="892">892</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col8 ref" href="#98metric" title='metric' data-ref="98metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::last_sample_count" title='redisServer::(anonymous struct)::last_sample_count' data-ref="redisServer::(anonymous)::last_sample_count">last_sample_count</a> = <a class="local col9 ref" href="#99current_reading" title='current_reading' data-ref="99current_reading">current_reading</a>;</td></tr>
<tr><th id="893">893</th><td>}</td></tr>
<tr><th id="894">894</th><td></td></tr>
<tr><th id="895">895</th><td><i>/* Return the mean of all the samples. */</i></td></tr>
<tr><th id="896">896</th><td><em>long</em> <em>long</em> <dfn class="decl def fn" id="getInstantaneousMetric" title='getInstantaneousMetric' data-ref="getInstantaneousMetric">getInstantaneousMetric</dfn>(<em>int</em> <dfn class="local col3 decl" id="103metric" title='metric' data-type='int' data-ref="103metric">metric</dfn>) {</td></tr>
<tr><th id="897">897</th><td>    <em>int</em> <dfn class="local col4 decl" id="104j" title='j' data-type='int' data-ref="104j">j</dfn>;</td></tr>
<tr><th id="898">898</th><td>    <em>long</em> <em>long</em> <dfn class="local col5 decl" id="105sum" title='sum' data-type='long long' data-ref="105sum">sum</dfn> = <var>0</var>;</td></tr>
<tr><th id="899">899</th><td></td></tr>
<tr><th id="900">900</th><td>    <b>for</b> (<a class="local col4 ref" href="#104j" title='j' data-ref="104j">j</a> = <var>0</var>; <a class="local col4 ref" href="#104j" title='j' data-ref="104j">j</a> &lt; <a class="macro" href="redis.h.html#140" title="16" data-ref="_M/REDIS_METRIC_SAMPLES">REDIS_METRIC_SAMPLES</a>; <a class="local col4 ref" href="#104j" title='j' data-ref="104j">j</a>++)</td></tr>
<tr><th id="901">901</th><td>        <a class="local col5 ref" href="#105sum" title='sum' data-ref="105sum">sum</a> += <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col3 ref" href="#103metric" title='metric' data-ref="103metric">metric</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::samples" title='redisServer::(anonymous struct)::samples' data-ref="redisServer::(anonymous)::samples">samples</a>[<a class="local col4 ref" href="#104j" title='j' data-ref="104j">j</a>];</td></tr>
<tr><th id="902">902</th><td>    <b>return</b> <a class="local col5 ref" href="#105sum" title='sum' data-ref="105sum">sum</a> / <a class="macro" href="redis.h.html#140" title="16" data-ref="_M/REDIS_METRIC_SAMPLES">REDIS_METRIC_SAMPLES</a>;</td></tr>
<tr><th id="903">903</th><td>}</td></tr>
<tr><th id="904">904</th><td></td></tr>
<tr><th id="905">905</th><td><i>/* Check for timeouts. Returns non-zero if the client was terminated */</i></td></tr>
<tr><th id="906">906</th><td><em>int</em> <dfn class="decl def fn" id="clientsCronHandleTimeout" title='clientsCronHandleTimeout' data-ref="clientsCronHandleTimeout">clientsCronHandleTimeout</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col6 decl" id="106c" title='c' data-type='redisClient *' data-ref="106c">c</dfn>) {</td></tr>
<tr><th id="907">907</th><td>    <a class="typedef" href="../../include/time.h.html#time_t" title='time_t' data-type='__time_t' data-ref="time_t">time_t</a> <dfn class="local col7 decl" id="107now" title='now' data-type='time_t' data-ref="107now">now</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>;</td></tr>
<tr><th id="908">908</th><td></td></tr>
<tr><th id="909">909</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxidletime" title='redisServer::maxidletime' data-ref="redisServer::maxidletime">maxidletime</a> &amp;&amp;</td></tr>
<tr><th id="910">910</th><td>        !(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#232" title="(1&lt;&lt;0)" data-ref="_M/REDIS_SLAVE">REDIS_SLAVE</a>) &amp;&amp;    <i>/* no timeout for slaves */</i></td></tr>
<tr><th id="911">911</th><td>        !(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#233" title="(1&lt;&lt;1)" data-ref="_M/REDIS_MASTER">REDIS_MASTER</a>) &amp;&amp;   <i>/* no timeout for masters */</i></td></tr>
<tr><th id="912">912</th><td>        !(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#236" title="(1&lt;&lt;4)" data-ref="_M/REDIS_BLOCKED">REDIS_BLOCKED</a>) &amp;&amp;  <i>/* no timeout for BLPOP */</i></td></tr>
<tr><th id="913">913</th><td>        !(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#251" title="(1&lt;&lt;18)" data-ref="_M/REDIS_PUBSUB">REDIS_PUBSUB</a>) &amp;&amp;   <i>/* no timeout for Pub/Sub clients */</i></td></tr>
<tr><th id="914">914</th><td>        (<a class="local col7 ref" href="#107now" title='now' data-ref="107now">now</a> - <a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::lastinteraction" title='redisClient::lastinteraction' data-ref="redisClient::lastinteraction">lastinteraction</a> &gt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxidletime" title='redisServer::maxidletime' data-ref="redisServer::maxidletime">maxidletime</a>))</td></tr>
<tr><th id="915">915</th><td>    {</td></tr>
<tr><th id="916">916</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#302" title="1" data-ref="_M/REDIS_VERBOSE">REDIS_VERBOSE</a>,<q>"Closing idle client"</q>);</td></tr>
<tr><th id="917">917</th><td>        <a class="ref fn" href="redis.h.html#freeClient" title='freeClient' data-ref="freeClient">freeClient</a>(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>);</td></tr>
<tr><th id="918">918</th><td>        <b>return</b> <var>1</var>;</td></tr>
<tr><th id="919">919</th><td>    } <b>else</b> <b>if</b> (<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#236" title="(1&lt;&lt;4)" data-ref="_M/REDIS_BLOCKED">REDIS_BLOCKED</a>) {</td></tr>
<tr><th id="920">920</th><td>        <i>/* Blocked OPS timeout is handled with milliseconds resolution.</i></td></tr>
<tr><th id="921">921</th><td><i>         * However note that the actual resolution is limited by</i></td></tr>
<tr><th id="922">922</th><td><i>         * server.hz. */</i></td></tr>
<tr><th id="923">923</th><td>        <a class="typedef" href="redis.h.html#mstime_t" title='mstime_t' data-type='long long' data-ref="mstime_t">mstime_t</a> <dfn class="local col8 decl" id="108now_ms" title='now_ms' data-type='mstime_t' data-ref="108now_ms">now_ms</dfn> = <a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>();</td></tr>
<tr><th id="924">924</th><td></td></tr>
<tr><th id="925">925</th><td>        <b>if</b> (<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::bpop" title='redisClient::bpop' data-ref="redisClient::bpop">bpop</a>.<a class="ref field" href="redis.h.html#blockingState::timeout" title='blockingState::timeout' data-ref="blockingState::timeout">timeout</a> != <var>0</var> &amp;&amp; <a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::bpop" title='redisClient::bpop' data-ref="redisClient::bpop">bpop</a>.<a class="ref field" href="redis.h.html#blockingState::timeout" title='blockingState::timeout' data-ref="blockingState::timeout">timeout</a> &lt; <a class="local col8 ref" href="#108now_ms" title='now_ms' data-ref="108now_ms">now_ms</a>) {</td></tr>
<tr><th id="926">926</th><td>            <i>/* Handle blocking operation specific timeout. */</i></td></tr>
<tr><th id="927">927</th><td>            <a class="ref fn" href="redis.h.html#replyToBlockedClientTimedOut" title='replyToBlockedClientTimedOut' data-ref="replyToBlockedClientTimedOut">replyToBlockedClientTimedOut</a>(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>);</td></tr>
<tr><th id="928">928</th><td>            <a class="ref fn" href="redis.h.html#unblockClient" title='unblockClient' data-ref="unblockClient">unblockClient</a>(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>);</td></tr>
<tr><th id="929">929</th><td>        } <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) {</td></tr>
<tr><th id="930">930</th><td>            <i>/* Cluster: handle unblock &amp; redirect of clients blocked</i></td></tr>
<tr><th id="931">931</th><td><i>             * into keys no longer served by this server. */</i></td></tr>
<tr><th id="932">932</th><td>            <b>if</b> (<a class="ref fn" href="cluster.h.html#clusterRedirectBlockedClientIfNeeded" title='clusterRedirectBlockedClientIfNeeded' data-ref="clusterRedirectBlockedClientIfNeeded">clusterRedirectBlockedClientIfNeeded</a>(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>))</td></tr>
<tr><th id="933">933</th><td>                <a class="ref fn" href="redis.h.html#unblockClient" title='unblockClient' data-ref="unblockClient">unblockClient</a>(<a class="local col6 ref" href="#106c" title='c' data-ref="106c">c</a>);</td></tr>
<tr><th id="934">934</th><td>        }</td></tr>
<tr><th id="935">935</th><td>    }</td></tr>
<tr><th id="936">936</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="937">937</th><td>}</td></tr>
<tr><th id="938">938</th><td></td></tr>
<tr><th id="939">939</th><td><i>/* The client query buffer is an sds.c string that can end with a lot of</i></td></tr>
<tr><th id="940">940</th><td><i> * free space not used, this function reclaims space if needed.</i></td></tr>
<tr><th id="941">941</th><td><i> *</i></td></tr>
<tr><th id="942">942</th><td><i> * The function always returns 0 as it never terminates the client. */</i></td></tr>
<tr><th id="943">943</th><td><em>int</em> <dfn class="decl def fn" id="clientsCronResizeQueryBuffer" title='clientsCronResizeQueryBuffer' data-ref="clientsCronResizeQueryBuffer">clientsCronResizeQueryBuffer</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col9 decl" id="109c" title='c' data-type='redisClient *' data-ref="109c">c</dfn>) {</td></tr>
<tr><th id="944">944</th><td>    <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col0 decl" id="110querybuf_size" title='querybuf_size' data-type='size_t' data-ref="110querybuf_size">querybuf_size</dfn> = <a class="ref fn" href="sds.h.html#sdsAllocSize" title='sdsAllocSize' data-ref="sdsAllocSize">sdsAllocSize</a>(<a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::querybuf" title='redisClient::querybuf' data-ref="redisClient::querybuf">querybuf</a>);</td></tr>
<tr><th id="945">945</th><td>    <a class="typedef" href="../../include/time.h.html#time_t" title='time_t' data-type='__time_t' data-ref="time_t">time_t</a> <dfn class="local col1 decl" id="111idletime" title='idletime' data-type='time_t' data-ref="111idletime">idletime</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a> - <a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::lastinteraction" title='redisClient::lastinteraction' data-ref="redisClient::lastinteraction">lastinteraction</a>;</td></tr>
<tr><th id="946">946</th><td></td></tr>
<tr><th id="947">947</th><td>    <i>/* There are two conditions to resize the query buffer:</i></td></tr>
<tr><th id="948">948</th><td><i>     * 1) Query buffer is &gt; BIG_ARG and too big for latest peak.</i></td></tr>
<tr><th id="949">949</th><td><i>     * 2) Client is inactive and the buffer is bigger than 1k. */</i></td></tr>
<tr><th id="950">950</th><td>    <b>if</b> (((<a class="local col0 ref" href="#110querybuf_size" title='querybuf_size' data-ref="110querybuf_size">querybuf_size</a> &gt; <a class="macro" href="redis.h.html#151" title="(1024*32)" data-ref="_M/REDIS_MBULK_BIG_ARG">REDIS_MBULK_BIG_ARG</a>) &amp;&amp;</td></tr>
<tr><th id="951">951</th><td>         (<a class="local col0 ref" href="#110querybuf_size" title='querybuf_size' data-ref="110querybuf_size">querybuf_size</a>/(<a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::querybuf_peak" title='redisClient::querybuf_peak' data-ref="redisClient::querybuf_peak">querybuf_peak</a>+<var>1</var>)) &gt; <var>2</var>) ||</td></tr>
<tr><th id="952">952</th><td>         (<a class="local col0 ref" href="#110querybuf_size" title='querybuf_size' data-ref="110querybuf_size">querybuf_size</a> &gt; <var>1024</var> &amp;&amp; <a class="local col1 ref" href="#111idletime" title='idletime' data-ref="111idletime">idletime</a> &gt; <var>2</var>))</td></tr>
<tr><th id="953">953</th><td>    {</td></tr>
<tr><th id="954">954</th><td>        <i>/* Only resize the query buffer if it is actually wasting space. */</i></td></tr>
<tr><th id="955">955</th><td>        <b>if</b> (<a class="ref fn" href="sds.h.html#sdsavail" title='sdsavail' data-ref="sdsavail">sdsavail</a>(<a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::querybuf" title='redisClient::querybuf' data-ref="redisClient::querybuf">querybuf</a>) &gt; <var>1024</var>) {</td></tr>
<tr><th id="956">956</th><td>            <a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::querybuf" title='redisClient::querybuf' data-ref="redisClient::querybuf">querybuf</a> = <a class="ref fn" href="sds.h.html#sdsRemoveFreeSpace" title='sdsRemoveFreeSpace' data-ref="sdsRemoveFreeSpace">sdsRemoveFreeSpace</a>(<a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::querybuf" title='redisClient::querybuf' data-ref="redisClient::querybuf">querybuf</a>);</td></tr>
<tr><th id="957">957</th><td>        }</td></tr>
<tr><th id="958">958</th><td>    }</td></tr>
<tr><th id="959">959</th><td>    <i>/* Reset the peak again to capture the peak memory usage in the next</i></td></tr>
<tr><th id="960">960</th><td><i>     * cycle. */</i></td></tr>
<tr><th id="961">961</th><td>    <a class="local col9 ref" href="#109c" title='c' data-ref="109c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::querybuf_peak" title='redisClient::querybuf_peak' data-ref="redisClient::querybuf_peak">querybuf_peak</a> = <var>0</var>;</td></tr>
<tr><th id="962">962</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="963">963</th><td>}</td></tr>
<tr><th id="964">964</th><td></td></tr>
<tr><th id="965">965</th><td><em>void</em> <dfn class="decl def fn" id="clientsCron" title='clientsCron' data-ref="clientsCron">clientsCron</dfn>(<em>void</em>) {</td></tr>
<tr><th id="966">966</th><td>    <i>/* Make sure to process at least 1/(server.hz*10) of clients per call.</i></td></tr>
<tr><th id="967">967</th><td><i>     * Since this function is called server.hz times per second we are sure that</i></td></tr>
<tr><th id="968">968</th><td><i>     * in the worst case we process all the clients in 10 seconds.</i></td></tr>
<tr><th id="969">969</th><td><i>     * In normal conditions (a reasonable number of clients) we process</i></td></tr>
<tr><th id="970">970</th><td><i>     * all the clients in a shorter time. */</i></td></tr>
<tr><th id="971">971</th><td>    <em>int</em> <dfn class="local col2 decl" id="112numclients" title='numclients' data-type='int' data-ref="112numclients">numclients</dfn> = <a class="macro" href="adlist.h.html#57" title="((server.clients)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a>);</td></tr>
<tr><th id="972">972</th><td>    <em>int</em> <dfn class="local col3 decl" id="113iterations" title='iterations' data-type='int' data-ref="113iterations">iterations</dfn> = <a class="local col2 ref" href="#112numclients" title='numclients' data-ref="112numclients">numclients</a>/(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hz" title='redisServer::hz' data-ref="redisServer::hz">hz</a>*<var>10</var>);</td></tr>
<tr><th id="973">973</th><td></td></tr>
<tr><th id="974">974</th><td>    <b>if</b> (<a class="local col3 ref" href="#113iterations" title='iterations' data-ref="113iterations">iterations</a> &lt; <var>50</var>)</td></tr>
<tr><th id="975">975</th><td>        <a class="local col3 ref" href="#113iterations" title='iterations' data-ref="113iterations">iterations</a> = (<a class="local col2 ref" href="#112numclients" title='numclients' data-ref="112numclients">numclients</a> &lt; <var>50</var>) ? <a class="local col2 ref" href="#112numclients" title='numclients' data-ref="112numclients">numclients</a> : <var>50</var>;</td></tr>
<tr><th id="976">976</th><td>    <b>while</b>(<a class="macro" href="adlist.h.html#57" title="((server.clients)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a>) &amp;&amp; <a class="local col3 ref" href="#113iterations" title='iterations' data-ref="113iterations">iterations</a>--) {</td></tr>
<tr><th id="977">977</th><td>        <a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col4 decl" id="114c" title='c' data-type='redisClient *' data-ref="114c">c</dfn>;</td></tr>
<tr><th id="978">978</th><td>        <a class="typedef" href="adlist.h.html#listNode" title='listNode' data-type='struct listNode' data-ref="listNode">listNode</a> *<dfn class="local col5 decl" id="115head" title='head' data-type='listNode *' data-ref="115head">head</dfn>;</td></tr>
<tr><th id="979">979</th><td></td></tr>
<tr><th id="980">980</th><td>        <i>/* Rotate the list, take the current head, process.</i></td></tr>
<tr><th id="981">981</th><td><i>         * This way if the client must be removed from the list it's the</i></td></tr>
<tr><th id="982">982</th><td><i>         * first element and we don't incur into O(N) computation. */</i></td></tr>
<tr><th id="983">983</th><td>        <a class="ref fn" href="adlist.h.html#listRotate" title='listRotate' data-ref="listRotate">listRotate</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a>);</td></tr>
<tr><th id="984">984</th><td>        <a class="local col5 ref" href="#115head" title='head' data-ref="115head">head</a> = <a class="macro" href="adlist.h.html#58" title="((server.clients)-&gt;head)" data-ref="_M/listFirst">listFirst</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a>);</td></tr>
<tr><th id="985">985</th><td>        <a class="local col4 ref" href="#114c" title='c' data-ref="114c">c</a> = <a class="macro" href="adlist.h.html#62" title="((head)-&gt;value)" data-ref="_M/listNodeValue">listNodeValue</a>(<a class="local col5 ref" href="#115head" title='head' data-ref="115head">head</a>);</td></tr>
<tr><th id="986">986</th><td>        <i>/* The following functions do different service checks on the client.</i></td></tr>
<tr><th id="987">987</th><td><i>         * The protocol is that they return non-zero if the client was</i></td></tr>
<tr><th id="988">988</th><td><i>         * terminated. */</i></td></tr>
<tr><th id="989">989</th><td>        <b>if</b> (<a class="ref fn" href="#clientsCronHandleTimeout" title='clientsCronHandleTimeout' data-ref="clientsCronHandleTimeout">clientsCronHandleTimeout</a>(<a class="local col4 ref" href="#114c" title='c' data-ref="114c">c</a>)) <b>continue</b>;</td></tr>
<tr><th id="990">990</th><td>        <b>if</b> (<a class="ref fn" href="#clientsCronResizeQueryBuffer" title='clientsCronResizeQueryBuffer' data-ref="clientsCronResizeQueryBuffer">clientsCronResizeQueryBuffer</a>(<a class="local col4 ref" href="#114c" title='c' data-ref="114c">c</a>)) <b>continue</b>;</td></tr>
<tr><th id="991">991</th><td>    }</td></tr>
<tr><th id="992">992</th><td>}</td></tr>
<tr><th id="993">993</th><td></td></tr>
<tr><th id="994">994</th><td><i>/* This function handles 'background' operations we are required to do</i></td></tr>
<tr><th id="995">995</th><td><i> * incrementally in Redis databases, such as active key expiring, resizing,</i></td></tr>
<tr><th id="996">996</th><td><i> * rehashing. */</i></td></tr>
<tr><th id="997">997</th><td><em>void</em> <dfn class="decl def fn" id="databasesCron" title='databasesCron' data-ref="databasesCron">databasesCron</dfn>(<em>void</em>) {</td></tr>
<tr><th id="998">998</th><td>    <i>/* Expire keys by random sampling. Not required for slaves</i></td></tr>
<tr><th id="999">999</th><td><i>     * as master will synthesize DELs for us. */</i></td></tr>
<tr><th id="1000">1000</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::active_expire_enabled" title='redisServer::active_expire_enabled' data-ref="redisServer::active_expire_enabled">active_expire_enabled</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="1001">1001</th><td>        <a class="ref fn" href="#activeExpireCycle" title='activeExpireCycle' data-ref="activeExpireCycle">activeExpireCycle</a>(<a class="macro" href="redis.h.html#136" title="0" data-ref="_M/ACTIVE_EXPIRE_CYCLE_SLOW">ACTIVE_EXPIRE_CYCLE_SLOW</a>);</td></tr>
<tr><th id="1002">1002</th><td></td></tr>
<tr><th id="1003">1003</th><td>    <i>/* Perform hash tables rehashing if needed, but only if there are no</i></td></tr>
<tr><th id="1004">1004</th><td><i>     * other processes saving the DB on disk. Otherwise rehashing is bad</i></td></tr>
<tr><th id="1005">1005</th><td><i>     * as will cause a lot of copy-on-write of memory pages. */</i></td></tr>
<tr><th id="1006">1006</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> == -<var>1</var> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> == -<var>1</var>) {</td></tr>
<tr><th id="1007">1007</th><td>        <i>/* We use global counters so if we stop the computation at a given</i></td></tr>
<tr><th id="1008">1008</th><td><i>         * DB we'll be able to start from the successive in the next</i></td></tr>
<tr><th id="1009">1009</th><td><i>         * cron loop iteration. */</i></td></tr>
<tr><th id="1010">1010</th><td>        <em>static</em> <em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="116resize_db" title='resize_db' data-type='unsigned int' data-ref="116resize_db">resize_db</dfn> = <var>0</var>;</td></tr>
<tr><th id="1011">1011</th><td>        <em>static</em> <em>unsigned</em> <em>int</em> <dfn class="local col7 decl" id="117rehash_db" title='rehash_db' data-type='unsigned int' data-ref="117rehash_db">rehash_db</dfn> = <var>0</var>;</td></tr>
<tr><th id="1012">1012</th><td>        <em>int</em> <dfn class="local col8 decl" id="118dbs_per_call" title='dbs_per_call' data-type='int' data-ref="118dbs_per_call">dbs_per_call</dfn> = <a class="macro" href="redis.h.html#79" title="16" data-ref="_M/REDIS_DBCRON_DBS_PER_CALL">REDIS_DBCRON_DBS_PER_CALL</a>;</td></tr>
<tr><th id="1013">1013</th><td>        <em>int</em> <dfn class="local col9 decl" id="119j" title='j' data-type='int' data-ref="119j">j</dfn>;</td></tr>
<tr><th id="1014">1014</th><td></td></tr>
<tr><th id="1015">1015</th><td>        <i>/* Don't test more DBs than we have. */</i></td></tr>
<tr><th id="1016">1016</th><td>        <b>if</b> (<a class="local col8 ref" href="#118dbs_per_call" title='dbs_per_call' data-ref="118dbs_per_call">dbs_per_call</a> &gt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>) <a class="local col8 ref" href="#118dbs_per_call" title='dbs_per_call' data-ref="118dbs_per_call">dbs_per_call</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>;</td></tr>
<tr><th id="1017">1017</th><td></td></tr>
<tr><th id="1018">1018</th><td>        <i>/* Resize */</i></td></tr>
<tr><th id="1019">1019</th><td>        <b>for</b> (<a class="local col9 ref" href="#119j" title='j' data-ref="119j">j</a> = <var>0</var>; <a class="local col9 ref" href="#119j" title='j' data-ref="119j">j</a> &lt; <a class="local col8 ref" href="#118dbs_per_call" title='dbs_per_call' data-ref="118dbs_per_call">dbs_per_call</a>; <a class="local col9 ref" href="#119j" title='j' data-ref="119j">j</a>++) {</td></tr>
<tr><th id="1020">1020</th><td>            <a class="ref fn" href="#tryResizeHashTables" title='tryResizeHashTables' data-ref="tryResizeHashTables">tryResizeHashTables</a>(<a class="local col6 ref" href="#116resize_db" title='resize_db' data-ref="116resize_db">resize_db</a> % <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>);</td></tr>
<tr><th id="1021">1021</th><td>            <a class="local col6 ref" href="#116resize_db" title='resize_db' data-ref="116resize_db">resize_db</a>++;</td></tr>
<tr><th id="1022">1022</th><td>        }</td></tr>
<tr><th id="1023">1023</th><td></td></tr>
<tr><th id="1024">1024</th><td>        <i>/* Rehash */</i></td></tr>
<tr><th id="1025">1025</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::activerehashing" title='redisServer::activerehashing' data-ref="redisServer::activerehashing">activerehashing</a>) {</td></tr>
<tr><th id="1026">1026</th><td>            <b>for</b> (<a class="local col9 ref" href="#119j" title='j' data-ref="119j">j</a> = <var>0</var>; <a class="local col9 ref" href="#119j" title='j' data-ref="119j">j</a> &lt; <a class="local col8 ref" href="#118dbs_per_call" title='dbs_per_call' data-ref="118dbs_per_call">dbs_per_call</a>; <a class="local col9 ref" href="#119j" title='j' data-ref="119j">j</a>++) {</td></tr>
<tr><th id="1027">1027</th><td>                <em>int</em> <dfn class="local col0 decl" id="120work_done" title='work_done' data-type='int' data-ref="120work_done">work_done</dfn> = <a class="ref fn" href="#incrementallyRehash" title='incrementallyRehash' data-ref="incrementallyRehash">incrementallyRehash</a>(<a class="local col7 ref" href="#117rehash_db" title='rehash_db' data-ref="117rehash_db">rehash_db</a> % <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>);</td></tr>
<tr><th id="1028">1028</th><td>                <a class="local col7 ref" href="#117rehash_db" title='rehash_db' data-ref="117rehash_db">rehash_db</a>++;</td></tr>
<tr><th id="1029">1029</th><td>                <b>if</b> (<a class="local col0 ref" href="#120work_done" title='work_done' data-ref="120work_done">work_done</a>) {</td></tr>
<tr><th id="1030">1030</th><td>                    <i>/* If the function did some work, stop here, we'll do</i></td></tr>
<tr><th id="1031">1031</th><td><i>                     * more at the next cron loop. */</i></td></tr>
<tr><th id="1032">1032</th><td>                    <b>break</b>;</td></tr>
<tr><th id="1033">1033</th><td>                }</td></tr>
<tr><th id="1034">1034</th><td>            }</td></tr>
<tr><th id="1035">1035</th><td>        }</td></tr>
<tr><th id="1036">1036</th><td>    }</td></tr>
<tr><th id="1037">1037</th><td>}</td></tr>
<tr><th id="1038">1038</th><td></td></tr>
<tr><th id="1039">1039</th><td><i>/* We take a cached value of the unix time in the global state because with</i></td></tr>
<tr><th id="1040">1040</th><td><i> * virtual memory and aging there is to store the current time in objects at</i></td></tr>
<tr><th id="1041">1041</th><td><i> * every object access, and accuracy is not needed. To access a global var is</i></td></tr>
<tr><th id="1042">1042</th><td><i> * a lot faster than calling time(NULL) */</i></td></tr>
<tr><th id="1043">1043</th><td><em>void</em> <dfn class="decl def fn" id="updateCachedTime" title='updateCachedTime' data-ref="updateCachedTime">updateCachedTime</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1044">1044</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1045">1045</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::mstime" title='redisServer::mstime' data-ref="redisServer::mstime">mstime</a> = <a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>();</td></tr>
<tr><th id="1046">1046</th><td>}</td></tr>
<tr><th id="1047">1047</th><td></td></tr>
<tr><th id="1048">1048</th><td><i>/* This is our timer interrupt, called server.hz times per second.</i></td></tr>
<tr><th id="1049">1049</th><td><i> * Here is where we do a number of things that need to be done asynchronously.</i></td></tr>
<tr><th id="1050">1050</th><td><i> * For instance:</i></td></tr>
<tr><th id="1051">1051</th><td><i> *</i></td></tr>
<tr><th id="1052">1052</th><td><i> * - Active expired keys collection (it is also performed in a lazy way on</i></td></tr>
<tr><th id="1053">1053</th><td><i> *   lookup).</i></td></tr>
<tr><th id="1054">1054</th><td><i> * - Software watchdog.</i></td></tr>
<tr><th id="1055">1055</th><td><i> * - Update some statistic.</i></td></tr>
<tr><th id="1056">1056</th><td><i> * - Incremental rehashing of the DBs hash tables.</i></td></tr>
<tr><th id="1057">1057</th><td><i> * - Triggering BGSAVE / AOF rewrite, and handling of terminated children.</i></td></tr>
<tr><th id="1058">1058</th><td><i> * - Clients timeout of different kinds.</i></td></tr>
<tr><th id="1059">1059</th><td><i> * - Replication reconnection.</i></td></tr>
<tr><th id="1060">1060</th><td><i> * - Many more...</i></td></tr>
<tr><th id="1061">1061</th><td><i> *</i></td></tr>
<tr><th id="1062">1062</th><td><i> * Everything directly called here will be called server.hz times per second,</i></td></tr>
<tr><th id="1063">1063</th><td><i> * so in order to throttle execution of things we want to do less frequently</i></td></tr>
<tr><th id="1064">1064</th><td><i> * a macro is used: run_with_period(milliseconds) { .... }</i></td></tr>
<tr><th id="1065">1065</th><td><i> */</i></td></tr>
<tr><th id="1066">1066</th><td></td></tr>
<tr><th id="1067">1067</th><td><em>int</em> <dfn class="decl def fn" id="serverCron" title='serverCron' data-ref="serverCron">serverCron</dfn>(<b>struct</b> <a class="type" href="ae.h.html#aeEventLoop" title='aeEventLoop' data-ref="aeEventLoop">aeEventLoop</a> *<dfn class="local col1 decl" id="121eventLoop" title='eventLoop' data-type='struct aeEventLoop *' data-ref="121eventLoop">eventLoop</dfn>, <em>long</em> <em>long</em> <dfn class="local col2 decl" id="122id" title='id' data-type='long long' data-ref="122id">id</dfn>, <em>void</em> *<dfn class="local col3 decl" id="123clientData" title='clientData' data-type='void *' data-ref="123clientData">clientData</dfn>) {</td></tr>
<tr><th id="1068">1068</th><td>    <em>int</em> <dfn class="local col4 decl" id="124j" title='j' data-type='int' data-ref="124j">j</dfn>;</td></tr>
<tr><th id="1069">1069</th><td>    <a class="macro" href="redis.h.html#309" title="((void) eventLoop)" data-ref="_M/REDIS_NOTUSED">REDIS_NOTUSED</a>(<a class="local col1 ref" href="#121eventLoop" title='eventLoop' data-ref="121eventLoop">eventLoop</a>);</td></tr>
<tr><th id="1070">1070</th><td>    <a class="macro" href="redis.h.html#309" title="((void) id)" data-ref="_M/REDIS_NOTUSED">REDIS_NOTUSED</a>(<a class="local col2 ref" href="#122id" title='id' data-ref="122id">id</a>);</td></tr>
<tr><th id="1071">1071</th><td>    <a class="macro" href="redis.h.html#309" title="((void) clientData)" data-ref="_M/REDIS_NOTUSED">REDIS_NOTUSED</a>(<a class="local col3 ref" href="#123clientData" title='clientData' data-ref="123clientData">clientData</a>);</td></tr>
<tr><th id="1072">1072</th><td></td></tr>
<tr><th id="1073">1073</th><td>    <i>/* Software watchdog: deliver the SIGALRM that will reach the signal</i></td></tr>
<tr><th id="1074">1074</th><td><i>     * handler if we don't return here fast enough. */</i></td></tr>
<tr><th id="1075">1075</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::watchdog_period" title='redisServer::watchdog_period' data-ref="redisServer::watchdog_period">watchdog_period</a>) <a class="ref fn" href="redis.h.html#watchdogScheduleSignal" title='watchdogScheduleSignal' data-ref="watchdogScheduleSignal">watchdogScheduleSignal</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::watchdog_period" title='redisServer::watchdog_period' data-ref="redisServer::watchdog_period">watchdog_period</a>);</td></tr>
<tr><th id="1076">1076</th><td></td></tr>
<tr><th id="1077">1077</th><td>    <i>/* Update the time cache. */</i></td></tr>
<tr><th id="1078">1078</th><td>    <a class="ref fn" href="#updateCachedTime" title='updateCachedTime' data-ref="updateCachedTime">updateCachedTime</a>();</td></tr>
<tr><th id="1079">1079</th><td></td></tr>
<tr><th id="1080">1080</th><td>    <a class="macro" href="redis.h.html#395" title="if ((100 &lt;= 1000/server.hz) || !(server.cronloops%((100)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>100</var>) {</td></tr>
<tr><th id="1081">1081</th><td>        <a class="ref fn" href="#trackInstantaneousMetric" title='trackInstantaneousMetric' data-ref="trackInstantaneousMetric">trackInstantaneousMetric</a>(<a class="macro" href="redis.h.html#141" title="0" data-ref="_M/REDIS_METRIC_COMMAND">REDIS_METRIC_COMMAND</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_numcommands" title='redisServer::stat_numcommands' data-ref="redisServer::stat_numcommands">stat_numcommands</a>);</td></tr>
<tr><th id="1082">1082</th><td>        <a class="ref fn" href="#trackInstantaneousMetric" title='trackInstantaneousMetric' data-ref="trackInstantaneousMetric">trackInstantaneousMetric</a>(<a class="macro" href="redis.h.html#142" title="1" data-ref="_M/REDIS_METRIC_NET_INPUT">REDIS_METRIC_NET_INPUT</a>,</td></tr>
<tr><th id="1083">1083</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_net_input_bytes" title='redisServer::stat_net_input_bytes' data-ref="redisServer::stat_net_input_bytes">stat_net_input_bytes</a>);</td></tr>
<tr><th id="1084">1084</th><td>        <a class="ref fn" href="#trackInstantaneousMetric" title='trackInstantaneousMetric' data-ref="trackInstantaneousMetric">trackInstantaneousMetric</a>(<a class="macro" href="redis.h.html#143" title="2" data-ref="_M/REDIS_METRIC_NET_OUTPUT">REDIS_METRIC_NET_OUTPUT</a>,</td></tr>
<tr><th id="1085">1085</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_net_output_bytes" title='redisServer::stat_net_output_bytes' data-ref="redisServer::stat_net_output_bytes">stat_net_output_bytes</a>);</td></tr>
<tr><th id="1086">1086</th><td>    }</td></tr>
<tr><th id="1087">1087</th><td></td></tr>
<tr><th id="1088">1088</th><td>    <i>/* We have just REDIS_LRU_BITS bits per object for LRU information.</i></td></tr>
<tr><th id="1089">1089</th><td><i>     * So we use an (eventually wrapping) LRU clock.</i></td></tr>
<tr><th id="1090">1090</th><td><i>     *</i></td></tr>
<tr><th id="1091">1091</th><td><i>     * Note that even if the counter wraps it's not a big problem,</i></td></tr>
<tr><th id="1092">1092</th><td><i>     * everything will still work but some object will appear younger</i></td></tr>
<tr><th id="1093">1093</th><td><i>     * to Redis. However for this to happen a given object should never be</i></td></tr>
<tr><th id="1094">1094</th><td><i>     * touched for all the time needed to the counter to wrap, which is</i></td></tr>
<tr><th id="1095">1095</th><td><i>     * not likely.</i></td></tr>
<tr><th id="1096">1096</th><td><i>     *</i></td></tr>
<tr><th id="1097">1097</th><td><i>     * Note that you can change the resolution altering the</i></td></tr>
<tr><th id="1098">1098</th><td><i>     * REDIS_LRU_CLOCK_RESOLUTION define. */</i></td></tr>
<tr><th id="1099">1099</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lruclock" title='redisServer::lruclock' data-ref="redisServer::lruclock">lruclock</a> = <a class="ref fn" href="#getLRUClock" title='getLRUClock' data-ref="getLRUClock">getLRUClock</a>();</td></tr>
<tr><th id="1100">1100</th><td></td></tr>
<tr><th id="1101">1101</th><td>    <i>/* Record the max memory used since the server was started. */</i></td></tr>
<tr><th id="1102">1102</th><td>    <b>if</b> (<a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>() &gt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a>)</td></tr>
<tr><th id="1103">1103</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a> = <a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>();</td></tr>
<tr><th id="1104">1104</th><td></td></tr>
<tr><th id="1105">1105</th><td>    <i>/* Sample the RSS here since this is a relatively slow call. */</i></td></tr>
<tr><th id="1106">1106</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::resident_set_size" title='redisServer::resident_set_size' data-ref="redisServer::resident_set_size">resident_set_size</a> = <a class="ref fn" href="zmalloc.h.html#zmalloc_get_rss" title='zmalloc_get_rss' data-ref="zmalloc_get_rss">zmalloc_get_rss</a>();</td></tr>
<tr><th id="1107">1107</th><td></td></tr>
<tr><th id="1108">1108</th><td>    <i>/* We received a SIGTERM, shutting down here in a safe way, as it is</i></td></tr>
<tr><th id="1109">1109</th><td><i>     * not ok doing so inside the signal handler. */</i></td></tr>
<tr><th id="1110">1110</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::shutdown_asap" title='redisServer::shutdown_asap' data-ref="redisServer::shutdown_asap">shutdown_asap</a>) {</td></tr>
<tr><th id="1111">1111</th><td>        <b>if</b> (<a class="ref fn" href="#prepareForShutdown" title='prepareForShutdown' data-ref="prepareForShutdown">prepareForShutdown</a>(<var>0</var>) == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>) <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>0</var>);</td></tr>
<tr><th id="1112">1112</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"SIGTERM received but errors trying to shut down the server, check the logs for more information"</q>);</td></tr>
<tr><th id="1113">1113</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::shutdown_asap" title='redisServer::shutdown_asap' data-ref="redisServer::shutdown_asap">shutdown_asap</a> = <var>0</var>;</td></tr>
<tr><th id="1114">1114</th><td>    }</td></tr>
<tr><th id="1115">1115</th><td></td></tr>
<tr><th id="1116">1116</th><td>    <i>/* Show some info about non-empty databases */</i></td></tr>
<tr><th id="1117">1117</th><td>    <a class="macro" href="redis.h.html#395" title="if ((5000 &lt;= 1000/server.hz) || !(server.cronloops%((5000)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>5000</var>) {</td></tr>
<tr><th id="1118">1118</th><td>        <b>for</b> (<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a> = <var>0</var>; <a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>; <a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>++) {</td></tr>
<tr><th id="1119">1119</th><td>            <em>long</em> <em>long</em> <dfn class="local col5 decl" id="125size" title='size' data-type='long long' data-ref="125size">size</dfn>, <dfn class="local col6 decl" id="126used" title='used' data-type='long long' data-ref="126used">used</dfn>, <dfn class="local col7 decl" id="127vkeys" title='vkeys' data-type='long long' data-ref="127vkeys">vkeys</dfn>;</td></tr>
<tr><th id="1120">1120</th><td></td></tr>
<tr><th id="1121">1121</th><td>            <a class="local col5 ref" href="#125size" title='size' data-ref="125size">size</a> = <a class="macro" href="dict.h.html#145" title="((server.db[j].dict)-&gt;ht[0].size+(server.db[j].dict)-&gt;ht[1].size)" data-ref="_M/dictSlots">dictSlots</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>);</td></tr>
<tr><th id="1122">1122</th><td>            <a class="local col6 ref" href="#126used" title='used' data-ref="126used">used</a> = <a class="macro" href="dict.h.html#146" title="((server.db[j].dict)-&gt;ht[0].used+(server.db[j].dict)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>);</td></tr>
<tr><th id="1123">1123</th><td>            <a class="local col7 ref" href="#127vkeys" title='vkeys' data-ref="127vkeys">vkeys</a> = <a class="macro" href="dict.h.html#146" title="((server.db[j].expires)-&gt;ht[0].used+(server.db[j].expires)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>);</td></tr>
<tr><th id="1124">1124</th><td>            <b>if</b> (<a class="local col6 ref" href="#126used" title='used' data-ref="126used">used</a> || <a class="local col7 ref" href="#127vkeys" title='vkeys' data-ref="127vkeys">vkeys</a>) {</td></tr>
<tr><th id="1125">1125</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#302" title="1" data-ref="_M/REDIS_VERBOSE">REDIS_VERBOSE</a>,<q>"DB %d: %lld keys (%lld volatile) in %lld slots HT."</q>,<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>,<a class="local col6 ref" href="#126used" title='used' data-ref="126used">used</a>,<a class="local col7 ref" href="#127vkeys" title='vkeys' data-ref="127vkeys">vkeys</a>,<a class="local col5 ref" href="#125size" title='size' data-ref="125size">size</a>);</td></tr>
<tr><th id="1126">1126</th><td>                <i>/* dictPrintStats(server.dict); */</i></td></tr>
<tr><th id="1127">1127</th><td>            }</td></tr>
<tr><th id="1128">1128</th><td>        }</td></tr>
<tr><th id="1129">1129</th><td>    }</td></tr>
<tr><th id="1130">1130</th><td></td></tr>
<tr><th id="1131">1131</th><td>    <i>/* Show information about connected clients */</i></td></tr>
<tr><th id="1132">1132</th><td>    <b>if</b> (!<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) {</td></tr>
<tr><th id="1133">1133</th><td>        <a class="macro" href="redis.h.html#395" title="if ((5000 &lt;= 1000/server.hz) || !(server.cronloops%((5000)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>5000</var>) {</td></tr>
<tr><th id="1134">1134</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#302" title="1" data-ref="_M/REDIS_VERBOSE">REDIS_VERBOSE</a>,</td></tr>
<tr><th id="1135">1135</th><td>                <q>"%lu clients connected (%lu slaves), %zu bytes in use"</q>,</td></tr>
<tr><th id="1136">1136</th><td>                <a class="macro" href="adlist.h.html#57" title="((server.clients)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a>)-<a class="macro" href="adlist.h.html#57" title="((server.slaves)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>),</td></tr>
<tr><th id="1137">1137</th><td>                <a class="macro" href="adlist.h.html#57" title="((server.slaves)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>),</td></tr>
<tr><th id="1138">1138</th><td>                <a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>());</td></tr>
<tr><th id="1139">1139</th><td>        }</td></tr>
<tr><th id="1140">1140</th><td>    }</td></tr>
<tr><th id="1141">1141</th><td></td></tr>
<tr><th id="1142">1142</th><td>    <i>/* We need to do a few operations on clients asynchronously. */</i></td></tr>
<tr><th id="1143">1143</th><td>    <a class="ref fn" href="#clientsCron" title='clientsCron' data-ref="clientsCron">clientsCron</a>();</td></tr>
<tr><th id="1144">1144</th><td></td></tr>
<tr><th id="1145">1145</th><td>    <i>/* Handle background operations on Redis databases. */</i></td></tr>
<tr><th id="1146">1146</th><td>    <a class="ref fn" href="#databasesCron" title='databasesCron' data-ref="databasesCron">databasesCron</a>();</td></tr>
<tr><th id="1147">1147</th><td></td></tr>
<tr><th id="1148">1148</th><td>    <i>/* Start a scheduled AOF rewrite if this was requested by the user while</i></td></tr>
<tr><th id="1149">1149</th><td><i>     * a BGSAVE was in progress. */</i></td></tr>
<tr><th id="1150">1150</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> == -<var>1</var> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> == -<var>1</var> &amp;&amp;</td></tr>
<tr><th id="1151">1151</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_scheduled" title='redisServer::aof_rewrite_scheduled' data-ref="redisServer::aof_rewrite_scheduled">aof_rewrite_scheduled</a>)</td></tr>
<tr><th id="1152">1152</th><td>    {</td></tr>
<tr><th id="1153">1153</th><td>        <a class="ref fn" href="redis.h.html#rewriteAppendOnlyFileBackground" title='rewriteAppendOnlyFileBackground' data-ref="rewriteAppendOnlyFileBackground">rewriteAppendOnlyFileBackground</a>();</td></tr>
<tr><th id="1154">1154</th><td>    }</td></tr>
<tr><th id="1155">1155</th><td></td></tr>
<tr><th id="1156">1156</th><td>    <i>/* Check if a background saving or AOF rewrite in progress terminated. */</i></td></tr>
<tr><th id="1157">1157</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> != -<var>1</var> || <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> != -<var>1</var>) {</td></tr>
<tr><th id="1158">1158</th><td>        <em>int</em> <dfn class="local col8 decl" id="128statloc" title='statloc' data-type='int' data-ref="128statloc">statloc</dfn>;</td></tr>
<tr><th id="1159">1159</th><td>        <a class="typedef" href="../../include/x86_64-linux-gnu/sys/types.h.html#pid_t" title='pid_t' data-type='__pid_t' data-ref="pid_t">pid_t</a> <dfn class="local col9 decl" id="129pid" title='pid' data-type='pid_t' data-ref="129pid">pid</dfn>;</td></tr>
<tr><th id="1160">1160</th><td></td></tr>
<tr><th id="1161">1161</th><td>        <b>if</b> ((<a class="local col9 ref" href="#129pid" title='pid' data-ref="129pid">pid</a> = <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/wait.h.html#wait3" title='wait3' data-ref="wait3">wait3</a>(&amp;<a class="local col8 ref" href="#128statloc" title='statloc' data-ref="128statloc">statloc</a>,<a class="macro" href="../../include/x86_64-linux-gnu/bits/waitflags.h.html#25" title="1" data-ref="_M/WNOHANG">WNOHANG</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) != <var>0</var>) {</td></tr>
<tr><th id="1162">1162</th><td>            <em>int</em> <dfn class="local col0 decl" id="130exitcode" title='exitcode' data-type='int' data-ref="130exitcode">exitcode</dfn> = <a class="macro" href="../../include/stdlib.h.html#84" title="((((__extension__ (((union { __typeof(statloc) __in; int __i; }) { .__in = (statloc) }).__i))) &amp; 0xff00) &gt;&gt; 8)" data-ref="_M/WEXITSTATUS">WEXITSTATUS</a>(<a class="local col8 ref" href="#128statloc" title='statloc' data-ref="128statloc">statloc</a>);</td></tr>
<tr><th id="1163">1163</th><td>            <em>int</em> <dfn class="local col1 decl" id="131bysignal" title='bysignal' data-type='int' data-ref="131bysignal">bysignal</dfn> = <var>0</var>;</td></tr>
<tr><th id="1164">1164</th><td></td></tr>
<tr><th id="1165">1165</th><td>            <b>if</b> (<a class="macro" href="../../include/stdlib.h.html#88" title="(((signed char) ((((__extension__ (((union { __typeof(statloc) __in; int __i; }) { .__in = (statloc) }).__i))) &amp; 0x7f) + 1) &gt;&gt; 1) &gt; 0)" data-ref="_M/WIFSIGNALED">WIFSIGNALED</a>(<a class="local col8 ref" href="#128statloc" title='statloc' data-ref="128statloc">statloc</a>)) <a class="local col1 ref" href="#131bysignal" title='bysignal' data-ref="131bysignal">bysignal</a> = <a class="macro" href="../../include/stdlib.h.html#85" title="(((__extension__ (((union { __typeof(statloc) __in; int __i; }) { .__in = (statloc) }).__i))) &amp; 0x7f)" data-ref="_M/WTERMSIG">WTERMSIG</a>(<a class="local col8 ref" href="#128statloc" title='statloc' data-ref="128statloc">statloc</a>);</td></tr>
<tr><th id="1166">1166</th><td></td></tr>
<tr><th id="1167">1167</th><td>            <b>if</b> (<a class="local col9 ref" href="#129pid" title='pid' data-ref="129pid">pid</a> == <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a>) {</td></tr>
<tr><th id="1168">1168</th><td>                <a class="ref fn" href="rdb.h.html#backgroundSaveDoneHandler" title='backgroundSaveDoneHandler' data-ref="backgroundSaveDoneHandler">backgroundSaveDoneHandler</a>(<a class="local col0 ref" href="#130exitcode" title='exitcode' data-ref="130exitcode">exitcode</a>,<a class="local col1 ref" href="#131bysignal" title='bysignal' data-ref="131bysignal">bysignal</a>);</td></tr>
<tr><th id="1169">1169</th><td>            } <b>else</b> <b>if</b> (<a class="local col9 ref" href="#129pid" title='pid' data-ref="129pid">pid</a> == <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a>) {</td></tr>
<tr><th id="1170">1170</th><td>                <a class="ref fn" href="redis.h.html#backgroundRewriteDoneHandler" title='backgroundRewriteDoneHandler' data-ref="backgroundRewriteDoneHandler">backgroundRewriteDoneHandler</a>(<a class="local col0 ref" href="#130exitcode" title='exitcode' data-ref="130exitcode">exitcode</a>,<a class="local col1 ref" href="#131bysignal" title='bysignal' data-ref="131bysignal">bysignal</a>);</td></tr>
<tr><th id="1171">1171</th><td>            } <b>else</b> {</td></tr>
<tr><th id="1172">1172</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,</td></tr>
<tr><th id="1173">1173</th><td>                    <q>"Warning, detected child with unmatched pid: %ld"</q>,</td></tr>
<tr><th id="1174">1174</th><td>                    (<em>long</em>)<a class="local col9 ref" href="#129pid" title='pid' data-ref="129pid">pid</a>);</td></tr>
<tr><th id="1175">1175</th><td>            }</td></tr>
<tr><th id="1176">1176</th><td>            <a class="ref fn" href="#updateDictResizePolicy" title='updateDictResizePolicy' data-ref="updateDictResizePolicy">updateDictResizePolicy</a>();</td></tr>
<tr><th id="1177">1177</th><td>        }</td></tr>
<tr><th id="1178">1178</th><td>    } <b>else</b> {</td></tr>
<tr><th id="1179">1179</th><td>        <i>/* If there is not a background saving/rewrite in progress check if</i></td></tr>
<tr><th id="1180">1180</th><td><i>         * we have to save/rewrite now */</i></td></tr>
<tr><th id="1181">1181</th><td>         <b>for</b> (<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a> = <var>0</var>; <a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::saveparamslen" title='redisServer::saveparamslen' data-ref="redisServer::saveparamslen">saveparamslen</a>; <a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>++) {</td></tr>
<tr><th id="1182">1182</th><td>            <b>struct</b> <a class="type" href="redis.h.html#saveparam" title='saveparam' data-ref="saveparam">saveparam</a> *<dfn class="local col2 decl" id="132sp" title='sp' data-type='struct saveparam *' data-ref="132sp">sp</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::saveparams" title='redisServer::saveparams' data-ref="redisServer::saveparams">saveparams</a>+<a class="local col4 ref" href="#124j" title='j' data-ref="124j">j</a>;</td></tr>
<tr><th id="1183">1183</th><td></td></tr>
<tr><th id="1184">1184</th><td>            <i>/* Save if we reached the given amount of changes,</i></td></tr>
<tr><th id="1185">1185</th><td><i>             * the given amount of seconds, and if the latest bgsave was</i></td></tr>
<tr><th id="1186">1186</th><td><i>             * successful or if, in case of an error, at least</i></td></tr>
<tr><th id="1187">1187</th><td><i>             * REDIS_BGSAVE_RETRY_DELAY seconds already elapsed. */</i></td></tr>
<tr><th id="1188">1188</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dirty" title='redisServer::dirty' data-ref="redisServer::dirty">dirty</a> &gt;= <a class="local col2 ref" href="#132sp" title='sp' data-ref="132sp">sp</a>-&gt;<a class="ref field" href="redis.h.html#saveparam::changes" title='saveparam::changes' data-ref="saveparam::changes">changes</a> &amp;&amp;</td></tr>
<tr><th id="1189">1189</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastsave" title='redisServer::lastsave' data-ref="redisServer::lastsave">lastsave</a> &gt; <a class="local col2 ref" href="#132sp" title='sp' data-ref="132sp">sp</a>-&gt;<a class="ref field" href="redis.h.html#saveparam::seconds" title='saveparam::seconds' data-ref="saveparam::seconds">seconds</a> &amp;&amp;</td></tr>
<tr><th id="1190">1190</th><td>                (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastbgsave_try" title='redisServer::lastbgsave_try' data-ref="redisServer::lastbgsave_try">lastbgsave_try</a> &gt;</td></tr>
<tr><th id="1191">1191</th><td>                 <a class="macro" href="redis.h.html#100" title="5" data-ref="_M/REDIS_BGSAVE_RETRY_DELAY">REDIS_BGSAVE_RETRY_DELAY</a> ||</td></tr>
<tr><th id="1192">1192</th><td>                 <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastbgsave_status" title='redisServer::lastbgsave_status' data-ref="redisServer::lastbgsave_status">lastbgsave_status</a> == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>))</td></tr>
<tr><th id="1193">1193</th><td>            {</td></tr>
<tr><th id="1194">1194</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"%d changes in %d seconds. Saving..."</q>,</td></tr>
<tr><th id="1195">1195</th><td>                    <a class="local col2 ref" href="#132sp" title='sp' data-ref="132sp">sp</a>-&gt;<a class="ref field" href="redis.h.html#saveparam::changes" title='saveparam::changes' data-ref="saveparam::changes">changes</a>, (<em>int</em>)<a class="local col2 ref" href="#132sp" title='sp' data-ref="132sp">sp</a>-&gt;<a class="ref field" href="redis.h.html#saveparam::seconds" title='saveparam::seconds' data-ref="saveparam::seconds">seconds</a>);</td></tr>
<tr><th id="1196">1196</th><td>                <a class="ref fn" href="rdb.h.html#rdbSaveBackground" title='rdbSaveBackground' data-ref="rdbSaveBackground">rdbSaveBackground</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_filename" title='redisServer::rdb_filename' data-ref="redisServer::rdb_filename">rdb_filename</a>);</td></tr>
<tr><th id="1197">1197</th><td>                <b>break</b>;</td></tr>
<tr><th id="1198">1198</th><td>            }</td></tr>
<tr><th id="1199">1199</th><td>         }</td></tr>
<tr><th id="1200">1200</th><td></td></tr>
<tr><th id="1201">1201</th><td>         <i>/* Trigger an AOF rewrite if needed */</i></td></tr>
<tr><th id="1202">1202</th><td>         <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> == -<var>1</var> &amp;&amp;</td></tr>
<tr><th id="1203">1203</th><td>             <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> == -<var>1</var> &amp;&amp;</td></tr>
<tr><th id="1204">1204</th><td>             <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_perc" title='redisServer::aof_rewrite_perc' data-ref="redisServer::aof_rewrite_perc">aof_rewrite_perc</a> &amp;&amp;</td></tr>
<tr><th id="1205">1205</th><td>             <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_current_size" title='redisServer::aof_current_size' data-ref="redisServer::aof_current_size">aof_current_size</a> &gt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_min_size" title='redisServer::aof_rewrite_min_size' data-ref="redisServer::aof_rewrite_min_size">aof_rewrite_min_size</a>)</td></tr>
<tr><th id="1206">1206</th><td>         {</td></tr>
<tr><th id="1207">1207</th><td>            <em>long</em> <em>long</em> <dfn class="local col3 decl" id="133base" title='base' data-type='long long' data-ref="133base">base</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_base_size" title='redisServer::aof_rewrite_base_size' data-ref="redisServer::aof_rewrite_base_size">aof_rewrite_base_size</a> ?</td></tr>
<tr><th id="1208">1208</th><td>                            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_base_size" title='redisServer::aof_rewrite_base_size' data-ref="redisServer::aof_rewrite_base_size">aof_rewrite_base_size</a> : <var>1</var>;</td></tr>
<tr><th id="1209">1209</th><td>            <em>long</em> <em>long</em> <dfn class="local col4 decl" id="134growth" title='growth' data-type='long long' data-ref="134growth">growth</dfn> = (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_current_size" title='redisServer::aof_current_size' data-ref="redisServer::aof_current_size">aof_current_size</a>*<var>100</var>/<a class="local col3 ref" href="#133base" title='base' data-ref="133base">base</a>) - <var>100</var>;</td></tr>
<tr><th id="1210">1210</th><td>            <b>if</b> (<a class="local col4 ref" href="#134growth" title='growth' data-ref="134growth">growth</a> &gt;= <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_perc" title='redisServer::aof_rewrite_perc' data-ref="redisServer::aof_rewrite_perc">aof_rewrite_perc</a>) {</td></tr>
<tr><th id="1211">1211</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"Starting automatic rewriting of AOF on %lld%% growth"</q>,<a class="local col4 ref" href="#134growth" title='growth' data-ref="134growth">growth</a>);</td></tr>
<tr><th id="1212">1212</th><td>                <a class="ref fn" href="redis.h.html#rewriteAppendOnlyFileBackground" title='rewriteAppendOnlyFileBackground' data-ref="rewriteAppendOnlyFileBackground">rewriteAppendOnlyFileBackground</a>();</td></tr>
<tr><th id="1213">1213</th><td>            }</td></tr>
<tr><th id="1214">1214</th><td>         }</td></tr>
<tr><th id="1215">1215</th><td>    }</td></tr>
<tr><th id="1216">1216</th><td></td></tr>
<tr><th id="1217">1217</th><td></td></tr>
<tr><th id="1218">1218</th><td>    <i>/* AOF postponed flush: Try at every cron cycle if the slow fsync</i></td></tr>
<tr><th id="1219">1219</th><td><i>     * completed. */</i></td></tr>
<tr><th id="1220">1220</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_flush_postponed_start" title='redisServer::aof_flush_postponed_start' data-ref="redisServer::aof_flush_postponed_start">aof_flush_postponed_start</a>) <a class="ref fn" href="redis.h.html#flushAppendOnlyFile" title='flushAppendOnlyFile' data-ref="flushAppendOnlyFile">flushAppendOnlyFile</a>(<var>0</var>);</td></tr>
<tr><th id="1221">1221</th><td></td></tr>
<tr><th id="1222">1222</th><td>    <i>/* AOF write errors: in this case we have a buffer to flush as well and</i></td></tr>
<tr><th id="1223">1223</th><td><i>     * clear the AOF error in case of success to make the DB writable again,</i></td></tr>
<tr><th id="1224">1224</th><td><i>     * however to try every second is enough in case of 'hz' is set to</i></td></tr>
<tr><th id="1225">1225</th><td><i>     * an higher frequency. */</i></td></tr>
<tr><th id="1226">1226</th><td>    <a class="macro" href="redis.h.html#395" title="if ((1000 &lt;= 1000/server.hz) || !(server.cronloops%((1000)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>1000</var>) {</td></tr>
<tr><th id="1227">1227</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_status" title='redisServer::aof_last_write_status' data-ref="redisServer::aof_last_write_status">aof_last_write_status</a> == <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>)</td></tr>
<tr><th id="1228">1228</th><td>            <a class="ref fn" href="redis.h.html#flushAppendOnlyFile" title='flushAppendOnlyFile' data-ref="flushAppendOnlyFile">flushAppendOnlyFile</a>(<var>0</var>);</td></tr>
<tr><th id="1229">1229</th><td>    }</td></tr>
<tr><th id="1230">1230</th><td></td></tr>
<tr><th id="1231">1231</th><td>    <i>/* Close clients that need to be closed asynchronous */</i></td></tr>
<tr><th id="1232">1232</th><td>    <a class="ref fn" href="redis.h.html#freeClientsInAsyncFreeQueue" title='freeClientsInAsyncFreeQueue' data-ref="freeClientsInAsyncFreeQueue">freeClientsInAsyncFreeQueue</a>();</td></tr>
<tr><th id="1233">1233</th><td></td></tr>
<tr><th id="1234">1234</th><td>    <i>/* Clear the paused clients flag if needed. */</i></td></tr>
<tr><th id="1235">1235</th><td>    <a class="ref fn" href="redis.h.html#clientsArePaused" title='clientsArePaused' data-ref="clientsArePaused">clientsArePaused</a>(); <i>/* Don't check return value, just use the side effect. */</i></td></tr>
<tr><th id="1236">1236</th><td></td></tr>
<tr><th id="1237">1237</th><td>    <i>/* Replication cron function -- used to reconnect to master and</i></td></tr>
<tr><th id="1238">1238</th><td><i>     * to detect transfer failures. */</i></td></tr>
<tr><th id="1239">1239</th><td>    <a class="macro" href="redis.h.html#395" title="if ((1000 &lt;= 1000/server.hz) || !(server.cronloops%((1000)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>1000</var>) <a class="ref fn" href="redis.h.html#replicationCron" title='replicationCron' data-ref="replicationCron">replicationCron</a>();</td></tr>
<tr><th id="1240">1240</th><td></td></tr>
<tr><th id="1241">1241</th><td>    <i>/* Run the Redis Cluster cron. */</i></td></tr>
<tr><th id="1242">1242</th><td>    <a class="macro" href="redis.h.html#395" title="if ((100 &lt;= 1000/server.hz) || !(server.cronloops%((100)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>100</var>) {</td></tr>
<tr><th id="1243">1243</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) <a class="ref fn" href="redis.h.html#clusterCron" title='clusterCron' data-ref="clusterCron">clusterCron</a>();</td></tr>
<tr><th id="1244">1244</th><td>    }</td></tr>
<tr><th id="1245">1245</th><td></td></tr>
<tr><th id="1246">1246</th><td>    <i>/* Run the Sentinel timer if we are in sentinel mode. */</i></td></tr>
<tr><th id="1247">1247</th><td>    <a class="macro" href="redis.h.html#395" title="if ((100 &lt;= 1000/server.hz) || !(server.cronloops%((100)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>100</var>) {</td></tr>
<tr><th id="1248">1248</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) <a class="ref fn" href="redis.h.html#sentinelTimer" title='sentinelTimer' data-ref="sentinelTimer">sentinelTimer</a>();</td></tr>
<tr><th id="1249">1249</th><td>    }</td></tr>
<tr><th id="1250">1250</th><td></td></tr>
<tr><th id="1251">1251</th><td>    <i>/* Cleanup expired MIGRATE cached sockets. */</i></td></tr>
<tr><th id="1252">1252</th><td>    <a class="macro" href="redis.h.html#395" title="if ((1000 &lt;= 1000/server.hz) || !(server.cronloops%((1000)/(1000/server.hz))))" data-ref="_M/run_with_period">run_with_period</a>(<var>1000</var>) {</td></tr>
<tr><th id="1253">1253</th><td>        <a class="ref fn" href="redis.h.html#migrateCloseTimedoutSockets" title='migrateCloseTimedoutSockets' data-ref="migrateCloseTimedoutSockets">migrateCloseTimedoutSockets</a>();</td></tr>
<tr><th id="1254">1254</th><td>    }</td></tr>
<tr><th id="1255">1255</th><td></td></tr>
<tr><th id="1256">1256</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cronloops" title='redisServer::cronloops' data-ref="redisServer::cronloops">cronloops</a>++;</td></tr>
<tr><th id="1257">1257</th><td>    <b>return</b> <var>1000</var>/<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hz" title='redisServer::hz' data-ref="redisServer::hz">hz</a>;</td></tr>
<tr><th id="1258">1258</th><td>}</td></tr>
<tr><th id="1259">1259</th><td></td></tr>
<tr><th id="1260">1260</th><td><i>/* This function gets called every time Redis is entering the</i></td></tr>
<tr><th id="1261">1261</th><td><i> * main loop of the event driven library, that is, before to sleep</i></td></tr>
<tr><th id="1262">1262</th><td><i> * for ready file descriptors. */</i></td></tr>
<tr><th id="1263">1263</th><td><em>void</em> <dfn class="decl def fn" id="beforeSleep" title='beforeSleep' data-ref="beforeSleep">beforeSleep</dfn>(<b>struct</b> <a class="type" href="ae.h.html#aeEventLoop" title='aeEventLoop' data-ref="aeEventLoop">aeEventLoop</a> *<dfn class="local col5 decl" id="135eventLoop" title='eventLoop' data-type='struct aeEventLoop *' data-ref="135eventLoop">eventLoop</dfn>) {</td></tr>
<tr><th id="1264">1264</th><td>    <a class="macro" href="redis.h.html#309" title="((void) eventLoop)" data-ref="_M/REDIS_NOTUSED">REDIS_NOTUSED</a>(<a class="local col5 ref" href="#135eventLoop" title='eventLoop' data-ref="135eventLoop">eventLoop</a>);</td></tr>
<tr><th id="1265">1265</th><td></td></tr>
<tr><th id="1266">1266</th><td>    <i>/* Call the Redis Cluster before sleep function. Note that this function</i></td></tr>
<tr><th id="1267">1267</th><td><i>     * may change the state of Redis Cluster (from ok to fail or vice versa),</i></td></tr>
<tr><th id="1268">1268</th><td><i>     * so it's a good idea to call it before serving the unblocked clients</i></td></tr>
<tr><th id="1269">1269</th><td><i>     * later in this function. */</i></td></tr>
<tr><th id="1270">1270</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) <a class="ref fn" href="redis.h.html#clusterBeforeSleep" title='clusterBeforeSleep' data-ref="clusterBeforeSleep">clusterBeforeSleep</a>();</td></tr>
<tr><th id="1271">1271</th><td></td></tr>
<tr><th id="1272">1272</th><td>    <i>/* Run a fast expire cycle (the called function will return</i></td></tr>
<tr><th id="1273">1273</th><td><i>     * ASAP if a fast cycle is not needed). */</i></td></tr>
<tr><th id="1274">1274</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::active_expire_enabled" title='redisServer::active_expire_enabled' data-ref="redisServer::active_expire_enabled">active_expire_enabled</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="1275">1275</th><td>        <a class="ref fn" href="#activeExpireCycle" title='activeExpireCycle' data-ref="activeExpireCycle">activeExpireCycle</a>(<a class="macro" href="redis.h.html#137" title="1" data-ref="_M/ACTIVE_EXPIRE_CYCLE_FAST">ACTIVE_EXPIRE_CYCLE_FAST</a>);</td></tr>
<tr><th id="1276">1276</th><td></td></tr>
<tr><th id="1277">1277</th><td>    <i>/* Send all the slaves an ACK request if at least one client blocked</i></td></tr>
<tr><th id="1278">1278</th><td><i>     * during the previous event loop iteration. */</i></td></tr>
<tr><th id="1279">1279</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::get_ack_from_slaves" title='redisServer::get_ack_from_slaves' data-ref="redisServer::get_ack_from_slaves">get_ack_from_slaves</a>) {</td></tr>
<tr><th id="1280">1280</th><td>        <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col6 decl" id="136argv" title='argv' data-type='robj *[3]' data-ref="136argv">argv</dfn>[<var>3</var>];</td></tr>
<tr><th id="1281">1281</th><td></td></tr>
<tr><th id="1282">1282</th><td>        <a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>[<var>0</var>] = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"REPLCONF"</q>,<var>8</var>);</td></tr>
<tr><th id="1283">1283</th><td>        <a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>[<var>1</var>] = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"GETACK"</q>,<var>6</var>);</td></tr>
<tr><th id="1284">1284</th><td>        <a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>[<var>2</var>] = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"*"</q>,<var>1</var>); <i>/* Not used argument. */</i></td></tr>
<tr><th id="1285">1285</th><td>        <a class="ref fn" href="redis.h.html#replicationFeedSlaves" title='replicationFeedSlaves' data-ref="replicationFeedSlaves">replicationFeedSlaves</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaveseldb" title='redisServer::slaveseldb' data-ref="redisServer::slaveseldb">slaveseldb</a>, <a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>, <var>3</var>);</td></tr>
<tr><th id="1286">1286</th><td>        <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>[<var>0</var>]);</td></tr>
<tr><th id="1287">1287</th><td>        <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>[<var>1</var>]);</td></tr>
<tr><th id="1288">1288</th><td>        <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col6 ref" href="#136argv" title='argv' data-ref="136argv">argv</a>[<var>2</var>]);</td></tr>
<tr><th id="1289">1289</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::get_ack_from_slaves" title='redisServer::get_ack_from_slaves' data-ref="redisServer::get_ack_from_slaves">get_ack_from_slaves</a> = <var>0</var>;</td></tr>
<tr><th id="1290">1290</th><td>    }</td></tr>
<tr><th id="1291">1291</th><td></td></tr>
<tr><th id="1292">1292</th><td>    <i>/* Unblock all the clients blocked for synchronous replication</i></td></tr>
<tr><th id="1293">1293</th><td><i>     * in WAIT. */</i></td></tr>
<tr><th id="1294">1294</th><td>    <b>if</b> (<a class="macro" href="adlist.h.html#57" title="((server.clients_waiting_acks)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients_waiting_acks" title='redisServer::clients_waiting_acks' data-ref="redisServer::clients_waiting_acks">clients_waiting_acks</a>))</td></tr>
<tr><th id="1295">1295</th><td>        <a class="ref fn" href="redis.h.html#processClientsWaitingReplicas" title='processClientsWaitingReplicas' data-ref="processClientsWaitingReplicas">processClientsWaitingReplicas</a>();</td></tr>
<tr><th id="1296">1296</th><td></td></tr>
<tr><th id="1297">1297</th><td>    <i>/* Try to process pending commands for clients that were just unblocked. */</i></td></tr>
<tr><th id="1298">1298</th><td>    <b>if</b> (<a class="macro" href="adlist.h.html#57" title="((server.unblocked_clients)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unblocked_clients" title='redisServer::unblocked_clients' data-ref="redisServer::unblocked_clients">unblocked_clients</a>))</td></tr>
<tr><th id="1299">1299</th><td>        <a class="ref fn" href="redis.h.html#processUnblockedClients" title='processUnblockedClients' data-ref="processUnblockedClients">processUnblockedClients</a>();</td></tr>
<tr><th id="1300">1300</th><td></td></tr>
<tr><th id="1301">1301</th><td>    <i>/* Write the AOF buffer on disk */</i></td></tr>
<tr><th id="1302">1302</th><td>    <a class="ref fn" href="redis.h.html#flushAppendOnlyFile" title='flushAppendOnlyFile' data-ref="flushAppendOnlyFile">flushAppendOnlyFile</a>(<var>0</var>);</td></tr>
<tr><th id="1303">1303</th><td>}</td></tr>
<tr><th id="1304">1304</th><td></td></tr>
<tr><th id="1305">1305</th><td><i>/* =========================== Server initialization ======================== */</i></td></tr>
<tr><th id="1306">1306</th><td></td></tr>
<tr><th id="1307">1307</th><td><em>void</em> <dfn class="decl def fn" id="createSharedObjects" title='createSharedObjects' data-ref="createSharedObjects">createSharedObjects</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1308">1308</th><td>    <em>int</em> <dfn class="local col7 decl" id="137j" title='j' data-type='int' data-ref="137j">j</dfn>;</td></tr>
<tr><th id="1309">1309</th><td></td></tr>
<tr><th id="1310">1310</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::crlf" title='sharedObjectsStruct::crlf' data-ref="sharedObjectsStruct::crlf">crlf</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"\r\n"</q>));</td></tr>
<tr><th id="1311">1311</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::ok" title='sharedObjectsStruct::ok' data-ref="sharedObjectsStruct::ok">ok</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"+OK\r\n"</q>));</td></tr>
<tr><th id="1312">1312</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::err" title='sharedObjectsStruct::err' data-ref="sharedObjectsStruct::err">err</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"-ERR\r\n"</q>));</td></tr>
<tr><th id="1313">1313</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::emptybulk" title='sharedObjectsStruct::emptybulk' data-ref="sharedObjectsStruct::emptybulk">emptybulk</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"$0\r\n\r\n"</q>));</td></tr>
<tr><th id="1314">1314</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::czero" title='sharedObjectsStruct::czero' data-ref="sharedObjectsStruct::czero">czero</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>":0\r\n"</q>));</td></tr>
<tr><th id="1315">1315</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::cone" title='sharedObjectsStruct::cone' data-ref="sharedObjectsStruct::cone">cone</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>":1\r\n"</q>));</td></tr>
<tr><th id="1316">1316</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::cnegone" title='sharedObjectsStruct::cnegone' data-ref="sharedObjectsStruct::cnegone">cnegone</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>":-1\r\n"</q>));</td></tr>
<tr><th id="1317">1317</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::nullbulk" title='sharedObjectsStruct::nullbulk' data-ref="sharedObjectsStruct::nullbulk">nullbulk</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"$-1\r\n"</q>));</td></tr>
<tr><th id="1318">1318</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::nullmultibulk" title='sharedObjectsStruct::nullmultibulk' data-ref="sharedObjectsStruct::nullmultibulk">nullmultibulk</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"*-1\r\n"</q>));</td></tr>
<tr><th id="1319">1319</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::emptymultibulk" title='sharedObjectsStruct::emptymultibulk' data-ref="sharedObjectsStruct::emptymultibulk">emptymultibulk</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"*0\r\n"</q>));</td></tr>
<tr><th id="1320">1320</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::pong" title='sharedObjectsStruct::pong' data-ref="sharedObjectsStruct::pong">pong</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"+PONG\r\n"</q>));</td></tr>
<tr><th id="1321">1321</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::queued" title='sharedObjectsStruct::queued' data-ref="sharedObjectsStruct::queued">queued</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"+QUEUED\r\n"</q>));</td></tr>
<tr><th id="1322">1322</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::emptyscan" title='sharedObjectsStruct::emptyscan' data-ref="sharedObjectsStruct::emptyscan">emptyscan</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"*2\r\n$1\r\n0\r\n*0\r\n"</q>));</td></tr>
<tr><th id="1323">1323</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::wrongtypeerr" title='sharedObjectsStruct::wrongtypeerr' data-ref="sharedObjectsStruct::wrongtypeerr">wrongtypeerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1324">1324</th><td>        <q>"-WRONGTYPE Operation against a key holding the wrong kind of value\r\n"</q>));</td></tr>
<tr><th id="1325">1325</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::nokeyerr" title='sharedObjectsStruct::nokeyerr' data-ref="sharedObjectsStruct::nokeyerr">nokeyerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1326">1326</th><td>        <q>"-ERR no such key\r\n"</q>));</td></tr>
<tr><th id="1327">1327</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::syntaxerr" title='sharedObjectsStruct::syntaxerr' data-ref="sharedObjectsStruct::syntaxerr">syntaxerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1328">1328</th><td>        <q>"-ERR syntax error\r\n"</q>));</td></tr>
<tr><th id="1329">1329</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::sameobjecterr" title='sharedObjectsStruct::sameobjecterr' data-ref="sharedObjectsStruct::sameobjecterr">sameobjecterr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1330">1330</th><td>        <q>"-ERR source and destination objects are the same\r\n"</q>));</td></tr>
<tr><th id="1331">1331</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::outofrangeerr" title='sharedObjectsStruct::outofrangeerr' data-ref="sharedObjectsStruct::outofrangeerr">outofrangeerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1332">1332</th><td>        <q>"-ERR index out of range\r\n"</q>));</td></tr>
<tr><th id="1333">1333</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::noscripterr" title='sharedObjectsStruct::noscripterr' data-ref="sharedObjectsStruct::noscripterr">noscripterr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1334">1334</th><td>        <q>"-NOSCRIPT No matching script. Please use EVAL.\r\n"</q>));</td></tr>
<tr><th id="1335">1335</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::loadingerr" title='sharedObjectsStruct::loadingerr' data-ref="sharedObjectsStruct::loadingerr">loadingerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1336">1336</th><td>        <q>"-LOADING Redis is loading the dataset in memory\r\n"</q>));</td></tr>
<tr><th id="1337">1337</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::slowscripterr" title='sharedObjectsStruct::slowscripterr' data-ref="sharedObjectsStruct::slowscripterr">slowscripterr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1338">1338</th><td>        <q>"-BUSY Redis is busy running a script. You can only call SCRIPT KILL or SHUTDOWN NOSAVE.\r\n"</q>));</td></tr>
<tr><th id="1339">1339</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::masterdownerr" title='sharedObjectsStruct::masterdownerr' data-ref="sharedObjectsStruct::masterdownerr">masterdownerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1340">1340</th><td>        <q>"-MASTERDOWN Link with MASTER is down and slave-serve-stale-data is set to 'no'.\r\n"</q>));</td></tr>
<tr><th id="1341">1341</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::bgsaveerr" title='sharedObjectsStruct::bgsaveerr' data-ref="sharedObjectsStruct::bgsaveerr">bgsaveerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1342">1342</th><td>        <q>"-MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.\r\n"</q>));</td></tr>
<tr><th id="1343">1343</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::roslaveerr" title='sharedObjectsStruct::roslaveerr' data-ref="sharedObjectsStruct::roslaveerr">roslaveerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1344">1344</th><td>        <q>"-READONLY You can't write against a read only slave.\r\n"</q>));</td></tr>
<tr><th id="1345">1345</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::noautherr" title='sharedObjectsStruct::noautherr' data-ref="sharedObjectsStruct::noautherr">noautherr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1346">1346</th><td>        <q>"-NOAUTH Authentication required.\r\n"</q>));</td></tr>
<tr><th id="1347">1347</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::oomerr" title='sharedObjectsStruct::oomerr' data-ref="sharedObjectsStruct::oomerr">oomerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1348">1348</th><td>        <q>"-OOM command not allowed when used memory &gt; 'maxmemory'.\r\n"</q>));</td></tr>
<tr><th id="1349">1349</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::execaborterr" title='sharedObjectsStruct::execaborterr' data-ref="sharedObjectsStruct::execaborterr">execaborterr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1350">1350</th><td>        <q>"-EXECABORT Transaction discarded because of previous errors.\r\n"</q>));</td></tr>
<tr><th id="1351">1351</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::noreplicaserr" title='sharedObjectsStruct::noreplicaserr' data-ref="sharedObjectsStruct::noreplicaserr">noreplicaserr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1352">1352</th><td>        <q>"-NOREPLICAS Not enough good slaves to write.\r\n"</q>));</td></tr>
<tr><th id="1353">1353</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::busykeyerr" title='sharedObjectsStruct::busykeyerr' data-ref="sharedObjectsStruct::busykeyerr">busykeyerr</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(</td></tr>
<tr><th id="1354">1354</th><td>        <q>"-BUSYKEY Target key name already exists.\r\n"</q>));</td></tr>
<tr><th id="1355">1355</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::space" title='sharedObjectsStruct::space' data-ref="sharedObjectsStruct::space">space</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>" "</q>));</td></tr>
<tr><th id="1356">1356</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::colon" title='sharedObjectsStruct::colon' data-ref="sharedObjectsStruct::colon">colon</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>":"</q>));</td></tr>
<tr><th id="1357">1357</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::plus" title='sharedObjectsStruct::plus' data-ref="sharedObjectsStruct::plus">plus</a> = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,<a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<q>"+"</q>));</td></tr>
<tr><th id="1358">1358</th><td></td></tr>
<tr><th id="1359">1359</th><td>    <b>for</b> (<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a> = <var>0</var>; <a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a> &lt; <a class="macro" href="redis.h.html#81" title="10" data-ref="_M/REDIS_SHARED_SELECT_CMDS">REDIS_SHARED_SELECT_CMDS</a>; <a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>++) {</td></tr>
<tr><th id="1360">1360</th><td>        <em>char</em> <dfn class="local col8 decl" id="138dictid_str" title='dictid_str' data-type='char [64]' data-ref="138dictid_str">dictid_str</dfn>[<var>64</var>];</td></tr>
<tr><th id="1361">1361</th><td>        <em>int</em> <dfn class="local col9 decl" id="139dictid_len" title='dictid_len' data-type='int' data-ref="139dictid_len">dictid_len</dfn>;</td></tr>
<tr><th id="1362">1362</th><td></td></tr>
<tr><th id="1363">1363</th><td>        <a class="local col9 ref" href="#139dictid_len" title='dictid_len' data-ref="139dictid_len">dictid_len</a> = <a class="ref fn" href="util.h.html#ll2string" title='ll2string' data-ref="ll2string">ll2string</a>(<a class="local col8 ref" href="#138dictid_str" title='dictid_str' data-ref="138dictid_str">dictid_str</a>,<b>sizeof</b>(<a class="local col8 ref" href="#138dictid_str" title='dictid_str' data-ref="138dictid_str">dictid_str</a>),<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>);</td></tr>
<tr><th id="1364">1364</th><td>        <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::select" title='sharedObjectsStruct::select' data-ref="sharedObjectsStruct::select">select</a>[<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>] = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,</td></tr>
<tr><th id="1365">1365</th><td>            <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>(),</td></tr>
<tr><th id="1366">1366</th><td>                <q>"*2\r\n$6\r\nSELECT\r\n$%d\r\n%s\r\n"</q>,</td></tr>
<tr><th id="1367">1367</th><td>                <a class="local col9 ref" href="#139dictid_len" title='dictid_len' data-ref="139dictid_len">dictid_len</a>, <a class="local col8 ref" href="#138dictid_str" title='dictid_str' data-ref="138dictid_str">dictid_str</a>));</td></tr>
<tr><th id="1368">1368</th><td>    }</td></tr>
<tr><th id="1369">1369</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::messagebulk" title='sharedObjectsStruct::messagebulk' data-ref="sharedObjectsStruct::messagebulk">messagebulk</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"$7\r\nmessage\r\n"</q>,<var>13</var>);</td></tr>
<tr><th id="1370">1370</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::pmessagebulk" title='sharedObjectsStruct::pmessagebulk' data-ref="sharedObjectsStruct::pmessagebulk">pmessagebulk</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"$8\r\npmessage\r\n"</q>,<var>14</var>);</td></tr>
<tr><th id="1371">1371</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::subscribebulk" title='sharedObjectsStruct::subscribebulk' data-ref="sharedObjectsStruct::subscribebulk">subscribebulk</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"$9\r\nsubscribe\r\n"</q>,<var>15</var>);</td></tr>
<tr><th id="1372">1372</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::unsubscribebulk" title='sharedObjectsStruct::unsubscribebulk' data-ref="sharedObjectsStruct::unsubscribebulk">unsubscribebulk</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"$11\r\nunsubscribe\r\n"</q>,<var>18</var>);</td></tr>
<tr><th id="1373">1373</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::psubscribebulk" title='sharedObjectsStruct::psubscribebulk' data-ref="sharedObjectsStruct::psubscribebulk">psubscribebulk</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"$10\r\npsubscribe\r\n"</q>,<var>17</var>);</td></tr>
<tr><th id="1374">1374</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::punsubscribebulk" title='sharedObjectsStruct::punsubscribebulk' data-ref="sharedObjectsStruct::punsubscribebulk">punsubscribebulk</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"$12\r\npunsubscribe\r\n"</q>,<var>19</var>);</td></tr>
<tr><th id="1375">1375</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::del" title='sharedObjectsStruct::del' data-ref="sharedObjectsStruct::del">del</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"DEL"</q>,<var>3</var>);</td></tr>
<tr><th id="1376">1376</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::rpop" title='sharedObjectsStruct::rpop' data-ref="sharedObjectsStruct::rpop">rpop</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"RPOP"</q>,<var>4</var>);</td></tr>
<tr><th id="1377">1377</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::lpop" title='sharedObjectsStruct::lpop' data-ref="sharedObjectsStruct::lpop">lpop</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"LPOP"</q>,<var>4</var>);</td></tr>
<tr><th id="1378">1378</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::lpush" title='sharedObjectsStruct::lpush' data-ref="sharedObjectsStruct::lpush">lpush</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"LPUSH"</q>,<var>5</var>);</td></tr>
<tr><th id="1379">1379</th><td>    <b>for</b> (<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a> = <var>0</var>; <a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a> &lt; <a class="macro" href="redis.h.html#82" title="10000" data-ref="_M/REDIS_SHARED_INTEGERS">REDIS_SHARED_INTEGERS</a>; <a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>++) {</td></tr>
<tr><th id="1380">1380</th><td>        <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::integers" title='sharedObjectsStruct::integers' data-ref="sharedObjectsStruct::integers">integers</a>[<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>] = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,(<em>void</em>*)(<em>long</em>)<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>);</td></tr>
<tr><th id="1381">1381</th><td>        <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::integers" title='sharedObjectsStruct::integers' data-ref="sharedObjectsStruct::integers">integers</a>[<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>]-&gt;<a class="ref field" href="redis.h.html#redisObject::encoding" title='redisObject::encoding' data-ref="redisObject::encoding">encoding</a> = <a class="macro" href="redis.h.html#190" title="1" data-ref="_M/REDIS_ENCODING_INT">REDIS_ENCODING_INT</a>;</td></tr>
<tr><th id="1382">1382</th><td>    }</td></tr>
<tr><th id="1383">1383</th><td>    <b>for</b> (<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a> = <var>0</var>; <a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a> &lt; <a class="macro" href="redis.h.html#83" title="32" data-ref="_M/REDIS_SHARED_BULKHDR_LEN">REDIS_SHARED_BULKHDR_LEN</a>; <a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>++) {</td></tr>
<tr><th id="1384">1384</th><td>        <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::mbulkhdr" title='sharedObjectsStruct::mbulkhdr' data-ref="sharedObjectsStruct::mbulkhdr">mbulkhdr</a>[<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>] = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,</td></tr>
<tr><th id="1385">1385</th><td>            <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>(),<q>"*%d\r\n"</q>,<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>));</td></tr>
<tr><th id="1386">1386</th><td>        <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::bulkhdr" title='sharedObjectsStruct::bulkhdr' data-ref="sharedObjectsStruct::bulkhdr">bulkhdr</a>[<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>] = <a class="ref fn" href="redis.h.html#createObject" title='createObject' data-ref="createObject">createObject</a>(<a class="macro" href="redis.h.html#180" title="0" data-ref="_M/REDIS_STRING">REDIS_STRING</a>,</td></tr>
<tr><th id="1387">1387</th><td>            <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>(),<q>"$%d\r\n"</q>,<a class="local col7 ref" href="#137j" title='j' data-ref="137j">j</a>));</td></tr>
<tr><th id="1388">1388</th><td>    }</td></tr>
<tr><th id="1389">1389</th><td>    <i>/* The following two shared objects, minstring and maxstrings, are not</i></td></tr>
<tr><th id="1390">1390</th><td><i>     * actually used for their value but as a special object meaning</i></td></tr>
<tr><th id="1391">1391</th><td><i>     * respectively the minimum possible string and the maximum possible</i></td></tr>
<tr><th id="1392">1392</th><td><i>     * string in string comparisons for the ZRANGEBYLEX command. */</i></td></tr>
<tr><th id="1393">1393</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::minstring" title='sharedObjectsStruct::minstring' data-ref="sharedObjectsStruct::minstring">minstring</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"minstring"</q>,<var>9</var>);</td></tr>
<tr><th id="1394">1394</th><td>    <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::maxstring" title='sharedObjectsStruct::maxstring' data-ref="sharedObjectsStruct::maxstring">maxstring</a> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<q>"maxstring"</q>,<var>9</var>);</td></tr>
<tr><th id="1395">1395</th><td>}</td></tr>
<tr><th id="1396">1396</th><td></td></tr>
<tr><th id="1397">1397</th><td><em>void</em> <dfn class="decl def fn" id="initServerConfig" title='initServerConfig' data-ref="initServerConfig">initServerConfig</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1398">1398</th><td>    <em>int</em> <dfn class="local col0 decl" id="140j" title='j' data-type='int' data-ref="140j">j</dfn>;</td></tr>
<tr><th id="1399">1399</th><td></td></tr>
<tr><th id="1400">1400</th><td>    <a class="ref fn" href="redis.h.html#getRandomHexChars" title='getRandomHexChars' data-ref="getRandomHexChars">getRandomHexChars</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::runid" title='redisServer::runid' data-ref="redisServer::runid">runid</a>,<a class="macro" href="redis.h.html#95" title="40" data-ref="_M/REDIS_RUN_ID_SIZE">REDIS_RUN_ID_SIZE</a>);</td></tr>
<tr><th id="1401">1401</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::configfile" title='redisServer::configfile' data-ref="redisServer::configfile">configfile</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1402">1402</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hz" title='redisServer::hz' data-ref="redisServer::hz">hz</a> = <a class="macro" href="redis.h.html#71" title="10" data-ref="_M/REDIS_DEFAULT_HZ">REDIS_DEFAULT_HZ</a>;</td></tr>
<tr><th id="1403">1403</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::runid" title='redisServer::runid' data-ref="redisServer::runid">runid</a>[<a class="macro" href="redis.h.html#95" title="40" data-ref="_M/REDIS_RUN_ID_SIZE">REDIS_RUN_ID_SIZE</a>] = <kbd>'\0'</kbd>;</td></tr>
<tr><th id="1404">1404</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::arch_bits" title='redisServer::arch_bits' data-ref="redisServer::arch_bits">arch_bits</a> = (<b>sizeof</b>(<em>long</em>) == <var>8</var>) ? <var>64</var> : <var>32</var>;</td></tr>
<tr><th id="1405">1405</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a> = <a class="macro" href="redis.h.html#74" title="6379" data-ref="_M/REDIS_SERVERPORT">REDIS_SERVERPORT</a>;</td></tr>
<tr><th id="1406">1406</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a> = <a class="macro" href="redis.h.html#75" title="511" data-ref="_M/REDIS_TCP_BACKLOG">REDIS_TCP_BACKLOG</a>;</td></tr>
<tr><th id="1407">1407</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr_count" title='redisServer::bindaddr_count' data-ref="redisServer::bindaddr_count">bindaddr_count</a> = <var>0</var>;</td></tr>
<tr><th id="1408">1408</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1409">1409</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocketperm" title='redisServer::unixsocketperm' data-ref="redisServer::unixsocketperm">unixsocketperm</a> = <a class="macro" href="redis.h.html#105" title="0" data-ref="_M/REDIS_DEFAULT_UNIX_SOCKET_PERM">REDIS_DEFAULT_UNIX_SOCKET_PERM</a>;</td></tr>
<tr><th id="1410">1410</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd_count" title='redisServer::ipfd_count' data-ref="redisServer::ipfd_count">ipfd_count</a> = <var>0</var>;</td></tr>
<tr><th id="1411">1411</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> = -<var>1</var>;</td></tr>
<tr><th id="1412">1412</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a> = <a class="macro" href="redis.h.html#77" title="16" data-ref="_M/REDIS_DEFAULT_DBNUM">REDIS_DEFAULT_DBNUM</a>;</td></tr>
<tr><th id="1413">1413</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::verbosity" title='redisServer::verbosity' data-ref="redisServer::verbosity">verbosity</a> = <a class="macro" href="redis.h.html#306" title="2" data-ref="_M/REDIS_DEFAULT_VERBOSITY">REDIS_DEFAULT_VERBOSITY</a>;</td></tr>
<tr><th id="1414">1414</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxidletime" title='redisServer::maxidletime' data-ref="redisServer::maxidletime">maxidletime</a> = <a class="macro" href="redis.h.html#76" title="0" data-ref="_M/REDIS_MAXIDLETIME">REDIS_MAXIDLETIME</a>;</td></tr>
<tr><th id="1415">1415</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcpkeepalive" title='redisServer::tcpkeepalive' data-ref="redisServer::tcpkeepalive">tcpkeepalive</a> = <a class="macro" href="redis.h.html#106" title="0" data-ref="_M/REDIS_DEFAULT_TCP_KEEPALIVE">REDIS_DEFAULT_TCP_KEEPALIVE</a>;</td></tr>
<tr><th id="1416">1416</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::active_expire_enabled" title='redisServer::active_expire_enabled' data-ref="redisServer::active_expire_enabled">active_expire_enabled</a> = <var>1</var>;</td></tr>
<tr><th id="1417">1417</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::client_max_querybuf_len" title='redisServer::client_max_querybuf_len' data-ref="redisServer::client_max_querybuf_len">client_max_querybuf_len</a> = <a class="macro" href="redis.h.html#147" title="(1024*1024*1024)" data-ref="_M/REDIS_MAX_QUERYBUF_LEN">REDIS_MAX_QUERYBUF_LEN</a>;</td></tr>
<tr><th id="1418">1418</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::saveparams" title='redisServer::saveparams' data-ref="redisServer::saveparams">saveparams</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1419">1419</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a> = <var>0</var>;</td></tr>
<tr><th id="1420">1420</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::logfile" title='redisServer::logfile' data-ref="redisServer::logfile">logfile</a> = <a class="ref fn" href="zmalloc.h.html#zstrdup" title='zstrdup' data-ref="zstrdup">zstrdup</a>(<a class="macro" href="redis.h.html#107" title="&quot;&quot;" data-ref="_M/REDIS_DEFAULT_LOGFILE">REDIS_DEFAULT_LOGFILE</a>);</td></tr>
<tr><th id="1421">1421</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_enabled" title='redisServer::syslog_enabled' data-ref="redisServer::syslog_enabled">syslog_enabled</a> = <a class="macro" href="redis.h.html#108" title="0" data-ref="_M/REDIS_DEFAULT_SYSLOG_ENABLED">REDIS_DEFAULT_SYSLOG_ENABLED</a>;</td></tr>
<tr><th id="1422">1422</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_ident" title='redisServer::syslog_ident' data-ref="redisServer::syslog_ident">syslog_ident</a> = <a class="ref fn" href="zmalloc.h.html#zstrdup" title='zstrdup' data-ref="zstrdup">zstrdup</a>(<a class="macro" href="redis.h.html#102" title="&quot;redis&quot;" data-ref="_M/REDIS_DEFAULT_SYSLOG_IDENT">REDIS_DEFAULT_SYSLOG_IDENT</a>);</td></tr>
<tr><th id="1423">1423</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_facility" title='redisServer::syslog_facility' data-ref="redisServer::syslog_facility">syslog_facility</a> = <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#107" title="(16&lt;&lt;3)" data-ref="_M/LOG_LOCAL0">LOG_LOCAL0</a>;</td></tr>
<tr><th id="1424">1424</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::daemonize" title='redisServer::daemonize' data-ref="redisServer::daemonize">daemonize</a> = <a class="macro" href="redis.h.html#104" title="0" data-ref="_M/REDIS_DEFAULT_DAEMONIZE">REDIS_DEFAULT_DAEMONIZE</a>;</td></tr>
<tr><th id="1425">1425</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> = <a class="macro" href="redis.h.html#227" title="0" data-ref="_M/REDIS_AOF_OFF">REDIS_AOF_OFF</a>;</td></tr>
<tr><th id="1426">1426</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="macro" href="config.h.html#87" title="fdatasync" data-ref="_M/aof_fsync">aof_fsync</a> = <a class="macro" href="redis.h.html#318" title="2" data-ref="_M/REDIS_DEFAULT_AOF_FSYNC">REDIS_DEFAULT_AOF_FSYNC</a>;</td></tr>
<tr><th id="1427">1427</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_no_fsync_on_rewrite" title='redisServer::aof_no_fsync_on_rewrite' data-ref="redisServer::aof_no_fsync_on_rewrite">aof_no_fsync_on_rewrite</a> = <a class="macro" href="redis.h.html#121" title="0" data-ref="_M/REDIS_DEFAULT_AOF_NO_FSYNC_ON_REWRITE">REDIS_DEFAULT_AOF_NO_FSYNC_ON_REWRITE</a>;</td></tr>
<tr><th id="1428">1428</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_perc" title='redisServer::aof_rewrite_perc' data-ref="redisServer::aof_rewrite_perc">aof_rewrite_perc</a> = <a class="macro" href="redis.h.html#85" title="100" data-ref="_M/REDIS_AOF_REWRITE_PERC">REDIS_AOF_REWRITE_PERC</a>;</td></tr>
<tr><th id="1429">1429</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_min_size" title='redisServer::aof_rewrite_min_size' data-ref="redisServer::aof_rewrite_min_size">aof_rewrite_min_size</a> = <a class="macro" href="redis.h.html#86" title="(64*1024*1024)" data-ref="_M/REDIS_AOF_REWRITE_MIN_SIZE">REDIS_AOF_REWRITE_MIN_SIZE</a>;</td></tr>
<tr><th id="1430">1430</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_base_size" title='redisServer::aof_rewrite_base_size' data-ref="redisServer::aof_rewrite_base_size">aof_rewrite_base_size</a> = <var>0</var>;</td></tr>
<tr><th id="1431">1431</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_scheduled" title='redisServer::aof_rewrite_scheduled' data-ref="redisServer::aof_rewrite_scheduled">aof_rewrite_scheduled</a> = <var>0</var>;</td></tr>
<tr><th id="1432">1432</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_fsync" title='redisServer::aof_last_fsync' data-ref="redisServer::aof_last_fsync">aof_last_fsync</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1433">1433</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_time_last" title='redisServer::aof_rewrite_time_last' data-ref="redisServer::aof_rewrite_time_last">aof_rewrite_time_last</a> = -<var>1</var>;</td></tr>
<tr><th id="1434">1434</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_time_start" title='redisServer::aof_rewrite_time_start' data-ref="redisServer::aof_rewrite_time_start">aof_rewrite_time_start</a> = -<var>1</var>;</td></tr>
<tr><th id="1435">1435</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_lastbgrewrite_status" title='redisServer::aof_lastbgrewrite_status' data-ref="redisServer::aof_lastbgrewrite_status">aof_lastbgrewrite_status</a> = <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="1436">1436</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_delayed_fsync" title='redisServer::aof_delayed_fsync' data-ref="redisServer::aof_delayed_fsync">aof_delayed_fsync</a> = <var>0</var>;</td></tr>
<tr><th id="1437">1437</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_fd" title='redisServer::aof_fd' data-ref="redisServer::aof_fd">aof_fd</a> = -<var>1</var>;</td></tr>
<tr><th id="1438">1438</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_selected_db" title='redisServer::aof_selected_db' data-ref="redisServer::aof_selected_db">aof_selected_db</a> = -<var>1</var>; <i>/* Make sure the first time will not match */</i></td></tr>
<tr><th id="1439">1439</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_flush_postponed_start" title='redisServer::aof_flush_postponed_start' data-ref="redisServer::aof_flush_postponed_start">aof_flush_postponed_start</a> = <var>0</var>;</td></tr>
<tr><th id="1440">1440</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_incremental_fsync" title='redisServer::aof_rewrite_incremental_fsync' data-ref="redisServer::aof_rewrite_incremental_fsync">aof_rewrite_incremental_fsync</a> = <a class="macro" href="redis.h.html#124" title="1" data-ref="_M/REDIS_DEFAULT_AOF_REWRITE_INCREMENTAL_FSYNC">REDIS_DEFAULT_AOF_REWRITE_INCREMENTAL_FSYNC</a>;</td></tr>
<tr><th id="1441">1441</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_load_truncated" title='redisServer::aof_load_truncated' data-ref="redisServer::aof_load_truncated">aof_load_truncated</a> = <a class="macro" href="redis.h.html#122" title="1" data-ref="_M/REDIS_DEFAULT_AOF_LOAD_TRUNCATED">REDIS_DEFAULT_AOF_LOAD_TRUNCATED</a>;</td></tr>
<tr><th id="1442">1442</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pidfile" title='redisServer::pidfile' data-ref="redisServer::pidfile">pidfile</a> = <a class="ref fn" href="zmalloc.h.html#zstrdup" title='zstrdup' data-ref="zstrdup">zstrdup</a>(<a class="macro" href="redis.h.html#101" title="&quot;/var/run/redis.pid&quot;" data-ref="_M/REDIS_DEFAULT_PID_FILE">REDIS_DEFAULT_PID_FILE</a>);</td></tr>
<tr><th id="1443">1443</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_filename" title='redisServer::rdb_filename' data-ref="redisServer::rdb_filename">rdb_filename</a> = <a class="ref fn" href="zmalloc.h.html#zstrdup" title='zstrdup' data-ref="zstrdup">zstrdup</a>(<a class="macro" href="redis.h.html#112" title="&quot;dump.rdb&quot;" data-ref="_M/REDIS_DEFAULT_RDB_FILENAME">REDIS_DEFAULT_RDB_FILENAME</a>);</td></tr>
<tr><th id="1444">1444</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_filename" title='redisServer::aof_filename' data-ref="redisServer::aof_filename">aof_filename</a> = <a class="ref fn" href="zmalloc.h.html#zstrdup" title='zstrdup' data-ref="zstrdup">zstrdup</a>(<a class="macro" href="redis.h.html#120" title="&quot;appendonly.aof&quot;" data-ref="_M/REDIS_DEFAULT_AOF_FILENAME">REDIS_DEFAULT_AOF_FILENAME</a>);</td></tr>
<tr><th id="1445">1445</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::requirepass" title='redisServer::requirepass' data-ref="redisServer::requirepass">requirepass</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1446">1446</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_compression" title='redisServer::rdb_compression' data-ref="redisServer::rdb_compression">rdb_compression</a> = <a class="macro" href="redis.h.html#110" title="1" data-ref="_M/REDIS_DEFAULT_RDB_COMPRESSION">REDIS_DEFAULT_RDB_COMPRESSION</a>;</td></tr>
<tr><th id="1447">1447</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_checksum" title='redisServer::rdb_checksum' data-ref="redisServer::rdb_checksum">rdb_checksum</a> = <a class="macro" href="redis.h.html#111" title="1" data-ref="_M/REDIS_DEFAULT_RDB_CHECKSUM">REDIS_DEFAULT_RDB_CHECKSUM</a>;</td></tr>
<tr><th id="1448">1448</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stop_writes_on_bgsave_err" title='redisServer::stop_writes_on_bgsave_err' data-ref="redisServer::stop_writes_on_bgsave_err">stop_writes_on_bgsave_err</a> = <a class="macro" href="redis.h.html#109" title="1" data-ref="_M/REDIS_DEFAULT_STOP_WRITES_ON_BGSAVE_ERROR">REDIS_DEFAULT_STOP_WRITES_ON_BGSAVE_ERROR</a>;</td></tr>
<tr><th id="1449">1449</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::activerehashing" title='redisServer::activerehashing' data-ref="redisServer::activerehashing">activerehashing</a> = <a class="macro" href="redis.h.html#123" title="1" data-ref="_M/REDIS_DEFAULT_ACTIVE_REHASHING">REDIS_DEFAULT_ACTIVE_REHASHING</a>;</td></tr>
<tr><th id="1450">1450</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::notify_keyspace_events" title='redisServer::notify_keyspace_events' data-ref="redisServer::notify_keyspace_events">notify_keyspace_events</a> = <var>0</var>;</td></tr>
<tr><th id="1451">1451</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a> = <a class="macro" href="redis.h.html#90" title="10000" data-ref="_M/REDIS_MAX_CLIENTS">REDIS_MAX_CLIENTS</a>;</td></tr>
<tr><th id="1452">1452</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bpop_blocked_clients" title='redisServer::bpop_blocked_clients' data-ref="redisServer::bpop_blocked_clients">bpop_blocked_clients</a> = <var>0</var>;</td></tr>
<tr><th id="1453">1453</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a> = <a class="macro" href="redis.h.html#118" title="0" data-ref="_M/REDIS_DEFAULT_MAXMEMORY">REDIS_DEFAULT_MAXMEMORY</a>;</td></tr>
<tr><th id="1454">1454</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> = <a class="macro" href="redis.h.html#344" title="5" data-ref="_M/REDIS_DEFAULT_MAXMEMORY_POLICY">REDIS_DEFAULT_MAXMEMORY_POLICY</a>;</td></tr>
<tr><th id="1455">1455</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_samples" title='redisServer::maxmemory_samples' data-ref="redisServer::maxmemory_samples">maxmemory_samples</a> = <a class="macro" href="redis.h.html#119" title="5" data-ref="_M/REDIS_DEFAULT_MAXMEMORY_SAMPLES">REDIS_DEFAULT_MAXMEMORY_SAMPLES</a>;</td></tr>
<tr><th id="1456">1456</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hash_max_ziplist_entries" title='redisServer::hash_max_ziplist_entries' data-ref="redisServer::hash_max_ziplist_entries">hash_max_ziplist_entries</a> = <a class="macro" href="redis.h.html#321" title="512" data-ref="_M/REDIS_HASH_MAX_ZIPLIST_ENTRIES">REDIS_HASH_MAX_ZIPLIST_ENTRIES</a>;</td></tr>
<tr><th id="1457">1457</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hash_max_ziplist_value" title='redisServer::hash_max_ziplist_value' data-ref="redisServer::hash_max_ziplist_value">hash_max_ziplist_value</a> = <a class="macro" href="redis.h.html#322" title="64" data-ref="_M/REDIS_HASH_MAX_ZIPLIST_VALUE">REDIS_HASH_MAX_ZIPLIST_VALUE</a>;</td></tr>
<tr><th id="1458">1458</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::list_max_ziplist_entries" title='redisServer::list_max_ziplist_entries' data-ref="redisServer::list_max_ziplist_entries">list_max_ziplist_entries</a> = <a class="macro" href="redis.h.html#323" title="512" data-ref="_M/REDIS_LIST_MAX_ZIPLIST_ENTRIES">REDIS_LIST_MAX_ZIPLIST_ENTRIES</a>;</td></tr>
<tr><th id="1459">1459</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::list_max_ziplist_value" title='redisServer::list_max_ziplist_value' data-ref="redisServer::list_max_ziplist_value">list_max_ziplist_value</a> = <a class="macro" href="redis.h.html#324" title="64" data-ref="_M/REDIS_LIST_MAX_ZIPLIST_VALUE">REDIS_LIST_MAX_ZIPLIST_VALUE</a>;</td></tr>
<tr><th id="1460">1460</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::set_max_intset_entries" title='redisServer::set_max_intset_entries' data-ref="redisServer::set_max_intset_entries">set_max_intset_entries</a> = <a class="macro" href="redis.h.html#325" title="512" data-ref="_M/REDIS_SET_MAX_INTSET_ENTRIES">REDIS_SET_MAX_INTSET_ENTRIES</a>;</td></tr>
<tr><th id="1461">1461</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::zset_max_ziplist_entries" title='redisServer::zset_max_ziplist_entries' data-ref="redisServer::zset_max_ziplist_entries">zset_max_ziplist_entries</a> = <a class="macro" href="redis.h.html#326" title="128" data-ref="_M/REDIS_ZSET_MAX_ZIPLIST_ENTRIES">REDIS_ZSET_MAX_ZIPLIST_ENTRIES</a>;</td></tr>
<tr><th id="1462">1462</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::zset_max_ziplist_value" title='redisServer::zset_max_ziplist_value' data-ref="redisServer::zset_max_ziplist_value">zset_max_ziplist_value</a> = <a class="macro" href="redis.h.html#327" title="64" data-ref="_M/REDIS_ZSET_MAX_ZIPLIST_VALUE">REDIS_ZSET_MAX_ZIPLIST_VALUE</a>;</td></tr>
<tr><th id="1463">1463</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hll_sparse_max_bytes" title='redisServer::hll_sparse_max_bytes' data-ref="redisServer::hll_sparse_max_bytes">hll_sparse_max_bytes</a> = <a class="macro" href="redis.h.html#330" title="3000" data-ref="_M/REDIS_DEFAULT_HLL_SPARSE_MAX_BYTES">REDIS_DEFAULT_HLL_SPARSE_MAX_BYTES</a>;</td></tr>
<tr><th id="1464">1464</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::shutdown_asap" title='redisServer::shutdown_asap' data-ref="redisServer::shutdown_asap">shutdown_asap</a> = <var>0</var>;</td></tr>
<tr><th id="1465">1465</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_ping_slave_period" title='redisServer::repl_ping_slave_period' data-ref="redisServer::repl_ping_slave_period">repl_ping_slave_period</a> = <a class="macro" href="redis.h.html#94" title="10" data-ref="_M/REDIS_REPL_PING_SLAVE_PERIOD">REDIS_REPL_PING_SLAVE_PERIOD</a>;</td></tr>
<tr><th id="1466">1466</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_timeout" title='redisServer::repl_timeout' data-ref="redisServer::repl_timeout">repl_timeout</a> = <a class="macro" href="redis.h.html#93" title="60" data-ref="_M/REDIS_REPL_TIMEOUT">REDIS_REPL_TIMEOUT</a>;</td></tr>
<tr><th id="1467">1467</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_to_write" title='redisServer::repl_min_slaves_to_write' data-ref="redisServer::repl_min_slaves_to_write">repl_min_slaves_to_write</a> = <a class="macro" href="redis.h.html#125" title="0" data-ref="_M/REDIS_DEFAULT_MIN_SLAVES_TO_WRITE">REDIS_DEFAULT_MIN_SLAVES_TO_WRITE</a>;</td></tr>
<tr><th id="1468">1468</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_max_lag" title='redisServer::repl_min_slaves_max_lag' data-ref="redisServer::repl_min_slaves_max_lag">repl_min_slaves_max_lag</a> = <a class="macro" href="redis.h.html#126" title="10" data-ref="_M/REDIS_DEFAULT_MIN_SLAVES_MAX_LAG">REDIS_DEFAULT_MIN_SLAVES_MAX_LAG</a>;</td></tr>
<tr><th id="1469">1469</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a> = <var>0</var>;</td></tr>
<tr><th id="1470">1470</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_node_timeout" title='redisServer::cluster_node_timeout' data-ref="redisServer::cluster_node_timeout">cluster_node_timeout</a> = <a class="macro" href="cluster.h.html#16" title="15000" data-ref="_M/REDIS_CLUSTER_DEFAULT_NODE_TIMEOUT">REDIS_CLUSTER_DEFAULT_NODE_TIMEOUT</a>;</td></tr>
<tr><th id="1471">1471</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_migration_barrier" title='redisServer::cluster_migration_barrier' data-ref="redisServer::cluster_migration_barrier">cluster_migration_barrier</a> = <a class="macro" href="cluster.h.html#23" title="1" data-ref="_M/REDIS_CLUSTER_DEFAULT_MIGRATION_BARRIER">REDIS_CLUSTER_DEFAULT_MIGRATION_BARRIER</a>;</td></tr>
<tr><th id="1472">1472</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_slave_validity_factor" title='redisServer::cluster_slave_validity_factor' data-ref="redisServer::cluster_slave_validity_factor">cluster_slave_validity_factor</a> = <a class="macro" href="cluster.h.html#17" title="10" data-ref="_M/REDIS_CLUSTER_DEFAULT_SLAVE_VALIDITY">REDIS_CLUSTER_DEFAULT_SLAVE_VALIDITY</a>;</td></tr>
<tr><th id="1473">1473</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_require_full_coverage" title='redisServer::cluster_require_full_coverage' data-ref="redisServer::cluster_require_full_coverage">cluster_require_full_coverage</a> = <a class="macro" href="cluster.h.html#18" title="1" data-ref="_M/REDIS_CLUSTER_DEFAULT_REQUIRE_FULL_COVERAGE">REDIS_CLUSTER_DEFAULT_REQUIRE_FULL_COVERAGE</a>;</td></tr>
<tr><th id="1474">1474</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_configfile" title='redisServer::cluster_configfile' data-ref="redisServer::cluster_configfile">cluster_configfile</a> = <a class="ref fn" href="zmalloc.h.html#zstrdup" title='zstrdup' data-ref="zstrdup">zstrdup</a>(<a class="macro" href="redis.h.html#103" title="&quot;nodes.conf&quot;" data-ref="_M/REDIS_DEFAULT_CLUSTER_CONFIG_FILE">REDIS_DEFAULT_CLUSTER_CONFIG_FILE</a>);</td></tr>
<tr><th id="1475">1475</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_caller" title='redisServer::lua_caller' data-ref="redisServer::lua_caller">lua_caller</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1476">1476</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_time_limit" title='redisServer::lua_time_limit' data-ref="redisServer::lua_time_limit">lua_time_limit</a> = <a class="macro" href="redis.h.html#347" title="5000" data-ref="_M/REDIS_LUA_TIME_LIMIT">REDIS_LUA_TIME_LIMIT</a>;</td></tr>
<tr><th id="1477">1477</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_client" title='redisServer::lua_client' data-ref="redisServer::lua_client">lua_client</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1478">1478</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_timedout" title='redisServer::lua_timedout' data-ref="redisServer::lua_timedout">lua_timedout</a> = <var>0</var>;</td></tr>
<tr><th id="1479">1479</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::migrate_cached_sockets" title='redisServer::migrate_cached_sockets' data-ref="redisServer::migrate_cached_sockets">migrate_cached_sockets</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#migrateCacheDictType" title='migrateCacheDictType' data-ref="migrateCacheDictType">migrateCacheDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1480">1480</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::next_client_id" title='redisServer::next_client_id' data-ref="redisServer::next_client_id">next_client_id</a> = <var>1</var>; <i>/* Client IDs, start from 1 .*/</i></td></tr>
<tr><th id="1481">1481</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_process_events_interval_bytes" title='redisServer::loading_process_events_interval_bytes' data-ref="redisServer::loading_process_events_interval_bytes">loading_process_events_interval_bytes</a> = (<var>1024</var>*<var>1024</var>*<var>2</var>);</td></tr>
<tr><th id="1482">1482</th><td></td></tr>
<tr><th id="1483">1483</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lruclock" title='redisServer::lruclock' data-ref="redisServer::lruclock">lruclock</a> = <a class="ref fn" href="#getLRUClock" title='getLRUClock' data-ref="getLRUClock">getLRUClock</a>();</td></tr>
<tr><th id="1484">1484</th><td>    <a class="ref fn" href="redis.h.html#resetServerSaveParams" title='resetServerSaveParams' data-ref="resetServerSaveParams">resetServerSaveParams</a>();</td></tr>
<tr><th id="1485">1485</th><td></td></tr>
<tr><th id="1486">1486</th><td>    <a class="ref fn" href="redis.h.html#appendServerSaveParams" title='appendServerSaveParams' data-ref="appendServerSaveParams">appendServerSaveParams</a>(<var>60</var>*<var>60</var>,<var>1</var>);  <i>/* save after 1 hour and 1 change */</i></td></tr>
<tr><th id="1487">1487</th><td>    <a class="ref fn" href="redis.h.html#appendServerSaveParams" title='appendServerSaveParams' data-ref="appendServerSaveParams">appendServerSaveParams</a>(<var>300</var>,<var>100</var>);  <i>/* save after 5 minutes and 100 changes */</i></td></tr>
<tr><th id="1488">1488</th><td>    <a class="ref fn" href="redis.h.html#appendServerSaveParams" title='appendServerSaveParams' data-ref="appendServerSaveParams">appendServerSaveParams</a>(<var>60</var>,<var>10000</var>); <i>/* save after 1 minute and 10000 changes */</i></td></tr>
<tr><th id="1489">1489</th><td>    <i>/* Replication related */</i></td></tr>
<tr><th id="1490">1490</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterauth" title='redisServer::masterauth' data-ref="redisServer::masterauth">masterauth</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1491">1491</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1492">1492</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterport" title='redisServer::masterport' data-ref="redisServer::masterport">masterport</a> = <var>6379</var>;</td></tr>
<tr><th id="1493">1493</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master" title='redisServer::master' data-ref="redisServer::master">master</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1494">1494</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cached_master" title='redisServer::cached_master' data-ref="redisServer::cached_master">cached_master</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1495">1495</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_master_initial_offset" title='redisServer::repl_master_initial_offset' data-ref="redisServer::repl_master_initial_offset">repl_master_initial_offset</a> = -<var>1</var>;</td></tr>
<tr><th id="1496">1496</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_state" title='redisServer::repl_state' data-ref="redisServer::repl_state">repl_state</a> = <a class="macro" href="redis.h.html#271" title="0" data-ref="_M/REDIS_REPL_NONE">REDIS_REPL_NONE</a>;</td></tr>
<tr><th id="1497">1497</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_syncio_timeout" title='redisServer::repl_syncio_timeout' data-ref="redisServer::repl_syncio_timeout">repl_syncio_timeout</a> = <a class="macro" href="redis.h.html#288" title="5" data-ref="_M/REDIS_REPL_SYNCIO_TIMEOUT">REDIS_REPL_SYNCIO_TIMEOUT</a>;</td></tr>
<tr><th id="1498">1498</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_serve_stale_data" title='redisServer::repl_serve_stale_data' data-ref="redisServer::repl_serve_stale_data">repl_serve_stale_data</a> = <a class="macro" href="redis.h.html#115" title="1" data-ref="_M/REDIS_DEFAULT_SLAVE_SERVE_STALE_DATA">REDIS_DEFAULT_SLAVE_SERVE_STALE_DATA</a>;</td></tr>
<tr><th id="1499">1499</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_slave_ro" title='redisServer::repl_slave_ro' data-ref="redisServer::repl_slave_ro">repl_slave_ro</a> = <a class="macro" href="redis.h.html#116" title="1" data-ref="_M/REDIS_DEFAULT_SLAVE_READ_ONLY">REDIS_DEFAULT_SLAVE_READ_ONLY</a>;</td></tr>
<tr><th id="1500">1500</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_down_since" title='redisServer::repl_down_since' data-ref="redisServer::repl_down_since">repl_down_since</a> = <var>0</var>; <i>/* Never connected, repl is down since EVER. */</i></td></tr>
<tr><th id="1501">1501</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_disable_tcp_nodelay" title='redisServer::repl_disable_tcp_nodelay' data-ref="redisServer::repl_disable_tcp_nodelay">repl_disable_tcp_nodelay</a> = <a class="macro" href="redis.h.html#117" title="0" data-ref="_M/REDIS_DEFAULT_REPL_DISABLE_TCP_NODELAY">REDIS_DEFAULT_REPL_DISABLE_TCP_NODELAY</a>;</td></tr>
<tr><th id="1502">1502</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_diskless_sync" title='redisServer::repl_diskless_sync' data-ref="redisServer::repl_diskless_sync">repl_diskless_sync</a> = <a class="macro" href="redis.h.html#113" title="0" data-ref="_M/REDIS_DEFAULT_REPL_DISKLESS_SYNC">REDIS_DEFAULT_REPL_DISKLESS_SYNC</a>;</td></tr>
<tr><th id="1503">1503</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_diskless_sync_delay" title='redisServer::repl_diskless_sync_delay' data-ref="redisServer::repl_diskless_sync_delay">repl_diskless_sync_delay</a> = <a class="macro" href="redis.h.html#114" title="5" data-ref="_M/REDIS_DEFAULT_REPL_DISKLESS_SYNC_DELAY">REDIS_DEFAULT_REPL_DISKLESS_SYNC_DELAY</a>;</td></tr>
<tr><th id="1504">1504</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slave_priority" title='redisServer::slave_priority' data-ref="redisServer::slave_priority">slave_priority</a> = <a class="macro" href="redis.h.html#92" title="100" data-ref="_M/REDIS_DEFAULT_SLAVE_PRIORITY">REDIS_DEFAULT_SLAVE_PRIORITY</a>;</td></tr>
<tr><th id="1505">1505</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master_repl_offset" title='redisServer::master_repl_offset' data-ref="redisServer::master_repl_offset">master_repl_offset</a> = <var>0</var>;</td></tr>
<tr><th id="1506">1506</th><td></td></tr>
<tr><th id="1507">1507</th><td>    <i>/* Replication partial resync backlog */</i></td></tr>
<tr><th id="1508">1508</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog" title='redisServer::repl_backlog' data-ref="redisServer::repl_backlog">repl_backlog</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1509">1509</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_size" title='redisServer::repl_backlog_size' data-ref="redisServer::repl_backlog_size">repl_backlog_size</a> = <a class="macro" href="redis.h.html#97" title="(1024*1024)" data-ref="_M/REDIS_DEFAULT_REPL_BACKLOG_SIZE">REDIS_DEFAULT_REPL_BACKLOG_SIZE</a>;</td></tr>
<tr><th id="1510">1510</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_histlen" title='redisServer::repl_backlog_histlen' data-ref="redisServer::repl_backlog_histlen">repl_backlog_histlen</a> = <var>0</var>;</td></tr>
<tr><th id="1511">1511</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_idx" title='redisServer::repl_backlog_idx' data-ref="redisServer::repl_backlog_idx">repl_backlog_idx</a> = <var>0</var>;</td></tr>
<tr><th id="1512">1512</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_off" title='redisServer::repl_backlog_off' data-ref="redisServer::repl_backlog_off">repl_backlog_off</a> = <var>0</var>;</td></tr>
<tr><th id="1513">1513</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_time_limit" title='redisServer::repl_backlog_time_limit' data-ref="redisServer::repl_backlog_time_limit">repl_backlog_time_limit</a> = <a class="macro" href="redis.h.html#98" title="(60*60)" data-ref="_M/REDIS_DEFAULT_REPL_BACKLOG_TIME_LIMIT">REDIS_DEFAULT_REPL_BACKLOG_TIME_LIMIT</a>;</td></tr>
<tr><th id="1514">1514</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_no_slaves_since" title='redisServer::repl_no_slaves_since' data-ref="redisServer::repl_no_slaves_since">repl_no_slaves_since</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1515">1515</th><td></td></tr>
<tr><th id="1516">1516</th><td>    <i>/* Client output buffer limits */</i></td></tr>
<tr><th id="1517">1517</th><td>    <b>for</b> (<a class="local col0 ref" href="#140j" title='j' data-ref="140j">j</a> = <var>0</var>; <a class="local col0 ref" href="#140j" title='j' data-ref="140j">j</a> &lt; <a class="macro" href="redis.h.html#268" title="3" data-ref="_M/REDIS_CLIENT_TYPE_COUNT">REDIS_CLIENT_TYPE_COUNT</a>; <a class="local col0 ref" href="#140j" title='j' data-ref="140j">j</a>++)</td></tr>
<tr><th id="1518">1518</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::client_obuf_limits" title='redisServer::client_obuf_limits' data-ref="redisServer::client_obuf_limits">client_obuf_limits</a>[<a class="local col0 ref" href="#140j" title='j' data-ref="140j">j</a>] = <a class="ref" href="redis.h.html#clientBufferLimitsDefaults" title='clientBufferLimitsDefaults' data-ref="clientBufferLimitsDefaults">clientBufferLimitsDefaults</a>[<a class="local col0 ref" href="#140j" title='j' data-ref="140j">j</a>];</td></tr>
<tr><th id="1519">1519</th><td></td></tr>
<tr><th id="1520">1520</th><td>    <i>/* Double constants initialization */</i></td></tr>
<tr><th id="1521">1521</th><td>    <a class="ref" href="redis.h.html#R_Zero" title='R_Zero' data-ref="R_Zero">R_Zero</a> = <var>0.0</var>;</td></tr>
<tr><th id="1522">1522</th><td>    <a class="ref" href="redis.h.html#R_PosInf" title='R_PosInf' data-ref="R_PosInf">R_PosInf</a> = <var>1.0</var>/<a class="ref" href="redis.h.html#R_Zero" title='R_Zero' data-ref="R_Zero">R_Zero</a>;</td></tr>
<tr><th id="1523">1523</th><td>    <a class="ref" href="redis.h.html#R_NegInf" title='R_NegInf' data-ref="R_NegInf">R_NegInf</a> = -<var>1.0</var>/<a class="ref" href="redis.h.html#R_Zero" title='R_Zero' data-ref="R_Zero">R_Zero</a>;</td></tr>
<tr><th id="1524">1524</th><td>    <a class="ref" href="redis.h.html#R_Nan" title='R_Nan' data-ref="R_Nan">R_Nan</a> = <a class="ref" href="redis.h.html#R_Zero" title='R_Zero' data-ref="R_Zero">R_Zero</a>/<a class="ref" href="redis.h.html#R_Zero" title='R_Zero' data-ref="R_Zero">R_Zero</a>;</td></tr>
<tr><th id="1525">1525</th><td></td></tr>
<tr><th id="1526">1526</th><td>    <i>/* Command table -- we initiialize it here as it is part of the</i></td></tr>
<tr><th id="1527">1527</th><td><i>     * initial configuration, since command names may be changed via</i></td></tr>
<tr><th id="1528">1528</th><td><i>     * redis.conf using the rename-command directive. */</i></td></tr>
<tr><th id="1529">1529</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#commandTableDictType" title='commandTableDictType' data-ref="commandTableDictType">commandTableDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1530">1530</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::orig_commands" title='redisServer::orig_commands' data-ref="redisServer::orig_commands">orig_commands</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#commandTableDictType" title='commandTableDictType' data-ref="commandTableDictType">commandTableDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1531">1531</th><td>    <a class="ref fn" href="#populateCommandTable" title='populateCommandTable' data-ref="populateCommandTable">populateCommandTable</a>();</td></tr>
<tr><th id="1532">1532</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::delCommand" title='redisServer::delCommand' data-ref="redisServer::delCommand">delCommand</a> = <a class="ref fn" href="#lookupCommandByCString" title='lookupCommandByCString' data-ref="lookupCommandByCString">lookupCommandByCString</a>(<q>"del"</q>);</td></tr>
<tr><th id="1533">1533</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::multiCommand" title='redisServer::multiCommand' data-ref="redisServer::multiCommand">multiCommand</a> = <a class="ref fn" href="#lookupCommandByCString" title='lookupCommandByCString' data-ref="lookupCommandByCString">lookupCommandByCString</a>(<q>"multi"</q>);</td></tr>
<tr><th id="1534">1534</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lpushCommand" title='redisServer::lpushCommand' data-ref="redisServer::lpushCommand">lpushCommand</a> = <a class="ref fn" href="#lookupCommandByCString" title='lookupCommandByCString' data-ref="lookupCommandByCString">lookupCommandByCString</a>(<q>"lpush"</q>);</td></tr>
<tr><th id="1535">1535</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lpopCommand" title='redisServer::lpopCommand' data-ref="redisServer::lpopCommand">lpopCommand</a> = <a class="ref fn" href="#lookupCommandByCString" title='lookupCommandByCString' data-ref="lookupCommandByCString">lookupCommandByCString</a>(<q>"lpop"</q>);</td></tr>
<tr><th id="1536">1536</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rpopCommand" title='redisServer::rpopCommand' data-ref="redisServer::rpopCommand">rpopCommand</a> = <a class="ref fn" href="#lookupCommandByCString" title='lookupCommandByCString' data-ref="lookupCommandByCString">lookupCommandByCString</a>(<q>"rpop"</q>);</td></tr>
<tr><th id="1537">1537</th><td></td></tr>
<tr><th id="1538">1538</th><td>    <i>/* Slow log */</i></td></tr>
<tr><th id="1539">1539</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slowlog_log_slower_than" title='redisServer::slowlog_log_slower_than' data-ref="redisServer::slowlog_log_slower_than">slowlog_log_slower_than</a> = <a class="macro" href="redis.h.html#88" title="10000" data-ref="_M/REDIS_SLOWLOG_LOG_SLOWER_THAN">REDIS_SLOWLOG_LOG_SLOWER_THAN</a>;</td></tr>
<tr><th id="1540">1540</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slowlog_max_len" title='redisServer::slowlog_max_len' data-ref="redisServer::slowlog_max_len">slowlog_max_len</a> = <a class="macro" href="redis.h.html#89" title="128" data-ref="_M/REDIS_SLOWLOG_MAX_LEN">REDIS_SLOWLOG_MAX_LEN</a>;</td></tr>
<tr><th id="1541">1541</th><td></td></tr>
<tr><th id="1542">1542</th><td>    <i>/* Latency monitor */</i></td></tr>
<tr><th id="1543">1543</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::latency_monitor_threshold" title='redisServer::latency_monitor_threshold' data-ref="redisServer::latency_monitor_threshold">latency_monitor_threshold</a> = <a class="macro" href="redis.h.html#131" title="0" data-ref="_M/REDIS_DEFAULT_LATENCY_MONITOR_THRESHOLD">REDIS_DEFAULT_LATENCY_MONITOR_THRESHOLD</a>;</td></tr>
<tr><th id="1544">1544</th><td></td></tr>
<tr><th id="1545">1545</th><td>    <i>/* Debugging */</i></td></tr>
<tr><th id="1546">1546</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::assert_failed" title='redisServer::assert_failed' data-ref="redisServer::assert_failed">assert_failed</a> = <q>"&lt;no assertion failed&gt;"</q>;</td></tr>
<tr><th id="1547">1547</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::assert_file" title='redisServer::assert_file' data-ref="redisServer::assert_file">assert_file</a> = <q>"&lt;no file&gt;"</q>;</td></tr>
<tr><th id="1548">1548</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::assert_line" title='redisServer::assert_line' data-ref="redisServer::assert_line">assert_line</a> = <var>0</var>;</td></tr>
<tr><th id="1549">1549</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bug_report_start" title='redisServer::bug_report_start' data-ref="redisServer::bug_report_start">bug_report_start</a> = <var>0</var>;</td></tr>
<tr><th id="1550">1550</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::watchdog_period" title='redisServer::watchdog_period' data-ref="redisServer::watchdog_period">watchdog_period</a> = <var>0</var>;</td></tr>
<tr><th id="1551">1551</th><td>}</td></tr>
<tr><th id="1552">1552</th><td></td></tr>
<tr><th id="1553">1553</th><td><i>/* This function will try to raise the max number of open files accordingly to</i></td></tr>
<tr><th id="1554">1554</th><td><i> * the configured max number of clients. It also reserves a number of file</i></td></tr>
<tr><th id="1555">1555</th><td><i> * descriptors (REDIS_MIN_RESERVED_FDS) for extra operations of</i></td></tr>
<tr><th id="1556">1556</th><td><i> * persistence, listening sockets, log files and so forth.</i></td></tr>
<tr><th id="1557">1557</th><td><i> *</i></td></tr>
<tr><th id="1558">1558</th><td><i> * If it will not be possible to set the limit accordingly to the configured</i></td></tr>
<tr><th id="1559">1559</th><td><i> * max number of clients, the function will do the reverse setting</i></td></tr>
<tr><th id="1560">1560</th><td><i> * server.maxclients to the value that we can actually handle. */</i></td></tr>
<tr><th id="1561">1561</th><td><em>void</em> <dfn class="decl def fn" id="adjustOpenFilesLimit" title='adjustOpenFilesLimit' data-ref="adjustOpenFilesLimit">adjustOpenFilesLimit</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1562">1562</th><td>    <a class="typedef" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlim_t" title='rlim_t' data-type='__rlim64_t' data-ref="rlim_t">rlim_t</a> <dfn class="local col1 decl" id="141maxfiles" title='maxfiles' data-type='rlim_t' data-ref="141maxfiles">maxfiles</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a>+<a class="macro" href="redis.h.html#130" title="32" data-ref="_M/REDIS_MIN_RESERVED_FDS">REDIS_MIN_RESERVED_FDS</a>;</td></tr>
<tr><th id="1563">1563</th><td>    <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlimit" title='rlimit' data-ref="rlimit">rlimit</a> <dfn class="local col2 decl" id="142limit" title='limit' data-type='struct rlimit' data-ref="142limit">limit</dfn>;</td></tr>
<tr><th id="1564">1564</th><td></td></tr>
<tr><th id="1565">1565</th><td>    <b>if</b> (<a class="ref fn" href="../../include/x86_64-linux-gnu/sys/resource.h.html#54" title='getrlimit' data-ref="getrlimit64">getrlimit</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/resource.h.html#63" title="RLIMIT_NOFILE" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>,&amp;<a class="local col2 ref" href="#142limit" title='limit' data-ref="142limit">limit</a>) == -<var>1</var>) {</td></tr>
<tr><th id="1566">1566</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Unable to obtain the current NOFILE limit (%s), assuming 1024 and setting the max clients configuration accordingly."</q>,</td></tr>
<tr><th id="1567">1567</th><td>            <a class="ref fn" href="../../include/string.h.html#strerror" title='strerror' data-ref="strerror">strerror</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/errno.h.html#54" title="(*__errno_location ())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="1568">1568</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a> = <var>1024</var>-<a class="macro" href="redis.h.html#130" title="32" data-ref="_M/REDIS_MIN_RESERVED_FDS">REDIS_MIN_RESERVED_FDS</a>;</td></tr>
<tr><th id="1569">1569</th><td>    } <b>else</b> {</td></tr>
<tr><th id="1570">1570</th><td>        <a class="typedef" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlim_t" title='rlim_t' data-type='__rlim64_t' data-ref="rlim_t">rlim_t</a> <dfn class="local col3 decl" id="143oldlimit" title='oldlimit' data-type='rlim_t' data-ref="143oldlimit">oldlimit</dfn> = <a class="local col2 ref" href="#142limit" title='limit' data-ref="142limit">limit</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur">rlim_cur</a>;</td></tr>
<tr><th id="1571">1571</th><td></td></tr>
<tr><th id="1572">1572</th><td>        <i>/* Set the max number of files if the current limit is not enough</i></td></tr>
<tr><th id="1573">1573</th><td><i>         * for our needs. */</i></td></tr>
<tr><th id="1574">1574</th><td>        <b>if</b> (<a class="local col3 ref" href="#143oldlimit" title='oldlimit' data-ref="143oldlimit">oldlimit</a> &lt; <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>) {</td></tr>
<tr><th id="1575">1575</th><td>            <a class="typedef" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlim_t" title='rlim_t' data-type='__rlim64_t' data-ref="rlim_t">rlim_t</a> <dfn class="local col4 decl" id="144bestlimit" title='bestlimit' data-type='rlim_t' data-ref="144bestlimit">bestlimit</dfn>;</td></tr>
<tr><th id="1576">1576</th><td>            <em>int</em> <dfn class="local col5 decl" id="145setrlimit_error" title='setrlimit_error' data-type='int' data-ref="145setrlimit_error">setrlimit_error</dfn> = <var>0</var>;</td></tr>
<tr><th id="1577">1577</th><td></td></tr>
<tr><th id="1578">1578</th><td>            <i>/* Try to set the file limit to match 'maxfiles' or at least</i></td></tr>
<tr><th id="1579">1579</th><td><i>             * to the higher value supported less than maxfiles. */</i></td></tr>
<tr><th id="1580">1580</th><td>            <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> = <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>;</td></tr>
<tr><th id="1581">1581</th><td>            <b>while</b>(<a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> &gt; <a class="local col3 ref" href="#143oldlimit" title='oldlimit' data-ref="143oldlimit">oldlimit</a>) {</td></tr>
<tr><th id="1582">1582</th><td>                <a class="typedef" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlim_t" title='rlim_t' data-type='__rlim64_t' data-ref="rlim_t">rlim_t</a> <dfn class="local col6 decl" id="146decr_step" title='decr_step' data-type='rlim_t' data-ref="146decr_step">decr_step</dfn> = <var>16</var>;</td></tr>
<tr><th id="1583">1583</th><td></td></tr>
<tr><th id="1584">1584</th><td>                <a class="local col2 ref" href="#142limit" title='limit' data-ref="142limit">limit</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur">rlim_cur</a> = <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a>;</td></tr>
<tr><th id="1585">1585</th><td>                <a class="local col2 ref" href="#142limit" title='limit' data-ref="142limit">limit</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max">rlim_max</a> = <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a>;</td></tr>
<tr><th id="1586">1586</th><td>                <b>if</b> (<a class="ref fn" href="../../include/x86_64-linux-gnu/sys/resource.h.html#73" title='setrlimit' data-ref="setrlimit64">setrlimit</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/resource.h.html#63" title="RLIMIT_NOFILE" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>,&amp;<a class="local col2 ref" href="#142limit" title='limit' data-ref="142limit">limit</a>) != -<var>1</var>) <b>break</b>;</td></tr>
<tr><th id="1587">1587</th><td>                <a class="local col5 ref" href="#145setrlimit_error" title='setrlimit_error' data-ref="145setrlimit_error">setrlimit_error</a> = <a class="macro" href="../../include/x86_64-linux-gnu/bits/errno.h.html#54" title="(*__errno_location ())" data-ref="_M/errno">errno</a>;</td></tr>
<tr><th id="1588">1588</th><td></td></tr>
<tr><th id="1589">1589</th><td>                <i>/* We failed to set file limit to 'bestlimit'. Try with a</i></td></tr>
<tr><th id="1590">1590</th><td><i>                 * smaller limit decrementing by a few FDs per iteration. */</i></td></tr>
<tr><th id="1591">1591</th><td>                <b>if</b> (<a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> &lt; <a class="local col6 ref" href="#146decr_step" title='decr_step' data-ref="146decr_step">decr_step</a>) <b>break</b>;</td></tr>
<tr><th id="1592">1592</th><td>                <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> -= <a class="local col6 ref" href="#146decr_step" title='decr_step' data-ref="146decr_step">decr_step</a>;</td></tr>
<tr><th id="1593">1593</th><td>            }</td></tr>
<tr><th id="1594">1594</th><td></td></tr>
<tr><th id="1595">1595</th><td>            <i>/* Assume that the limit we get initially is still valid if</i></td></tr>
<tr><th id="1596">1596</th><td><i>             * our last try was even lower. */</i></td></tr>
<tr><th id="1597">1597</th><td>            <b>if</b> (<a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> &lt; <a class="local col3 ref" href="#143oldlimit" title='oldlimit' data-ref="143oldlimit">oldlimit</a>) <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> = <a class="local col3 ref" href="#143oldlimit" title='oldlimit' data-ref="143oldlimit">oldlimit</a>;</td></tr>
<tr><th id="1598">1598</th><td></td></tr>
<tr><th id="1599">1599</th><td>            <b>if</b> (<a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a> &lt; <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>) {</td></tr>
<tr><th id="1600">1600</th><td>                <em>int</em> <dfn class="local col7 decl" id="147old_maxclients" title='old_maxclients' data-type='int' data-ref="147old_maxclients">old_maxclients</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a>;</td></tr>
<tr><th id="1601">1601</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a> = <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a>-<a class="macro" href="redis.h.html#130" title="32" data-ref="_M/REDIS_MIN_RESERVED_FDS">REDIS_MIN_RESERVED_FDS</a>;</td></tr>
<tr><th id="1602">1602</th><td>                <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a> &lt; <var>1</var>) {</td></tr>
<tr><th id="1603">1603</th><td>                    <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Your current 'ulimit -n' "</q></td></tr>
<tr><th id="1604">1604</th><td>                        <q>"of %llu is not enough for Redis to start. "</q></td></tr>
<tr><th id="1605">1605</th><td>                        <q>"Please increase your open file limit to at least "</q></td></tr>
<tr><th id="1606">1606</th><td>                        <q>"%llu. Exiting."</q>,</td></tr>
<tr><th id="1607">1607</th><td>                        (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col3 ref" href="#143oldlimit" title='oldlimit' data-ref="143oldlimit">oldlimit</a>,</td></tr>
<tr><th id="1608">1608</th><td>                        (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>);</td></tr>
<tr><th id="1609">1609</th><td>                    <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="1610">1610</th><td>                }</td></tr>
<tr><th id="1611">1611</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"You requested maxclients of %d "</q></td></tr>
<tr><th id="1612">1612</th><td>                    <q>"requiring at least %llu max file descriptors."</q>,</td></tr>
<tr><th id="1613">1613</th><td>                    <a class="local col7 ref" href="#147old_maxclients" title='old_maxclients' data-ref="147old_maxclients">old_maxclients</a>,</td></tr>
<tr><th id="1614">1614</th><td>                    (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>);</td></tr>
<tr><th id="1615">1615</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Redis can't set maximum open files "</q></td></tr>
<tr><th id="1616">1616</th><td>                    <q>"to %llu because of OS error: %s."</q>,</td></tr>
<tr><th id="1617">1617</th><td>                    (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>, <a class="ref fn" href="../../include/string.h.html#strerror" title='strerror' data-ref="strerror">strerror</a>(<a class="local col5 ref" href="#145setrlimit_error" title='setrlimit_error' data-ref="145setrlimit_error">setrlimit_error</a>));</td></tr>
<tr><th id="1618">1618</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Current maximum open files is %llu. "</q></td></tr>
<tr><th id="1619">1619</th><td>                    <q>"maxclients has been reduced to %d to compensate for "</q></td></tr>
<tr><th id="1620">1620</th><td>                    <q>"low ulimit. "</q></td></tr>
<tr><th id="1621">1621</th><td>                    <q>"If you need higher maxclients increase 'ulimit -n'."</q>,</td></tr>
<tr><th id="1622">1622</th><td>                    (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col4 ref" href="#144bestlimit" title='bestlimit' data-ref="144bestlimit">bestlimit</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a>);</td></tr>
<tr><th id="1623">1623</th><td>            } <b>else</b> {</td></tr>
<tr><th id="1624">1624</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"Increased maximum number of open files "</q></td></tr>
<tr><th id="1625">1625</th><td>                    <q>"to %llu (it was originally set to %llu)."</q>,</td></tr>
<tr><th id="1626">1626</th><td>                    (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col1 ref" href="#141maxfiles" title='maxfiles' data-ref="141maxfiles">maxfiles</a>,</td></tr>
<tr><th id="1627">1627</th><td>                    (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="local col3 ref" href="#143oldlimit" title='oldlimit' data-ref="143oldlimit">oldlimit</a>);</td></tr>
<tr><th id="1628">1628</th><td>            }</td></tr>
<tr><th id="1629">1629</th><td>        }</td></tr>
<tr><th id="1630">1630</th><td>    }</td></tr>
<tr><th id="1631">1631</th><td>}</td></tr>
<tr><th id="1632">1632</th><td></td></tr>
<tr><th id="1633">1633</th><td><i>/* Check that server.tcp_backlog can be actually enforced in Linux according</i></td></tr>
<tr><th id="1634">1634</th><td><i> * to the value of /proc/sys/net/core/somaxconn, or warn about it. */</i></td></tr>
<tr><th id="1635">1635</th><td><em>void</em> <dfn class="decl def fn" id="checkTcpBacklogSettings" title='checkTcpBacklogSettings' data-ref="checkTcpBacklogSettings">checkTcpBacklogSettings</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1636">1636</th><td><u>#<span data-ppcond="1636">ifdef</span> <a class="macro" href="config.h.html#56" data-ref="_M/HAVE_PROC_SOMAXCONN">HAVE_PROC_SOMAXCONN</a></u></td></tr>
<tr><th id="1637">1637</th><td>    <a class="typedef" href="../../include/stdio.h.html#FILE" title='FILE' data-type='struct _IO_FILE' data-ref="FILE">FILE</a> *<dfn class="local col8 decl" id="148fp" title='fp' data-type='FILE *' data-ref="148fp">fp</dfn> = <a class="ref fn" href="../../include/stdio.h.html#283" title='fopen' data-ref="fopen64">fopen</a>(<q>"/proc/sys/net/core/somaxconn"</q>,<q>"r"</q>);</td></tr>
<tr><th id="1638">1638</th><td>    <em>char</em> <dfn class="local col9 decl" id="149buf" title='buf' data-type='char [1024]' data-ref="149buf">buf</dfn>[<var>1024</var>];</td></tr>
<tr><th id="1639">1639</th><td>    <b>if</b> (!<a class="local col8 ref" href="#148fp" title='fp' data-ref="148fp">fp</a>) <b>return</b>;</td></tr>
<tr><th id="1640">1640</th><td>    <b>if</b> (<a class="ref fn" href="../../include/stdio.h.html#fgets" title='fgets' data-ref="fgets">fgets</a>(<a class="local col9 ref" href="#149buf" title='buf' data-ref="149buf">buf</a>,<b>sizeof</b>(<a class="local col9 ref" href="#149buf" title='buf' data-ref="149buf">buf</a>),<a class="local col8 ref" href="#148fp" title='fp' data-ref="148fp">fp</a>) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1641">1641</th><td>        <em>int</em> <dfn class="local col0 decl" id="150somaxconn" title='somaxconn' data-type='int' data-ref="150somaxconn">somaxconn</dfn> = <a class="ref fn" href="../../include/stdlib.h.html#atoi" title='atoi' data-ref="atoi">atoi</a>(<a class="local col9 ref" href="#149buf" title='buf' data-ref="149buf">buf</a>);</td></tr>
<tr><th id="1642">1642</th><td>        <b>if</b> (<a class="local col0 ref" href="#150somaxconn" title='somaxconn' data-ref="150somaxconn">somaxconn</a> &gt; <var>0</var> &amp;&amp; <a class="local col0 ref" href="#150somaxconn" title='somaxconn' data-ref="150somaxconn">somaxconn</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>) {</td></tr>
<tr><th id="1643">1643</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"WARNING: The TCP backlog setting of %d cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of %d."</q>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>, <a class="local col0 ref" href="#150somaxconn" title='somaxconn' data-ref="150somaxconn">somaxconn</a>);</td></tr>
<tr><th id="1644">1644</th><td>        }</td></tr>
<tr><th id="1645">1645</th><td>    }</td></tr>
<tr><th id="1646">1646</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fclose" title='fclose' data-ref="fclose">fclose</a>(<a class="local col8 ref" href="#148fp" title='fp' data-ref="148fp">fp</a>);</td></tr>
<tr><th id="1647">1647</th><td><u>#<span data-ppcond="1636">endif</span></u></td></tr>
<tr><th id="1648">1648</th><td>}</td></tr>
<tr><th id="1649">1649</th><td></td></tr>
<tr><th id="1650">1650</th><td><i>/* Initialize a set of file descriptors to listen to the specified 'port'</i></td></tr>
<tr><th id="1651">1651</th><td><i> * binding the addresses specified in the Redis server configuration.</i></td></tr>
<tr><th id="1652">1652</th><td><i> *</i></td></tr>
<tr><th id="1653">1653</th><td><i> * The listening file descriptors are stored in the integer array 'fds'</i></td></tr>
<tr><th id="1654">1654</th><td><i> * and their number is set in '*count'.</i></td></tr>
<tr><th id="1655">1655</th><td><i> *</i></td></tr>
<tr><th id="1656">1656</th><td><i> * The addresses to bind are specified in the global server.bindaddr array</i></td></tr>
<tr><th id="1657">1657</th><td><i> * and their number is server.bindaddr_count. If the server configuration</i></td></tr>
<tr><th id="1658">1658</th><td><i> * contains no specific addresses to bind, this function will try to</i></td></tr>
<tr><th id="1659">1659</th><td><i> * bind * (all addresses) for both the IPv4 and IPv6 protocols.</i></td></tr>
<tr><th id="1660">1660</th><td><i> *</i></td></tr>
<tr><th id="1661">1661</th><td><i> * On success the function returns REDIS_OK.</i></td></tr>
<tr><th id="1662">1662</th><td><i> *</i></td></tr>
<tr><th id="1663">1663</th><td><i> * On error the function returns REDIS_ERR. For the function to be on</i></td></tr>
<tr><th id="1664">1664</th><td><i> * error, at least one of the server.bindaddr addresses was</i></td></tr>
<tr><th id="1665">1665</th><td><i> * impossible to bind, or no bind addresses were specified in the server</i></td></tr>
<tr><th id="1666">1666</th><td><i> * configuration but the function is not able to bind * for at least</i></td></tr>
<tr><th id="1667">1667</th><td><i> * one of the IPv4 or IPv6 protocols. */</i></td></tr>
<tr><th id="1668">1668</th><td><em>int</em> <dfn class="decl def fn" id="listenToPort" title='listenToPort' data-ref="listenToPort">listenToPort</dfn>(<em>int</em> <dfn class="local col1 decl" id="151port" title='port' data-type='int' data-ref="151port">port</dfn>, <em>int</em> *<dfn class="local col2 decl" id="152fds" title='fds' data-type='int *' data-ref="152fds">fds</dfn>, <em>int</em> *<dfn class="local col3 decl" id="153count" title='count' data-type='int *' data-ref="153count">count</dfn>) {</td></tr>
<tr><th id="1669">1669</th><td>    <em>int</em> <dfn class="local col4 decl" id="154j" title='j' data-type='int' data-ref="154j">j</dfn>;</td></tr>
<tr><th id="1670">1670</th><td></td></tr>
<tr><th id="1671">1671</th><td>    <i>/* Force binding of 0.0.0.0 if no bind address is specified, always</i></td></tr>
<tr><th id="1672">1672</th><td><i>     * entering the loop if j == 0. */</i></td></tr>
<tr><th id="1673">1673</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr_count" title='redisServer::bindaddr_count' data-ref="redisServer::bindaddr_count">bindaddr_count</a> == <var>0</var>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<var>0</var>] = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1674">1674</th><td>    <b>for</b> (<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a> = <var>0</var>; <a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr_count" title='redisServer::bindaddr_count' data-ref="redisServer::bindaddr_count">bindaddr_count</a> || <a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a> == <var>0</var>; <a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>++) {</td></tr>
<tr><th id="1675">1675</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>] == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1676">1676</th><td>            <i>/* Bind * for both IPv6 and IPv4, we enter here only if</i></td></tr>
<tr><th id="1677">1677</th><td><i>             * server.bindaddr_count == 0. */</i></td></tr>
<tr><th id="1678">1678</th><td>            <a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] = <a class="ref fn" href="anet.h.html#anetTcp6Server" title='anetTcp6Server' data-ref="anetTcp6Server">anetTcp6Server</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>,<a class="local col1 ref" href="#151port" title='port' data-ref="151port">port</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="1679">1679</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>);</td></tr>
<tr><th id="1680">1680</th><td>            <b>if</b> (<a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] != <a class="macro" href="anet.h.html#35" title="-1" data-ref="_M/ANET_ERR">ANET_ERR</a>) {</td></tr>
<tr><th id="1681">1681</th><td>                <a class="ref fn" href="anet.h.html#anetNonBlock" title='anetNonBlock' data-ref="anetNonBlock">anetNonBlock</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>]);</td></tr>
<tr><th id="1682">1682</th><td>                (*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>)++;</td></tr>
<tr><th id="1683">1683</th><td>            }</td></tr>
<tr><th id="1684">1684</th><td>            <a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] = <a class="ref fn" href="anet.h.html#anetTcpServer" title='anetTcpServer' data-ref="anetTcpServer">anetTcpServer</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>,<a class="local col1 ref" href="#151port" title='port' data-ref="151port">port</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="1685">1685</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>);</td></tr>
<tr><th id="1686">1686</th><td>            <b>if</b> (<a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] != <a class="macro" href="anet.h.html#35" title="-1" data-ref="_M/ANET_ERR">ANET_ERR</a>) {</td></tr>
<tr><th id="1687">1687</th><td>                <a class="ref fn" href="anet.h.html#anetNonBlock" title='anetNonBlock' data-ref="anetNonBlock">anetNonBlock</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>]);</td></tr>
<tr><th id="1688">1688</th><td>                (*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>)++;</td></tr>
<tr><th id="1689">1689</th><td>            }</td></tr>
<tr><th id="1690">1690</th><td>            <i>/* Exit the loop if we were able to bind * on IPv4 or IPv6,</i></td></tr>
<tr><th id="1691">1691</th><td><i>             * otherwise fds[*count] will be ANET_ERR and we'll print an</i></td></tr>
<tr><th id="1692">1692</th><td><i>             * error and return to the caller with an error. */</i></td></tr>
<tr><th id="1693">1693</th><td>            <b>if</b> (*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>) <b>break</b>;</td></tr>
<tr><th id="1694">1694</th><td>        } <b>else</b> <b>if</b> (<a class="ref fn" href="../../include/string.h.html#strchr" title='strchr' data-ref="strchr">strchr</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>],<kbd>':'</kbd>)) {</td></tr>
<tr><th id="1695">1695</th><td>            <i>/* Bind IPv6 address. */</i></td></tr>
<tr><th id="1696">1696</th><td>            <a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] = <a class="ref fn" href="anet.h.html#anetTcp6Server" title='anetTcp6Server' data-ref="anetTcp6Server">anetTcp6Server</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>,<a class="local col1 ref" href="#151port" title='port' data-ref="151port">port</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>],</td></tr>
<tr><th id="1697">1697</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>);</td></tr>
<tr><th id="1698">1698</th><td>        } <b>else</b> {</td></tr>
<tr><th id="1699">1699</th><td>            <i>/* Bind IPv4 address. */</i></td></tr>
<tr><th id="1700">1700</th><td>            <a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] = <a class="ref fn" href="anet.h.html#anetTcpServer" title='anetTcpServer' data-ref="anetTcpServer">anetTcpServer</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>,<a class="local col1 ref" href="#151port" title='port' data-ref="151port">port</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>],</td></tr>
<tr><th id="1701">1701</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>);</td></tr>
<tr><th id="1702">1702</th><td>        }</td></tr>
<tr><th id="1703">1703</th><td>        <b>if</b> (<a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>] == <a class="macro" href="anet.h.html#35" title="-1" data-ref="_M/ANET_ERR">ANET_ERR</a>) {</td></tr>
<tr><th id="1704">1704</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,</td></tr>
<tr><th id="1705">1705</th><td>                <q>"Creating Server TCP listening socket %s:%d: %s"</q>,</td></tr>
<tr><th id="1706">1706</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>] ? <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<a class="local col4 ref" href="#154j" title='j' data-ref="154j">j</a>] : <q>"*"</q>,</td></tr>
<tr><th id="1707">1707</th><td>                <a class="local col1 ref" href="#151port" title='port' data-ref="151port">port</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>);</td></tr>
<tr><th id="1708">1708</th><td>            <b>return</b> <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>;</td></tr>
<tr><th id="1709">1709</th><td>        }</td></tr>
<tr><th id="1710">1710</th><td>        <a class="ref fn" href="anet.h.html#anetNonBlock" title='anetNonBlock' data-ref="anetNonBlock">anetNonBlock</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<a class="local col2 ref" href="#152fds" title='fds' data-ref="152fds">fds</a>[*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>]);</td></tr>
<tr><th id="1711">1711</th><td>        (*<a class="local col3 ref" href="#153count" title='count' data-ref="153count">count</a>)++;</td></tr>
<tr><th id="1712">1712</th><td>    }</td></tr>
<tr><th id="1713">1713</th><td>    <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="1714">1714</th><td>}</td></tr>
<tr><th id="1715">1715</th><td></td></tr>
<tr><th id="1716">1716</th><td><i>/* Resets the stats that we expose via INFO or other means that we want</i></td></tr>
<tr><th id="1717">1717</th><td><i> * to reset via CONFIG RESETSTAT. The function is also used in order to</i></td></tr>
<tr><th id="1718">1718</th><td><i> * initialize these fields in initServer() at server startup. */</i></td></tr>
<tr><th id="1719">1719</th><td><em>void</em> <dfn class="decl def fn" id="resetServerStats" title='resetServerStats' data-ref="resetServerStats">resetServerStats</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1720">1720</th><td>    <em>int</em> <dfn class="local col5 decl" id="155j" title='j' data-type='int' data-ref="155j">j</dfn>;</td></tr>
<tr><th id="1721">1721</th><td></td></tr>
<tr><th id="1722">1722</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_numcommands" title='redisServer::stat_numcommands' data-ref="redisServer::stat_numcommands">stat_numcommands</a> = <var>0</var>;</td></tr>
<tr><th id="1723">1723</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_numconnections" title='redisServer::stat_numconnections' data-ref="redisServer::stat_numconnections">stat_numconnections</a> = <var>0</var>;</td></tr>
<tr><th id="1724">1724</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_expiredkeys" title='redisServer::stat_expiredkeys' data-ref="redisServer::stat_expiredkeys">stat_expiredkeys</a> = <var>0</var>;</td></tr>
<tr><th id="1725">1725</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_evictedkeys" title='redisServer::stat_evictedkeys' data-ref="redisServer::stat_evictedkeys">stat_evictedkeys</a> = <var>0</var>;</td></tr>
<tr><th id="1726">1726</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_keyspace_misses" title='redisServer::stat_keyspace_misses' data-ref="redisServer::stat_keyspace_misses">stat_keyspace_misses</a> = <var>0</var>;</td></tr>
<tr><th id="1727">1727</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_keyspace_hits" title='redisServer::stat_keyspace_hits' data-ref="redisServer::stat_keyspace_hits">stat_keyspace_hits</a> = <var>0</var>;</td></tr>
<tr><th id="1728">1728</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_fork_time" title='redisServer::stat_fork_time' data-ref="redisServer::stat_fork_time">stat_fork_time</a> = <var>0</var>;</td></tr>
<tr><th id="1729">1729</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_fork_rate" title='redisServer::stat_fork_rate' data-ref="redisServer::stat_fork_rate">stat_fork_rate</a> = <var>0</var>;</td></tr>
<tr><th id="1730">1730</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_rejected_conn" title='redisServer::stat_rejected_conn' data-ref="redisServer::stat_rejected_conn">stat_rejected_conn</a> = <var>0</var>;</td></tr>
<tr><th id="1731">1731</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_sync_full" title='redisServer::stat_sync_full' data-ref="redisServer::stat_sync_full">stat_sync_full</a> = <var>0</var>;</td></tr>
<tr><th id="1732">1732</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_sync_partial_ok" title='redisServer::stat_sync_partial_ok' data-ref="redisServer::stat_sync_partial_ok">stat_sync_partial_ok</a> = <var>0</var>;</td></tr>
<tr><th id="1733">1733</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_sync_partial_err" title='redisServer::stat_sync_partial_err' data-ref="redisServer::stat_sync_partial_err">stat_sync_partial_err</a> = <var>0</var>;</td></tr>
<tr><th id="1734">1734</th><td>    <b>for</b> (<a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a> = <var>0</var>; <a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a> &lt; <a class="macro" href="redis.h.html#144" title="3" data-ref="_M/REDIS_METRIC_COUNT">REDIS_METRIC_COUNT</a>; <a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a>++) {</td></tr>
<tr><th id="1735">1735</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::idx" title='redisServer::(anonymous struct)::idx' data-ref="redisServer::(anonymous)::idx">idx</a> = <var>0</var>;</td></tr>
<tr><th id="1736">1736</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::last_sample_time" title='redisServer::(anonymous struct)::last_sample_time' data-ref="redisServer::(anonymous)::last_sample_time">last_sample_time</a> = <a class="ref fn" href="#mstime" title='mstime' data-ref="mstime">mstime</a>();</td></tr>
<tr><th id="1737">1737</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::last_sample_count" title='redisServer::(anonymous struct)::last_sample_count' data-ref="redisServer::(anonymous)::last_sample_count">last_sample_count</a> = <var>0</var>;</td></tr>
<tr><th id="1738">1738</th><td>        <a class="ref fn" href="../../include/string.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::samples" title='redisServer::(anonymous struct)::samples' data-ref="redisServer::(anonymous)::samples">samples</a>,<var>0</var>,</td></tr>
<tr><th id="1739">1739</th><td>            <b>sizeof</b>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::inst_metric" title='redisServer::inst_metric' data-ref="redisServer::inst_metric">inst_metric</a>[<a class="local col5 ref" href="#155j" title='j' data-ref="155j">j</a>].<a class="ref field" href="redis.h.html#redisServer::(anonymous)::samples" title='redisServer::(anonymous struct)::samples' data-ref="redisServer::(anonymous)::samples">samples</a>));</td></tr>
<tr><th id="1740">1740</th><td>    }</td></tr>
<tr><th id="1741">1741</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_net_input_bytes" title='redisServer::stat_net_input_bytes' data-ref="redisServer::stat_net_input_bytes">stat_net_input_bytes</a> = <var>0</var>;</td></tr>
<tr><th id="1742">1742</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_net_output_bytes" title='redisServer::stat_net_output_bytes' data-ref="redisServer::stat_net_output_bytes">stat_net_output_bytes</a> = <var>0</var>;</td></tr>
<tr><th id="1743">1743</th><td>}</td></tr>
<tr><th id="1744">1744</th><td></td></tr>
<tr><th id="1745">1745</th><td><em>void</em> <dfn class="decl def fn" id="initServer" title='initServer' data-ref="initServer">initServer</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1746">1746</th><td>    <em>int</em> <dfn class="local col6 decl" id="156j" title='j' data-type='int' data-ref="156j">j</dfn>;</td></tr>
<tr><th id="1747">1747</th><td></td></tr>
<tr><th id="1748">1748</th><td>    <a class="ref fn" href="../../include/signal.h.html#signal" title='signal' data-ref="signal">signal</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#32" title="1" data-ref="_M/SIGHUP">SIGHUP</a>, <a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#24" title="((__sighandler_t) 1)" data-ref="_M/SIG_IGN">SIG_IGN</a>);</td></tr>
<tr><th id="1749">1749</th><td>    <a class="ref fn" href="../../include/signal.h.html#signal" title='signal' data-ref="signal">signal</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#45" title="13" data-ref="_M/SIGPIPE">SIGPIPE</a>, <a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#24" title="((__sighandler_t) 1)" data-ref="_M/SIG_IGN">SIG_IGN</a>);</td></tr>
<tr><th id="1750">1750</th><td>    <a class="ref fn" href="#setupSignalHandlers" title='setupSignalHandlers' data-ref="setupSignalHandlers">setupSignalHandlers</a>();</td></tr>
<tr><th id="1751">1751</th><td></td></tr>
<tr><th id="1752">1752</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_enabled" title='redisServer::syslog_enabled' data-ref="redisServer::syslog_enabled">syslog_enabled</a>) {</td></tr>
<tr><th id="1753">1753</th><td>        <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#openlog" title='openlog' data-ref="openlog">openlog</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_ident" title='redisServer::syslog_ident' data-ref="redisServer::syslog_ident">syslog_ident</a>, <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#162" title="0x01" data-ref="_M/LOG_PID">LOG_PID</a> | <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#165" title="0x08" data-ref="_M/LOG_NDELAY">LOG_NDELAY</a> | <a class="macro" href="../../include/x86_64-linux-gnu/sys/syslog.h.html#166" title="0x10" data-ref="_M/LOG_NOWAIT">LOG_NOWAIT</a>,</td></tr>
<tr><th id="1754">1754</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_facility" title='redisServer::syslog_facility' data-ref="redisServer::syslog_facility">syslog_facility</a>);</td></tr>
<tr><th id="1755">1755</th><td>    }</td></tr>
<tr><th id="1756">1756</th><td></td></tr>
<tr><th id="1757">1757</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pid" title='redisServer::pid' data-ref="redisServer::pid">pid</a> = <a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>();</td></tr>
<tr><th id="1758">1758</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::current_client" title='redisServer::current_client' data-ref="redisServer::current_client">current_client</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1759">1759</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1760">1760</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients_to_close" title='redisServer::clients_to_close' data-ref="redisServer::clients_to_close">clients_to_close</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1761">1761</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1762">1762</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::monitors" title='redisServer::monitors' data-ref="redisServer::monitors">monitors</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1763">1763</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaveseldb" title='redisServer::slaveseldb' data-ref="redisServer::slaveseldb">slaveseldb</a> = -<var>1</var>; <i>/* Force to emit the first SELECT command. */</i></td></tr>
<tr><th id="1764">1764</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unblocked_clients" title='redisServer::unblocked_clients' data-ref="redisServer::unblocked_clients">unblocked_clients</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1765">1765</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ready_keys" title='redisServer::ready_keys' data-ref="redisServer::ready_keys">ready_keys</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1766">1766</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients_waiting_acks" title='redisServer::clients_waiting_acks' data-ref="redisServer::clients_waiting_acks">clients_waiting_acks</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1767">1767</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::get_ack_from_slaves" title='redisServer::get_ack_from_slaves' data-ref="redisServer::get_ack_from_slaves">get_ack_from_slaves</a> = <var>0</var>;</td></tr>
<tr><th id="1768">1768</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients_paused" title='redisServer::clients_paused' data-ref="redisServer::clients_paused">clients_paused</a> = <var>0</var>;</td></tr>
<tr><th id="1769">1769</th><td></td></tr>
<tr><th id="1770">1770</th><td>    <a class="ref fn" href="#createSharedObjects" title='createSharedObjects' data-ref="createSharedObjects">createSharedObjects</a>();</td></tr>
<tr><th id="1771">1771</th><td>    <a class="ref fn" href="#adjustOpenFilesLimit" title='adjustOpenFilesLimit' data-ref="adjustOpenFilesLimit">adjustOpenFilesLimit</a>();</td></tr>
<tr><th id="1772">1772</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a> = <a class="ref fn" href="ae.h.html#aeCreateEventLoop" title='aeCreateEventLoop' data-ref="aeCreateEventLoop">aeCreateEventLoop</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxclients" title='redisServer::maxclients' data-ref="redisServer::maxclients">maxclients</a>+<a class="macro" href="redis.h.html#157" title="(32+96)" data-ref="_M/REDIS_EVENTLOOP_FDSET_INCR">REDIS_EVENTLOOP_FDSET_INCR</a>);</td></tr>
<tr><th id="1773">1773</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a> = <a class="ref fn" href="zmalloc.h.html#zmalloc" title='zmalloc' data-ref="zmalloc">zmalloc</a>(<b>sizeof</b>(<a class="typedef" href="redis.h.html#redisDb" title='redisDb' data-type='struct redisDb' data-ref="redisDb">redisDb</a>)*<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>);</td></tr>
<tr><th id="1774">1774</th><td></td></tr>
<tr><th id="1775">1775</th><td>    <i>/* Open the TCP listening socket for the user commands. */</i></td></tr>
<tr><th id="1776">1776</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a> != <var>0</var> &amp;&amp;</td></tr>
<tr><th id="1777">1777</th><td>        <a class="ref fn" href="#listenToPort" title='listenToPort' data-ref="listenToPort">listenToPort</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd" title='redisServer::ipfd' data-ref="redisServer::ipfd">ipfd</a>,&amp;<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd_count" title='redisServer::ipfd_count' data-ref="redisServer::ipfd_count">ipfd_count</a>) == <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>)</td></tr>
<tr><th id="1778">1778</th><td>        <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="1779">1779</th><td></td></tr>
<tr><th id="1780">1780</th><td>    <i>/* Open the listening Unix domain socket. */</i></td></tr>
<tr><th id="1781">1781</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1782">1782</th><td>        <a class="ref fn" href="../../include/unistd.h.html#unlink" title='unlink' data-ref="unlink">unlink</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a>); <i>/* don't care if this fails */</i></td></tr>
<tr><th id="1783">1783</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> = <a class="ref fn" href="anet.h.html#anetUnixServer" title='anetUnixServer' data-ref="anetUnixServer">anetUnixServer</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a>,</td></tr>
<tr><th id="1784">1784</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocketperm" title='redisServer::unixsocketperm' data-ref="redisServer::unixsocketperm">unixsocketperm</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::tcp_backlog" title='redisServer::tcp_backlog' data-ref="redisServer::tcp_backlog">tcp_backlog</a>);</td></tr>
<tr><th id="1785">1785</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> == <a class="macro" href="anet.h.html#35" title="-1" data-ref="_M/ANET_ERR">ANET_ERR</a>) {</td></tr>
<tr><th id="1786">1786</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <q>"Opening Unix socket: %s"</q>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::neterr" title='redisServer::neterr' data-ref="redisServer::neterr">neterr</a>);</td></tr>
<tr><th id="1787">1787</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="1788">1788</th><td>        }</td></tr>
<tr><th id="1789">1789</th><td>        <a class="ref fn" href="anet.h.html#anetNonBlock" title='anetNonBlock' data-ref="anetNonBlock">anetNonBlock</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a>);</td></tr>
<tr><th id="1790">1790</th><td>    }</td></tr>
<tr><th id="1791">1791</th><td></td></tr>
<tr><th id="1792">1792</th><td>    <i>/* Abort if there are no listening sockets at all. */</i></td></tr>
<tr><th id="1793">1793</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd_count" title='redisServer::ipfd_count' data-ref="redisServer::ipfd_count">ipfd_count</a> == <var>0</var> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> &lt; <var>0</var>) {</td></tr>
<tr><th id="1794">1794</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <q>"Configured to not listen anywhere, exiting."</q>);</td></tr>
<tr><th id="1795">1795</th><td>        <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="1796">1796</th><td>    }</td></tr>
<tr><th id="1797">1797</th><td></td></tr>
<tr><th id="1798">1798</th><td>    <i>/* Create the Redis databases, and initialize other internal state. */</i></td></tr>
<tr><th id="1799">1799</th><td>    <b>for</b> (<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a> = <var>0</var>; <a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>; <a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>++) {</td></tr>
<tr><th id="1800">1800</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="redis.h.html#dbDictType" title='dbDictType' data-ref="dbDictType">dbDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1801">1801</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#keyptrDictType" title='keyptrDictType' data-ref="keyptrDictType">keyptrDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1802">1802</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::blocking_keys" title='redisDb::blocking_keys' data-ref="redisDb::blocking_keys">blocking_keys</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#keylistDictType" title='keylistDictType' data-ref="keylistDictType">keylistDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1803">1803</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::ready_keys" title='redisDb::ready_keys' data-ref="redisDb::ready_keys">ready_keys</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="redis.h.html#setDictType" title='setDictType' data-ref="setDictType">setDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1804">1804</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::watched_keys" title='redisDb::watched_keys' data-ref="redisDb::watched_keys">watched_keys</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#keylistDictType" title='keylistDictType' data-ref="keylistDictType">keylistDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1805">1805</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::eviction_pool" title='redisDb::eviction_pool' data-ref="redisDb::eviction_pool">eviction_pool</a> = <a class="ref fn" href="#evictionPoolAlloc" title='evictionPoolAlloc' data-ref="evictionPoolAlloc">evictionPoolAlloc</a>();</td></tr>
<tr><th id="1806">1806</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::id" title='redisDb::id' data-ref="redisDb::id">id</a> = <a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>;</td></tr>
<tr><th id="1807">1807</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>].<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a> = <var>0</var>;</td></tr>
<tr><th id="1808">1808</th><td>    }</td></tr>
<tr><th id="1809">1809</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pubsub_channels" title='redisServer::pubsub_channels' data-ref="redisServer::pubsub_channels">pubsub_channels</a> = <a class="ref fn" href="dict.h.html#dictCreate" title='dictCreate' data-ref="dictCreate">dictCreate</a>(&amp;<a class="ref" href="#keylistDictType" title='keylistDictType' data-ref="keylistDictType">keylistDictType</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1810">1810</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pubsub_patterns" title='redisServer::pubsub_patterns' data-ref="redisServer::pubsub_patterns">pubsub_patterns</a> = <a class="ref fn" href="adlist.h.html#listCreate" title='listCreate' data-ref="listCreate">listCreate</a>();</td></tr>
<tr><th id="1811">1811</th><td>    <a class="macro" href="adlist.h.html#65" title="((server.pubsub_patterns)-&gt;free = (freePubsubPattern))" data-ref="_M/listSetFreeMethod">listSetFreeMethod</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pubsub_patterns" title='redisServer::pubsub_patterns' data-ref="redisServer::pubsub_patterns">pubsub_patterns</a>,<a class="ref fn" href="redis.h.html#freePubsubPattern" title='freePubsubPattern' data-ref="freePubsubPattern">freePubsubPattern</a>);</td></tr>
<tr><th id="1812">1812</th><td>    <a class="macro" href="adlist.h.html#66" title="((server.pubsub_patterns)-&gt;match = (listMatchPubsubPattern))" data-ref="_M/listSetMatchMethod">listSetMatchMethod</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pubsub_patterns" title='redisServer::pubsub_patterns' data-ref="redisServer::pubsub_patterns">pubsub_patterns</a>,<a class="ref fn" href="redis.h.html#listMatchPubsubPattern" title='listMatchPubsubPattern' data-ref="listMatchPubsubPattern">listMatchPubsubPattern</a>);</td></tr>
<tr><th id="1813">1813</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cronloops" title='redisServer::cronloops' data-ref="redisServer::cronloops">cronloops</a> = <var>0</var>;</td></tr>
<tr><th id="1814">1814</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> = -<var>1</var>;</td></tr>
<tr><th id="1815">1815</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> = -<var>1</var>;</td></tr>
<tr><th id="1816">1816</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_type" title='redisServer::rdb_child_type' data-ref="redisServer::rdb_child_type">rdb_child_type</a> = <a class="macro" href="redis.h.html#371" title="0" data-ref="_M/REDIS_RDB_CHILD_TYPE_NONE">REDIS_RDB_CHILD_TYPE_NONE</a>;</td></tr>
<tr><th id="1817">1817</th><td>    <a class="ref fn" href="redis.h.html#aofRewriteBufferReset" title='aofRewriteBufferReset' data-ref="aofRewriteBufferReset">aofRewriteBufferReset</a>();</td></tr>
<tr><th id="1818">1818</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_buf" title='redisServer::aof_buf' data-ref="redisServer::aof_buf">aof_buf</a> = <a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>();</td></tr>
<tr><th id="1819">1819</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastsave" title='redisServer::lastsave' data-ref="redisServer::lastsave">lastsave</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>); <i>/* At startup we consider the DB saved. */</i></td></tr>
<tr><th id="1820">1820</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastbgsave_try" title='redisServer::lastbgsave_try' data-ref="redisServer::lastbgsave_try">lastbgsave_try</a> = <var>0</var>;    <i>/* At startup we never tried to BGSAVE. */</i></td></tr>
<tr><th id="1821">1821</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_save_time_last" title='redisServer::rdb_save_time_last' data-ref="redisServer::rdb_save_time_last">rdb_save_time_last</a> = -<var>1</var>;</td></tr>
<tr><th id="1822">1822</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_save_time_start" title='redisServer::rdb_save_time_start' data-ref="redisServer::rdb_save_time_start">rdb_save_time_start</a> = -<var>1</var>;</td></tr>
<tr><th id="1823">1823</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dirty" title='redisServer::dirty' data-ref="redisServer::dirty">dirty</a> = <var>0</var>;</td></tr>
<tr><th id="1824">1824</th><td>    <a class="ref fn" href="#resetServerStats" title='resetServerStats' data-ref="resetServerStats">resetServerStats</a>();</td></tr>
<tr><th id="1825">1825</th><td>    <i>/* A few stats we don't want to reset: server startup time, and peak mem. */</i></td></tr>
<tr><th id="1826">1826</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_starttime" title='redisServer::stat_starttime' data-ref="redisServer::stat_starttime">stat_starttime</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1827">1827</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a> = <var>0</var>;</td></tr>
<tr><th id="1828">1828</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::resident_set_size" title='redisServer::resident_set_size' data-ref="redisServer::resident_set_size">resident_set_size</a> = <var>0</var>;</td></tr>
<tr><th id="1829">1829</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastbgsave_status" title='redisServer::lastbgsave_status' data-ref="redisServer::lastbgsave_status">lastbgsave_status</a> = <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="1830">1830</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_status" title='redisServer::aof_last_write_status' data-ref="redisServer::aof_last_write_status">aof_last_write_status</a> = <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="1831">1831</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_errno" title='redisServer::aof_last_write_errno' data-ref="redisServer::aof_last_write_errno">aof_last_write_errno</a> = <var>0</var>;</td></tr>
<tr><th id="1832">1832</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_good_slaves_count" title='redisServer::repl_good_slaves_count' data-ref="redisServer::repl_good_slaves_count">repl_good_slaves_count</a> = <var>0</var>;</td></tr>
<tr><th id="1833">1833</th><td>    <a class="ref fn" href="#updateCachedTime" title='updateCachedTime' data-ref="updateCachedTime">updateCachedTime</a>();</td></tr>
<tr><th id="1834">1834</th><td></td></tr>
<tr><th id="1835">1835</th><td>    <i>/* Create the serverCron() time event, that's our main way to process</i></td></tr>
<tr><th id="1836">1836</th><td><i>     * background operations. */</i></td></tr>
<tr><th id="1837">1837</th><td>    <b>if</b>(<a class="ref fn" href="ae.h.html#aeCreateTimeEvent" title='aeCreateTimeEvent' data-ref="aeCreateTimeEvent">aeCreateTimeEvent</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a>, <var>1</var>, <a class="ref fn" href="#serverCron" title='serverCron' data-ref="serverCron">serverCron</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) == <a class="macro" href="ae.h.html#37" title="-1" data-ref="_M/AE_ERR">AE_ERR</a>) {</td></tr>
<tr><th id="1838">1838</th><td>        <a class="macro" href="redis.h.html#400" title="_redisPanic(&quot;\&quot;Can&apos;t create the serverCron time event.\&quot;&quot;,&quot;/vagrant/data/redis-v3.0.0/src/redis.c&quot;,1838),_exit(1)" data-ref="_M/redisPanic">redisPanic</a>(<q>"Can't create the serverCron time event."</q>);</td></tr>
<tr><th id="1839">1839</th><td>        <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="1840">1840</th><td>    }</td></tr>
<tr><th id="1841">1841</th><td></td></tr>
<tr><th id="1842">1842</th><td>    <i>/* Create an event handler for accepting new connections in TCP and Unix</i></td></tr>
<tr><th id="1843">1843</th><td><i>     * domain sockets. */</i></td></tr>
<tr><th id="1844">1844</th><td>    <b>for</b> (<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a> = <var>0</var>; <a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd_count" title='redisServer::ipfd_count' data-ref="redisServer::ipfd_count">ipfd_count</a>; <a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>++) {</td></tr>
<tr><th id="1845">1845</th><td>        <b>if</b> (<a class="ref fn" href="ae.h.html#aeCreateFileEvent" title='aeCreateFileEvent' data-ref="aeCreateFileEvent">aeCreateFileEvent</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd" title='redisServer::ipfd' data-ref="redisServer::ipfd">ipfd</a>[<a class="local col6 ref" href="#156j" title='j' data-ref="156j">j</a>], <a class="macro" href="ae.h.html#40" title="1" data-ref="_M/AE_READABLE">AE_READABLE</a>,</td></tr>
<tr><th id="1846">1846</th><td>            <a class="ref fn" href="redis.h.html#acceptTcpHandler" title='acceptTcpHandler' data-ref="acceptTcpHandler">acceptTcpHandler</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) == <a class="macro" href="ae.h.html#37" title="-1" data-ref="_M/AE_ERR">AE_ERR</a>)</td></tr>
<tr><th id="1847">1847</th><td>            {</td></tr>
<tr><th id="1848">1848</th><td>                <a class="macro" href="redis.h.html#400" title="_redisPanic(&quot;\&quot;Unrecoverable error creating server.ipfd file event.\&quot;&quot;,&quot;/vagrant/data/redis-v3.0.0/src/redis.c&quot;,1849),_exit(1)" data-ref="_M/redisPanic">redisPanic</a>(</td></tr>
<tr><th id="1849">1849</th><td>                    <q>"Unrecoverable error creating server.ipfd file event."</q>);</td></tr>
<tr><th id="1850">1850</th><td>            }</td></tr>
<tr><th id="1851">1851</th><td>    }</td></tr>
<tr><th id="1852">1852</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> &gt; <var>0</var> &amp;&amp; <a class="ref fn" href="ae.h.html#aeCreateFileEvent" title='aeCreateFileEvent' data-ref="aeCreateFileEvent">aeCreateFileEvent</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a>,<a class="macro" href="ae.h.html#40" title="1" data-ref="_M/AE_READABLE">AE_READABLE</a>,</td></tr>
<tr><th id="1853">1853</th><td>        <a class="ref fn" href="redis.h.html#acceptUnixHandler" title='acceptUnixHandler' data-ref="acceptUnixHandler">acceptUnixHandler</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) == <a class="macro" href="ae.h.html#37" title="-1" data-ref="_M/AE_ERR">AE_ERR</a>) <a class="macro" href="redis.h.html#400" title="_redisPanic(&quot;\&quot;Unrecoverable error creating server.sofd file event.\&quot;&quot;,&quot;/vagrant/data/redis-v3.0.0/src/redis.c&quot;,1853),_exit(1)" data-ref="_M/redisPanic">redisPanic</a>(<q>"Unrecoverable error creating server.sofd file event."</q>);</td></tr>
<tr><th id="1854">1854</th><td></td></tr>
<tr><th id="1855">1855</th><td>    <i>/* Open the AOF file if needed. */</i></td></tr>
<tr><th id="1856">1856</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> == <a class="macro" href="redis.h.html#228" title="1" data-ref="_M/REDIS_AOF_ON">REDIS_AOF_ON</a>) {</td></tr>
<tr><th id="1857">1857</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_fd" title='redisServer::aof_fd' data-ref="redisServer::aof_fd">aof_fd</a> = <a class="ref fn" href="../../include/fcntl.h.html#159" title='open' data-ref="open64">open</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_filename" title='redisServer::aof_filename' data-ref="redisServer::aof_filename">aof_filename</a>,</td></tr>
<tr><th id="1858">1858</th><td>                               <a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#44" title="01" data-ref="_M/O_WRONLY">O_WRONLY</a>|<a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#59" title="02000" data-ref="_M/O_APPEND">O_APPEND</a>|<a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#47" title="0100" data-ref="_M/O_CREAT">O_CREAT</a>,<var>0644</var>);</td></tr>
<tr><th id="1859">1859</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_fd" title='redisServer::aof_fd' data-ref="redisServer::aof_fd">aof_fd</a> == -<var>1</var>) {</td></tr>
<tr><th id="1860">1860</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <q>"Can't open the append-only file: %s"</q>,</td></tr>
<tr><th id="1861">1861</th><td>                <a class="ref fn" href="../../include/string.h.html#strerror" title='strerror' data-ref="strerror">strerror</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/errno.h.html#54" title="(*__errno_location ())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="1862">1862</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="1863">1863</th><td>        }</td></tr>
<tr><th id="1864">1864</th><td>    }</td></tr>
<tr><th id="1865">1865</th><td></td></tr>
<tr><th id="1866">1866</th><td>    <i>/* 32 bit instances are limited to 4GB of address space, so if there is</i></td></tr>
<tr><th id="1867">1867</th><td><i>     * no explicit limit in the user provided configuration we set a limit</i></td></tr>
<tr><th id="1868">1868</th><td><i>     * at 3 GB using maxmemory with 'noeviction' policy'. This avoids</i></td></tr>
<tr><th id="1869">1869</th><td><i>     * useless crashes of the Redis instance for out of memory. */</i></td></tr>
<tr><th id="1870">1870</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::arch_bits" title='redisServer::arch_bits' data-ref="redisServer::arch_bits">arch_bits</a> == <var>32</var> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a> == <var>0</var>) {</td></tr>
<tr><th id="1871">1871</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Warning: 32 bit instance detected but no memory limit set. Setting 3 GB maxmemory limit with 'noeviction' policy now."</q>);</td></tr>
<tr><th id="1872">1872</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a> = <var>3072LL</var>*(<var>1024</var>*<var>1024</var>); <i>/* 3 GB */</i></td></tr>
<tr><th id="1873">1873</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> = <a class="macro" href="redis.h.html#343" title="5" data-ref="_M/REDIS_MAXMEMORY_NO_EVICTION">REDIS_MAXMEMORY_NO_EVICTION</a>;</td></tr>
<tr><th id="1874">1874</th><td>    }</td></tr>
<tr><th id="1875">1875</th><td></td></tr>
<tr><th id="1876">1876</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) <a class="ref fn" href="redis.h.html#clusterInit" title='clusterInit' data-ref="clusterInit">clusterInit</a>();</td></tr>
<tr><th id="1877">1877</th><td>    <a class="ref fn" href="redis.h.html#replicationScriptCacheInit" title='replicationScriptCacheInit' data-ref="replicationScriptCacheInit">replicationScriptCacheInit</a>();</td></tr>
<tr><th id="1878">1878</th><td>    <a class="ref fn" href="redis.h.html#scriptingInit" title='scriptingInit' data-ref="scriptingInit">scriptingInit</a>();</td></tr>
<tr><th id="1879">1879</th><td>    <a class="ref fn" href="slowlog.h.html#slowlogInit" title='slowlogInit' data-ref="slowlogInit">slowlogInit</a>();</td></tr>
<tr><th id="1880">1880</th><td>    <a class="ref fn" href="latency.h.html#latencyMonitorInit" title='latencyMonitorInit' data-ref="latencyMonitorInit">latencyMonitorInit</a>();</td></tr>
<tr><th id="1881">1881</th><td>    <a class="ref fn" href="bio.h.html#bioInit" title='bioInit' data-ref="bioInit">bioInit</a>();</td></tr>
<tr><th id="1882">1882</th><td>}</td></tr>
<tr><th id="1883">1883</th><td></td></tr>
<tr><th id="1884">1884</th><td><i>/* Populates the Redis Command Table starting from the hard coded list</i></td></tr>
<tr><th id="1885">1885</th><td><i> * we have on top of redis.c file. */</i></td></tr>
<tr><th id="1886">1886</th><td><em>void</em> <dfn class="decl def fn" id="populateCommandTable" title='populateCommandTable' data-ref="populateCommandTable">populateCommandTable</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1887">1887</th><td>    <em>int</em> <dfn class="local col7 decl" id="157j" title='j' data-type='int' data-ref="157j">j</dfn>;</td></tr>
<tr><th id="1888">1888</th><td>    <em>int</em> <dfn class="local col8 decl" id="158numcommands" title='numcommands' data-type='int' data-ref="158numcommands">numcommands</dfn> = <b>sizeof</b>(<a class="ref" href="#redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</a>)/<b>sizeof</b>(<b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a>);</td></tr>
<tr><th id="1889">1889</th><td></td></tr>
<tr><th id="1890">1890</th><td>    <b>for</b> (<a class="local col7 ref" href="#157j" title='j' data-ref="157j">j</a> = <var>0</var>; <a class="local col7 ref" href="#157j" title='j' data-ref="157j">j</a> &lt; <a class="local col8 ref" href="#158numcommands" title='numcommands' data-ref="158numcommands">numcommands</a>; <a class="local col7 ref" href="#157j" title='j' data-ref="157j">j</a>++) {</td></tr>
<tr><th id="1891">1891</th><td>        <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col9 decl" id="159c" title='c' data-type='struct redisCommand *' data-ref="159c">c</dfn> = <a class="ref" href="#redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</a>+<a class="local col7 ref" href="#157j" title='j' data-ref="157j">j</a>;</td></tr>
<tr><th id="1892">1892</th><td>        <em>char</em> *<dfn class="local col0 decl" id="160f" title='f' data-type='char *' data-ref="160f">f</dfn> = <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::sflags" title='redisCommand::sflags' data-ref="redisCommand::sflags">sflags</a>;</td></tr>
<tr><th id="1893">1893</th><td>        <em>int</em> <dfn class="local col1 decl" id="161retval1" title='retval1' data-type='int' data-ref="161retval1">retval1</dfn>, <dfn class="local col2 decl" id="162retval2" title='retval2' data-type='int' data-ref="162retval2">retval2</dfn>;</td></tr>
<tr><th id="1894">1894</th><td></td></tr>
<tr><th id="1895">1895</th><td>        <b>while</b>(*<a class="local col0 ref" href="#160f" title='f' data-ref="160f">f</a> != <kbd>'\0'</kbd>) {</td></tr>
<tr><th id="1896">1896</th><td>            <b>switch</b>(*<a class="local col0 ref" href="#160f" title='f' data-ref="160f">f</a>) {</td></tr>
<tr><th id="1897">1897</th><td>            <b>case</b> <kbd>'w'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#164" title="1" data-ref="_M/REDIS_CMD_WRITE">REDIS_CMD_WRITE</a>; <b>break</b>;</td></tr>
<tr><th id="1898">1898</th><td>            <b>case</b> <kbd>'r'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#165" title="2" data-ref="_M/REDIS_CMD_READONLY">REDIS_CMD_READONLY</a>; <b>break</b>;</td></tr>
<tr><th id="1899">1899</th><td>            <b>case</b> <kbd>'m'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#166" title="4" data-ref="_M/REDIS_CMD_DENYOOM">REDIS_CMD_DENYOOM</a>; <b>break</b>;</td></tr>
<tr><th id="1900">1900</th><td>            <b>case</b> <kbd>'a'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#168" title="16" data-ref="_M/REDIS_CMD_ADMIN">REDIS_CMD_ADMIN</a>; <b>break</b>;</td></tr>
<tr><th id="1901">1901</th><td>            <b>case</b> <kbd>'p'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#169" title="32" data-ref="_M/REDIS_CMD_PUBSUB">REDIS_CMD_PUBSUB</a>; <b>break</b>;</td></tr>
<tr><th id="1902">1902</th><td>            <b>case</b> <kbd>'s'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#170" title="64" data-ref="_M/REDIS_CMD_NOSCRIPT">REDIS_CMD_NOSCRIPT</a>; <b>break</b>;</td></tr>
<tr><th id="1903">1903</th><td>            <b>case</b> <kbd>'R'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#171" title="128" data-ref="_M/REDIS_CMD_RANDOM">REDIS_CMD_RANDOM</a>; <b>break</b>;</td></tr>
<tr><th id="1904">1904</th><td>            <b>case</b> <kbd>'S'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#172" title="256" data-ref="_M/REDIS_CMD_SORT_FOR_SCRIPT">REDIS_CMD_SORT_FOR_SCRIPT</a>; <b>break</b>;</td></tr>
<tr><th id="1905">1905</th><td>            <b>case</b> <kbd>'l'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#173" title="512" data-ref="_M/REDIS_CMD_LOADING">REDIS_CMD_LOADING</a>; <b>break</b>;</td></tr>
<tr><th id="1906">1906</th><td>            <b>case</b> <kbd>'t'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#174" title="1024" data-ref="_M/REDIS_CMD_STALE">REDIS_CMD_STALE</a>; <b>break</b>;</td></tr>
<tr><th id="1907">1907</th><td>            <b>case</b> <kbd>'M'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#175" title="2048" data-ref="_M/REDIS_CMD_SKIP_MONITOR">REDIS_CMD_SKIP_MONITOR</a>; <b>break</b>;</td></tr>
<tr><th id="1908">1908</th><td>            <b>case</b> <kbd>'k'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#176" title="4096" data-ref="_M/REDIS_CMD_ASKING">REDIS_CMD_ASKING</a>; <b>break</b>;</td></tr>
<tr><th id="1909">1909</th><td>            <b>case</b> <kbd>'F'</kbd>: <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> |= <a class="macro" href="redis.h.html#177" title="8192" data-ref="_M/REDIS_CMD_FAST">REDIS_CMD_FAST</a>; <b>break</b>;</td></tr>
<tr><th id="1910">1910</th><td>            <b>default</b>: <a class="macro" href="redis.h.html#400" title="_redisPanic(&quot;\&quot;Unsupported command flag\&quot;&quot;,&quot;/vagrant/data/redis-v3.0.0/src/redis.c&quot;,1910),_exit(1)" data-ref="_M/redisPanic">redisPanic</a>(<q>"Unsupported command flag"</q>); <b>break</b>;</td></tr>
<tr><th id="1911">1911</th><td>            }</td></tr>
<tr><th id="1912">1912</th><td>            <a class="local col0 ref" href="#160f" title='f' data-ref="160f">f</a>++;</td></tr>
<tr><th id="1913">1913</th><td>        }</td></tr>
<tr><th id="1914">1914</th><td></td></tr>
<tr><th id="1915">1915</th><td>        <a class="local col1 ref" href="#161retval1" title='retval1' data-ref="161retval1">retval1</a> = <a class="ref fn" href="dict.h.html#dictAdd" title='dictAdd' data-ref="dictAdd">dictAdd</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>, <a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::name" title='redisCommand::name' data-ref="redisCommand::name">name</a>), <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>);</td></tr>
<tr><th id="1916">1916</th><td>        <i>/* Populate an additional dictionary that will be unaffected</i></td></tr>
<tr><th id="1917">1917</th><td><i>         * by rename-command statements in redis.conf. */</i></td></tr>
<tr><th id="1918">1918</th><td>        <a class="local col2 ref" href="#162retval2" title='retval2' data-ref="162retval2">retval2</a> = <a class="ref fn" href="dict.h.html#dictAdd" title='dictAdd' data-ref="dictAdd">dictAdd</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::orig_commands" title='redisServer::orig_commands' data-ref="redisServer::orig_commands">orig_commands</a>, <a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::name" title='redisCommand::name' data-ref="redisCommand::name">name</a>), <a class="local col9 ref" href="#159c" title='c' data-ref="159c">c</a>);</td></tr>
<tr><th id="1919">1919</th><td>        <a class="macro" href="redis.h.html#399" title="((retval1 == 0 &amp;&amp; retval2 == 0)?(void)0 : (_redisAssert(&quot;retval1 == DICT_OK &amp;&amp; retval2 == DICT_OK&quot;,&quot;/vagrant/data/redis-v3.0.0/src/redis.c&quot;,1919),_exit(1)))" data-ref="_M/redisAssert">redisAssert</a>(<a class="local col1 ref" href="#161retval1" title='retval1' data-ref="161retval1">retval1</a> == <a class="macro" href="dict.h.html#41" title="0" data-ref="_M/DICT_OK">DICT_OK</a> &amp;&amp; <a class="local col2 ref" href="#162retval2" title='retval2' data-ref="162retval2">retval2</a> == <a class="macro" href="dict.h.html#41" title="0" data-ref="_M/DICT_OK">DICT_OK</a>);</td></tr>
<tr><th id="1920">1920</th><td>    }</td></tr>
<tr><th id="1921">1921</th><td>}</td></tr>
<tr><th id="1922">1922</th><td></td></tr>
<tr><th id="1923">1923</th><td><em>void</em> <dfn class="decl def fn" id="resetCommandTableStats" title='resetCommandTableStats' data-ref="resetCommandTableStats">resetCommandTableStats</dfn>(<em>void</em>) {</td></tr>
<tr><th id="1924">1924</th><td>    <em>int</em> <dfn class="local col3 decl" id="163numcommands" title='numcommands' data-type='int' data-ref="163numcommands">numcommands</dfn> = <b>sizeof</b>(<a class="ref" href="#redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</a>)/<b>sizeof</b>(<b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a>);</td></tr>
<tr><th id="1925">1925</th><td>    <em>int</em> <dfn class="local col4 decl" id="164j" title='j' data-type='int' data-ref="164j">j</dfn>;</td></tr>
<tr><th id="1926">1926</th><td></td></tr>
<tr><th id="1927">1927</th><td>    <b>for</b> (<a class="local col4 ref" href="#164j" title='j' data-ref="164j">j</a> = <var>0</var>; <a class="local col4 ref" href="#164j" title='j' data-ref="164j">j</a> &lt; <a class="local col3 ref" href="#163numcommands" title='numcommands' data-ref="163numcommands">numcommands</a>; <a class="local col4 ref" href="#164j" title='j' data-ref="164j">j</a>++) {</td></tr>
<tr><th id="1928">1928</th><td>        <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col5 decl" id="165c" title='c' data-type='struct redisCommand *' data-ref="165c">c</dfn> = <a class="ref" href="#redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</a>+<a class="local col4 ref" href="#164j" title='j' data-ref="164j">j</a>;</td></tr>
<tr><th id="1929">1929</th><td></td></tr>
<tr><th id="1930">1930</th><td>        <a class="local col5 ref" href="#165c" title='c' data-ref="165c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::microseconds" title='redisCommand::microseconds' data-ref="redisCommand::microseconds">microseconds</a> = <var>0</var>;</td></tr>
<tr><th id="1931">1931</th><td>        <a class="local col5 ref" href="#165c" title='c' data-ref="165c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::calls" title='redisCommand::calls' data-ref="redisCommand::calls">calls</a> = <var>0</var>;</td></tr>
<tr><th id="1932">1932</th><td>    }</td></tr>
<tr><th id="1933">1933</th><td>}</td></tr>
<tr><th id="1934">1934</th><td></td></tr>
<tr><th id="1935">1935</th><td><i>/* ========================== Redis OP Array API ============================ */</i></td></tr>
<tr><th id="1936">1936</th><td></td></tr>
<tr><th id="1937">1937</th><td><em>void</em> <dfn class="decl def fn" id="redisOpArrayInit" title='redisOpArrayInit' data-ref="redisOpArrayInit">redisOpArrayInit</dfn>(<a class="typedef" href="redis.h.html#redisOpArray" title='redisOpArray' data-type='struct redisOpArray' data-ref="redisOpArray">redisOpArray</a> *<dfn class="local col6 decl" id="166oa" title='oa' data-type='redisOpArray *' data-ref="166oa">oa</dfn>) {</td></tr>
<tr><th id="1938">1938</th><td>    <a class="local col6 ref" href="#166oa" title='oa' data-ref="166oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1939">1939</th><td>    <a class="local col6 ref" href="#166oa" title='oa' data-ref="166oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a> = <var>0</var>;</td></tr>
<tr><th id="1940">1940</th><td>}</td></tr>
<tr><th id="1941">1941</th><td></td></tr>
<tr><th id="1942">1942</th><td><em>int</em> <dfn class="decl def fn" id="redisOpArrayAppend" title='redisOpArrayAppend' data-ref="redisOpArrayAppend">redisOpArrayAppend</dfn>(<a class="typedef" href="redis.h.html#redisOpArray" title='redisOpArray' data-type='struct redisOpArray' data-ref="redisOpArray">redisOpArray</a> *<dfn class="local col7 decl" id="167oa" title='oa' data-type='redisOpArray *' data-ref="167oa">oa</dfn>, <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col8 decl" id="168cmd" title='cmd' data-type='struct redisCommand *' data-ref="168cmd">cmd</dfn>, <em>int</em> <dfn class="local col9 decl" id="169dbid" title='dbid' data-type='int' data-ref="169dbid">dbid</dfn>,</td></tr>
<tr><th id="1943">1943</th><td>                       <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> **<dfn class="local col0 decl" id="170argv" title='argv' data-type='robj **' data-ref="170argv">argv</dfn>, <em>int</em> <dfn class="local col1 decl" id="171argc" title='argc' data-type='int' data-ref="171argc">argc</dfn>, <em>int</em> <dfn class="local col2 decl" id="172target" title='target' data-type='int' data-ref="172target">target</dfn>)</td></tr>
<tr><th id="1944">1944</th><td>{</td></tr>
<tr><th id="1945">1945</th><td>    <a class="typedef" href="redis.h.html#redisOp" title='redisOp' data-type='struct redisOp' data-ref="redisOp">redisOp</a> *<dfn class="local col3 decl" id="173op" title='op' data-type='redisOp *' data-ref="173op">op</dfn>;</td></tr>
<tr><th id="1946">1946</th><td></td></tr>
<tr><th id="1947">1947</th><td>    <a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a> = <a class="ref fn" href="zmalloc.h.html#zrealloc" title='zrealloc' data-ref="zrealloc">zrealloc</a>(<a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a>,<b>sizeof</b>(<a class="typedef" href="redis.h.html#redisOp" title='redisOp' data-type='struct redisOp' data-ref="redisOp">redisOp</a>)*(<a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>+<var>1</var>));</td></tr>
<tr><th id="1948">1948</th><td>    <a class="local col3 ref" href="#173op" title='op' data-ref="173op">op</a> = <a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a>+<a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>;</td></tr>
<tr><th id="1949">1949</th><td>    <a class="local col3 ref" href="#173op" title='op' data-ref="173op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::cmd" title='redisOp::cmd' data-ref="redisOp::cmd">cmd</a> = <a class="local col8 ref" href="#168cmd" title='cmd' data-ref="168cmd">cmd</a>;</td></tr>
<tr><th id="1950">1950</th><td>    <a class="local col3 ref" href="#173op" title='op' data-ref="173op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::dbid" title='redisOp::dbid' data-ref="redisOp::dbid">dbid</a> = <a class="local col9 ref" href="#169dbid" title='dbid' data-ref="169dbid">dbid</a>;</td></tr>
<tr><th id="1951">1951</th><td>    <a class="local col3 ref" href="#173op" title='op' data-ref="173op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argv" title='redisOp::argv' data-ref="redisOp::argv">argv</a> = <a class="local col0 ref" href="#170argv" title='argv' data-ref="170argv">argv</a>;</td></tr>
<tr><th id="1952">1952</th><td>    <a class="local col3 ref" href="#173op" title='op' data-ref="173op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argc" title='redisOp::argc' data-ref="redisOp::argc">argc</a> = <a class="local col1 ref" href="#171argc" title='argc' data-ref="171argc">argc</a>;</td></tr>
<tr><th id="1953">1953</th><td>    <a class="local col3 ref" href="#173op" title='op' data-ref="173op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::target" title='redisOp::target' data-ref="redisOp::target">target</a> = <a class="local col2 ref" href="#172target" title='target' data-ref="172target">target</a>;</td></tr>
<tr><th id="1954">1954</th><td>    <a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>++;</td></tr>
<tr><th id="1955">1955</th><td>    <b>return</b> <a class="local col7 ref" href="#167oa" title='oa' data-ref="167oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>;</td></tr>
<tr><th id="1956">1956</th><td>}</td></tr>
<tr><th id="1957">1957</th><td></td></tr>
<tr><th id="1958">1958</th><td><em>void</em> <dfn class="decl def fn" id="redisOpArrayFree" title='redisOpArrayFree' data-ref="redisOpArrayFree">redisOpArrayFree</dfn>(<a class="typedef" href="redis.h.html#redisOpArray" title='redisOpArray' data-type='struct redisOpArray' data-ref="redisOpArray">redisOpArray</a> *<dfn class="local col4 decl" id="174oa" title='oa' data-type='redisOpArray *' data-ref="174oa">oa</dfn>) {</td></tr>
<tr><th id="1959">1959</th><td>    <b>while</b>(<a class="local col4 ref" href="#174oa" title='oa' data-ref="174oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>) {</td></tr>
<tr><th id="1960">1960</th><td>        <em>int</em> <dfn class="local col5 decl" id="175j" title='j' data-type='int' data-ref="175j">j</dfn>;</td></tr>
<tr><th id="1961">1961</th><td>        <a class="typedef" href="redis.h.html#redisOp" title='redisOp' data-type='struct redisOp' data-ref="redisOp">redisOp</a> *<dfn class="local col6 decl" id="176op" title='op' data-type='redisOp *' data-ref="176op">op</dfn>;</td></tr>
<tr><th id="1962">1962</th><td></td></tr>
<tr><th id="1963">1963</th><td>        <a class="local col4 ref" href="#174oa" title='oa' data-ref="174oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>--;</td></tr>
<tr><th id="1964">1964</th><td>        <a class="local col6 ref" href="#176op" title='op' data-ref="176op">op</a> = <a class="local col4 ref" href="#174oa" title='oa' data-ref="174oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a>+<a class="local col4 ref" href="#174oa" title='oa' data-ref="174oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>;</td></tr>
<tr><th id="1965">1965</th><td>        <b>for</b> (<a class="local col5 ref" href="#175j" title='j' data-ref="175j">j</a> = <var>0</var>; <a class="local col5 ref" href="#175j" title='j' data-ref="175j">j</a> &lt; <a class="local col6 ref" href="#176op" title='op' data-ref="176op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argc" title='redisOp::argc' data-ref="redisOp::argc">argc</a>; <a class="local col5 ref" href="#175j" title='j' data-ref="175j">j</a>++)</td></tr>
<tr><th id="1966">1966</th><td>            <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col6 ref" href="#176op" title='op' data-ref="176op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argv" title='redisOp::argv' data-ref="redisOp::argv">argv</a>[<a class="local col5 ref" href="#175j" title='j' data-ref="175j">j</a>]);</td></tr>
<tr><th id="1967">1967</th><td>        <a class="ref fn" href="zmalloc.h.html#zfree" title='zfree' data-ref="zfree">zfree</a>(<a class="local col6 ref" href="#176op" title='op' data-ref="176op">op</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argv" title='redisOp::argv' data-ref="redisOp::argv">argv</a>);</td></tr>
<tr><th id="1968">1968</th><td>    }</td></tr>
<tr><th id="1969">1969</th><td>    <a class="ref fn" href="zmalloc.h.html#zfree" title='zfree' data-ref="zfree">zfree</a>(<a class="local col4 ref" href="#174oa" title='oa' data-ref="174oa">oa</a>-&gt;<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a>);</td></tr>
<tr><th id="1970">1970</th><td>}</td></tr>
<tr><th id="1971">1971</th><td></td></tr>
<tr><th id="1972">1972</th><td><i>/* ====================== Commands lookup and execution ===================== */</i></td></tr>
<tr><th id="1973">1973</th><td></td></tr>
<tr><th id="1974">1974</th><td><b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="decl def fn" id="lookupCommand" title='lookupCommand' data-ref="lookupCommand">lookupCommand</dfn>(<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col7 decl" id="177name" title='name' data-type='sds' data-ref="177name">name</dfn>) {</td></tr>
<tr><th id="1975">1975</th><td>    <b>return</b> <a class="ref fn" href="dict.h.html#dictFetchValue" title='dictFetchValue' data-ref="dictFetchValue">dictFetchValue</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>, <a class="local col7 ref" href="#177name" title='name' data-ref="177name">name</a>);</td></tr>
<tr><th id="1976">1976</th><td>}</td></tr>
<tr><th id="1977">1977</th><td></td></tr>
<tr><th id="1978">1978</th><td><b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="decl def fn" id="lookupCommandByCString" title='lookupCommandByCString' data-ref="lookupCommandByCString">lookupCommandByCString</dfn>(<em>char</em> *<dfn class="local col8 decl" id="178s" title='s' data-type='char *' data-ref="178s">s</dfn>) {</td></tr>
<tr><th id="1979">1979</th><td>    <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col9 decl" id="179cmd" title='cmd' data-type='struct redisCommand *' data-ref="179cmd">cmd</dfn>;</td></tr>
<tr><th id="1980">1980</th><td>    <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col0 decl" id="180name" title='name' data-type='sds' data-ref="180name">name</dfn> = <a class="ref fn" href="sds.h.html#sdsnew" title='sdsnew' data-ref="sdsnew">sdsnew</a>(<a class="local col8 ref" href="#178s" title='s' data-ref="178s">s</a>);</td></tr>
<tr><th id="1981">1981</th><td></td></tr>
<tr><th id="1982">1982</th><td>    <a class="local col9 ref" href="#179cmd" title='cmd' data-ref="179cmd">cmd</a> = <a class="ref fn" href="dict.h.html#dictFetchValue" title='dictFetchValue' data-ref="dictFetchValue">dictFetchValue</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>, <a class="local col0 ref" href="#180name" title='name' data-ref="180name">name</a>);</td></tr>
<tr><th id="1983">1983</th><td>    <a class="ref fn" href="sds.h.html#sdsfree" title='sdsfree' data-ref="sdsfree">sdsfree</a>(<a class="local col0 ref" href="#180name" title='name' data-ref="180name">name</a>);</td></tr>
<tr><th id="1984">1984</th><td>    <b>return</b> <a class="local col9 ref" href="#179cmd" title='cmd' data-ref="179cmd">cmd</a>;</td></tr>
<tr><th id="1985">1985</th><td>}</td></tr>
<tr><th id="1986">1986</th><td></td></tr>
<tr><th id="1987">1987</th><td><i>/* Lookup the command in the current table, if not found also check in</i></td></tr>
<tr><th id="1988">1988</th><td><i> * the original table containing the original command names unaffected by</i></td></tr>
<tr><th id="1989">1989</th><td><i> * redis.conf rename-command statement.</i></td></tr>
<tr><th id="1990">1990</th><td><i> *</i></td></tr>
<tr><th id="1991">1991</th><td><i> * This is used by functions rewriting the argument vector such as</i></td></tr>
<tr><th id="1992">1992</th><td><i> * rewriteClientCommandVector() in order to set client-&gt;cmd pointer</i></td></tr>
<tr><th id="1993">1993</th><td><i> * correctly even if the command was renamed. */</i></td></tr>
<tr><th id="1994">1994</th><td><b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="decl def fn" id="lookupCommandOrOriginal" title='lookupCommandOrOriginal' data-ref="lookupCommandOrOriginal">lookupCommandOrOriginal</dfn>(<a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col1 decl" id="181name" title='name' data-type='sds' data-ref="181name">name</dfn>) {</td></tr>
<tr><th id="1995">1995</th><td>    <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col2 decl" id="182cmd" title='cmd' data-type='struct redisCommand *' data-ref="182cmd">cmd</dfn> = <a class="ref fn" href="dict.h.html#dictFetchValue" title='dictFetchValue' data-ref="dictFetchValue">dictFetchValue</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>, <a class="local col1 ref" href="#181name" title='name' data-ref="181name">name</a>);</td></tr>
<tr><th id="1996">1996</th><td></td></tr>
<tr><th id="1997">1997</th><td>    <b>if</b> (!<a class="local col2 ref" href="#182cmd" title='cmd' data-ref="182cmd">cmd</a>) <a class="local col2 ref" href="#182cmd" title='cmd' data-ref="182cmd">cmd</a> = <a class="ref fn" href="dict.h.html#dictFetchValue" title='dictFetchValue' data-ref="dictFetchValue">dictFetchValue</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::orig_commands" title='redisServer::orig_commands' data-ref="redisServer::orig_commands">orig_commands</a>,<a class="local col1 ref" href="#181name" title='name' data-ref="181name">name</a>);</td></tr>
<tr><th id="1998">1998</th><td>    <b>return</b> <a class="local col2 ref" href="#182cmd" title='cmd' data-ref="182cmd">cmd</a>;</td></tr>
<tr><th id="1999">1999</th><td>}</td></tr>
<tr><th id="2000">2000</th><td></td></tr>
<tr><th id="2001">2001</th><td><i>/* Propagate the specified command (in the context of the specified database id)</i></td></tr>
<tr><th id="2002">2002</th><td><i> * to AOF and Slaves.</i></td></tr>
<tr><th id="2003">2003</th><td><i> *</i></td></tr>
<tr><th id="2004">2004</th><td><i> * flags are an xor between:</i></td></tr>
<tr><th id="2005">2005</th><td><i> * + REDIS_PROPAGATE_NONE (no propagation of command at all)</i></td></tr>
<tr><th id="2006">2006</th><td><i> * + REDIS_PROPAGATE_AOF (propagate into the AOF file if is enabled)</i></td></tr>
<tr><th id="2007">2007</th><td><i> * + REDIS_PROPAGATE_REPL (propagate into the replication link)</i></td></tr>
<tr><th id="2008">2008</th><td><i> */</i></td></tr>
<tr><th id="2009">2009</th><td><em>void</em> <dfn class="decl def fn" id="propagate" title='propagate' data-ref="propagate">propagate</dfn>(<b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col3 decl" id="183cmd" title='cmd' data-type='struct redisCommand *' data-ref="183cmd">cmd</dfn>, <em>int</em> <dfn class="local col4 decl" id="184dbid" title='dbid' data-type='int' data-ref="184dbid">dbid</dfn>, <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> **<dfn class="local col5 decl" id="185argv" title='argv' data-type='robj **' data-ref="185argv">argv</dfn>, <em>int</em> <dfn class="local col6 decl" id="186argc" title='argc' data-type='int' data-ref="186argc">argc</dfn>,</td></tr>
<tr><th id="2010">2010</th><td>               <em>int</em> <dfn class="local col7 decl" id="187flags" title='flags' data-type='int' data-ref="187flags">flags</dfn>)</td></tr>
<tr><th id="2011">2011</th><td>{</td></tr>
<tr><th id="2012">2012</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> != <a class="macro" href="redis.h.html#227" title="0" data-ref="_M/REDIS_AOF_OFF">REDIS_AOF_OFF</a> &amp;&amp; <a class="local col7 ref" href="#187flags" title='flags' data-ref="187flags">flags</a> &amp; <a class="macro" href="redis.h.html#367" title="1" data-ref="_M/REDIS_PROPAGATE_AOF">REDIS_PROPAGATE_AOF</a>)</td></tr>
<tr><th id="2013">2013</th><td>        <a class="ref fn" href="redis.h.html#feedAppendOnlyFile" title='feedAppendOnlyFile' data-ref="feedAppendOnlyFile">feedAppendOnlyFile</a>(<a class="local col3 ref" href="#183cmd" title='cmd' data-ref="183cmd">cmd</a>,<a class="local col4 ref" href="#184dbid" title='dbid' data-ref="184dbid">dbid</a>,<a class="local col5 ref" href="#185argv" title='argv' data-ref="185argv">argv</a>,<a class="local col6 ref" href="#186argc" title='argc' data-ref="186argc">argc</a>);</td></tr>
<tr><th id="2014">2014</th><td>    <b>if</b> (<a class="local col7 ref" href="#187flags" title='flags' data-ref="187flags">flags</a> &amp; <a class="macro" href="redis.h.html#368" title="2" data-ref="_M/REDIS_PROPAGATE_REPL">REDIS_PROPAGATE_REPL</a>)</td></tr>
<tr><th id="2015">2015</th><td>        <a class="ref fn" href="redis.h.html#replicationFeedSlaves" title='replicationFeedSlaves' data-ref="replicationFeedSlaves">replicationFeedSlaves</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>,<a class="local col4 ref" href="#184dbid" title='dbid' data-ref="184dbid">dbid</a>,<a class="local col5 ref" href="#185argv" title='argv' data-ref="185argv">argv</a>,<a class="local col6 ref" href="#186argc" title='argc' data-ref="186argc">argc</a>);</td></tr>
<tr><th id="2016">2016</th><td>}</td></tr>
<tr><th id="2017">2017</th><td></td></tr>
<tr><th id="2018">2018</th><td><i>/* Used inside commands to schedule the propagation of additional commands</i></td></tr>
<tr><th id="2019">2019</th><td><i> * after the current command is propagated to AOF / Replication. */</i></td></tr>
<tr><th id="2020">2020</th><td><em>void</em> <dfn class="decl def fn" id="alsoPropagate" title='alsoPropagate' data-ref="alsoPropagate">alsoPropagate</dfn>(<b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col8 decl" id="188cmd" title='cmd' data-type='struct redisCommand *' data-ref="188cmd">cmd</dfn>, <em>int</em> <dfn class="local col9 decl" id="189dbid" title='dbid' data-type='int' data-ref="189dbid">dbid</dfn>, <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> **<dfn class="local col0 decl" id="190argv" title='argv' data-type='robj **' data-ref="190argv">argv</dfn>, <em>int</em> <dfn class="local col1 decl" id="191argc" title='argc' data-type='int' data-ref="191argc">argc</dfn>,</td></tr>
<tr><th id="2021">2021</th><td>                   <em>int</em> <dfn class="local col2 decl" id="192target" title='target' data-type='int' data-ref="192target">target</dfn>)</td></tr>
<tr><th id="2022">2022</th><td>{</td></tr>
<tr><th id="2023">2023</th><td>    <a class="ref fn" href="#redisOpArrayAppend" title='redisOpArrayAppend' data-ref="redisOpArrayAppend">redisOpArrayAppend</a>(&amp;<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::also_propagate" title='redisServer::also_propagate' data-ref="redisServer::also_propagate">also_propagate</a>,<a class="local col8 ref" href="#188cmd" title='cmd' data-ref="188cmd">cmd</a>,<a class="local col9 ref" href="#189dbid" title='dbid' data-ref="189dbid">dbid</a>,<a class="local col0 ref" href="#190argv" title='argv' data-ref="190argv">argv</a>,<a class="local col1 ref" href="#191argc" title='argc' data-ref="191argc">argc</a>,<a class="local col2 ref" href="#192target" title='target' data-ref="192target">target</a>);</td></tr>
<tr><th id="2024">2024</th><td>}</td></tr>
<tr><th id="2025">2025</th><td></td></tr>
<tr><th id="2026">2026</th><td><i>/* It is possible to call the function forceCommandPropagation() inside a</i></td></tr>
<tr><th id="2027">2027</th><td><i> * Redis command implementation in order to to force the propagation of a</i></td></tr>
<tr><th id="2028">2028</th><td><i> * specific command execution into AOF / Replication. */</i></td></tr>
<tr><th id="2029">2029</th><td><em>void</em> <dfn class="decl def fn" id="forceCommandPropagation" title='forceCommandPropagation' data-ref="forceCommandPropagation">forceCommandPropagation</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col3 decl" id="193c" title='c' data-type='redisClient *' data-ref="193c">c</dfn>, <em>int</em> <dfn class="local col4 decl" id="194flags" title='flags' data-type='int' data-ref="194flags">flags</dfn>) {</td></tr>
<tr><th id="2030">2030</th><td>    <b>if</b> (<a class="local col4 ref" href="#194flags" title='flags' data-ref="194flags">flags</a> &amp; <a class="macro" href="redis.h.html#368" title="2" data-ref="_M/REDIS_PROPAGATE_REPL">REDIS_PROPAGATE_REPL</a>) <a class="local col3 ref" href="#193c" title='c' data-ref="193c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= <a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>;</td></tr>
<tr><th id="2031">2031</th><td>    <b>if</b> (<a class="local col4 ref" href="#194flags" title='flags' data-ref="194flags">flags</a> &amp; <a class="macro" href="redis.h.html#367" title="1" data-ref="_M/REDIS_PROPAGATE_AOF">REDIS_PROPAGATE_AOF</a>) <a class="local col3 ref" href="#193c" title='c' data-ref="193c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= <a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>;</td></tr>
<tr><th id="2032">2032</th><td>}</td></tr>
<tr><th id="2033">2033</th><td></td></tr>
<tr><th id="2034">2034</th><td><i>/* Call() is the core of Redis execution of a command */</i></td></tr>
<tr><th id="2035">2035</th><td><em>void</em> <dfn class="decl def fn" id="call" title='call' data-ref="call">call</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col5 decl" id="195c" title='c' data-type='redisClient *' data-ref="195c">c</dfn>, <em>int</em> <dfn class="local col6 decl" id="196flags" title='flags' data-type='int' data-ref="196flags">flags</dfn>) {</td></tr>
<tr><th id="2036">2036</th><td>    <em>long</em> <em>long</em> <dfn class="local col7 decl" id="197dirty" title='dirty' data-type='long long' data-ref="197dirty">dirty</dfn>, <dfn class="local col8 decl" id="198start" title='start' data-type='long long' data-ref="198start">start</dfn>, <dfn class="local col9 decl" id="199duration" title='duration' data-type='long long' data-ref="199duration">duration</dfn>;</td></tr>
<tr><th id="2037">2037</th><td>    <em>int</em> <dfn class="local col0 decl" id="200client_old_flags" title='client_old_flags' data-type='int' data-ref="200client_old_flags">client_old_flags</dfn> = <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a>;</td></tr>
<tr><th id="2038">2038</th><td></td></tr>
<tr><th id="2039">2039</th><td>    <i>/* Sent the command to clients in MONITOR mode, only if the commands are</i></td></tr>
<tr><th id="2040">2040</th><td><i>     * not generated from reading an AOF. */</i></td></tr>
<tr><th id="2041">2041</th><td>    <b>if</b> (<a class="macro" href="adlist.h.html#57" title="((server.monitors)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::monitors" title='redisServer::monitors' data-ref="redisServer::monitors">monitors</a>) &amp;&amp;</td></tr>
<tr><th id="2042">2042</th><td>        !<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a> &amp;&amp;</td></tr>
<tr><th id="2043">2043</th><td>        !(<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; (<a class="macro" href="redis.h.html#175" title="2048" data-ref="_M/REDIS_CMD_SKIP_MONITOR">REDIS_CMD_SKIP_MONITOR</a>|<a class="macro" href="redis.h.html#168" title="16" data-ref="_M/REDIS_CMD_ADMIN">REDIS_CMD_ADMIN</a>)))</td></tr>
<tr><th id="2044">2044</th><td>    {</td></tr>
<tr><th id="2045">2045</th><td>        <a class="ref fn" href="redis.h.html#replicationFeedMonitors" title='replicationFeedMonitors' data-ref="replicationFeedMonitors">replicationFeedMonitors</a>(<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::monitors" title='redisServer::monitors' data-ref="redisServer::monitors">monitors</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::db" title='redisClient::db' data-ref="redisClient::db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::id" title='redisDb::id' data-ref="redisDb::id">id</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>);</td></tr>
<tr><th id="2046">2046</th><td>    }</td></tr>
<tr><th id="2047">2047</th><td></td></tr>
<tr><th id="2048">2048</th><td>    <i>/* Call the command. */</i></td></tr>
<tr><th id="2049">2049</th><td>    <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp;= ~(<a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>|<a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>);</td></tr>
<tr><th id="2050">2050</th><td>    <a class="ref fn" href="#redisOpArrayInit" title='redisOpArrayInit' data-ref="redisOpArrayInit">redisOpArrayInit</a>(&amp;<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::also_propagate" title='redisServer::also_propagate' data-ref="redisServer::also_propagate">also_propagate</a>);</td></tr>
<tr><th id="2051">2051</th><td>    <a class="local col7 ref" href="#197dirty" title='dirty' data-ref="197dirty">dirty</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dirty" title='redisServer::dirty' data-ref="redisServer::dirty">dirty</a>;</td></tr>
<tr><th id="2052">2052</th><td>    <a class="local col8 ref" href="#198start" title='start' data-ref="198start">start</a> = <a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>();</td></tr>
<tr><th id="2053">2053</th><td>    <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a>(<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>);</td></tr>
<tr><th id="2054">2054</th><td>    <a class="local col9 ref" href="#199duration" title='duration' data-ref="199duration">duration</a> = <a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>()-<a class="local col8 ref" href="#198start" title='start' data-ref="198start">start</a>;</td></tr>
<tr><th id="2055">2055</th><td>    <a class="local col7 ref" href="#197dirty" title='dirty' data-ref="197dirty">dirty</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dirty" title='redisServer::dirty' data-ref="redisServer::dirty">dirty</a>-<a class="local col7 ref" href="#197dirty" title='dirty' data-ref="197dirty">dirty</a>;</td></tr>
<tr><th id="2056">2056</th><td>    <b>if</b> (<a class="local col7 ref" href="#197dirty" title='dirty' data-ref="197dirty">dirty</a> &lt; <var>0</var>) <a class="local col7 ref" href="#197dirty" title='dirty' data-ref="197dirty">dirty</a> = <var>0</var>;</td></tr>
<tr><th id="2057">2057</th><td></td></tr>
<tr><th id="2058">2058</th><td>    <i>/* When EVAL is called loading the AOF we don't want commands called</i></td></tr>
<tr><th id="2059">2059</th><td><i>     * from Lua to go into the slowlog or to populate statistics. */</i></td></tr>
<tr><th id="2060">2060</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a> &amp;&amp; <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#241" title="(1&lt;&lt;8)" data-ref="_M/REDIS_LUA_CLIENT">REDIS_LUA_CLIENT</a>)</td></tr>
<tr><th id="2061">2061</th><td>        <a class="local col6 ref" href="#196flags" title='flags' data-ref="196flags">flags</a> &amp;= ~(<a class="macro" href="redis.h.html#360" title="1" data-ref="_M/REDIS_CALL_SLOWLOG">REDIS_CALL_SLOWLOG</a> | <a class="macro" href="redis.h.html#361" title="2" data-ref="_M/REDIS_CALL_STATS">REDIS_CALL_STATS</a>);</td></tr>
<tr><th id="2062">2062</th><td></td></tr>
<tr><th id="2063">2063</th><td>    <i>/* If the caller is Lua, we want to force the EVAL caller to propagate</i></td></tr>
<tr><th id="2064">2064</th><td><i>     * the script if the command flag or client flag are forcing the</i></td></tr>
<tr><th id="2065">2065</th><td><i>     * propagation. */</i></td></tr>
<tr><th id="2066">2066</th><td>    <b>if</b> (<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#241" title="(1&lt;&lt;8)" data-ref="_M/REDIS_LUA_CLIENT">REDIS_LUA_CLIENT</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_caller" title='redisServer::lua_caller' data-ref="redisServer::lua_caller">lua_caller</a>) {</td></tr>
<tr><th id="2067">2067</th><td>        <b>if</b> (<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>)</td></tr>
<tr><th id="2068">2068</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_caller" title='redisServer::lua_caller' data-ref="redisServer::lua_caller">lua_caller</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= <a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>;</td></tr>
<tr><th id="2069">2069</th><td>        <b>if</b> (<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>)</td></tr>
<tr><th id="2070">2070</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_caller" title='redisServer::lua_caller' data-ref="redisServer::lua_caller">lua_caller</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= <a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>;</td></tr>
<tr><th id="2071">2071</th><td>    }</td></tr>
<tr><th id="2072">2072</th><td></td></tr>
<tr><th id="2073">2073</th><td>    <i>/* Log the command into the Slow log if needed, and populate the</i></td></tr>
<tr><th id="2074">2074</th><td><i>     * per-command statistics that we show in INFO commandstats. */</i></td></tr>
<tr><th id="2075">2075</th><td>    <b>if</b> (<a class="local col6 ref" href="#196flags" title='flags' data-ref="196flags">flags</a> &amp; <a class="macro" href="redis.h.html#360" title="1" data-ref="_M/REDIS_CALL_SLOWLOG">REDIS_CALL_SLOWLOG</a> &amp;&amp; <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#execCommand" title='execCommand' data-ref="execCommand">execCommand</a>) {</td></tr>
<tr><th id="2076">2076</th><td>        <em>char</em> *<dfn class="local col1 decl" id="201latency_event" title='latency_event' data-type='char *' data-ref="201latency_event">latency_event</dfn> = (<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#177" title="8192" data-ref="_M/REDIS_CMD_FAST">REDIS_CMD_FAST</a>) ?</td></tr>
<tr><th id="2077">2077</th><td>                              <q>"fast-command"</q> : <q>"command"</q>;</td></tr>
<tr><th id="2078">2078</th><td>        <a class="macro" href="latency.h.html#84" title="if (server.latency_monitor_threshold &amp;&amp; (duration/1000) &gt;= server.latency_monitor_threshold) latencyAddSample((latency_event),(duration/1000));" data-ref="_M/latencyAddSampleIfNeeded">latencyAddSampleIfNeeded</a>(<a class="local col1 ref" href="#201latency_event" title='latency_event' data-ref="201latency_event">latency_event</a>,<a class="local col9 ref" href="#199duration" title='duration' data-ref="199duration">duration</a>/<var>1000</var>);</td></tr>
<tr><th id="2079">2079</th><td>        <a class="ref fn" href="slowlog.h.html#slowlogPushEntryIfNeeded" title='slowlogPushEntryIfNeeded' data-ref="slowlogPushEntryIfNeeded">slowlogPushEntryIfNeeded</a>(<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>,<a class="local col9 ref" href="#199duration" title='duration' data-ref="199duration">duration</a>);</td></tr>
<tr><th id="2080">2080</th><td>    }</td></tr>
<tr><th id="2081">2081</th><td>    <b>if</b> (<a class="local col6 ref" href="#196flags" title='flags' data-ref="196flags">flags</a> &amp; <a class="macro" href="redis.h.html#361" title="2" data-ref="_M/REDIS_CALL_STATS">REDIS_CALL_STATS</a>) {</td></tr>
<tr><th id="2082">2082</th><td>        <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::microseconds" title='redisCommand::microseconds' data-ref="redisCommand::microseconds">microseconds</a> += <a class="local col9 ref" href="#199duration" title='duration' data-ref="199duration">duration</a>;</td></tr>
<tr><th id="2083">2083</th><td>        <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::calls" title='redisCommand::calls' data-ref="redisCommand::calls">calls</a>++;</td></tr>
<tr><th id="2084">2084</th><td>    }</td></tr>
<tr><th id="2085">2085</th><td></td></tr>
<tr><th id="2086">2086</th><td>    <i>/* Propagate the command into the AOF and replication link */</i></td></tr>
<tr><th id="2087">2087</th><td>    <b>if</b> (<a class="local col6 ref" href="#196flags" title='flags' data-ref="196flags">flags</a> &amp; <a class="macro" href="redis.h.html#362" title="4" data-ref="_M/REDIS_CALL_PROPAGATE">REDIS_CALL_PROPAGATE</a>) {</td></tr>
<tr><th id="2088">2088</th><td>        <em>int</em> <dfn class="local col2 decl" id="202flags" title='flags' data-type='int' data-ref="202flags">flags</dfn> = <a class="macro" href="redis.h.html#366" title="0" data-ref="_M/REDIS_PROPAGATE_NONE">REDIS_PROPAGATE_NONE</a>;</td></tr>
<tr><th id="2089">2089</th><td></td></tr>
<tr><th id="2090">2090</th><td>        <b>if</b> (<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>) <a class="local col2 ref" href="#202flags" title='flags' data-ref="202flags">flags</a> |= <a class="macro" href="redis.h.html#368" title="2" data-ref="_M/REDIS_PROPAGATE_REPL">REDIS_PROPAGATE_REPL</a>;</td></tr>
<tr><th id="2091">2091</th><td>        <b>if</b> (<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>) <a class="local col2 ref" href="#202flags" title='flags' data-ref="202flags">flags</a> |= <a class="macro" href="redis.h.html#367" title="1" data-ref="_M/REDIS_PROPAGATE_AOF">REDIS_PROPAGATE_AOF</a>;</td></tr>
<tr><th id="2092">2092</th><td>        <b>if</b> (<a class="local col7 ref" href="#197dirty" title='dirty' data-ref="197dirty">dirty</a>)</td></tr>
<tr><th id="2093">2093</th><td>            <a class="local col2 ref" href="#202flags" title='flags' data-ref="202flags">flags</a> |= (<a class="macro" href="redis.h.html#368" title="2" data-ref="_M/REDIS_PROPAGATE_REPL">REDIS_PROPAGATE_REPL</a> | <a class="macro" href="redis.h.html#367" title="1" data-ref="_M/REDIS_PROPAGATE_AOF">REDIS_PROPAGATE_AOF</a>);</td></tr>
<tr><th id="2094">2094</th><td>        <b>if</b> (<a class="local col2 ref" href="#202flags" title='flags' data-ref="202flags">flags</a> != <a class="macro" href="redis.h.html#366" title="0" data-ref="_M/REDIS_PROPAGATE_NONE">REDIS_PROPAGATE_NONE</a>)</td></tr>
<tr><th id="2095">2095</th><td>            <a class="ref fn" href="#propagate" title='propagate' data-ref="propagate">propagate</a>(<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::db" title='redisClient::db' data-ref="redisClient::db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::id" title='redisDb::id' data-ref="redisDb::id">id</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>,<a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>,<a class="local col2 ref" href="#202flags" title='flags' data-ref="202flags">flags</a>);</td></tr>
<tr><th id="2096">2096</th><td>    }</td></tr>
<tr><th id="2097">2097</th><td></td></tr>
<tr><th id="2098">2098</th><td>    <i>/* Restore the old FORCE_AOF/REPL flags, since call can be executed</i></td></tr>
<tr><th id="2099">2099</th><td><i>     * recursively. */</i></td></tr>
<tr><th id="2100">2100</th><td>    <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp;= ~(<a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>|<a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>);</td></tr>
<tr><th id="2101">2101</th><td>    <a class="local col5 ref" href="#195c" title='c' data-ref="195c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= <a class="local col0 ref" href="#200client_old_flags" title='client_old_flags' data-ref="200client_old_flags">client_old_flags</a> &amp; (<a class="macro" href="redis.h.html#247" title="(1&lt;&lt;14)" data-ref="_M/REDIS_FORCE_AOF">REDIS_FORCE_AOF</a>|<a class="macro" href="redis.h.html#248" title="(1&lt;&lt;15)" data-ref="_M/REDIS_FORCE_REPL">REDIS_FORCE_REPL</a>);</td></tr>
<tr><th id="2102">2102</th><td></td></tr>
<tr><th id="2103">2103</th><td>    <i>/* Handle the alsoPropagate() API to handle commands that want to propagate</i></td></tr>
<tr><th id="2104">2104</th><td><i>     * multiple separated commands. */</i></td></tr>
<tr><th id="2105">2105</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::also_propagate" title='redisServer::also_propagate' data-ref="redisServer::also_propagate">also_propagate</a>.<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>) {</td></tr>
<tr><th id="2106">2106</th><td>        <em>int</em> <dfn class="local col3 decl" id="203j" title='j' data-type='int' data-ref="203j">j</dfn>;</td></tr>
<tr><th id="2107">2107</th><td>        <a class="typedef" href="redis.h.html#redisOp" title='redisOp' data-type='struct redisOp' data-ref="redisOp">redisOp</a> *<dfn class="local col4 decl" id="204rop" title='rop' data-type='redisOp *' data-ref="204rop">rop</dfn>;</td></tr>
<tr><th id="2108">2108</th><td></td></tr>
<tr><th id="2109">2109</th><td>        <b>for</b> (<a class="local col3 ref" href="#203j" title='j' data-ref="203j">j</a> = <var>0</var>; <a class="local col3 ref" href="#203j" title='j' data-ref="203j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::also_propagate" title='redisServer::also_propagate' data-ref="redisServer::also_propagate">also_propagate</a>.<a class="ref field" href="redis.h.html#redisOpArray::numops" title='redisOpArray::numops' data-ref="redisOpArray::numops">numops</a>; <a class="local col3 ref" href="#203j" title='j' data-ref="203j">j</a>++) {</td></tr>
<tr><th id="2110">2110</th><td>            <a class="local col4 ref" href="#204rop" title='rop' data-ref="204rop">rop</a> = &amp;<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::also_propagate" title='redisServer::also_propagate' data-ref="redisServer::also_propagate">also_propagate</a>.<a class="ref field" href="redis.h.html#redisOpArray::ops" title='redisOpArray::ops' data-ref="redisOpArray::ops">ops</a>[<a class="local col3 ref" href="#203j" title='j' data-ref="203j">j</a>];</td></tr>
<tr><th id="2111">2111</th><td>            <a class="ref fn" href="#propagate" title='propagate' data-ref="propagate">propagate</a>(<a class="local col4 ref" href="#204rop" title='rop' data-ref="204rop">rop</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::cmd" title='redisOp::cmd' data-ref="redisOp::cmd">cmd</a>, <a class="local col4 ref" href="#204rop" title='rop' data-ref="204rop">rop</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::dbid" title='redisOp::dbid' data-ref="redisOp::dbid">dbid</a>, <a class="local col4 ref" href="#204rop" title='rop' data-ref="204rop">rop</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argv" title='redisOp::argv' data-ref="redisOp::argv">argv</a>, <a class="local col4 ref" href="#204rop" title='rop' data-ref="204rop">rop</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::argc" title='redisOp::argc' data-ref="redisOp::argc">argc</a>, <a class="local col4 ref" href="#204rop" title='rop' data-ref="204rop">rop</a>-&gt;<a class="ref field" href="redis.h.html#redisOp::target" title='redisOp::target' data-ref="redisOp::target">target</a>);</td></tr>
<tr><th id="2112">2112</th><td>        }</td></tr>
<tr><th id="2113">2113</th><td>        <a class="ref fn" href="#redisOpArrayFree" title='redisOpArrayFree' data-ref="redisOpArrayFree">redisOpArrayFree</a>(&amp;<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::also_propagate" title='redisServer::also_propagate' data-ref="redisServer::also_propagate">also_propagate</a>);</td></tr>
<tr><th id="2114">2114</th><td>    }</td></tr>
<tr><th id="2115">2115</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_numcommands" title='redisServer::stat_numcommands' data-ref="redisServer::stat_numcommands">stat_numcommands</a>++;</td></tr>
<tr><th id="2116">2116</th><td>}</td></tr>
<tr><th id="2117">2117</th><td></td></tr>
<tr><th id="2118">2118</th><td><i>/* If this function gets called we already read a whole</i></td></tr>
<tr><th id="2119">2119</th><td><i> * command, arguments are in the client argv/argc fields.</i></td></tr>
<tr><th id="2120">2120</th><td><i> * processCommand() execute the command or prepare the</i></td></tr>
<tr><th id="2121">2121</th><td><i> * server for a bulk read from the client.</i></td></tr>
<tr><th id="2122">2122</th><td><i> *</i></td></tr>
<tr><th id="2123">2123</th><td><i> * If 1 is returned the client is still alive and valid and</i></td></tr>
<tr><th id="2124">2124</th><td><i> * other operations can be performed by the caller. Otherwise</i></td></tr>
<tr><th id="2125">2125</th><td><i> * if 0 is returned the client was destroyed (i.e. after QUIT). */</i></td></tr>
<tr><th id="2126">2126</th><td><em>int</em> <dfn class="decl def fn" id="processCommand" title='processCommand' data-ref="processCommand">processCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col5 decl" id="205c" title='c' data-type='redisClient *' data-ref="205c">c</dfn>) {</td></tr>
<tr><th id="2127">2127</th><td>    <i>/* The QUIT command is handled separately. Normal command procs will</i></td></tr>
<tr><th id="2128">2128</th><td><i>     * go through checking for replication and QUIT will cause trouble</i></td></tr>
<tr><th id="2129">2129</th><td><i>     * when FORCE_REPLICATION is enabled and would be implemented in</i></td></tr>
<tr><th id="2130">2130</th><td><i>     * a regular command proc. */</i></td></tr>
<tr><th id="2131">2131</th><td>    <b>if</b> (!<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>0</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>,<q>"quit"</q>)) {</td></tr>
<tr><th id="2132">2132</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::ok" title='sharedObjectsStruct::ok' data-ref="sharedObjectsStruct::ok">ok</a>);</td></tr>
<tr><th id="2133">2133</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= <a class="macro" href="redis.h.html#238" title="(1&lt;&lt;6)" data-ref="_M/REDIS_CLOSE_AFTER_REPLY">REDIS_CLOSE_AFTER_REPLY</a>;</td></tr>
<tr><th id="2134">2134</th><td>        <b>return</b> <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>;</td></tr>
<tr><th id="2135">2135</th><td>    }</td></tr>
<tr><th id="2136">2136</th><td></td></tr>
<tr><th id="2137">2137</th><td>    <i>/* Now lookup the command and check ASAP about trivial error conditions</i></td></tr>
<tr><th id="2138">2138</th><td><i>     * such as wrong arity, bad command name and so forth. */</i></td></tr>
<tr><th id="2139">2139</th><td>    <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a> = <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::lastcmd" title='redisClient::lastcmd' data-ref="redisClient::lastcmd">lastcmd</a> = <a class="ref fn" href="#lookupCommand" title='lookupCommand' data-ref="lookupCommand">lookupCommand</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>0</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>);</td></tr>
<tr><th id="2140">2140</th><td>    <b>if</b> (!<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>) {</td></tr>
<tr><th id="2141">2141</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2142">2142</th><td>        <a class="ref fn" href="redis.h.html#addReplyErrorFormat" title='addReplyErrorFormat' data-ref="addReplyErrorFormat">addReplyErrorFormat</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<q>"unknown command '%s'"</q>,</td></tr>
<tr><th id="2143">2143</th><td>            (<em>char</em>*)<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>0</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>);</td></tr>
<tr><th id="2144">2144</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2145">2145</th><td>    } <b>else</b> <b>if</b> ((<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a> &gt; <var>0</var> &amp;&amp; <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a> != <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>) ||</td></tr>
<tr><th id="2146">2146</th><td>               (<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> &lt; -<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a>)) {</td></tr>
<tr><th id="2147">2147</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2148">2148</th><td>        <a class="ref fn" href="redis.h.html#addReplyErrorFormat" title='addReplyErrorFormat' data-ref="addReplyErrorFormat">addReplyErrorFormat</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<q>"wrong number of arguments for '%s' command"</q>,</td></tr>
<tr><th id="2149">2149</th><td>            <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::name" title='redisCommand::name' data-ref="redisCommand::name">name</a>);</td></tr>
<tr><th id="2150">2150</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2151">2151</th><td>    }</td></tr>
<tr><th id="2152">2152</th><td></td></tr>
<tr><th id="2153">2153</th><td>    <i>/* Check if the user is authenticated */</i></td></tr>
<tr><th id="2154">2154</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::requirepass" title='redisServer::requirepass' data-ref="redisServer::requirepass">requirepass</a> &amp;&amp; !<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::authenticated" title='redisClient::authenticated' data-ref="redisClient::authenticated">authenticated</a> &amp;&amp; <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="#authCommand" title='authCommand' data-ref="authCommand">authCommand</a>)</td></tr>
<tr><th id="2155">2155</th><td>    {</td></tr>
<tr><th id="2156">2156</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2157">2157</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::noautherr" title='sharedObjectsStruct::noautherr' data-ref="sharedObjectsStruct::noautherr">noautherr</a>);</td></tr>
<tr><th id="2158">2158</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2159">2159</th><td>    }</td></tr>
<tr><th id="2160">2160</th><td></td></tr>
<tr><th id="2161">2161</th><td>    <i>/* If cluster is enabled perform the cluster redirection here.</i></td></tr>
<tr><th id="2162">2162</th><td><i>     * However we don't perform the redirection if:</i></td></tr>
<tr><th id="2163">2163</th><td><i>     * 1) The sender of this command is our master.</i></td></tr>
<tr><th id="2164">2164</th><td><i>     * 2) The command has no key arguments. */</i></td></tr>
<tr><th id="2165">2165</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a> &amp;&amp;</td></tr>
<tr><th id="2166">2166</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#233" title="(1&lt;&lt;1)" data-ref="_M/REDIS_MASTER">REDIS_MASTER</a>) &amp;&amp;</td></tr>
<tr><th id="2167">2167</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#241" title="(1&lt;&lt;8)" data-ref="_M/REDIS_LUA_CLIENT">REDIS_LUA_CLIENT</a> &amp;&amp;</td></tr>
<tr><th id="2168">2168</th><td>          <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_caller" title='redisServer::lua_caller' data-ref="redisServer::lua_caller">lua_caller</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#233" title="(1&lt;&lt;1)" data-ref="_M/REDIS_MASTER">REDIS_MASTER</a>) &amp;&amp;</td></tr>
<tr><th id="2169">2169</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::getkeys_proc" title='redisCommand::getkeys_proc' data-ref="redisCommand::getkeys_proc">getkeys_proc</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> &amp;&amp; <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::firstkey" title='redisCommand::firstkey' data-ref="redisCommand::firstkey">firstkey</a> == <var>0</var>))</td></tr>
<tr><th id="2170">2170</th><td>    {</td></tr>
<tr><th id="2171">2171</th><td>        <em>int</em> <dfn class="local col6 decl" id="206hashslot" title='hashslot' data-type='int' data-ref="206hashslot">hashslot</dfn>;</td></tr>
<tr><th id="2172">2172</th><td></td></tr>
<tr><th id="2173">2173</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster" title='redisServer::cluster' data-ref="redisServer::cluster">cluster</a>-&gt;<a class="ref field" href="cluster.h.html#clusterState::state" title='clusterState::state' data-ref="clusterState::state">state</a> != <a class="macro" href="cluster.h.html#9" title="0" data-ref="_M/REDIS_CLUSTER_OK">REDIS_CLUSTER_OK</a>) {</td></tr>
<tr><th id="2174">2174</th><td>            <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2175">2175</th><td>            <a class="ref fn" href="cluster.h.html#clusterRedirectClient" title='clusterRedirectClient' data-ref="clusterRedirectClient">clusterRedirectClient</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>0</var>,<a class="macro" href="cluster.h.html#33" title="5" data-ref="_M/REDIS_CLUSTER_REDIR_DOWN_STATE">REDIS_CLUSTER_REDIR_DOWN_STATE</a>);</td></tr>
<tr><th id="2176">2176</th><td>            <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2177">2177</th><td>        } <b>else</b> {</td></tr>
<tr><th id="2178">2178</th><td>            <em>int</em> <dfn class="local col7 decl" id="207error_code" title='error_code' data-type='int' data-ref="207error_code">error_code</dfn>;</td></tr>
<tr><th id="2179">2179</th><td>            <a class="typedef" href="cluster.h.html#clusterNode" title='clusterNode' data-type='struct clusterNode' data-ref="clusterNode">clusterNode</a> *<dfn class="local col8 decl" id="208n" title='n' data-type='clusterNode *' data-ref="208n">n</dfn> = <a class="ref fn" href="cluster.h.html#getNodeByQuery" title='getNodeByQuery' data-ref="getNodeByQuery">getNodeByQuery</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>,<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>,<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>,&amp;<a class="local col6 ref" href="#206hashslot" title='hashslot' data-ref="206hashslot">hashslot</a>,&amp;<a class="local col7 ref" href="#207error_code" title='error_code' data-ref="207error_code">error_code</a>);</td></tr>
<tr><th id="2180">2180</th><td>            <b>if</b> (<a class="local col8 ref" href="#208n" title='n' data-ref="208n">n</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> || <a class="local col8 ref" href="#208n" title='n' data-ref="208n">n</a> != <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster" title='redisServer::cluster' data-ref="redisServer::cluster">cluster</a>-&gt;<a class="ref field" href="cluster.h.html#clusterState::myself" title='clusterState::myself' data-ref="clusterState::myself">myself</a>) {</td></tr>
<tr><th id="2181">2181</th><td>                <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2182">2182</th><td>                <a class="ref fn" href="cluster.h.html#clusterRedirectClient" title='clusterRedirectClient' data-ref="clusterRedirectClient">clusterRedirectClient</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<a class="local col8 ref" href="#208n" title='n' data-ref="208n">n</a>,<a class="local col6 ref" href="#206hashslot" title='hashslot' data-ref="206hashslot">hashslot</a>,<a class="local col7 ref" href="#207error_code" title='error_code' data-ref="207error_code">error_code</a>);</td></tr>
<tr><th id="2183">2183</th><td>                <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2184">2184</th><td>            }</td></tr>
<tr><th id="2185">2185</th><td>        }</td></tr>
<tr><th id="2186">2186</th><td>    }</td></tr>
<tr><th id="2187">2187</th><td></td></tr>
<tr><th id="2188">2188</th><td>    <i>/* Handle the maxmemory directive.</i></td></tr>
<tr><th id="2189">2189</th><td><i>     *</i></td></tr>
<tr><th id="2190">2190</th><td><i>     * First we try to free some memory if possible (if there are volatile</i></td></tr>
<tr><th id="2191">2191</th><td><i>     * keys in the dataset). If there are not the only thing we can do</i></td></tr>
<tr><th id="2192">2192</th><td><i>     * is returning an error. */</i></td></tr>
<tr><th id="2193">2193</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a>) {</td></tr>
<tr><th id="2194">2194</th><td>        <em>int</em> <dfn class="local col9 decl" id="209retval" title='retval' data-type='int' data-ref="209retval">retval</dfn> = <a class="ref fn" href="#freeMemoryIfNeeded" title='freeMemoryIfNeeded' data-ref="freeMemoryIfNeeded">freeMemoryIfNeeded</a>();</td></tr>
<tr><th id="2195">2195</th><td>        <b>if</b> ((<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#166" title="4" data-ref="_M/REDIS_CMD_DENYOOM">REDIS_CMD_DENYOOM</a>) &amp;&amp; <a class="local col9 ref" href="#209retval" title='retval' data-ref="209retval">retval</a> == <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>) {</td></tr>
<tr><th id="2196">2196</th><td>            <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2197">2197</th><td>            <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::oomerr" title='sharedObjectsStruct::oomerr' data-ref="sharedObjectsStruct::oomerr">oomerr</a>);</td></tr>
<tr><th id="2198">2198</th><td>            <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2199">2199</th><td>        }</td></tr>
<tr><th id="2200">2200</th><td>    }</td></tr>
<tr><th id="2201">2201</th><td></td></tr>
<tr><th id="2202">2202</th><td>    <i>/* Don't accept write commands if there are problems persisting on disk</i></td></tr>
<tr><th id="2203">2203</th><td><i>     * and if this is a master instance. */</i></td></tr>
<tr><th id="2204">2204</th><td>    <b>if</b> (((<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stop_writes_on_bgsave_err" title='redisServer::stop_writes_on_bgsave_err' data-ref="redisServer::stop_writes_on_bgsave_err">stop_writes_on_bgsave_err</a> &amp;&amp;</td></tr>
<tr><th id="2205">2205</th><td>          <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::saveparamslen" title='redisServer::saveparamslen' data-ref="redisServer::saveparamslen">saveparamslen</a> &gt; <var>0</var> &amp;&amp;</td></tr>
<tr><th id="2206">2206</th><td>          <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastbgsave_status" title='redisServer::lastbgsave_status' data-ref="redisServer::lastbgsave_status">lastbgsave_status</a> == <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>) ||</td></tr>
<tr><th id="2207">2207</th><td>          <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_status" title='redisServer::aof_last_write_status' data-ref="redisServer::aof_last_write_status">aof_last_write_status</a> == <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>) &amp;&amp;</td></tr>
<tr><th id="2208">2208</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> &amp;&amp;</td></tr>
<tr><th id="2209">2209</th><td>        (<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#164" title="1" data-ref="_M/REDIS_CMD_WRITE">REDIS_CMD_WRITE</a> ||</td></tr>
<tr><th id="2210">2210</th><td>         <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> == <a class="ref fn" href="#pingCommand" title='pingCommand' data-ref="pingCommand">pingCommand</a>))</td></tr>
<tr><th id="2211">2211</th><td>    {</td></tr>
<tr><th id="2212">2212</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2213">2213</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_status" title='redisServer::aof_last_write_status' data-ref="redisServer::aof_last_write_status">aof_last_write_status</a> == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>)</td></tr>
<tr><th id="2214">2214</th><td>            <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::bgsaveerr" title='sharedObjectsStruct::bgsaveerr' data-ref="sharedObjectsStruct::bgsaveerr">bgsaveerr</a>);</td></tr>
<tr><th id="2215">2215</th><td>        <b>else</b></td></tr>
<tr><th id="2216">2216</th><td>            <a class="ref fn" href="redis.h.html#addReplySds" title='addReplySds' data-ref="addReplySds">addReplySds</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,</td></tr>
<tr><th id="2217">2217</th><td>                <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>(),</td></tr>
<tr><th id="2218">2218</th><td>                <q>"-MISCONF Errors writing to the AOF file: %s\r\n"</q>,</td></tr>
<tr><th id="2219">2219</th><td>                <a class="ref fn" href="../../include/string.h.html#strerror" title='strerror' data-ref="strerror">strerror</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_errno" title='redisServer::aof_last_write_errno' data-ref="redisServer::aof_last_write_errno">aof_last_write_errno</a>)));</td></tr>
<tr><th id="2220">2220</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2221">2221</th><td>    }</td></tr>
<tr><th id="2222">2222</th><td></td></tr>
<tr><th id="2223">2223</th><td>    <i>/* Don't accept write commands if there are not enough good slaves and</i></td></tr>
<tr><th id="2224">2224</th><td><i>     * user configured the min-slaves-to-write option. */</i></td></tr>
<tr><th id="2225">2225</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> &amp;&amp;</td></tr>
<tr><th id="2226">2226</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_to_write" title='redisServer::repl_min_slaves_to_write' data-ref="redisServer::repl_min_slaves_to_write">repl_min_slaves_to_write</a> &amp;&amp;</td></tr>
<tr><th id="2227">2227</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_max_lag" title='redisServer::repl_min_slaves_max_lag' data-ref="redisServer::repl_min_slaves_max_lag">repl_min_slaves_max_lag</a> &amp;&amp;</td></tr>
<tr><th id="2228">2228</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#164" title="1" data-ref="_M/REDIS_CMD_WRITE">REDIS_CMD_WRITE</a> &amp;&amp;</td></tr>
<tr><th id="2229">2229</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_good_slaves_count" title='redisServer::repl_good_slaves_count' data-ref="redisServer::repl_good_slaves_count">repl_good_slaves_count</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_to_write" title='redisServer::repl_min_slaves_to_write' data-ref="redisServer::repl_min_slaves_to_write">repl_min_slaves_to_write</a>)</td></tr>
<tr><th id="2230">2230</th><td>    {</td></tr>
<tr><th id="2231">2231</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2232">2232</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::noreplicaserr" title='sharedObjectsStruct::noreplicaserr' data-ref="sharedObjectsStruct::noreplicaserr">noreplicaserr</a>);</td></tr>
<tr><th id="2233">2233</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2234">2234</th><td>    }</td></tr>
<tr><th id="2235">2235</th><td></td></tr>
<tr><th id="2236">2236</th><td>    <i>/* Don't accept write commands if this is a read only slave. But</i></td></tr>
<tr><th id="2237">2237</th><td><i>     * accept write commands if this is our master. */</i></td></tr>
<tr><th id="2238">2238</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_slave_ro" title='redisServer::repl_slave_ro' data-ref="redisServer::repl_slave_ro">repl_slave_ro</a> &amp;&amp;</td></tr>
<tr><th id="2239">2239</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#233" title="(1&lt;&lt;1)" data-ref="_M/REDIS_MASTER">REDIS_MASTER</a>) &amp;&amp;</td></tr>
<tr><th id="2240">2240</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#164" title="1" data-ref="_M/REDIS_CMD_WRITE">REDIS_CMD_WRITE</a>)</td></tr>
<tr><th id="2241">2241</th><td>    {</td></tr>
<tr><th id="2242">2242</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::roslaveerr" title='sharedObjectsStruct::roslaveerr' data-ref="sharedObjectsStruct::roslaveerr">roslaveerr</a>);</td></tr>
<tr><th id="2243">2243</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2244">2244</th><td>    }</td></tr>
<tr><th id="2245">2245</th><td></td></tr>
<tr><th id="2246">2246</th><td>    <i>/* Only allow SUBSCRIBE and UNSUBSCRIBE in the context of Pub/Sub */</i></td></tr>
<tr><th id="2247">2247</th><td>    <b>if</b> (<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#251" title="(1&lt;&lt;18)" data-ref="_M/REDIS_PUBSUB">REDIS_PUBSUB</a> &amp;&amp;</td></tr>
<tr><th id="2248">2248</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="#pingCommand" title='pingCommand' data-ref="pingCommand">pingCommand</a> &amp;&amp;</td></tr>
<tr><th id="2249">2249</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#subscribeCommand" title='subscribeCommand' data-ref="subscribeCommand">subscribeCommand</a> &amp;&amp;</td></tr>
<tr><th id="2250">2250</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#unsubscribeCommand" title='unsubscribeCommand' data-ref="unsubscribeCommand">unsubscribeCommand</a> &amp;&amp;</td></tr>
<tr><th id="2251">2251</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#psubscribeCommand" title='psubscribeCommand' data-ref="psubscribeCommand">psubscribeCommand</a> &amp;&amp;</td></tr>
<tr><th id="2252">2252</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#punsubscribeCommand" title='punsubscribeCommand' data-ref="punsubscribeCommand">punsubscribeCommand</a>) {</td></tr>
<tr><th id="2253">2253</th><td>        <a class="ref fn" href="redis.h.html#addReplyError" title='addReplyError' data-ref="addReplyError">addReplyError</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<q>"only (P)SUBSCRIBE / (P)UNSUBSCRIBE / QUIT allowed in this context"</q>);</td></tr>
<tr><th id="2254">2254</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2255">2255</th><td>    }</td></tr>
<tr><th id="2256">2256</th><td></td></tr>
<tr><th id="2257">2257</th><td>    <i>/* Only allow INFO and SLAVEOF when slave-serve-stale-data is no and</i></td></tr>
<tr><th id="2258">2258</th><td><i>     * we are a slave with a broken link with master. */</i></td></tr>
<tr><th id="2259">2259</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_state" title='redisServer::repl_state' data-ref="redisServer::repl_state">repl_state</a> != <a class="macro" href="redis.h.html#276" title="5" data-ref="_M/REDIS_REPL_CONNECTED">REDIS_REPL_CONNECTED</a> &amp;&amp;</td></tr>
<tr><th id="2260">2260</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_serve_stale_data" title='redisServer::repl_serve_stale_data' data-ref="redisServer::repl_serve_stale_data">repl_serve_stale_data</a> == <var>0</var> &amp;&amp;</td></tr>
<tr><th id="2261">2261</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#174" title="1024" data-ref="_M/REDIS_CMD_STALE">REDIS_CMD_STALE</a>))</td></tr>
<tr><th id="2262">2262</th><td>    {</td></tr>
<tr><th id="2263">2263</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2264">2264</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::masterdownerr" title='sharedObjectsStruct::masterdownerr' data-ref="sharedObjectsStruct::masterdownerr">masterdownerr</a>);</td></tr>
<tr><th id="2265">2265</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2266">2266</th><td>    }</td></tr>
<tr><th id="2267">2267</th><td></td></tr>
<tr><th id="2268">2268</th><td>    <i>/* Loading DB? Return an error if the command has not the</i></td></tr>
<tr><th id="2269">2269</th><td><i>     * REDIS_CMD_LOADING flag. */</i></td></tr>
<tr><th id="2270">2270</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a> &amp;&amp; !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="macro" href="redis.h.html#173" title="512" data-ref="_M/REDIS_CMD_LOADING">REDIS_CMD_LOADING</a>)) {</td></tr>
<tr><th id="2271">2271</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::loadingerr" title='sharedObjectsStruct::loadingerr' data-ref="sharedObjectsStruct::loadingerr">loadingerr</a>);</td></tr>
<tr><th id="2272">2272</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2273">2273</th><td>    }</td></tr>
<tr><th id="2274">2274</th><td></td></tr>
<tr><th id="2275">2275</th><td>    <i>/* Lua script too slow? Only allow a limited number of commands. */</i></td></tr>
<tr><th id="2276">2276</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua_timedout" title='redisServer::lua_timedout' data-ref="redisServer::lua_timedout">lua_timedout</a> &amp;&amp;</td></tr>
<tr><th id="2277">2277</th><td>          <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="#authCommand" title='authCommand' data-ref="authCommand">authCommand</a> &amp;&amp;</td></tr>
<tr><th id="2278">2278</th><td>          <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#replconfCommand" title='replconfCommand' data-ref="replconfCommand">replconfCommand</a> &amp;&amp;</td></tr>
<tr><th id="2279">2279</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> == <a class="ref fn" href="redis.h.html#shutdownCommand" title='shutdownCommand' data-ref="shutdownCommand">shutdownCommand</a> &amp;&amp;</td></tr>
<tr><th id="2280">2280</th><td>          <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>2</var> &amp;&amp;</td></tr>
<tr><th id="2281">2281</th><td>          <a class="ref fn" href="../../include/ctype.h.html#tolower" title='tolower' data-ref="tolower">tolower</a>(((<em>char</em>*)<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>)[<var>0</var>]) == <kbd>'n'</kbd>) &amp;&amp;</td></tr>
<tr><th id="2282">2282</th><td>        !(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> == <a class="ref fn" href="redis.h.html#scriptCommand" title='scriptCommand' data-ref="scriptCommand">scriptCommand</a> &amp;&amp;</td></tr>
<tr><th id="2283">2283</th><td>          <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>2</var> &amp;&amp;</td></tr>
<tr><th id="2284">2284</th><td>          <a class="ref fn" href="../../include/ctype.h.html#tolower" title='tolower' data-ref="tolower">tolower</a>(((<em>char</em>*)<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>)[<var>0</var>]) == <kbd>'k'</kbd>))</td></tr>
<tr><th id="2285">2285</th><td>    {</td></tr>
<tr><th id="2286">2286</th><td>        <a class="ref fn" href="redis.h.html#flagTransaction" title='flagTransaction' data-ref="flagTransaction">flagTransaction</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2287">2287</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::slowscripterr" title='sharedObjectsStruct::slowscripterr' data-ref="sharedObjectsStruct::slowscripterr">slowscripterr</a>);</td></tr>
<tr><th id="2288">2288</th><td>        <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2289">2289</th><td>    }</td></tr>
<tr><th id="2290">2290</th><td></td></tr>
<tr><th id="2291">2291</th><td>    <i>/* Exec the command */</i></td></tr>
<tr><th id="2292">2292</th><td>    <b>if</b> (<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#235" title="(1&lt;&lt;3)" data-ref="_M/REDIS_MULTI">REDIS_MULTI</a> &amp;&amp;</td></tr>
<tr><th id="2293">2293</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#execCommand" title='execCommand' data-ref="execCommand">execCommand</a> &amp;&amp; <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#discardCommand" title='discardCommand' data-ref="discardCommand">discardCommand</a> &amp;&amp;</td></tr>
<tr><th id="2294">2294</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#multiCommand" title='multiCommand' data-ref="multiCommand">multiCommand</a> &amp;&amp; <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::proc" title='redisCommand::proc' data-ref="redisCommand::proc">proc</a> != <a class="ref fn" href="redis.h.html#watchCommand" title='watchCommand' data-ref="watchCommand">watchCommand</a>)</td></tr>
<tr><th id="2295">2295</th><td>    {</td></tr>
<tr><th id="2296">2296</th><td>        <a class="ref fn" href="redis.h.html#queueMultiCommand" title='queueMultiCommand' data-ref="queueMultiCommand">queueMultiCommand</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>);</td></tr>
<tr><th id="2297">2297</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::queued" title='sharedObjectsStruct::queued' data-ref="sharedObjectsStruct::queued">queued</a>);</td></tr>
<tr><th id="2298">2298</th><td>    } <b>else</b> {</td></tr>
<tr><th id="2299">2299</th><td>        <a class="ref fn" href="#call" title='call' data-ref="call">call</a>(<a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>,<a class="macro" href="redis.h.html#363" title="(1 | 2 | 4)" data-ref="_M/REDIS_CALL_FULL">REDIS_CALL_FULL</a>);</td></tr>
<tr><th id="2300">2300</th><td>        <a class="local col5 ref" href="#205c" title='c' data-ref="205c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::woff" title='redisClient::woff' data-ref="redisClient::woff">woff</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master_repl_offset" title='redisServer::master_repl_offset' data-ref="redisServer::master_repl_offset">master_repl_offset</a>;</td></tr>
<tr><th id="2301">2301</th><td>        <b>if</b> (<a class="macro" href="adlist.h.html#57" title="((server.ready_keys)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ready_keys" title='redisServer::ready_keys' data-ref="redisServer::ready_keys">ready_keys</a>))</td></tr>
<tr><th id="2302">2302</th><td>            <a class="ref fn" href="redis.h.html#handleClientsBlockedOnLists" title='handleClientsBlockedOnLists' data-ref="handleClientsBlockedOnLists">handleClientsBlockedOnLists</a>();</td></tr>
<tr><th id="2303">2303</th><td>    }</td></tr>
<tr><th id="2304">2304</th><td>    <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2305">2305</th><td>}</td></tr>
<tr><th id="2306">2306</th><td></td></tr>
<tr><th id="2307">2307</th><td><i>/*================================== Shutdown =============================== */</i></td></tr>
<tr><th id="2308">2308</th><td></td></tr>
<tr><th id="2309">2309</th><td><i>/* Close listening sockets. Also unlink the unix domain socket if</i></td></tr>
<tr><th id="2310">2310</th><td><i> * unlink_unix_socket is non-zero. */</i></td></tr>
<tr><th id="2311">2311</th><td><em>void</em> <dfn class="decl def fn" id="closeListeningSockets" title='closeListeningSockets' data-ref="closeListeningSockets">closeListeningSockets</dfn>(<em>int</em> <dfn class="local col0 decl" id="210unlink_unix_socket" title='unlink_unix_socket' data-type='int' data-ref="210unlink_unix_socket">unlink_unix_socket</dfn>) {</td></tr>
<tr><th id="2312">2312</th><td>    <em>int</em> <dfn class="local col1 decl" id="211j" title='j' data-type='int' data-ref="211j">j</dfn>;</td></tr>
<tr><th id="2313">2313</th><td></td></tr>
<tr><th id="2314">2314</th><td>    <b>for</b> (<a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a> = <var>0</var>; <a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd_count" title='redisServer::ipfd_count' data-ref="redisServer::ipfd_count">ipfd_count</a>; <a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a>++) <a class="ref fn" href="../../include/unistd.h.html#close" title='close' data-ref="close">close</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd" title='redisServer::ipfd' data-ref="redisServer::ipfd">ipfd</a>[<a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a>]);</td></tr>
<tr><th id="2315">2315</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> != -<var>1</var>) <a class="ref fn" href="../../include/unistd.h.html#close" title='close' data-ref="close">close</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a>);</td></tr>
<tr><th id="2316">2316</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>)</td></tr>
<tr><th id="2317">2317</th><td>        <b>for</b> (<a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a> = <var>0</var>; <a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cfd_count" title='redisServer::cfd_count' data-ref="redisServer::cfd_count">cfd_count</a>; <a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a>++) <a class="ref fn" href="../../include/unistd.h.html#close" title='close' data-ref="close">close</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cfd" title='redisServer::cfd' data-ref="redisServer::cfd">cfd</a>[<a class="local col1 ref" href="#211j" title='j' data-ref="211j">j</a>]);</td></tr>
<tr><th id="2318">2318</th><td>    <b>if</b> (<a class="local col0 ref" href="#210unlink_unix_socket" title='unlink_unix_socket' data-ref="210unlink_unix_socket">unlink_unix_socket</a> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a>) {</td></tr>
<tr><th id="2319">2319</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"Removing the unix socket file."</q>);</td></tr>
<tr><th id="2320">2320</th><td>        <a class="ref fn" href="../../include/unistd.h.html#unlink" title='unlink' data-ref="unlink">unlink</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a>); <i>/* don't care if this fails */</i></td></tr>
<tr><th id="2321">2321</th><td>    }</td></tr>
<tr><th id="2322">2322</th><td>}</td></tr>
<tr><th id="2323">2323</th><td></td></tr>
<tr><th id="2324">2324</th><td><em>int</em> <dfn class="decl def fn" id="prepareForShutdown" title='prepareForShutdown' data-ref="prepareForShutdown">prepareForShutdown</dfn>(<em>int</em> <dfn class="local col2 decl" id="212flags" title='flags' data-type='int' data-ref="212flags">flags</dfn>) {</td></tr>
<tr><th id="2325">2325</th><td>    <em>int</em> <dfn class="local col3 decl" id="213save" title='save' data-type='int' data-ref="213save">save</dfn> = <a class="local col2 ref" href="#212flags" title='flags' data-ref="212flags">flags</a> &amp; <a class="macro" href="redis.h.html#354" title="1" data-ref="_M/REDIS_SHUTDOWN_SAVE">REDIS_SHUTDOWN_SAVE</a>;</td></tr>
<tr><th id="2326">2326</th><td>    <em>int</em> <dfn class="local col4 decl" id="214nosave" title='nosave' data-type='int' data-ref="214nosave">nosave</dfn> = <a class="local col2 ref" href="#212flags" title='flags' data-ref="212flags">flags</a> &amp; <a class="macro" href="redis.h.html#356" title="2" data-ref="_M/REDIS_SHUTDOWN_NOSAVE">REDIS_SHUTDOWN_NOSAVE</a>;</td></tr>
<tr><th id="2327">2327</th><td></td></tr>
<tr><th id="2328">2328</th><td>    <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"User requested shutdown..."</q>);</td></tr>
<tr><th id="2329">2329</th><td>    <i>/* Kill the saving child if there is a background saving in progress.</i></td></tr>
<tr><th id="2330">2330</th><td><i>       We want to avoid race conditions, for instance our saving child may</i></td></tr>
<tr><th id="2331">2331</th><td><i>       overwrite the synchronous saving did by SHUTDOWN. */</i></td></tr>
<tr><th id="2332">2332</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> != -<var>1</var>) {</td></tr>
<tr><th id="2333">2333</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"There is a child saving an .rdb. Killing it!"</q>);</td></tr>
<tr><th id="2334">2334</th><td>        <a class="ref fn" href="../../include/signal.h.html#kill" title='kill' data-ref="kill">kill</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a>,<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#42" title="10" data-ref="_M/SIGUSR1">SIGUSR1</a>);</td></tr>
<tr><th id="2335">2335</th><td>        <a class="ref fn" href="rdb.h.html#rdbRemoveTempFile" title='rdbRemoveTempFile' data-ref="rdbRemoveTempFile">rdbRemoveTempFile</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a>);</td></tr>
<tr><th id="2336">2336</th><td>    }</td></tr>
<tr><th id="2337">2337</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> != <a class="macro" href="redis.h.html#227" title="0" data-ref="_M/REDIS_AOF_OFF">REDIS_AOF_OFF</a>) {</td></tr>
<tr><th id="2338">2338</th><td>        <i>/* Kill the AOF saving child as the AOF we already have may be longer</i></td></tr>
<tr><th id="2339">2339</th><td><i>         * but contains the full dataset anyway. */</i></td></tr>
<tr><th id="2340">2340</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> != -<var>1</var>) {</td></tr>
<tr><th id="2341">2341</th><td>            <i>/* If we have AOF enabled but haven't written the AOF yet, don't</i></td></tr>
<tr><th id="2342">2342</th><td><i>             * shutdown or else the dataset will be lost. */</i></td></tr>
<tr><th id="2343">2343</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> == <a class="macro" href="redis.h.html#229" title="2" data-ref="_M/REDIS_AOF_WAIT_REWRITE">REDIS_AOF_WAIT_REWRITE</a>) {</td></tr>
<tr><th id="2344">2344</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <q>"Writing initial AOF, can't exit."</q>);</td></tr>
<tr><th id="2345">2345</th><td>                <b>return</b> <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>;</td></tr>
<tr><th id="2346">2346</th><td>            }</td></tr>
<tr><th id="2347">2347</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,</td></tr>
<tr><th id="2348">2348</th><td>                <q>"There is a child rewriting the AOF. Killing it!"</q>);</td></tr>
<tr><th id="2349">2349</th><td>            <a class="ref fn" href="../../include/signal.h.html#kill" title='kill' data-ref="kill">kill</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a>,<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#42" title="10" data-ref="_M/SIGUSR1">SIGUSR1</a>);</td></tr>
<tr><th id="2350">2350</th><td>        }</td></tr>
<tr><th id="2351">2351</th><td>        <i>/* Append only file: fsync() the AOF and exit */</i></td></tr>
<tr><th id="2352">2352</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"Calling fsync() on the AOF file."</q>);</td></tr>
<tr><th id="2353">2353</th><td>        <a class="macro" href="config.h.html#87" title="fdatasync" data-ref="_M/aof_fsync">aof_fsync</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_fd" title='redisServer::aof_fd' data-ref="redisServer::aof_fd">aof_fd</a>);</td></tr>
<tr><th id="2354">2354</th><td>    }</td></tr>
<tr><th id="2355">2355</th><td>    <b>if</b> ((<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::saveparamslen" title='redisServer::saveparamslen' data-ref="redisServer::saveparamslen">saveparamslen</a> &gt; <var>0</var> &amp;&amp; !<a class="local col4 ref" href="#214nosave" title='nosave' data-ref="214nosave">nosave</a>) || <a class="local col3 ref" href="#213save" title='save' data-ref="213save">save</a>) {</td></tr>
<tr><th id="2356">2356</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"Saving the final RDB snapshot before exiting."</q>);</td></tr>
<tr><th id="2357">2357</th><td>        <i>/* Snapshotting. Perform a SYNC SAVE and exit */</i></td></tr>
<tr><th id="2358">2358</th><td>        <b>if</b> (<a class="ref fn" href="rdb.h.html#rdbSave" title='rdbSave' data-ref="rdbSave">rdbSave</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_filename" title='redisServer::rdb_filename' data-ref="redisServer::rdb_filename">rdb_filename</a>) != <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>) {</td></tr>
<tr><th id="2359">2359</th><td>            <i>/* Ooops.. error saving! The best we can do is to continue</i></td></tr>
<tr><th id="2360">2360</th><td><i>             * operating. Note that if there was a background saving process,</i></td></tr>
<tr><th id="2361">2361</th><td><i>             * in the next cron() Redis will be notified that the background</i></td></tr>
<tr><th id="2362">2362</th><td><i>             * saving aborted, handling special stuff like slaves pending for</i></td></tr>
<tr><th id="2363">2363</th><td><i>             * synchronization... */</i></td></tr>
<tr><th id="2364">2364</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Error trying to save the DB, can't exit."</q>);</td></tr>
<tr><th id="2365">2365</th><td>            <b>return</b> <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>;</td></tr>
<tr><th id="2366">2366</th><td>        }</td></tr>
<tr><th id="2367">2367</th><td>    }</td></tr>
<tr><th id="2368">2368</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::daemonize" title='redisServer::daemonize' data-ref="redisServer::daemonize">daemonize</a>) {</td></tr>
<tr><th id="2369">2369</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"Removing the pid file."</q>);</td></tr>
<tr><th id="2370">2370</th><td>        <a class="ref fn" href="../../include/unistd.h.html#unlink" title='unlink' data-ref="unlink">unlink</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pidfile" title='redisServer::pidfile' data-ref="redisServer::pidfile">pidfile</a>);</td></tr>
<tr><th id="2371">2371</th><td>    }</td></tr>
<tr><th id="2372">2372</th><td>    <i>/* Close the listening sockets. Apparently this allows faster restarts. */</i></td></tr>
<tr><th id="2373">2373</th><td>    <a class="ref fn" href="#closeListeningSockets" title='closeListeningSockets' data-ref="closeListeningSockets">closeListeningSockets</a>(<var>1</var>);</td></tr>
<tr><th id="2374">2374</th><td>    <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"%s is now ready to exit, bye bye..."</q>,</td></tr>
<tr><th id="2375">2375</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a> ? <q>"Sentinel"</q> : <q>"Redis"</q>);</td></tr>
<tr><th id="2376">2376</th><td>    <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="2377">2377</th><td>}</td></tr>
<tr><th id="2378">2378</th><td></td></tr>
<tr><th id="2379">2379</th><td><i>/*================================== Commands =============================== */</i></td></tr>
<tr><th id="2380">2380</th><td></td></tr>
<tr><th id="2381">2381</th><td><i>/* Return zero if strings are the same, non-zero if they are not.</i></td></tr>
<tr><th id="2382">2382</th><td><i> * The comparison is performed in a way that prevents an attacker to obtain</i></td></tr>
<tr><th id="2383">2383</th><td><i> * information about the nature of the strings just monitoring the execution</i></td></tr>
<tr><th id="2384">2384</th><td><i> * time of the function.</i></td></tr>
<tr><th id="2385">2385</th><td><i> *</i></td></tr>
<tr><th id="2386">2386</th><td><i> * Note that limiting the comparison length to strings up to 512 bytes we</i></td></tr>
<tr><th id="2387">2387</th><td><i> * can avoid leaking any information about the password length and any</i></td></tr>
<tr><th id="2388">2388</th><td><i> * possible branch misprediction related leak.</i></td></tr>
<tr><th id="2389">2389</th><td><i> */</i></td></tr>
<tr><th id="2390">2390</th><td><em>int</em> <dfn class="decl def fn" id="time_independent_strcmp" title='time_independent_strcmp' data-ref="time_independent_strcmp">time_independent_strcmp</dfn>(<em>char</em> *<dfn class="local col5 decl" id="215a" title='a' data-type='char *' data-ref="215a">a</dfn>, <em>char</em> *<dfn class="local col6 decl" id="216b" title='b' data-type='char *' data-ref="216b">b</dfn>) {</td></tr>
<tr><th id="2391">2391</th><td>    <em>char</em> <dfn class="local col7 decl" id="217bufa" title='bufa' data-type='char [512]' data-ref="217bufa">bufa</dfn>[<a class="macro" href="redis.h.html#91" title="512" data-ref="_M/REDIS_AUTHPASS_MAX_LEN">REDIS_AUTHPASS_MAX_LEN</a>], <dfn class="local col8 decl" id="218bufb" title='bufb' data-type='char [512]' data-ref="218bufb">bufb</dfn>[<a class="macro" href="redis.h.html#91" title="512" data-ref="_M/REDIS_AUTHPASS_MAX_LEN">REDIS_AUTHPASS_MAX_LEN</a>];</td></tr>
<tr><th id="2392">2392</th><td>    <i>/* The above two strlen perform len(a) + len(b) operations where either</i></td></tr>
<tr><th id="2393">2393</th><td><i>     * a or b are fixed (our password) length, and the difference is only</i></td></tr>
<tr><th id="2394">2394</th><td><i>     * relative to the length of the user provided string, so no information</i></td></tr>
<tr><th id="2395">2395</th><td><i>     * leak is possible in the following two lines of code. */</i></td></tr>
<tr><th id="2396">2396</th><td>    <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="219alen" title='alen' data-type='unsigned int' data-ref="219alen">alen</dfn> = <a class="ref fn" href="../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col5 ref" href="#215a" title='a' data-ref="215a">a</a>);</td></tr>
<tr><th id="2397">2397</th><td>    <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="220blen" title='blen' data-type='unsigned int' data-ref="220blen">blen</dfn> = <a class="ref fn" href="../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col6 ref" href="#216b" title='b' data-ref="216b">b</a>);</td></tr>
<tr><th id="2398">2398</th><td>    <em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="221j" title='j' data-type='unsigned int' data-ref="221j">j</dfn>;</td></tr>
<tr><th id="2399">2399</th><td>    <em>int</em> <dfn class="local col2 decl" id="222diff" title='diff' data-type='int' data-ref="222diff">diff</dfn> = <var>0</var>;</td></tr>
<tr><th id="2400">2400</th><td></td></tr>
<tr><th id="2401">2401</th><td>    <i>/* We can't compare strings longer than our static buffers.</i></td></tr>
<tr><th id="2402">2402</th><td><i>     * Note that this will never pass the first test in practical circumstances</i></td></tr>
<tr><th id="2403">2403</th><td><i>     * so there is no info leak. */</i></td></tr>
<tr><th id="2404">2404</th><td>    <b>if</b> (<a class="local col9 ref" href="#219alen" title='alen' data-ref="219alen">alen</a> &gt; <b>sizeof</b>(<a class="local col7 ref" href="#217bufa" title='bufa' data-ref="217bufa">bufa</a>) || <a class="local col0 ref" href="#220blen" title='blen' data-ref="220blen">blen</a> &gt; <b>sizeof</b>(<a class="local col8 ref" href="#218bufb" title='bufb' data-ref="218bufb">bufb</a>)) <b>return</b> <var>1</var>;</td></tr>
<tr><th id="2405">2405</th><td></td></tr>
<tr><th id="2406">2406</th><td>    <a class="ref fn" href="../../include/string.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col7 ref" href="#217bufa" title='bufa' data-ref="217bufa">bufa</a>,<var>0</var>,<b>sizeof</b>(<a class="local col7 ref" href="#217bufa" title='bufa' data-ref="217bufa">bufa</a>));        <i>/* Constant time. */</i></td></tr>
<tr><th id="2407">2407</th><td>    <a class="ref fn" href="../../include/string.h.html#memset" title='memset' data-ref="memset">memset</a>(<a class="local col8 ref" href="#218bufb" title='bufb' data-ref="218bufb">bufb</a>,<var>0</var>,<b>sizeof</b>(<a class="local col8 ref" href="#218bufb" title='bufb' data-ref="218bufb">bufb</a>));        <i>/* Constant time. */</i></td></tr>
<tr><th id="2408">2408</th><td>    <i>/* Again the time of the following two copies is proportional to</i></td></tr>
<tr><th id="2409">2409</th><td><i>     * len(a) + len(b) so no info is leaked. */</i></td></tr>
<tr><th id="2410">2410</th><td>    <a class="ref fn" href="../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col7 ref" href="#217bufa" title='bufa' data-ref="217bufa">bufa</a>,<a class="local col5 ref" href="#215a" title='a' data-ref="215a">a</a>,<a class="local col9 ref" href="#219alen" title='alen' data-ref="219alen">alen</a>);</td></tr>
<tr><th id="2411">2411</th><td>    <a class="ref fn" href="../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col8 ref" href="#218bufb" title='bufb' data-ref="218bufb">bufb</a>,<a class="local col6 ref" href="#216b" title='b' data-ref="216b">b</a>,<a class="local col0 ref" href="#220blen" title='blen' data-ref="220blen">blen</a>);</td></tr>
<tr><th id="2412">2412</th><td></td></tr>
<tr><th id="2413">2413</th><td>    <i>/* Always compare all the chars in the two buffers without</i></td></tr>
<tr><th id="2414">2414</th><td><i>     * conditional expressions. */</i></td></tr>
<tr><th id="2415">2415</th><td>    <b>for</b> (<a class="local col1 ref" href="#221j" title='j' data-ref="221j">j</a> = <var>0</var>; <a class="local col1 ref" href="#221j" title='j' data-ref="221j">j</a> &lt; <b>sizeof</b>(<a class="local col7 ref" href="#217bufa" title='bufa' data-ref="217bufa">bufa</a>); <a class="local col1 ref" href="#221j" title='j' data-ref="221j">j</a>++) {</td></tr>
<tr><th id="2416">2416</th><td>        <a class="local col2 ref" href="#222diff" title='diff' data-ref="222diff">diff</a> |= (<a class="local col7 ref" href="#217bufa" title='bufa' data-ref="217bufa">bufa</a>[<a class="local col1 ref" href="#221j" title='j' data-ref="221j">j</a>] ^ <a class="local col8 ref" href="#218bufb" title='bufb' data-ref="218bufb">bufb</a>[<a class="local col1 ref" href="#221j" title='j' data-ref="221j">j</a>]);</td></tr>
<tr><th id="2417">2417</th><td>    }</td></tr>
<tr><th id="2418">2418</th><td>    <i>/* Length must be equal as well. */</i></td></tr>
<tr><th id="2419">2419</th><td>    <a class="local col2 ref" href="#222diff" title='diff' data-ref="222diff">diff</a> |= <a class="local col9 ref" href="#219alen" title='alen' data-ref="219alen">alen</a> ^ <a class="local col0 ref" href="#220blen" title='blen' data-ref="220blen">blen</a>;</td></tr>
<tr><th id="2420">2420</th><td>    <b>return</b> <a class="local col2 ref" href="#222diff" title='diff' data-ref="222diff">diff</a>; <i>/* If zero strings are the same. */</i></td></tr>
<tr><th id="2421">2421</th><td>}</td></tr>
<tr><th id="2422">2422</th><td></td></tr>
<tr><th id="2423">2423</th><td><em>void</em> <dfn class="decl def fn" id="authCommand" title='authCommand' data-ref="authCommand">authCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col3 decl" id="223c" title='c' data-type='redisClient *' data-ref="223c">c</dfn>) {</td></tr>
<tr><th id="2424">2424</th><td>    <b>if</b> (!<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::requirepass" title='redisServer::requirepass' data-ref="redisServer::requirepass">requirepass</a>) {</td></tr>
<tr><th id="2425">2425</th><td>        <a class="ref fn" href="redis.h.html#addReplyError" title='addReplyError' data-ref="addReplyError">addReplyError</a>(<a class="local col3 ref" href="#223c" title='c' data-ref="223c">c</a>,<q>"Client sent AUTH, but no password is set"</q>);</td></tr>
<tr><th id="2426">2426</th><td>    } <b>else</b> <b>if</b> (!<a class="ref fn" href="#time_independent_strcmp" title='time_independent_strcmp' data-ref="time_independent_strcmp">time_independent_strcmp</a>(<a class="local col3 ref" href="#223c" title='c' data-ref="223c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::requirepass" title='redisServer::requirepass' data-ref="redisServer::requirepass">requirepass</a>)) {</td></tr>
<tr><th id="2427">2427</th><td>      <a class="local col3 ref" href="#223c" title='c' data-ref="223c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::authenticated" title='redisClient::authenticated' data-ref="redisClient::authenticated">authenticated</a> = <var>1</var>;</td></tr>
<tr><th id="2428">2428</th><td>      <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col3 ref" href="#223c" title='c' data-ref="223c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::ok" title='sharedObjectsStruct::ok' data-ref="sharedObjectsStruct::ok">ok</a>);</td></tr>
<tr><th id="2429">2429</th><td>    } <b>else</b> {</td></tr>
<tr><th id="2430">2430</th><td>      <a class="local col3 ref" href="#223c" title='c' data-ref="223c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::authenticated" title='redisClient::authenticated' data-ref="redisClient::authenticated">authenticated</a> = <var>0</var>;</td></tr>
<tr><th id="2431">2431</th><td>      <a class="ref fn" href="redis.h.html#addReplyError" title='addReplyError' data-ref="addReplyError">addReplyError</a>(<a class="local col3 ref" href="#223c" title='c' data-ref="223c">c</a>,<q>"invalid password"</q>);</td></tr>
<tr><th id="2432">2432</th><td>    }</td></tr>
<tr><th id="2433">2433</th><td>}</td></tr>
<tr><th id="2434">2434</th><td></td></tr>
<tr><th id="2435">2435</th><td><i>/* The PING command. It works in a different way if the client is in</i></td></tr>
<tr><th id="2436">2436</th><td><i> * in Pub/Sub mode. */</i></td></tr>
<tr><th id="2437">2437</th><td><em>void</em> <dfn class="decl def fn" id="pingCommand" title='pingCommand' data-ref="pingCommand">pingCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col4 decl" id="224c" title='c' data-type='redisClient *' data-ref="224c">c</dfn>) {</td></tr>
<tr><th id="2438">2438</th><td>    <i>/* The command takes zero or one arguments. */</i></td></tr>
<tr><th id="2439">2439</th><td>    <b>if</b> (<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> &gt; <var>2</var>) {</td></tr>
<tr><th id="2440">2440</th><td>        <a class="ref fn" href="redis.h.html#addReplyErrorFormat" title='addReplyErrorFormat' data-ref="addReplyErrorFormat">addReplyErrorFormat</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<q>"wrong number of arguments for '%s' command"</q>,</td></tr>
<tr><th id="2441">2441</th><td>            <a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::cmd" title='redisClient::cmd' data-ref="redisClient::cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::name" title='redisCommand::name' data-ref="redisCommand::name">name</a>);</td></tr>
<tr><th id="2442">2442</th><td>        <b>return</b>;</td></tr>
<tr><th id="2443">2443</th><td>    }</td></tr>
<tr><th id="2444">2444</th><td></td></tr>
<tr><th id="2445">2445</th><td>    <b>if</b> (<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#251" title="(1&lt;&lt;18)" data-ref="_M/REDIS_PUBSUB">REDIS_PUBSUB</a>) {</td></tr>
<tr><th id="2446">2446</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::mbulkhdr" title='sharedObjectsStruct::mbulkhdr' data-ref="sharedObjectsStruct::mbulkhdr">mbulkhdr</a>[<var>2</var>]);</td></tr>
<tr><th id="2447">2447</th><td>        <a class="ref fn" href="redis.h.html#addReplyBulkCBuffer" title='addReplyBulkCBuffer' data-ref="addReplyBulkCBuffer">addReplyBulkCBuffer</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<q>"pong"</q>,<var>4</var>);</td></tr>
<tr><th id="2448">2448</th><td>        <b>if</b> (<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>1</var>)</td></tr>
<tr><th id="2449">2449</th><td>            <a class="ref fn" href="redis.h.html#addReplyBulkCBuffer" title='addReplyBulkCBuffer' data-ref="addReplyBulkCBuffer">addReplyBulkCBuffer</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<q>""</q>,<var>0</var>);</td></tr>
<tr><th id="2450">2450</th><td>        <b>else</b></td></tr>
<tr><th id="2451">2451</th><td>            <a class="ref fn" href="redis.h.html#addReplyBulk" title='addReplyBulk' data-ref="addReplyBulk">addReplyBulk</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]);</td></tr>
<tr><th id="2452">2452</th><td>    } <b>else</b> {</td></tr>
<tr><th id="2453">2453</th><td>        <b>if</b> (<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>1</var>)</td></tr>
<tr><th id="2454">2454</th><td>            <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::pong" title='sharedObjectsStruct::pong' data-ref="sharedObjectsStruct::pong">pong</a>);</td></tr>
<tr><th id="2455">2455</th><td>        <b>else</b></td></tr>
<tr><th id="2456">2456</th><td>            <a class="ref fn" href="redis.h.html#addReplyBulk" title='addReplyBulk' data-ref="addReplyBulk">addReplyBulk</a>(<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>,<a class="local col4 ref" href="#224c" title='c' data-ref="224c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]);</td></tr>
<tr><th id="2457">2457</th><td>    }</td></tr>
<tr><th id="2458">2458</th><td>}</td></tr>
<tr><th id="2459">2459</th><td></td></tr>
<tr><th id="2460">2460</th><td><em>void</em> <dfn class="decl def fn" id="echoCommand" title='echoCommand' data-ref="echoCommand">echoCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col5 decl" id="225c" title='c' data-type='redisClient *' data-ref="225c">c</dfn>) {</td></tr>
<tr><th id="2461">2461</th><td>    <a class="ref fn" href="redis.h.html#addReplyBulk" title='addReplyBulk' data-ref="addReplyBulk">addReplyBulk</a>(<a class="local col5 ref" href="#225c" title='c' data-ref="225c">c</a>,<a class="local col5 ref" href="#225c" title='c' data-ref="225c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]);</td></tr>
<tr><th id="2462">2462</th><td>}</td></tr>
<tr><th id="2463">2463</th><td></td></tr>
<tr><th id="2464">2464</th><td><em>void</em> <dfn class="decl def fn" id="timeCommand" title='timeCommand' data-ref="timeCommand">timeCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col6 decl" id="226c" title='c' data-type='redisClient *' data-ref="226c">c</dfn>) {</td></tr>
<tr><th id="2465">2465</th><td>    <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval" title='timeval' data-ref="timeval">timeval</a> <dfn class="local col7 decl" id="227tv" title='tv' data-type='struct timeval' data-ref="227tv">tv</dfn>;</td></tr>
<tr><th id="2466">2466</th><td></td></tr>
<tr><th id="2467">2467</th><td>    <i>/* gettimeofday() can only fail if &amp;tv is a bad address so we</i></td></tr>
<tr><th id="2468">2468</th><td><i>     * don't check for errors. */</i></td></tr>
<tr><th id="2469">2469</th><td>    <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/time.h.html#gettimeofday" title='gettimeofday' data-ref="gettimeofday">gettimeofday</a>(&amp;<a class="local col7 ref" href="#227tv" title='tv' data-ref="227tv">tv</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="2470">2470</th><td>    <a class="ref fn" href="redis.h.html#addReplyMultiBulkLen" title='addReplyMultiBulkLen' data-ref="addReplyMultiBulkLen">addReplyMultiBulkLen</a>(<a class="local col6 ref" href="#226c" title='c' data-ref="226c">c</a>,<var>2</var>);</td></tr>
<tr><th id="2471">2471</th><td>    <a class="ref fn" href="redis.h.html#addReplyBulkLongLong" title='addReplyBulkLongLong' data-ref="addReplyBulkLongLong">addReplyBulkLongLong</a>(<a class="local col6 ref" href="#226c" title='c' data-ref="226c">c</a>,<a class="local col7 ref" href="#227tv" title='tv' data-ref="227tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>);</td></tr>
<tr><th id="2472">2472</th><td>    <a class="ref fn" href="redis.h.html#addReplyBulkLongLong" title='addReplyBulkLongLong' data-ref="addReplyBulkLongLong">addReplyBulkLongLong</a>(<a class="local col6 ref" href="#226c" title='c' data-ref="226c">c</a>,<a class="local col7 ref" href="#227tv" title='tv' data-ref="227tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>);</td></tr>
<tr><th id="2473">2473</th><td>}</td></tr>
<tr><th id="2474">2474</th><td></td></tr>
<tr><th id="2475">2475</th><td></td></tr>
<tr><th id="2476">2476</th><td><i>/* Helper function for addReplyCommand() to output flags. */</i></td></tr>
<tr><th id="2477">2477</th><td><em>int</em> <dfn class="decl def fn" id="addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col8 decl" id="228c" title='c' data-type='redisClient *' data-ref="228c">c</dfn>, <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col9 decl" id="229cmd" title='cmd' data-type='struct redisCommand *' data-ref="229cmd">cmd</dfn>, <em>int</em> <dfn class="local col0 decl" id="230f" title='f' data-type='int' data-ref="230f">f</dfn>, <em>char</em> *<dfn class="local col1 decl" id="231reply" title='reply' data-type='char *' data-ref="231reply">reply</dfn>) {</td></tr>
<tr><th id="2478">2478</th><td>    <b>if</b> (<a class="local col9 ref" href="#229cmd" title='cmd' data-ref="229cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::flags" title='redisCommand::flags' data-ref="redisCommand::flags">flags</a> &amp; <a class="local col0 ref" href="#230f" title='f' data-ref="230f">f</a>) {</td></tr>
<tr><th id="2479">2479</th><td>        <a class="ref fn" href="redis.h.html#addReplyStatus" title='addReplyStatus' data-ref="addReplyStatus">addReplyStatus</a>(<a class="local col8 ref" href="#228c" title='c' data-ref="228c">c</a>, <a class="local col1 ref" href="#231reply" title='reply' data-ref="231reply">reply</a>);</td></tr>
<tr><th id="2480">2480</th><td>        <b>return</b> <var>1</var>;</td></tr>
<tr><th id="2481">2481</th><td>    }</td></tr>
<tr><th id="2482">2482</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2483">2483</th><td>}</td></tr>
<tr><th id="2484">2484</th><td></td></tr>
<tr><th id="2485">2485</th><td><i>/* Output the representation of a Redis command. Used by the COMMAND command. */</i></td></tr>
<tr><th id="2486">2486</th><td><em>void</em> <dfn class="decl def fn" id="addReplyCommand" title='addReplyCommand' data-ref="addReplyCommand">addReplyCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col2 decl" id="232c" title='c' data-type='redisClient *' data-ref="232c">c</dfn>, <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col3 decl" id="233cmd" title='cmd' data-type='struct redisCommand *' data-ref="233cmd">cmd</dfn>) {</td></tr>
<tr><th id="2487">2487</th><td>    <b>if</b> (!<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>) {</td></tr>
<tr><th id="2488">2488</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::nullbulk" title='sharedObjectsStruct::nullbulk' data-ref="sharedObjectsStruct::nullbulk">nullbulk</a>);</td></tr>
<tr><th id="2489">2489</th><td>    } <b>else</b> {</td></tr>
<tr><th id="2490">2490</th><td>        <i>/* We are adding: command name, arg count, flags, first, last, offset */</i></td></tr>
<tr><th id="2491">2491</th><td>        <a class="ref fn" href="redis.h.html#addReplyMultiBulkLen" title='addReplyMultiBulkLen' data-ref="addReplyMultiBulkLen">addReplyMultiBulkLen</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <var>6</var>);</td></tr>
<tr><th id="2492">2492</th><td>        <a class="ref fn" href="redis.h.html#addReplyBulkCString" title='addReplyBulkCString' data-ref="addReplyBulkCString">addReplyBulkCString</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::name" title='redisCommand::name' data-ref="redisCommand::name">name</a>);</td></tr>
<tr><th id="2493">2493</th><td>        <a class="ref fn" href="redis.h.html#addReplyLongLong" title='addReplyLongLong' data-ref="addReplyLongLong">addReplyLongLong</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a>);</td></tr>
<tr><th id="2494">2494</th><td></td></tr>
<tr><th id="2495">2495</th><td>        <em>int</em> <dfn class="local col4 decl" id="234flagcount" title='flagcount' data-type='int' data-ref="234flagcount">flagcount</dfn> = <var>0</var>;</td></tr>
<tr><th id="2496">2496</th><td>        <em>void</em> *<dfn class="local col5 decl" id="235flaglen" title='flaglen' data-type='void *' data-ref="235flaglen">flaglen</dfn> = <a class="ref fn" href="redis.h.html#addDeferredMultiBulkLength" title='addDeferredMultiBulkLength' data-ref="addDeferredMultiBulkLength">addDeferredMultiBulkLength</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>);</td></tr>
<tr><th id="2497">2497</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#164" title="1" data-ref="_M/REDIS_CMD_WRITE">REDIS_CMD_WRITE</a>, <q>"write"</q>);</td></tr>
<tr><th id="2498">2498</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#165" title="2" data-ref="_M/REDIS_CMD_READONLY">REDIS_CMD_READONLY</a>, <q>"readonly"</q>);</td></tr>
<tr><th id="2499">2499</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#166" title="4" data-ref="_M/REDIS_CMD_DENYOOM">REDIS_CMD_DENYOOM</a>, <q>"denyoom"</q>);</td></tr>
<tr><th id="2500">2500</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#168" title="16" data-ref="_M/REDIS_CMD_ADMIN">REDIS_CMD_ADMIN</a>, <q>"admin"</q>);</td></tr>
<tr><th id="2501">2501</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#169" title="32" data-ref="_M/REDIS_CMD_PUBSUB">REDIS_CMD_PUBSUB</a>, <q>"pubsub"</q>);</td></tr>
<tr><th id="2502">2502</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#170" title="64" data-ref="_M/REDIS_CMD_NOSCRIPT">REDIS_CMD_NOSCRIPT</a>, <q>"noscript"</q>);</td></tr>
<tr><th id="2503">2503</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#171" title="128" data-ref="_M/REDIS_CMD_RANDOM">REDIS_CMD_RANDOM</a>, <q>"random"</q>);</td></tr>
<tr><th id="2504">2504</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#172" title="256" data-ref="_M/REDIS_CMD_SORT_FOR_SCRIPT">REDIS_CMD_SORT_FOR_SCRIPT</a>,<q>"sort_for_script"</q>);</td></tr>
<tr><th id="2505">2505</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#173" title="512" data-ref="_M/REDIS_CMD_LOADING">REDIS_CMD_LOADING</a>, <q>"loading"</q>);</td></tr>
<tr><th id="2506">2506</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#174" title="1024" data-ref="_M/REDIS_CMD_STALE">REDIS_CMD_STALE</a>, <q>"stale"</q>);</td></tr>
<tr><th id="2507">2507</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#175" title="2048" data-ref="_M/REDIS_CMD_SKIP_MONITOR">REDIS_CMD_SKIP_MONITOR</a>, <q>"skip_monitor"</q>);</td></tr>
<tr><th id="2508">2508</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#176" title="4096" data-ref="_M/REDIS_CMD_ASKING">REDIS_CMD_ASKING</a>, <q>"asking"</q>);</td></tr>
<tr><th id="2509">2509</th><td>        <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <a class="ref fn" href="#addReplyCommandFlag" title='addReplyCommandFlag' data-ref="addReplyCommandFlag">addReplyCommandFlag</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>,<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>,<a class="macro" href="redis.h.html#177" title="8192" data-ref="_M/REDIS_CMD_FAST">REDIS_CMD_FAST</a>, <q>"fast"</q>);</td></tr>
<tr><th id="2510">2510</th><td>        <b>if</b> (<a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::getkeys_proc" title='redisCommand::getkeys_proc' data-ref="redisCommand::getkeys_proc">getkeys_proc</a>) {</td></tr>
<tr><th id="2511">2511</th><td>            <a class="ref fn" href="redis.h.html#addReplyStatus" title='addReplyStatus' data-ref="addReplyStatus">addReplyStatus</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <q>"movablekeys"</q>);</td></tr>
<tr><th id="2512">2512</th><td>            <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a> += <var>1</var>;</td></tr>
<tr><th id="2513">2513</th><td>        }</td></tr>
<tr><th id="2514">2514</th><td>        <a class="ref fn" href="redis.h.html#setDeferredMultiBulkLength" title='setDeferredMultiBulkLength' data-ref="setDeferredMultiBulkLength">setDeferredMultiBulkLength</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="local col5 ref" href="#235flaglen" title='flaglen' data-ref="235flaglen">flaglen</a>, <a class="local col4 ref" href="#234flagcount" title='flagcount' data-ref="234flagcount">flagcount</a>);</td></tr>
<tr><th id="2515">2515</th><td></td></tr>
<tr><th id="2516">2516</th><td>        <a class="ref fn" href="redis.h.html#addReplyLongLong" title='addReplyLongLong' data-ref="addReplyLongLong">addReplyLongLong</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::firstkey" title='redisCommand::firstkey' data-ref="redisCommand::firstkey">firstkey</a>);</td></tr>
<tr><th id="2517">2517</th><td>        <a class="ref fn" href="redis.h.html#addReplyLongLong" title='addReplyLongLong' data-ref="addReplyLongLong">addReplyLongLong</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::lastkey" title='redisCommand::lastkey' data-ref="redisCommand::lastkey">lastkey</a>);</td></tr>
<tr><th id="2518">2518</th><td>        <a class="ref fn" href="redis.h.html#addReplyLongLong" title='addReplyLongLong' data-ref="addReplyLongLong">addReplyLongLong</a>(<a class="local col2 ref" href="#232c" title='c' data-ref="232c">c</a>, <a class="local col3 ref" href="#233cmd" title='cmd' data-ref="233cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::keystep" title='redisCommand::keystep' data-ref="redisCommand::keystep">keystep</a>);</td></tr>
<tr><th id="2519">2519</th><td>    }</td></tr>
<tr><th id="2520">2520</th><td>}</td></tr>
<tr><th id="2521">2521</th><td></td></tr>
<tr><th id="2522">2522</th><td><i>/* COMMAND &lt;subcommand&gt; &lt;args&gt; */</i></td></tr>
<tr><th id="2523">2523</th><td><em>void</em> <dfn class="decl def fn" id="commandCommand" title='commandCommand' data-ref="commandCommand">commandCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col6 decl" id="236c" title='c' data-type='redisClient *' data-ref="236c">c</dfn>) {</td></tr>
<tr><th id="2524">2524</th><td>    <a class="typedef" href="dict.h.html#dictIterator" title='dictIterator' data-type='struct dictIterator' data-ref="dictIterator">dictIterator</a> *<dfn class="local col7 decl" id="237di" title='di' data-type='dictIterator *' data-ref="237di">di</dfn>;</td></tr>
<tr><th id="2525">2525</th><td>    <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> *<dfn class="local col8 decl" id="238de" title='de' data-type='dictEntry *' data-ref="238de">de</dfn>;</td></tr>
<tr><th id="2526">2526</th><td></td></tr>
<tr><th id="2527">2527</th><td>    <b>if</b> (<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>1</var>) {</td></tr>
<tr><th id="2528">2528</th><td>        <a class="ref fn" href="redis.h.html#addReplyMultiBulkLen" title='addReplyMultiBulkLen' data-ref="addReplyMultiBulkLen">addReplyMultiBulkLen</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>, <a class="macro" href="dict.h.html#146" title="((server.commands)-&gt;ht[0].used+(server.commands)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>));</td></tr>
<tr><th id="2529">2529</th><td>        <a class="local col7 ref" href="#237di" title='di' data-ref="237di">di</a> = <a class="ref fn" href="dict.h.html#dictGetIterator" title='dictGetIterator' data-ref="dictGetIterator">dictGetIterator</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>);</td></tr>
<tr><th id="2530">2530</th><td>        <b>while</b> ((<a class="local col8 ref" href="#238de" title='de' data-ref="238de">de</a> = <a class="ref fn" href="dict.h.html#dictNext" title='dictNext' data-ref="dictNext">dictNext</a>(<a class="local col7 ref" href="#237di" title='di' data-ref="237di">di</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2531">2531</th><td>            <a class="ref fn" href="#addReplyCommand" title='addReplyCommand' data-ref="addReplyCommand">addReplyCommand</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>, <a class="macro" href="dict.h.html#141" title="((de)-&gt;v.val)" data-ref="_M/dictGetVal">dictGetVal</a>(<a class="local col8 ref" href="#238de" title='de' data-ref="238de">de</a>));</td></tr>
<tr><th id="2532">2532</th><td>        }</td></tr>
<tr><th id="2533">2533</th><td>        <a class="ref fn" href="dict.h.html#dictReleaseIterator" title='dictReleaseIterator' data-ref="dictReleaseIterator">dictReleaseIterator</a>(<a class="local col7 ref" href="#237di" title='di' data-ref="237di">di</a>);</td></tr>
<tr><th id="2534">2534</th><td>    } <b>else</b> <b>if</b> (!<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>, <q>"info"</q>)) {</td></tr>
<tr><th id="2535">2535</th><td>        <em>int</em> <dfn class="local col9 decl" id="239i" title='i' data-type='int' data-ref="239i">i</dfn>;</td></tr>
<tr><th id="2536">2536</th><td>        <a class="ref fn" href="redis.h.html#addReplyMultiBulkLen" title='addReplyMultiBulkLen' data-ref="addReplyMultiBulkLen">addReplyMultiBulkLen</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>, <a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>-<var>2</var>);</td></tr>
<tr><th id="2537">2537</th><td>        <b>for</b> (<a class="local col9 ref" href="#239i" title='i' data-ref="239i">i</a> = <var>2</var>; <a class="local col9 ref" href="#239i" title='i' data-ref="239i">i</a> &lt; <a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>; <a class="local col9 ref" href="#239i" title='i' data-ref="239i">i</a>++) {</td></tr>
<tr><th id="2538">2538</th><td>            <a class="ref fn" href="#addReplyCommand" title='addReplyCommand' data-ref="addReplyCommand">addReplyCommand</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>, <a class="ref fn" href="dict.h.html#dictFetchValue" title='dictFetchValue' data-ref="dictFetchValue">dictFetchValue</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>, <a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<a class="local col9 ref" href="#239i" title='i' data-ref="239i">i</a>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>));</td></tr>
<tr><th id="2539">2539</th><td>        }</td></tr>
<tr><th id="2540">2540</th><td>    } <b>else</b> <b>if</b> (!<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>, <q>"count"</q>) &amp;&amp; <a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>2</var>) {</td></tr>
<tr><th id="2541">2541</th><td>        <a class="ref fn" href="redis.h.html#addReplyLongLong" title='addReplyLongLong' data-ref="addReplyLongLong">addReplyLongLong</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>, <a class="macro" href="dict.h.html#146" title="((server.commands)-&gt;ht[0].used+(server.commands)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::commands" title='redisServer::commands' data-ref="redisServer::commands">commands</a>));</td></tr>
<tr><th id="2542">2542</th><td>    } <b>else</b> <b>if</b> (!<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>,<q>"getkeys"</q>) &amp;&amp; <a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> &gt;= <var>3</var>) {</td></tr>
<tr><th id="2543">2543</th><td>        <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col0 decl" id="240cmd" title='cmd' data-type='struct redisCommand *' data-ref="240cmd">cmd</dfn> = <a class="ref fn" href="#lookupCommand" title='lookupCommand' data-ref="lookupCommand">lookupCommand</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>2</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a>);</td></tr>
<tr><th id="2544">2544</th><td>        <em>int</em> *<dfn class="local col1 decl" id="241keys" title='keys' data-type='int *' data-ref="241keys">keys</dfn>, <dfn class="local col2 decl" id="242numkeys" title='numkeys' data-type='int' data-ref="242numkeys">numkeys</dfn>, <dfn class="local col3 decl" id="243j" title='j' data-type='int' data-ref="243j">j</dfn>;</td></tr>
<tr><th id="2545">2545</th><td></td></tr>
<tr><th id="2546">2546</th><td>        <b>if</b> (!<a class="local col0 ref" href="#240cmd" title='cmd' data-ref="240cmd">cmd</a>) {</td></tr>
<tr><th id="2547">2547</th><td>            <a class="ref fn" href="redis.h.html#addReplyErrorFormat" title='addReplyErrorFormat' data-ref="addReplyErrorFormat">addReplyErrorFormat</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>,<q>"Invalid command specified"</q>);</td></tr>
<tr><th id="2548">2548</th><td>            <b>return</b>;</td></tr>
<tr><th id="2549">2549</th><td>        } <b>else</b> <b>if</b> ((<a class="local col0 ref" href="#240cmd" title='cmd' data-ref="240cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a> &gt; <var>0</var> &amp;&amp; <a class="local col0 ref" href="#240cmd" title='cmd' data-ref="240cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a> != <a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>-<var>2</var>) ||</td></tr>
<tr><th id="2550">2550</th><td>                   ((<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>-<var>2</var>) &lt; -<a class="local col0 ref" href="#240cmd" title='cmd' data-ref="240cmd">cmd</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::arity" title='redisCommand::arity' data-ref="redisCommand::arity">arity</a>))</td></tr>
<tr><th id="2551">2551</th><td>        {</td></tr>
<tr><th id="2552">2552</th><td>            <a class="ref fn" href="redis.h.html#addReplyError" title='addReplyError' data-ref="addReplyError">addReplyError</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>,<q>"Invalid number of arguments specified for command"</q>);</td></tr>
<tr><th id="2553">2553</th><td>            <b>return</b>;</td></tr>
<tr><th id="2554">2554</th><td>        }</td></tr>
<tr><th id="2555">2555</th><td></td></tr>
<tr><th id="2556">2556</th><td>        <a class="local col1 ref" href="#241keys" title='keys' data-ref="241keys">keys</a> = <a class="ref fn" href="redis.h.html#getKeysFromCommand" title='getKeysFromCommand' data-ref="getKeysFromCommand">getKeysFromCommand</a>(<a class="local col0 ref" href="#240cmd" title='cmd' data-ref="240cmd">cmd</a>,<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>+<var>2</var>,<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a>-<var>2</var>,&amp;<a class="local col2 ref" href="#242numkeys" title='numkeys' data-ref="242numkeys">numkeys</a>);</td></tr>
<tr><th id="2557">2557</th><td>        <a class="ref fn" href="redis.h.html#addReplyMultiBulkLen" title='addReplyMultiBulkLen' data-ref="addReplyMultiBulkLen">addReplyMultiBulkLen</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>,<a class="local col2 ref" href="#242numkeys" title='numkeys' data-ref="242numkeys">numkeys</a>);</td></tr>
<tr><th id="2558">2558</th><td>        <b>for</b> (<a class="local col3 ref" href="#243j" title='j' data-ref="243j">j</a> = <var>0</var>; <a class="local col3 ref" href="#243j" title='j' data-ref="243j">j</a> &lt; <a class="local col2 ref" href="#242numkeys" title='numkeys' data-ref="242numkeys">numkeys</a>; <a class="local col3 ref" href="#243j" title='j' data-ref="243j">j</a>++) <a class="ref fn" href="redis.h.html#addReplyBulk" title='addReplyBulk' data-ref="addReplyBulk">addReplyBulk</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>,<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<a class="local col1 ref" href="#241keys" title='keys' data-ref="241keys">keys</a>[<a class="local col3 ref" href="#243j" title='j' data-ref="243j">j</a>]+<var>2</var>]);</td></tr>
<tr><th id="2559">2559</th><td>        <a class="ref fn" href="redis.h.html#getKeysFreeResult" title='getKeysFreeResult' data-ref="getKeysFreeResult">getKeysFreeResult</a>(<a class="local col1 ref" href="#241keys" title='keys' data-ref="241keys">keys</a>);</td></tr>
<tr><th id="2560">2560</th><td>    } <b>else</b> {</td></tr>
<tr><th id="2561">2561</th><td>        <a class="ref fn" href="redis.h.html#addReplyError" title='addReplyError' data-ref="addReplyError">addReplyError</a>(<a class="local col6 ref" href="#236c" title='c' data-ref="236c">c</a>, <q>"Unknown subcommand or wrong number of arguments."</q>);</td></tr>
<tr><th id="2562">2562</th><td>        <b>return</b>;</td></tr>
<tr><th id="2563">2563</th><td>    }</td></tr>
<tr><th id="2564">2564</th><td>}</td></tr>
<tr><th id="2565">2565</th><td></td></tr>
<tr><th id="2566">2566</th><td><i>/* Convert an amount of bytes into a human readable string in the form</i></td></tr>
<tr><th id="2567">2567</th><td><i> * of 100B, 2G, 100M, 4K, and so forth. */</i></td></tr>
<tr><th id="2568">2568</th><td><em>void</em> <dfn class="decl def fn" id="bytesToHuman" title='bytesToHuman' data-ref="bytesToHuman">bytesToHuman</dfn>(<em>char</em> *<dfn class="local col4 decl" id="244s" title='s' data-type='char *' data-ref="244s">s</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col5 decl" id="245n" title='n' data-type='unsigned long long' data-ref="245n">n</dfn>) {</td></tr>
<tr><th id="2569">2569</th><td>    <em>double</em> <dfn class="local col6 decl" id="246d" title='d' data-type='double' data-ref="246d">d</dfn>;</td></tr>
<tr><th id="2570">2570</th><td></td></tr>
<tr><th id="2571">2571</th><td>    <b>if</b> (<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a> &lt; <var>1024</var>) {</td></tr>
<tr><th id="2572">2572</th><td>        <i>/* Bytes */</i></td></tr>
<tr><th id="2573">2573</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%lluB"</q>,<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>);</td></tr>
<tr><th id="2574">2574</th><td>        <b>return</b>;</td></tr>
<tr><th id="2575">2575</th><td>    } <b>else</b> <b>if</b> (<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a> &lt; (<var>1024</var>*<var>1024</var>)) {</td></tr>
<tr><th id="2576">2576</th><td>        <a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a> = (<em>double</em>)<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>/(<var>1024</var>);</td></tr>
<tr><th id="2577">2577</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%.2fK"</q>,<a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a>);</td></tr>
<tr><th id="2578">2578</th><td>    } <b>else</b> <b>if</b> (<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a> &lt; (<var>1024LL</var>*<var>1024</var>*<var>1024</var>)) {</td></tr>
<tr><th id="2579">2579</th><td>        <a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a> = (<em>double</em>)<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>/(<var>1024</var>*<var>1024</var>);</td></tr>
<tr><th id="2580">2580</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%.2fM"</q>,<a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a>);</td></tr>
<tr><th id="2581">2581</th><td>    } <b>else</b> <b>if</b> (<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a> &lt; (<var>1024LL</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>)) {</td></tr>
<tr><th id="2582">2582</th><td>        <a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a> = (<em>double</em>)<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>/(<var>1024LL</var>*<var>1024</var>*<var>1024</var>);</td></tr>
<tr><th id="2583">2583</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%.2fG"</q>,<a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a>);</td></tr>
<tr><th id="2584">2584</th><td>    } <b>else</b> <b>if</b> (<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a> &lt; (<var>1024LL</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>)) {</td></tr>
<tr><th id="2585">2585</th><td>        <a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a> = (<em>double</em>)<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>/(<var>1024LL</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>);</td></tr>
<tr><th id="2586">2586</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%.2fT"</q>,<a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a>);</td></tr>
<tr><th id="2587">2587</th><td>    } <b>else</b> <b>if</b> (<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a> &lt; (<var>1024LL</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>)) {</td></tr>
<tr><th id="2588">2588</th><td>        <a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a> = (<em>double</em>)<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>/(<var>1024LL</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>*<var>1024</var>);</td></tr>
<tr><th id="2589">2589</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%.2fP"</q>,<a class="local col6 ref" href="#246d" title='d' data-ref="246d">d</a>);</td></tr>
<tr><th id="2590">2590</th><td>    } <b>else</b> {</td></tr>
<tr><th id="2591">2591</th><td>        <i>/* Let's hope we never need this */</i></td></tr>
<tr><th id="2592">2592</th><td>        <a class="ref fn" href="../../include/stdio.h.html#sprintf" title='sprintf' data-ref="sprintf">sprintf</a>(<a class="local col4 ref" href="#244s" title='s' data-ref="244s">s</a>,<q>"%lluB"</q>,<a class="local col5 ref" href="#245n" title='n' data-ref="245n">n</a>);</td></tr>
<tr><th id="2593">2593</th><td>    }</td></tr>
<tr><th id="2594">2594</th><td>}</td></tr>
<tr><th id="2595">2595</th><td></td></tr>
<tr><th id="2596">2596</th><td><i>/* Create the string returned by the INFO command. This is decoupled</i></td></tr>
<tr><th id="2597">2597</th><td><i> * by the INFO command itself as we need to report the same information</i></td></tr>
<tr><th id="2598">2598</th><td><i> * on memory corruption problems. */</i></td></tr>
<tr><th id="2599">2599</th><td><a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="decl def fn" id="genRedisInfoString" title='genRedisInfoString' data-ref="genRedisInfoString">genRedisInfoString</dfn>(<em>char</em> *<dfn class="local col7 decl" id="247section" title='section' data-type='char *' data-ref="247section">section</dfn>) {</td></tr>
<tr><th id="2600">2600</th><td>    <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col8 decl" id="248info" title='info' data-type='sds' data-ref="248info">info</dfn> = <a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>();</td></tr>
<tr><th id="2601">2601</th><td>    <a class="typedef" href="../../include/time.h.html#time_t" title='time_t' data-type='__time_t' data-ref="time_t">time_t</a> <dfn class="local col9 decl" id="249uptime" title='uptime' data-type='time_t' data-ref="249uptime">uptime</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_starttime" title='redisServer::stat_starttime' data-ref="redisServer::stat_starttime">stat_starttime</a>;</td></tr>
<tr><th id="2602">2602</th><td>    <em>int</em> <dfn class="local col0 decl" id="250j" title='j' data-type='int' data-ref="250j">j</dfn>, <dfn class="local col1 decl" id="251numcommands" title='numcommands' data-type='int' data-ref="251numcommands">numcommands</dfn>;</td></tr>
<tr><th id="2603">2603</th><td>    <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage" title='rusage' data-ref="rusage">rusage</a> <dfn class="local col2 decl" id="252self_ru" title='self_ru' data-type='struct rusage' data-ref="252self_ru">self_ru</dfn>, <dfn class="local col3 decl" id="253c_ru" title='c_ru' data-type='struct rusage' data-ref="253c_ru">c_ru</dfn>;</td></tr>
<tr><th id="2604">2604</th><td>    <em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="254lol" title='lol' data-type='unsigned long' data-ref="254lol">lol</dfn>, <dfn class="local col5 decl" id="255bib" title='bib' data-type='unsigned long' data-ref="255bib">bib</dfn>;</td></tr>
<tr><th id="2605">2605</th><td>    <em>int</em> <dfn class="local col6 decl" id="256allsections" title='allsections' data-type='int' data-ref="256allsections">allsections</dfn> = <var>0</var>, <dfn class="local col7 decl" id="257defsections" title='defsections' data-type='int' data-ref="257defsections">defsections</dfn> = <var>0</var>;</td></tr>
<tr><th id="2606">2606</th><td>    <em>int</em> <dfn class="local col8 decl" id="258sections" title='sections' data-type='int' data-ref="258sections">sections</dfn> = <var>0</var>;</td></tr>
<tr><th id="2607">2607</th><td></td></tr>
<tr><th id="2608">2608</th><td>    <b>if</b> (<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) <a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a> = <q>"default"</q>;</td></tr>
<tr><th id="2609">2609</th><td>    <a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> = <a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"all"</q>) == <var>0</var>;</td></tr>
<tr><th id="2610">2610</th><td>    <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> = <a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"default"</q>) == <var>0</var>;</td></tr>
<tr><th id="2611">2611</th><td></td></tr>
<tr><th id="2612">2612</th><td>    <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/resource.h.html#getrusage" title='getrusage' data-ref="getrusage">getrusage</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/resource.h.html#162" title="RUSAGE_SELF" data-ref="_M/RUSAGE_SELF">RUSAGE_SELF</a>, &amp;<a class="local col2 ref" href="#252self_ru" title='self_ru' data-ref="252self_ru">self_ru</a>);</td></tr>
<tr><th id="2613">2613</th><td>    <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/resource.h.html#getrusage" title='getrusage' data-ref="getrusage">getrusage</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/resource.h.html#166" title="RUSAGE_CHILDREN" data-ref="_M/RUSAGE_CHILDREN">RUSAGE_CHILDREN</a>, &amp;<a class="local col3 ref" href="#253c_ru" title='c_ru' data-ref="253c_ru">c_ru</a>);</td></tr>
<tr><th id="2614">2614</th><td>    <a class="ref fn" href="redis.h.html#getClientsMaxBuffers" title='getClientsMaxBuffers' data-ref="getClientsMaxBuffers">getClientsMaxBuffers</a>(&amp;<a class="local col4 ref" href="#254lol" title='lol' data-ref="254lol">lol</a>,&amp;<a class="local col5 ref" href="#255bib" title='bib' data-ref="255bib">bib</a>);</td></tr>
<tr><th id="2615">2615</th><td></td></tr>
<tr><th id="2616">2616</th><td>    <i>/* Server */</i></td></tr>
<tr><th id="2617">2617</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"server"</q>)) {</td></tr>
<tr><th id="2618">2618</th><td>        <em>static</em> <em>int</em> <dfn class="local col9 decl" id="259call_uname" title='call_uname' data-type='int' data-ref="259call_uname">call_uname</dfn> = <var>1</var>;</td></tr>
<tr><th id="2619">2619</th><td>        <em>static</em> <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/sys/utsname.h.html#utsname" title='utsname' data-ref="utsname">utsname</a> <dfn class="local col0 decl" id="260name" title='name' data-type='struct utsname' data-ref="260name">name</dfn>;</td></tr>
<tr><th id="2620">2620</th><td>        <em>char</em> *<dfn class="local col1 decl" id="261mode" title='mode' data-type='char *' data-ref="261mode">mode</dfn>;</td></tr>
<tr><th id="2621">2621</th><td></td></tr>
<tr><th id="2622">2622</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) <a class="local col1 ref" href="#261mode" title='mode' data-ref="261mode">mode</a> = <q>"cluster"</q>;</td></tr>
<tr><th id="2623">2623</th><td>        <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) <a class="local col1 ref" href="#261mode" title='mode' data-ref="261mode">mode</a> = <q>"sentinel"</q>;</td></tr>
<tr><th id="2624">2624</th><td>        <b>else</b> <a class="local col1 ref" href="#261mode" title='mode' data-ref="261mode">mode</a> = <q>"standalone"</q>;</td></tr>
<tr><th id="2625">2625</th><td></td></tr>
<tr><th id="2626">2626</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2627">2627</th><td></td></tr>
<tr><th id="2628">2628</th><td>        <b>if</b> (<a class="local col9 ref" href="#259call_uname" title='call_uname' data-ref="259call_uname">call_uname</a>) {</td></tr>
<tr><th id="2629">2629</th><td>            <i>/* Uname can be slow and is always the same output. Cache it. */</i></td></tr>
<tr><th id="2630">2630</th><td>            <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/utsname.h.html#uname" title='uname' data-ref="uname">uname</a>(&amp;<a class="local col0 ref" href="#260name" title='name' data-ref="260name">name</a>);</td></tr>
<tr><th id="2631">2631</th><td>            <a class="local col9 ref" href="#259call_uname" title='call_uname' data-ref="259call_uname">call_uname</a> = <var>0</var>;</td></tr>
<tr><th id="2632">2632</th><td>        }</td></tr>
<tr><th id="2633">2633</th><td></td></tr>
<tr><th id="2634">2634</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2635">2635</th><td>            <q>"# Server\r\n"</q></td></tr>
<tr><th id="2636">2636</th><td>            <q>"redis_version:%s\r\n"</q></td></tr>
<tr><th id="2637">2637</th><td>            <q>"redis_git_sha1:%s\r\n"</q></td></tr>
<tr><th id="2638">2638</th><td>            <q>"redis_git_dirty:%d\r\n"</q></td></tr>
<tr><th id="2639">2639</th><td>            <q>"redis_build_id:%llx\r\n"</q></td></tr>
<tr><th id="2640">2640</th><td>            <q>"redis_mode:%s\r\n"</q></td></tr>
<tr><th id="2641">2641</th><td>            <q>"os:%s %s %s\r\n"</q></td></tr>
<tr><th id="2642">2642</th><td>            <q>"arch_bits:%d\r\n"</q></td></tr>
<tr><th id="2643">2643</th><td>            <q>"multiplexing_api:%s\r\n"</q></td></tr>
<tr><th id="2644">2644</th><td>            <q>"gcc_version:%d.%d.%d\r\n"</q></td></tr>
<tr><th id="2645">2645</th><td>            <q>"process_id:%ld\r\n"</q></td></tr>
<tr><th id="2646">2646</th><td>            <q>"run_id:%s\r\n"</q></td></tr>
<tr><th id="2647">2647</th><td>            <q>"tcp_port:%d\r\n"</q></td></tr>
<tr><th id="2648">2648</th><td>            <q>"uptime_in_seconds:%jd\r\n"</q></td></tr>
<tr><th id="2649">2649</th><td>            <q>"uptime_in_days:%jd\r\n"</q></td></tr>
<tr><th id="2650">2650</th><td>            <q>"hz:%d\r\n"</q></td></tr>
<tr><th id="2651">2651</th><td>            <q>"lru_clock:%ld\r\n"</q></td></tr>
<tr><th id="2652">2652</th><td>            <q>"config_file:%s\r\n"</q>,</td></tr>
<tr><th id="2653">2653</th><td>            <a class="macro" href="version.h.html#1" title="&quot;3.0.0&quot;" data-ref="_M/REDIS_VERSION">REDIS_VERSION</a>,</td></tr>
<tr><th id="2654">2654</th><td>            <a class="ref fn" href="redis.h.html#redisGitSHA1" title='redisGitSHA1' data-ref="redisGitSHA1">redisGitSHA1</a>(),</td></tr>
<tr><th id="2655">2655</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#strtol" title='strtol' data-ref="strtol">strtol</a>(<a class="ref fn" href="redis.h.html#redisGitDirty" title='redisGitDirty' data-ref="redisGitDirty">redisGitDirty</a>(),<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>10</var>) &gt; <var>0</var>,</td></tr>
<tr><th id="2656">2656</th><td>            (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="ref fn" href="redis.h.html#redisBuildId" title='redisBuildId' data-ref="redisBuildId">redisBuildId</a>(),</td></tr>
<tr><th id="2657">2657</th><td>            <a class="local col1 ref" href="#261mode" title='mode' data-ref="261mode">mode</a>,</td></tr>
<tr><th id="2658">2658</th><td>            <a class="local col0 ref" href="#260name" title='name' data-ref="260name">name</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/sys/utsname.h.html#utsname::sysname" title='utsname::sysname' data-ref="utsname::sysname">sysname</a>, <a class="local col0 ref" href="#260name" title='name' data-ref="260name">name</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/sys/utsname.h.html#utsname::release" title='utsname::release' data-ref="utsname::release">release</a>, <a class="local col0 ref" href="#260name" title='name' data-ref="260name">name</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/sys/utsname.h.html#utsname::machine" title='utsname::machine' data-ref="utsname::machine">machine</a>,</td></tr>
<tr><th id="2659">2659</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::arch_bits" title='redisServer::arch_bits' data-ref="redisServer::arch_bits">arch_bits</a>,</td></tr>
<tr><th id="2660">2660</th><td>            <a class="ref fn" href="ae.h.html#aeGetApiName" title='aeGetApiName' data-ref="aeGetApiName">aeGetApiName</a>(),</td></tr>
<tr><th id="2661">2661</th><td><u>#<span data-ppcond="2661">ifdef</span> <span class="macro" data-ref="_M/__GNUC__">__GNUC__</span></u></td></tr>
<tr><th id="2662">2662</th><td>            <span class="macro" title="4" data-ref="_M/__GNUC__">__GNUC__</span>,<span class="macro" title="2" data-ref="_M/__GNUC_MINOR__">__GNUC_MINOR__</span>,<span class="macro" title="1" data-ref="_M/__GNUC_PATCHLEVEL__">__GNUC_PATCHLEVEL__</span>,</td></tr>
<tr><th id="2663">2663</th><td><u>#<span data-ppcond="2661">else</span></u></td></tr>
<tr><th id="2664">2664</th><td>            <var>0</var>,<var>0</var>,<var>0</var>,</td></tr>
<tr><th id="2665">2665</th><td><u>#<span data-ppcond="2661">endif</span></u></td></tr>
<tr><th id="2666">2666</th><td>            (<em>long</em>) <a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>(),</td></tr>
<tr><th id="2667">2667</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::runid" title='redisServer::runid' data-ref="redisServer::runid">runid</a>,</td></tr>
<tr><th id="2668">2668</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a>,</td></tr>
<tr><th id="2669">2669</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)<a class="local col9 ref" href="#249uptime" title='uptime' data-ref="249uptime">uptime</a>,</td></tr>
<tr><th id="2670">2670</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)(<a class="local col9 ref" href="#249uptime" title='uptime' data-ref="249uptime">uptime</a>/(<var>3600</var>*<var>24</var>)),</td></tr>
<tr><th id="2671">2671</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::hz" title='redisServer::hz' data-ref="redisServer::hz">hz</a>,</td></tr>
<tr><th id="2672">2672</th><td>            (<em>unsigned</em> <em>long</em>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lruclock" title='redisServer::lruclock' data-ref="redisServer::lruclock">lruclock</a>,</td></tr>
<tr><th id="2673">2673</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::configfile" title='redisServer::configfile' data-ref="redisServer::configfile">configfile</a> ? <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::configfile" title='redisServer::configfile' data-ref="redisServer::configfile">configfile</a> : <q>""</q>);</td></tr>
<tr><th id="2674">2674</th><td>    }</td></tr>
<tr><th id="2675">2675</th><td></td></tr>
<tr><th id="2676">2676</th><td>    <i>/* Clients */</i></td></tr>
<tr><th id="2677">2677</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"clients"</q>)) {</td></tr>
<tr><th id="2678">2678</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2679">2679</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2680">2680</th><td>            <q>"# Clients\r\n"</q></td></tr>
<tr><th id="2681">2681</th><td>            <q>"connected_clients:%lu\r\n"</q></td></tr>
<tr><th id="2682">2682</th><td>            <q>"client_longest_output_list:%lu\r\n"</q></td></tr>
<tr><th id="2683">2683</th><td>            <q>"client_biggest_input_buf:%lu\r\n"</q></td></tr>
<tr><th id="2684">2684</th><td>            <q>"blocked_clients:%d\r\n"</q>,</td></tr>
<tr><th id="2685">2685</th><td>            <a class="macro" href="adlist.h.html#57" title="((server.clients)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::clients" title='redisServer::clients' data-ref="redisServer::clients">clients</a>)-<a class="macro" href="adlist.h.html#57" title="((server.slaves)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>),</td></tr>
<tr><th id="2686">2686</th><td>            <a class="local col4 ref" href="#254lol" title='lol' data-ref="254lol">lol</a>, <a class="local col5 ref" href="#255bib" title='bib' data-ref="255bib">bib</a>,</td></tr>
<tr><th id="2687">2687</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bpop_blocked_clients" title='redisServer::bpop_blocked_clients' data-ref="redisServer::bpop_blocked_clients">bpop_blocked_clients</a>);</td></tr>
<tr><th id="2688">2688</th><td>    }</td></tr>
<tr><th id="2689">2689</th><td></td></tr>
<tr><th id="2690">2690</th><td>    <i>/* Memory */</i></td></tr>
<tr><th id="2691">2691</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"memory"</q>)) {</td></tr>
<tr><th id="2692">2692</th><td>        <em>char</em> <dfn class="local col2 decl" id="262hmem" title='hmem' data-type='char [64]' data-ref="262hmem">hmem</dfn>[<var>64</var>];</td></tr>
<tr><th id="2693">2693</th><td>        <em>char</em> <dfn class="local col3 decl" id="263peak_hmem" title='peak_hmem' data-type='char [64]' data-ref="263peak_hmem">peak_hmem</dfn>[<var>64</var>];</td></tr>
<tr><th id="2694">2694</th><td>        <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col4 decl" id="264zmalloc_used" title='zmalloc_used' data-type='size_t' data-ref="264zmalloc_used">zmalloc_used</dfn> = <a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>();</td></tr>
<tr><th id="2695">2695</th><td></td></tr>
<tr><th id="2696">2696</th><td>        <i>/* Peak memory is updated from time to time by serverCron() so it</i></td></tr>
<tr><th id="2697">2697</th><td><i>         * may happen that the instantaneous value is slightly bigger than</i></td></tr>
<tr><th id="2698">2698</th><td><i>         * the peak value. This may confuse users, so we update the peak</i></td></tr>
<tr><th id="2699">2699</th><td><i>         * if found smaller than the current memory usage. */</i></td></tr>
<tr><th id="2700">2700</th><td>        <b>if</b> (<a class="local col4 ref" href="#264zmalloc_used" title='zmalloc_used' data-ref="264zmalloc_used">zmalloc_used</a> &gt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a>)</td></tr>
<tr><th id="2701">2701</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a> = <a class="local col4 ref" href="#264zmalloc_used" title='zmalloc_used' data-ref="264zmalloc_used">zmalloc_used</a>;</td></tr>
<tr><th id="2702">2702</th><td></td></tr>
<tr><th id="2703">2703</th><td>        <a class="ref fn" href="#bytesToHuman" title='bytesToHuman' data-ref="bytesToHuman">bytesToHuman</a>(<a class="local col2 ref" href="#262hmem" title='hmem' data-ref="262hmem">hmem</a>,<a class="local col4 ref" href="#264zmalloc_used" title='zmalloc_used' data-ref="264zmalloc_used">zmalloc_used</a>);</td></tr>
<tr><th id="2704">2704</th><td>        <a class="ref fn" href="#bytesToHuman" title='bytesToHuman' data-ref="bytesToHuman">bytesToHuman</a>(<a class="local col3 ref" href="#263peak_hmem" title='peak_hmem' data-ref="263peak_hmem">peak_hmem</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a>);</td></tr>
<tr><th id="2705">2705</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2706">2706</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2707">2707</th><td>            <q>"# Memory\r\n"</q></td></tr>
<tr><th id="2708">2708</th><td>            <q>"used_memory:%zu\r\n"</q></td></tr>
<tr><th id="2709">2709</th><td>            <q>"used_memory_human:%s\r\n"</q></td></tr>
<tr><th id="2710">2710</th><td>            <q>"used_memory_rss:%zu\r\n"</q></td></tr>
<tr><th id="2711">2711</th><td>            <q>"used_memory_peak:%zu\r\n"</q></td></tr>
<tr><th id="2712">2712</th><td>            <q>"used_memory_peak_human:%s\r\n"</q></td></tr>
<tr><th id="2713">2713</th><td>            <q>"used_memory_lua:%lld\r\n"</q></td></tr>
<tr><th id="2714">2714</th><td>            <q>"mem_fragmentation_ratio:%.2f\r\n"</q></td></tr>
<tr><th id="2715">2715</th><td>            <q>"mem_allocator:%s\r\n"</q>,</td></tr>
<tr><th id="2716">2716</th><td>            <a class="local col4 ref" href="#264zmalloc_used" title='zmalloc_used' data-ref="264zmalloc_used">zmalloc_used</a>,</td></tr>
<tr><th id="2717">2717</th><td>            <a class="local col2 ref" href="#262hmem" title='hmem' data-ref="262hmem">hmem</a>,</td></tr>
<tr><th id="2718">2718</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::resident_set_size" title='redisServer::resident_set_size' data-ref="redisServer::resident_set_size">resident_set_size</a>,</td></tr>
<tr><th id="2719">2719</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_peak_memory" title='redisServer::stat_peak_memory' data-ref="redisServer::stat_peak_memory">stat_peak_memory</a>,</td></tr>
<tr><th id="2720">2720</th><td>            <a class="local col3 ref" href="#263peak_hmem" title='peak_hmem' data-ref="263peak_hmem">peak_hmem</a>,</td></tr>
<tr><th id="2721">2721</th><td>            ((<em>long</em> <em>long</em>)<a class="ref fn" href="../deps/lua/src/lua.h.html#lua_gc" title='lua_gc' data-ref="lua_gc">lua_gc</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lua" title='redisServer::lua' data-ref="redisServer::lua">lua</a>,<a class="macro" href="../deps/lua/src/lua.h.html#224" title="3" data-ref="_M/LUA_GCCOUNT">LUA_GCCOUNT</a>,<var>0</var>))*<var>1024LL</var>,</td></tr>
<tr><th id="2722">2722</th><td>            <a class="ref fn" href="zmalloc.h.html#zmalloc_get_fragmentation_ratio" title='zmalloc_get_fragmentation_ratio' data-ref="zmalloc_get_fragmentation_ratio">zmalloc_get_fragmentation_ratio</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::resident_set_size" title='redisServer::resident_set_size' data-ref="redisServer::resident_set_size">resident_set_size</a>),</td></tr>
<tr><th id="2723">2723</th><td>            <a class="macro" href="zmalloc.h.html#65" title="&quot;libc&quot;" data-ref="_M/ZMALLOC_LIB">ZMALLOC_LIB</a></td></tr>
<tr><th id="2724">2724</th><td>            );</td></tr>
<tr><th id="2725">2725</th><td>    }</td></tr>
<tr><th id="2726">2726</th><td></td></tr>
<tr><th id="2727">2727</th><td>    <i>/* Persistence */</i></td></tr>
<tr><th id="2728">2728</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"persistence"</q>)) {</td></tr>
<tr><th id="2729">2729</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2730">2730</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2731">2731</th><td>            <q>"# Persistence\r\n"</q></td></tr>
<tr><th id="2732">2732</th><td>            <q>"loading:%d\r\n"</q></td></tr>
<tr><th id="2733">2733</th><td>            <q>"rdb_changes_since_last_save:%lld\r\n"</q></td></tr>
<tr><th id="2734">2734</th><td>            <q>"rdb_bgsave_in_progress:%d\r\n"</q></td></tr>
<tr><th id="2735">2735</th><td>            <q>"rdb_last_save_time:%jd\r\n"</q></td></tr>
<tr><th id="2736">2736</th><td>            <q>"rdb_last_bgsave_status:%s\r\n"</q></td></tr>
<tr><th id="2737">2737</th><td>            <q>"rdb_last_bgsave_time_sec:%jd\r\n"</q></td></tr>
<tr><th id="2738">2738</th><td>            <q>"rdb_current_bgsave_time_sec:%jd\r\n"</q></td></tr>
<tr><th id="2739">2739</th><td>            <q>"aof_enabled:%d\r\n"</q></td></tr>
<tr><th id="2740">2740</th><td>            <q>"aof_rewrite_in_progress:%d\r\n"</q></td></tr>
<tr><th id="2741">2741</th><td>            <q>"aof_rewrite_scheduled:%d\r\n"</q></td></tr>
<tr><th id="2742">2742</th><td>            <q>"aof_last_rewrite_time_sec:%jd\r\n"</q></td></tr>
<tr><th id="2743">2743</th><td>            <q>"aof_current_rewrite_time_sec:%jd\r\n"</q></td></tr>
<tr><th id="2744">2744</th><td>            <q>"aof_last_bgrewrite_status:%s\r\n"</q></td></tr>
<tr><th id="2745">2745</th><td>            <q>"aof_last_write_status:%s\r\n"</q>,</td></tr>
<tr><th id="2746">2746</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a>,</td></tr>
<tr><th id="2747">2747</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dirty" title='redisServer::dirty' data-ref="redisServer::dirty">dirty</a>,</td></tr>
<tr><th id="2748">2748</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> != -<var>1</var>,</td></tr>
<tr><th id="2749">2749</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastsave" title='redisServer::lastsave' data-ref="redisServer::lastsave">lastsave</a>,</td></tr>
<tr><th id="2750">2750</th><td>            (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::lastbgsave_status" title='redisServer::lastbgsave_status' data-ref="redisServer::lastbgsave_status">lastbgsave_status</a> == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>) ? <q>"ok"</q> : <q>"err"</q>,</td></tr>
<tr><th id="2751">2751</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_save_time_last" title='redisServer::rdb_save_time_last' data-ref="redisServer::rdb_save_time_last">rdb_save_time_last</a>,</td></tr>
<tr><th id="2752">2752</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)((<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_child_pid" title='redisServer::rdb_child_pid' data-ref="redisServer::rdb_child_pid">rdb_child_pid</a> == -<var>1</var>) ?</td></tr>
<tr><th id="2753">2753</th><td>                -<var>1</var> : <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_save_time_start" title='redisServer::rdb_save_time_start' data-ref="redisServer::rdb_save_time_start">rdb_save_time_start</a>),</td></tr>
<tr><th id="2754">2754</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> != <a class="macro" href="redis.h.html#227" title="0" data-ref="_M/REDIS_AOF_OFF">REDIS_AOF_OFF</a>,</td></tr>
<tr><th id="2755">2755</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> != -<var>1</var>,</td></tr>
<tr><th id="2756">2756</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_scheduled" title='redisServer::aof_rewrite_scheduled' data-ref="redisServer::aof_rewrite_scheduled">aof_rewrite_scheduled</a>,</td></tr>
<tr><th id="2757">2757</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_time_last" title='redisServer::aof_rewrite_time_last' data-ref="redisServer::aof_rewrite_time_last">aof_rewrite_time_last</a>,</td></tr>
<tr><th id="2758">2758</th><td>            (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)((<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_child_pid" title='redisServer::aof_child_pid' data-ref="redisServer::aof_child_pid">aof_child_pid</a> == -<var>1</var>) ?</td></tr>
<tr><th id="2759">2759</th><td>                -<var>1</var> : <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_time_start" title='redisServer::aof_rewrite_time_start' data-ref="redisServer::aof_rewrite_time_start">aof_rewrite_time_start</a>),</td></tr>
<tr><th id="2760">2760</th><td>            (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_lastbgrewrite_status" title='redisServer::aof_lastbgrewrite_status' data-ref="redisServer::aof_lastbgrewrite_status">aof_lastbgrewrite_status</a> == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>) ? <q>"ok"</q> : <q>"err"</q>,</td></tr>
<tr><th id="2761">2761</th><td>            (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_last_write_status" title='redisServer::aof_last_write_status' data-ref="redisServer::aof_last_write_status">aof_last_write_status</a> == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>) ? <q>"ok"</q> : <q>"err"</q>);</td></tr>
<tr><th id="2762">2762</th><td></td></tr>
<tr><th id="2763">2763</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> != <a class="macro" href="redis.h.html#227" title="0" data-ref="_M/REDIS_AOF_OFF">REDIS_AOF_OFF</a>) {</td></tr>
<tr><th id="2764">2764</th><td>            <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2765">2765</th><td>                <q>"aof_current_size:%lld\r\n"</q></td></tr>
<tr><th id="2766">2766</th><td>                <q>"aof_base_size:%lld\r\n"</q></td></tr>
<tr><th id="2767">2767</th><td>                <q>"aof_pending_rewrite:%d\r\n"</q></td></tr>
<tr><th id="2768">2768</th><td>                <q>"aof_buffer_length:%zu\r\n"</q></td></tr>
<tr><th id="2769">2769</th><td>                <q>"aof_rewrite_buffer_length:%lu\r\n"</q></td></tr>
<tr><th id="2770">2770</th><td>                <q>"aof_pending_bio_fsync:%llu\r\n"</q></td></tr>
<tr><th id="2771">2771</th><td>                <q>"aof_delayed_fsync:%lu\r\n"</q>,</td></tr>
<tr><th id="2772">2772</th><td>                (<em>long</em> <em>long</em>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_current_size" title='redisServer::aof_current_size' data-ref="redisServer::aof_current_size">aof_current_size</a>,</td></tr>
<tr><th id="2773">2773</th><td>                (<em>long</em> <em>long</em>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_base_size" title='redisServer::aof_rewrite_base_size' data-ref="redisServer::aof_rewrite_base_size">aof_rewrite_base_size</a>,</td></tr>
<tr><th id="2774">2774</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_rewrite_scheduled" title='redisServer::aof_rewrite_scheduled' data-ref="redisServer::aof_rewrite_scheduled">aof_rewrite_scheduled</a>,</td></tr>
<tr><th id="2775">2775</th><td>                <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_buf" title='redisServer::aof_buf' data-ref="redisServer::aof_buf">aof_buf</a>),</td></tr>
<tr><th id="2776">2776</th><td>                <a class="ref fn" href="redis.h.html#aofRewriteBufferSize" title='aofRewriteBufferSize' data-ref="aofRewriteBufferSize">aofRewriteBufferSize</a>(),</td></tr>
<tr><th id="2777">2777</th><td>                <a class="ref fn" href="bio.h.html#bioPendingJobsOfType" title='bioPendingJobsOfType' data-ref="bioPendingJobsOfType">bioPendingJobsOfType</a>(<a class="macro" href="bio.h.html#40" title="1" data-ref="_M/REDIS_BIO_AOF_FSYNC">REDIS_BIO_AOF_FSYNC</a>),</td></tr>
<tr><th id="2778">2778</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_delayed_fsync" title='redisServer::aof_delayed_fsync' data-ref="redisServer::aof_delayed_fsync">aof_delayed_fsync</a>);</td></tr>
<tr><th id="2779">2779</th><td>        }</td></tr>
<tr><th id="2780">2780</th><td></td></tr>
<tr><th id="2781">2781</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a>) {</td></tr>
<tr><th id="2782">2782</th><td>            <em>double</em> <dfn class="local col5 decl" id="265perc" title='perc' data-type='double' data-ref="265perc">perc</dfn>;</td></tr>
<tr><th id="2783">2783</th><td>            <a class="typedef" href="../../include/time.h.html#time_t" title='time_t' data-type='__time_t' data-ref="time_t">time_t</a> <dfn class="local col6 decl" id="266eta" title='eta' data-type='time_t' data-ref="266eta">eta</dfn>, <dfn class="local col7 decl" id="267elapsed" title='elapsed' data-type='time_t' data-ref="267elapsed">elapsed</dfn>;</td></tr>
<tr><th id="2784">2784</th><td>            <a class="typedef" href="../../include/x86_64-linux-gnu/sys/types.h.html#off_t" title='off_t' data-type='__off64_t' data-ref="off_t">off_t</a> <dfn class="local col8 decl" id="268remaining_bytes" title='remaining_bytes' data-type='off_t' data-ref="268remaining_bytes">remaining_bytes</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_total_bytes" title='redisServer::loading_total_bytes' data-ref="redisServer::loading_total_bytes">loading_total_bytes</a>-</td></tr>
<tr><th id="2785">2785</th><td>                                    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_loaded_bytes" title='redisServer::loading_loaded_bytes' data-ref="redisServer::loading_loaded_bytes">loading_loaded_bytes</a>;</td></tr>
<tr><th id="2786">2786</th><td></td></tr>
<tr><th id="2787">2787</th><td>            <a class="local col5 ref" href="#265perc" title='perc' data-ref="265perc">perc</a> = ((<em>double</em>)<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_loaded_bytes" title='redisServer::loading_loaded_bytes' data-ref="redisServer::loading_loaded_bytes">loading_loaded_bytes</a> /</td></tr>
<tr><th id="2788">2788</th><td>                   (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_total_bytes" title='redisServer::loading_total_bytes' data-ref="redisServer::loading_total_bytes">loading_total_bytes</a>+<var>1</var>)) * <var>100</var>;</td></tr>
<tr><th id="2789">2789</th><td></td></tr>
<tr><th id="2790">2790</th><td>            <a class="local col7 ref" href="#267elapsed" title='elapsed' data-ref="267elapsed">elapsed</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_start_time" title='redisServer::loading_start_time' data-ref="redisServer::loading_start_time">loading_start_time</a>;</td></tr>
<tr><th id="2791">2791</th><td>            <b>if</b> (<a class="local col7 ref" href="#267elapsed" title='elapsed' data-ref="267elapsed">elapsed</a> == <var>0</var>) {</td></tr>
<tr><th id="2792">2792</th><td>                <a class="local col6 ref" href="#266eta" title='eta' data-ref="266eta">eta</a> = <var>1</var>; <i>/* A fake 1 second figure if we don't have</i></td></tr>
<tr><th id="2793">2793</th><td><i>                            enough info */</i></td></tr>
<tr><th id="2794">2794</th><td>            } <b>else</b> {</td></tr>
<tr><th id="2795">2795</th><td>                <a class="local col6 ref" href="#266eta" title='eta' data-ref="266eta">eta</a> = (<a class="local col7 ref" href="#267elapsed" title='elapsed' data-ref="267elapsed">elapsed</a>*<a class="local col8 ref" href="#268remaining_bytes" title='remaining_bytes' data-ref="268remaining_bytes">remaining_bytes</a>)/(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_loaded_bytes" title='redisServer::loading_loaded_bytes' data-ref="redisServer::loading_loaded_bytes">loading_loaded_bytes</a>+<var>1</var>);</td></tr>
<tr><th id="2796">2796</th><td>            }</td></tr>
<tr><th id="2797">2797</th><td></td></tr>
<tr><th id="2798">2798</th><td>            <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2799">2799</th><td>                <q>"loading_start_time:%jd\r\n"</q></td></tr>
<tr><th id="2800">2800</th><td>                <q>"loading_total_bytes:%llu\r\n"</q></td></tr>
<tr><th id="2801">2801</th><td>                <q>"loading_loaded_bytes:%llu\r\n"</q></td></tr>
<tr><th id="2802">2802</th><td>                <q>"loading_loaded_perc:%.2f\r\n"</q></td></tr>
<tr><th id="2803">2803</th><td>                <q>"loading_eta_seconds:%jd\r\n"</q>,</td></tr>
<tr><th id="2804">2804</th><td>                (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_start_time" title='redisServer::loading_start_time' data-ref="redisServer::loading_start_time">loading_start_time</a>,</td></tr>
<tr><th id="2805">2805</th><td>                (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_total_bytes" title='redisServer::loading_total_bytes' data-ref="redisServer::loading_total_bytes">loading_total_bytes</a>,</td></tr>
<tr><th id="2806">2806</th><td>                (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading_loaded_bytes" title='redisServer::loading_loaded_bytes' data-ref="redisServer::loading_loaded_bytes">loading_loaded_bytes</a>,</td></tr>
<tr><th id="2807">2807</th><td>                <a class="local col5 ref" href="#265perc" title='perc' data-ref="265perc">perc</a>,</td></tr>
<tr><th id="2808">2808</th><td>                (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)<a class="local col6 ref" href="#266eta" title='eta' data-ref="266eta">eta</a></td></tr>
<tr><th id="2809">2809</th><td>            );</td></tr>
<tr><th id="2810">2810</th><td>        }</td></tr>
<tr><th id="2811">2811</th><td>    }</td></tr>
<tr><th id="2812">2812</th><td></td></tr>
<tr><th id="2813">2813</th><td>    <i>/* Stats */</i></td></tr>
<tr><th id="2814">2814</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"stats"</q>)) {</td></tr>
<tr><th id="2815">2815</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2816">2816</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2817">2817</th><td>            <q>"# Stats\r\n"</q></td></tr>
<tr><th id="2818">2818</th><td>            <q>"total_connections_received:%lld\r\n"</q></td></tr>
<tr><th id="2819">2819</th><td>            <q>"total_commands_processed:%lld\r\n"</q></td></tr>
<tr><th id="2820">2820</th><td>            <q>"instantaneous_ops_per_sec:%lld\r\n"</q></td></tr>
<tr><th id="2821">2821</th><td>            <q>"total_net_input_bytes:%lld\r\n"</q></td></tr>
<tr><th id="2822">2822</th><td>            <q>"total_net_output_bytes:%lld\r\n"</q></td></tr>
<tr><th id="2823">2823</th><td>            <q>"instantaneous_input_kbps:%.2f\r\n"</q></td></tr>
<tr><th id="2824">2824</th><td>            <q>"instantaneous_output_kbps:%.2f\r\n"</q></td></tr>
<tr><th id="2825">2825</th><td>            <q>"rejected_connections:%lld\r\n"</q></td></tr>
<tr><th id="2826">2826</th><td>            <q>"sync_full:%lld\r\n"</q></td></tr>
<tr><th id="2827">2827</th><td>            <q>"sync_partial_ok:%lld\r\n"</q></td></tr>
<tr><th id="2828">2828</th><td>            <q>"sync_partial_err:%lld\r\n"</q></td></tr>
<tr><th id="2829">2829</th><td>            <q>"expired_keys:%lld\r\n"</q></td></tr>
<tr><th id="2830">2830</th><td>            <q>"evicted_keys:%lld\r\n"</q></td></tr>
<tr><th id="2831">2831</th><td>            <q>"keyspace_hits:%lld\r\n"</q></td></tr>
<tr><th id="2832">2832</th><td>            <q>"keyspace_misses:%lld\r\n"</q></td></tr>
<tr><th id="2833">2833</th><td>            <q>"pubsub_channels:%ld\r\n"</q></td></tr>
<tr><th id="2834">2834</th><td>            <q>"pubsub_patterns:%lu\r\n"</q></td></tr>
<tr><th id="2835">2835</th><td>            <q>"latest_fork_usec:%lld\r\n"</q></td></tr>
<tr><th id="2836">2836</th><td>            <q>"migrate_cached_sockets:%ld\r\n"</q>,</td></tr>
<tr><th id="2837">2837</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_numconnections" title='redisServer::stat_numconnections' data-ref="redisServer::stat_numconnections">stat_numconnections</a>,</td></tr>
<tr><th id="2838">2838</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_numcommands" title='redisServer::stat_numcommands' data-ref="redisServer::stat_numcommands">stat_numcommands</a>,</td></tr>
<tr><th id="2839">2839</th><td>            <a class="ref fn" href="#getInstantaneousMetric" title='getInstantaneousMetric' data-ref="getInstantaneousMetric">getInstantaneousMetric</a>(<a class="macro" href="redis.h.html#141" title="0" data-ref="_M/REDIS_METRIC_COMMAND">REDIS_METRIC_COMMAND</a>),</td></tr>
<tr><th id="2840">2840</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_net_input_bytes" title='redisServer::stat_net_input_bytes' data-ref="redisServer::stat_net_input_bytes">stat_net_input_bytes</a>,</td></tr>
<tr><th id="2841">2841</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_net_output_bytes" title='redisServer::stat_net_output_bytes' data-ref="redisServer::stat_net_output_bytes">stat_net_output_bytes</a>,</td></tr>
<tr><th id="2842">2842</th><td>            (<em>float</em>)<a class="ref fn" href="#getInstantaneousMetric" title='getInstantaneousMetric' data-ref="getInstantaneousMetric">getInstantaneousMetric</a>(<a class="macro" href="redis.h.html#142" title="1" data-ref="_M/REDIS_METRIC_NET_INPUT">REDIS_METRIC_NET_INPUT</a>)/<var>1024</var>,</td></tr>
<tr><th id="2843">2843</th><td>            (<em>float</em>)<a class="ref fn" href="#getInstantaneousMetric" title='getInstantaneousMetric' data-ref="getInstantaneousMetric">getInstantaneousMetric</a>(<a class="macro" href="redis.h.html#143" title="2" data-ref="_M/REDIS_METRIC_NET_OUTPUT">REDIS_METRIC_NET_OUTPUT</a>)/<var>1024</var>,</td></tr>
<tr><th id="2844">2844</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_rejected_conn" title='redisServer::stat_rejected_conn' data-ref="redisServer::stat_rejected_conn">stat_rejected_conn</a>,</td></tr>
<tr><th id="2845">2845</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_sync_full" title='redisServer::stat_sync_full' data-ref="redisServer::stat_sync_full">stat_sync_full</a>,</td></tr>
<tr><th id="2846">2846</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_sync_partial_ok" title='redisServer::stat_sync_partial_ok' data-ref="redisServer::stat_sync_partial_ok">stat_sync_partial_ok</a>,</td></tr>
<tr><th id="2847">2847</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_sync_partial_err" title='redisServer::stat_sync_partial_err' data-ref="redisServer::stat_sync_partial_err">stat_sync_partial_err</a>,</td></tr>
<tr><th id="2848">2848</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_expiredkeys" title='redisServer::stat_expiredkeys' data-ref="redisServer::stat_expiredkeys">stat_expiredkeys</a>,</td></tr>
<tr><th id="2849">2849</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_evictedkeys" title='redisServer::stat_evictedkeys' data-ref="redisServer::stat_evictedkeys">stat_evictedkeys</a>,</td></tr>
<tr><th id="2850">2850</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_keyspace_hits" title='redisServer::stat_keyspace_hits' data-ref="redisServer::stat_keyspace_hits">stat_keyspace_hits</a>,</td></tr>
<tr><th id="2851">2851</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_keyspace_misses" title='redisServer::stat_keyspace_misses' data-ref="redisServer::stat_keyspace_misses">stat_keyspace_misses</a>,</td></tr>
<tr><th id="2852">2852</th><td>            <a class="macro" href="dict.h.html#146" title="((server.pubsub_channels)-&gt;ht[0].used+(server.pubsub_channels)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pubsub_channels" title='redisServer::pubsub_channels' data-ref="redisServer::pubsub_channels">pubsub_channels</a>),</td></tr>
<tr><th id="2853">2853</th><td>            <a class="macro" href="adlist.h.html#57" title="((server.pubsub_patterns)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pubsub_patterns" title='redisServer::pubsub_patterns' data-ref="redisServer::pubsub_patterns">pubsub_patterns</a>),</td></tr>
<tr><th id="2854">2854</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_fork_time" title='redisServer::stat_fork_time' data-ref="redisServer::stat_fork_time">stat_fork_time</a>,</td></tr>
<tr><th id="2855">2855</th><td>            <a class="macro" href="dict.h.html#146" title="((server.migrate_cached_sockets)-&gt;ht[0].used+(server.migrate_cached_sockets)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::migrate_cached_sockets" title='redisServer::migrate_cached_sockets' data-ref="redisServer::migrate_cached_sockets">migrate_cached_sockets</a>));</td></tr>
<tr><th id="2856">2856</th><td>    }</td></tr>
<tr><th id="2857">2857</th><td></td></tr>
<tr><th id="2858">2858</th><td>    <i>/* Replication */</i></td></tr>
<tr><th id="2859">2859</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"replication"</q>)) {</td></tr>
<tr><th id="2860">2860</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2861">2861</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2862">2862</th><td>            <q>"# Replication\r\n"</q></td></tr>
<tr><th id="2863">2863</th><td>            <q>"role:%s\r\n"</q>,</td></tr>
<tr><th id="2864">2864</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> ? <q>"master"</q> : <q>"slave"</q>);</td></tr>
<tr><th id="2865">2865</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a>) {</td></tr>
<tr><th id="2866">2866</th><td>            <em>long</em> <em>long</em> <dfn class="local col9 decl" id="269slave_repl_offset" title='slave_repl_offset' data-type='long long' data-ref="269slave_repl_offset">slave_repl_offset</dfn> = <var>1</var>;</td></tr>
<tr><th id="2867">2867</th><td></td></tr>
<tr><th id="2868">2868</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master" title='redisServer::master' data-ref="redisServer::master">master</a>)</td></tr>
<tr><th id="2869">2869</th><td>                <a class="local col9 ref" href="#269slave_repl_offset" title='slave_repl_offset' data-ref="269slave_repl_offset">slave_repl_offset</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master" title='redisServer::master' data-ref="redisServer::master">master</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::reploff" title='redisClient::reploff' data-ref="redisClient::reploff">reploff</a>;</td></tr>
<tr><th id="2870">2870</th><td>            <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cached_master" title='redisServer::cached_master' data-ref="redisServer::cached_master">cached_master</a>)</td></tr>
<tr><th id="2871">2871</th><td>                <a class="local col9 ref" href="#269slave_repl_offset" title='slave_repl_offset' data-ref="269slave_repl_offset">slave_repl_offset</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cached_master" title='redisServer::cached_master' data-ref="redisServer::cached_master">cached_master</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::reploff" title='redisClient::reploff' data-ref="redisClient::reploff">reploff</a>;</td></tr>
<tr><th id="2872">2872</th><td></td></tr>
<tr><th id="2873">2873</th><td>            <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2874">2874</th><td>                <q>"master_host:%s\r\n"</q></td></tr>
<tr><th id="2875">2875</th><td>                <q>"master_port:%d\r\n"</q></td></tr>
<tr><th id="2876">2876</th><td>                <q>"master_link_status:%s\r\n"</q></td></tr>
<tr><th id="2877">2877</th><td>                <q>"master_last_io_seconds_ago:%d\r\n"</q></td></tr>
<tr><th id="2878">2878</th><td>                <q>"master_sync_in_progress:%d\r\n"</q></td></tr>
<tr><th id="2879">2879</th><td>                <q>"slave_repl_offset:%lld\r\n"</q></td></tr>
<tr><th id="2880">2880</th><td>                ,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterhost" title='redisServer::masterhost' data-ref="redisServer::masterhost">masterhost</a>,</td></tr>
<tr><th id="2881">2881</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::masterport" title='redisServer::masterport' data-ref="redisServer::masterport">masterport</a>,</td></tr>
<tr><th id="2882">2882</th><td>                (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_state" title='redisServer::repl_state' data-ref="redisServer::repl_state">repl_state</a> == <a class="macro" href="redis.h.html#276" title="5" data-ref="_M/REDIS_REPL_CONNECTED">REDIS_REPL_CONNECTED</a>) ?</td></tr>
<tr><th id="2883">2883</th><td>                    <q>"up"</q> : <q>"down"</q>,</td></tr>
<tr><th id="2884">2884</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master" title='redisServer::master' data-ref="redisServer::master">master</a> ?</td></tr>
<tr><th id="2885">2885</th><td>                ((<em>int</em>)(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master" title='redisServer::master' data-ref="redisServer::master">master</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::lastinteraction" title='redisClient::lastinteraction' data-ref="redisClient::lastinteraction">lastinteraction</a>)) : -<var>1</var>,</td></tr>
<tr><th id="2886">2886</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_state" title='redisServer::repl_state' data-ref="redisServer::repl_state">repl_state</a> == <a class="macro" href="redis.h.html#275" title="4" data-ref="_M/REDIS_REPL_TRANSFER">REDIS_REPL_TRANSFER</a>,</td></tr>
<tr><th id="2887">2887</th><td>                <a class="local col9 ref" href="#269slave_repl_offset" title='slave_repl_offset' data-ref="269slave_repl_offset">slave_repl_offset</a></td></tr>
<tr><th id="2888">2888</th><td>            );</td></tr>
<tr><th id="2889">2889</th><td></td></tr>
<tr><th id="2890">2890</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_state" title='redisServer::repl_state' data-ref="redisServer::repl_state">repl_state</a> == <a class="macro" href="redis.h.html#275" title="4" data-ref="_M/REDIS_REPL_TRANSFER">REDIS_REPL_TRANSFER</a>) {</td></tr>
<tr><th id="2891">2891</th><td>                <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2892">2892</th><td>                    <q>"master_sync_left_bytes:%lld\r\n"</q></td></tr>
<tr><th id="2893">2893</th><td>                    <q>"master_sync_last_io_seconds_ago:%d\r\n"</q></td></tr>
<tr><th id="2894">2894</th><td>                    , (<em>long</em> <em>long</em>)</td></tr>
<tr><th id="2895">2895</th><td>                        (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_transfer_size" title='redisServer::repl_transfer_size' data-ref="redisServer::repl_transfer_size">repl_transfer_size</a> - <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_transfer_read" title='redisServer::repl_transfer_read' data-ref="redisServer::repl_transfer_read">repl_transfer_read</a>),</td></tr>
<tr><th id="2896">2896</th><td>                    (<em>int</em>)(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_transfer_lastio" title='redisServer::repl_transfer_lastio' data-ref="redisServer::repl_transfer_lastio">repl_transfer_lastio</a>)</td></tr>
<tr><th id="2897">2897</th><td>                );</td></tr>
<tr><th id="2898">2898</th><td>            }</td></tr>
<tr><th id="2899">2899</th><td></td></tr>
<tr><th id="2900">2900</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_state" title='redisServer::repl_state' data-ref="redisServer::repl_state">repl_state</a> != <a class="macro" href="redis.h.html#276" title="5" data-ref="_M/REDIS_REPL_CONNECTED">REDIS_REPL_CONNECTED</a>) {</td></tr>
<tr><th id="2901">2901</th><td>                <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2902">2902</th><td>                    <q>"master_link_down_since_seconds:%jd\r\n"</q>,</td></tr>
<tr><th id="2903">2903</th><td>                    (<a class="typedef" href="../../include/stdint.h.html#intmax_t" title='intmax_t' data-type='long' data-ref="intmax_t">intmax_t</a>)<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixtime" title='redisServer::unixtime' data-ref="redisServer::unixtime">unixtime</a>-<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_down_since" title='redisServer::repl_down_since' data-ref="redisServer::repl_down_since">repl_down_since</a>);</td></tr>
<tr><th id="2904">2904</th><td>            }</td></tr>
<tr><th id="2905">2905</th><td>            <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2906">2906</th><td>                <q>"slave_priority:%d\r\n"</q></td></tr>
<tr><th id="2907">2907</th><td>                <q>"slave_read_only:%d\r\n"</q>,</td></tr>
<tr><th id="2908">2908</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slave_priority" title='redisServer::slave_priority' data-ref="redisServer::slave_priority">slave_priority</a>,</td></tr>
<tr><th id="2909">2909</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_slave_ro" title='redisServer::repl_slave_ro' data-ref="redisServer::repl_slave_ro">repl_slave_ro</a>);</td></tr>
<tr><th id="2910">2910</th><td>        }</td></tr>
<tr><th id="2911">2911</th><td></td></tr>
<tr><th id="2912">2912</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2913">2913</th><td>            <q>"connected_slaves:%lu\r\n"</q>,</td></tr>
<tr><th id="2914">2914</th><td>            <a class="macro" href="adlist.h.html#57" title="((server.slaves)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>));</td></tr>
<tr><th id="2915">2915</th><td></td></tr>
<tr><th id="2916">2916</th><td>        <i>/* If min-slaves-to-write is active, write the number of slaves</i></td></tr>
<tr><th id="2917">2917</th><td><i>         * currently considered 'good'. */</i></td></tr>
<tr><th id="2918">2918</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_to_write" title='redisServer::repl_min_slaves_to_write' data-ref="redisServer::repl_min_slaves_to_write">repl_min_slaves_to_write</a> &amp;&amp;</td></tr>
<tr><th id="2919">2919</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_min_slaves_max_lag" title='redisServer::repl_min_slaves_max_lag' data-ref="redisServer::repl_min_slaves_max_lag">repl_min_slaves_max_lag</a>) {</td></tr>
<tr><th id="2920">2920</th><td>            <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2921">2921</th><td>                <q>"min_slaves_good_slaves:%d\r\n"</q>,</td></tr>
<tr><th id="2922">2922</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_good_slaves_count" title='redisServer::repl_good_slaves_count' data-ref="redisServer::repl_good_slaves_count">repl_good_slaves_count</a>);</td></tr>
<tr><th id="2923">2923</th><td>        }</td></tr>
<tr><th id="2924">2924</th><td></td></tr>
<tr><th id="2925">2925</th><td>        <b>if</b> (<a class="macro" href="adlist.h.html#57" title="((server.slaves)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>)) {</td></tr>
<tr><th id="2926">2926</th><td>            <em>int</em> <dfn class="local col0 decl" id="270slaveid" title='slaveid' data-type='int' data-ref="270slaveid">slaveid</dfn> = <var>0</var>;</td></tr>
<tr><th id="2927">2927</th><td>            <a class="typedef" href="adlist.h.html#listNode" title='listNode' data-type='struct listNode' data-ref="listNode">listNode</a> *<dfn class="local col1 decl" id="271ln" title='ln' data-type='listNode *' data-ref="271ln">ln</dfn>;</td></tr>
<tr><th id="2928">2928</th><td>            <a class="typedef" href="adlist.h.html#listIter" title='listIter' data-type='struct listIter' data-ref="listIter">listIter</a> <dfn class="local col2 decl" id="272li" title='li' data-type='listIter' data-ref="272li">li</dfn>;</td></tr>
<tr><th id="2929">2929</th><td></td></tr>
<tr><th id="2930">2930</th><td>            <a class="ref fn" href="adlist.h.html#listRewind" title='listRewind' data-ref="listRewind">listRewind</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>,&amp;<a class="local col2 ref" href="#272li" title='li' data-ref="272li">li</a>);</td></tr>
<tr><th id="2931">2931</th><td>            <b>while</b>((<a class="local col1 ref" href="#271ln" title='ln' data-ref="271ln">ln</a> = <a class="ref fn" href="adlist.h.html#listNext" title='listNext' data-ref="listNext">listNext</a>(&amp;<a class="local col2 ref" href="#272li" title='li' data-ref="272li">li</a>))) {</td></tr>
<tr><th id="2932">2932</th><td>                <a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col3 decl" id="273slave" title='slave' data-type='redisClient *' data-ref="273slave">slave</dfn> = <a class="macro" href="adlist.h.html#62" title="((ln)-&gt;value)" data-ref="_M/listNodeValue">listNodeValue</a>(<a class="local col1 ref" href="#271ln" title='ln' data-ref="271ln">ln</a>);</td></tr>
<tr><th id="2933">2933</th><td>                <em>char</em> *<dfn class="local col4 decl" id="274state" title='state' data-type='char *' data-ref="274state">state</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2934">2934</th><td>                <em>char</em> <dfn class="local col5 decl" id="275ip" title='ip' data-type='char [46]' data-ref="275ip">ip</dfn>[<a class="macro" href="redis.h.html#127" title="46" data-ref="_M/REDIS_IP_STR_LEN">REDIS_IP_STR_LEN</a>];</td></tr>
<tr><th id="2935">2935</th><td>                <em>int</em> <dfn class="local col6 decl" id="276port" title='port' data-type='int' data-ref="276port">port</dfn>;</td></tr>
<tr><th id="2936">2936</th><td>                <em>long</em> <dfn class="local col7 decl" id="277lag" title='lag' data-type='long' data-ref="277lag">lag</dfn> = <var>0</var>;</td></tr>
<tr><th id="2937">2937</th><td></td></tr>
<tr><th id="2938">2938</th><td>                <b>if</b> (<a class="ref fn" href="anet.h.html#anetPeerToString" title='anetPeerToString' data-ref="anetPeerToString">anetPeerToString</a>(<a class="local col3 ref" href="#273slave" title='slave' data-ref="273slave">slave</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::fd" title='redisClient::fd' data-ref="redisClient::fd">fd</a>,<a class="local col5 ref" href="#275ip" title='ip' data-ref="275ip">ip</a>,<b>sizeof</b>(<a class="local col5 ref" href="#275ip" title='ip' data-ref="275ip">ip</a>),&amp;<a class="local col6 ref" href="#276port" title='port' data-ref="276port">port</a>) == -<var>1</var>) <b>continue</b>;</td></tr>
<tr><th id="2939">2939</th><td>                <b>switch</b>(<a class="local col3 ref" href="#273slave" title='slave' data-ref="273slave">slave</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::replstate" title='redisClient::replstate' data-ref="redisClient::replstate">replstate</a>) {</td></tr>
<tr><th id="2940">2940</th><td>                <b>case</b> <a class="macro" href="redis.h.html#282" title="6" data-ref="_M/REDIS_REPL_WAIT_BGSAVE_START">REDIS_REPL_WAIT_BGSAVE_START</a>:</td></tr>
<tr><th id="2941">2941</th><td>                <b>case</b> <a class="macro" href="redis.h.html#283" title="7" data-ref="_M/REDIS_REPL_WAIT_BGSAVE_END">REDIS_REPL_WAIT_BGSAVE_END</a>:</td></tr>
<tr><th id="2942">2942</th><td>                    <a class="local col4 ref" href="#274state" title='state' data-ref="274state">state</a> = <q>"wait_bgsave"</q>;</td></tr>
<tr><th id="2943">2943</th><td>                    <b>break</b>;</td></tr>
<tr><th id="2944">2944</th><td>                <b>case</b> <a class="macro" href="redis.h.html#284" title="8" data-ref="_M/REDIS_REPL_SEND_BULK">REDIS_REPL_SEND_BULK</a>:</td></tr>
<tr><th id="2945">2945</th><td>                    <a class="local col4 ref" href="#274state" title='state' data-ref="274state">state</a> = <q>"send_bulk"</q>;</td></tr>
<tr><th id="2946">2946</th><td>                    <b>break</b>;</td></tr>
<tr><th id="2947">2947</th><td>                <b>case</b> <a class="macro" href="redis.h.html#285" title="9" data-ref="_M/REDIS_REPL_ONLINE">REDIS_REPL_ONLINE</a>:</td></tr>
<tr><th id="2948">2948</th><td>                    <a class="local col4 ref" href="#274state" title='state' data-ref="274state">state</a> = <q>"online"</q>;</td></tr>
<tr><th id="2949">2949</th><td>                    <b>break</b>;</td></tr>
<tr><th id="2950">2950</th><td>                }</td></tr>
<tr><th id="2951">2951</th><td>                <b>if</b> (<a class="local col4 ref" href="#274state" title='state' data-ref="274state">state</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) <b>continue</b>;</td></tr>
<tr><th id="2952">2952</th><td>                <b>if</b> (<a class="local col3 ref" href="#273slave" title='slave' data-ref="273slave">slave</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::replstate" title='redisClient::replstate' data-ref="redisClient::replstate">replstate</a> == <a class="macro" href="redis.h.html#285" title="9" data-ref="_M/REDIS_REPL_ONLINE">REDIS_REPL_ONLINE</a>)</td></tr>
<tr><th id="2953">2953</th><td>                    <a class="local col7 ref" href="#277lag" title='lag' data-ref="277lag">lag</a> = <a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) - <a class="local col3 ref" href="#273slave" title='slave' data-ref="273slave">slave</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::repl_ack_time" title='redisClient::repl_ack_time' data-ref="redisClient::repl_ack_time">repl_ack_time</a>;</td></tr>
<tr><th id="2954">2954</th><td></td></tr>
<tr><th id="2955">2955</th><td>                <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2956">2956</th><td>                    <q>"slave%d:ip=%s,port=%d,state=%s,"</q></td></tr>
<tr><th id="2957">2957</th><td>                    <q>"offset=%lld,lag=%ld\r\n"</q>,</td></tr>
<tr><th id="2958">2958</th><td>                    <a class="local col0 ref" href="#270slaveid" title='slaveid' data-ref="270slaveid">slaveid</a>,<a class="local col5 ref" href="#275ip" title='ip' data-ref="275ip">ip</a>,<a class="local col3 ref" href="#273slave" title='slave' data-ref="273slave">slave</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::slave_listening_port" title='redisClient::slave_listening_port' data-ref="redisClient::slave_listening_port">slave_listening_port</a>,<a class="local col4 ref" href="#274state" title='state' data-ref="274state">state</a>,</td></tr>
<tr><th id="2959">2959</th><td>                    <a class="local col3 ref" href="#273slave" title='slave' data-ref="273slave">slave</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::repl_ack_off" title='redisClient::repl_ack_off' data-ref="redisClient::repl_ack_off">repl_ack_off</a>, <a class="local col7 ref" href="#277lag" title='lag' data-ref="277lag">lag</a>);</td></tr>
<tr><th id="2960">2960</th><td>                <a class="local col0 ref" href="#270slaveid" title='slaveid' data-ref="270slaveid">slaveid</a>++;</td></tr>
<tr><th id="2961">2961</th><td>            }</td></tr>
<tr><th id="2962">2962</th><td>        }</td></tr>
<tr><th id="2963">2963</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2964">2964</th><td>            <q>"master_repl_offset:%lld\r\n"</q></td></tr>
<tr><th id="2965">2965</th><td>            <q>"repl_backlog_active:%d\r\n"</q></td></tr>
<tr><th id="2966">2966</th><td>            <q>"repl_backlog_size:%lld\r\n"</q></td></tr>
<tr><th id="2967">2967</th><td>            <q>"repl_backlog_first_byte_offset:%lld\r\n"</q></td></tr>
<tr><th id="2968">2968</th><td>            <q>"repl_backlog_histlen:%lld\r\n"</q>,</td></tr>
<tr><th id="2969">2969</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::master_repl_offset" title='redisServer::master_repl_offset' data-ref="redisServer::master_repl_offset">master_repl_offset</a>,</td></tr>
<tr><th id="2970">2970</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog" title='redisServer::repl_backlog' data-ref="redisServer::repl_backlog">repl_backlog</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="2971">2971</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_size" title='redisServer::repl_backlog_size' data-ref="redisServer::repl_backlog_size">repl_backlog_size</a>,</td></tr>
<tr><th id="2972">2972</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_off" title='redisServer::repl_backlog_off' data-ref="redisServer::repl_backlog_off">repl_backlog_off</a>,</td></tr>
<tr><th id="2973">2973</th><td>            <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::repl_backlog_histlen" title='redisServer::repl_backlog_histlen' data-ref="redisServer::repl_backlog_histlen">repl_backlog_histlen</a>);</td></tr>
<tr><th id="2974">2974</th><td>    }</td></tr>
<tr><th id="2975">2975</th><td></td></tr>
<tr><th id="2976">2976</th><td>    <i>/* CPU */</i></td></tr>
<tr><th id="2977">2977</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"cpu"</q>)) {</td></tr>
<tr><th id="2978">2978</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2979">2979</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="2980">2980</th><td>        <q>"# CPU\r\n"</q></td></tr>
<tr><th id="2981">2981</th><td>        <q>"used_cpu_sys:%.2f\r\n"</q></td></tr>
<tr><th id="2982">2982</th><td>        <q>"used_cpu_user:%.2f\r\n"</q></td></tr>
<tr><th id="2983">2983</th><td>        <q>"used_cpu_sys_children:%.2f\r\n"</q></td></tr>
<tr><th id="2984">2984</th><td>        <q>"used_cpu_user_children:%.2f\r\n"</q>,</td></tr>
<tr><th id="2985">2985</th><td>        (<em>float</em>)<a class="local col2 ref" href="#252self_ru" title='self_ru' data-ref="252self_ru">self_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_stime" title='rusage::ru_stime' data-ref="rusage::ru_stime">ru_stime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>+(<em>float</em>)<a class="local col2 ref" href="#252self_ru" title='self_ru' data-ref="252self_ru">self_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_stime" title='rusage::ru_stime' data-ref="rusage::ru_stime">ru_stime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>/<var>1000000</var>,</td></tr>
<tr><th id="2986">2986</th><td>        (<em>float</em>)<a class="local col2 ref" href="#252self_ru" title='self_ru' data-ref="252self_ru">self_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_utime" title='rusage::ru_utime' data-ref="rusage::ru_utime">ru_utime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>+(<em>float</em>)<a class="local col2 ref" href="#252self_ru" title='self_ru' data-ref="252self_ru">self_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_utime" title='rusage::ru_utime' data-ref="rusage::ru_utime">ru_utime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>/<var>1000000</var>,</td></tr>
<tr><th id="2987">2987</th><td>        (<em>float</em>)<a class="local col3 ref" href="#253c_ru" title='c_ru' data-ref="253c_ru">c_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_stime" title='rusage::ru_stime' data-ref="rusage::ru_stime">ru_stime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>+(<em>float</em>)<a class="local col3 ref" href="#253c_ru" title='c_ru' data-ref="253c_ru">c_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_stime" title='rusage::ru_stime' data-ref="rusage::ru_stime">ru_stime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>/<var>1000000</var>,</td></tr>
<tr><th id="2988">2988</th><td>        (<em>float</em>)<a class="local col3 ref" href="#253c_ru" title='c_ru' data-ref="253c_ru">c_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_utime" title='rusage::ru_utime' data-ref="rusage::ru_utime">ru_utime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>+(<em>float</em>)<a class="local col3 ref" href="#253c_ru" title='c_ru' data-ref="253c_ru">c_ru</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/resource.h.html#rusage::ru_utime" title='rusage::ru_utime' data-ref="rusage::ru_utime">ru_utime</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>/<var>1000000</var>);</td></tr>
<tr><th id="2989">2989</th><td>    }</td></tr>
<tr><th id="2990">2990</th><td></td></tr>
<tr><th id="2991">2991</th><td>    <i>/* cmdtime */</i></td></tr>
<tr><th id="2992">2992</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"commandstats"</q>)) {</td></tr>
<tr><th id="2993">2993</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="2994">2994</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>, <q>"# Commandstats\r\n"</q>);</td></tr>
<tr><th id="2995">2995</th><td>        <a class="local col1 ref" href="#251numcommands" title='numcommands' data-ref="251numcommands">numcommands</a> = <b>sizeof</b>(<a class="ref" href="#redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</a>)/<b>sizeof</b>(<b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a>);</td></tr>
<tr><th id="2996">2996</th><td>        <b>for</b> (<a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a> = <var>0</var>; <a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a> &lt; <a class="local col1 ref" href="#251numcommands" title='numcommands' data-ref="251numcommands">numcommands</a>; <a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>++) {</td></tr>
<tr><th id="2997">2997</th><td>            <b>struct</b> <a class="type" href="redis.h.html#redisCommand" title='redisCommand' data-ref="redisCommand">redisCommand</a> *<dfn class="local col8 decl" id="278c" title='c' data-type='struct redisCommand *' data-ref="278c">c</dfn> = <a class="ref" href="#redisCommandTable" title='redisCommandTable' data-ref="redisCommandTable">redisCommandTable</a>+<a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>;</td></tr>
<tr><th id="2998">2998</th><td></td></tr>
<tr><th id="2999">2999</th><td>            <b>if</b> (!<a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::calls" title='redisCommand::calls' data-ref="redisCommand::calls">calls</a>) <b>continue</b>;</td></tr>
<tr><th id="3000">3000</th><td>            <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="3001">3001</th><td>                <q>"cmdstat_%s:calls=%lld,usec=%lld,usec_per_call=%.2f\r\n"</q>,</td></tr>
<tr><th id="3002">3002</th><td>                <a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::name" title='redisCommand::name' data-ref="redisCommand::name">name</a>, <a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::calls" title='redisCommand::calls' data-ref="redisCommand::calls">calls</a>, <a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::microseconds" title='redisCommand::microseconds' data-ref="redisCommand::microseconds">microseconds</a>,</td></tr>
<tr><th id="3003">3003</th><td>                (<a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::calls" title='redisCommand::calls' data-ref="redisCommand::calls">calls</a> == <var>0</var>) ? <var>0</var> : ((<em>float</em>)<a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::microseconds" title='redisCommand::microseconds' data-ref="redisCommand::microseconds">microseconds</a>/<a class="local col8 ref" href="#278c" title='c' data-ref="278c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisCommand::calls" title='redisCommand::calls' data-ref="redisCommand::calls">calls</a>));</td></tr>
<tr><th id="3004">3004</th><td>        }</td></tr>
<tr><th id="3005">3005</th><td>    }</td></tr>
<tr><th id="3006">3006</th><td></td></tr>
<tr><th id="3007">3007</th><td>    <i>/* Cluster */</i></td></tr>
<tr><th id="3008">3008</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"cluster"</q>)) {</td></tr>
<tr><th id="3009">3009</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="3010">3010</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="3011">3011</th><td>        <q>"# Cluster\r\n"</q></td></tr>
<tr><th id="3012">3012</th><td>        <q>"cluster_enabled:%d\r\n"</q>,</td></tr>
<tr><th id="3013">3013</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>);</td></tr>
<tr><th id="3014">3014</th><td>    }</td></tr>
<tr><th id="3015">3015</th><td></td></tr>
<tr><th id="3016">3016</th><td>    <i>/* Key space */</i></td></tr>
<tr><th id="3017">3017</th><td>    <b>if</b> (<a class="local col6 ref" href="#256allsections" title='allsections' data-ref="256allsections">allsections</a> || <a class="local col7 ref" href="#257defsections" title='defsections' data-ref="257defsections">defsections</a> || !<a class="ref fn" href="../../include/string.h.html#strcasecmp" title='strcasecmp' data-ref="strcasecmp">strcasecmp</a>(<a class="local col7 ref" href="#247section" title='section' data-ref="247section">section</a>,<q>"keyspace"</q>)) {</td></tr>
<tr><th id="3018">3018</th><td>        <b>if</b> (<a class="local col8 ref" href="#258sections" title='sections' data-ref="258sections">sections</a>++) <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,<q>"\r\n"</q>);</td></tr>
<tr><th id="3019">3019</th><td>        <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>, <q>"# Keyspace\r\n"</q>);</td></tr>
<tr><th id="3020">3020</th><td>        <b>for</b> (<a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a> = <var>0</var>; <a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>; <a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>++) {</td></tr>
<tr><th id="3021">3021</th><td>            <em>long</em> <em>long</em> <dfn class="local col9 decl" id="279keys" title='keys' data-type='long long' data-ref="279keys">keys</dfn>, <dfn class="local col0 decl" id="280vkeys" title='vkeys' data-type='long long' data-ref="280vkeys">vkeys</dfn>;</td></tr>
<tr><th id="3022">3022</th><td></td></tr>
<tr><th id="3023">3023</th><td>            <a class="local col9 ref" href="#279keys" title='keys' data-ref="279keys">keys</a> = <a class="macro" href="dict.h.html#146" title="((server.db[j].dict)-&gt;ht[0].used+(server.db[j].dict)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>);</td></tr>
<tr><th id="3024">3024</th><td>            <a class="local col0 ref" href="#280vkeys" title='vkeys' data-ref="280vkeys">vkeys</a> = <a class="macro" href="dict.h.html#146" title="((server.db[j].expires)-&gt;ht[0].used+(server.db[j].expires)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>);</td></tr>
<tr><th id="3025">3025</th><td>            <b>if</b> (<a class="local col9 ref" href="#279keys" title='keys' data-ref="279keys">keys</a> || <a class="local col0 ref" href="#280vkeys" title='vkeys' data-ref="280vkeys">vkeys</a>) {</td></tr>
<tr><th id="3026">3026</th><td>                <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a> = <a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>,</td></tr>
<tr><th id="3027">3027</th><td>                    <q>"db%d:keys=%lld,expires=%lld,avg_ttl=%lld\r\n"</q>,</td></tr>
<tr><th id="3028">3028</th><td>                    <a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>, <a class="local col9 ref" href="#279keys" title='keys' data-ref="279keys">keys</a>, <a class="local col0 ref" href="#280vkeys" title='vkeys' data-ref="280vkeys">vkeys</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col0 ref" href="#250j" title='j' data-ref="250j">j</a>].<a class="ref field" href="redis.h.html#redisDb::avg_ttl" title='redisDb::avg_ttl' data-ref="redisDb::avg_ttl">avg_ttl</a>);</td></tr>
<tr><th id="3029">3029</th><td>            }</td></tr>
<tr><th id="3030">3030</th><td>        }</td></tr>
<tr><th id="3031">3031</th><td>    }</td></tr>
<tr><th id="3032">3032</th><td>    <b>return</b> <a class="local col8 ref" href="#248info" title='info' data-ref="248info">info</a>;</td></tr>
<tr><th id="3033">3033</th><td>}</td></tr>
<tr><th id="3034">3034</th><td></td></tr>
<tr><th id="3035">3035</th><td><em>void</em> <dfn class="decl def fn" id="infoCommand" title='infoCommand' data-ref="infoCommand">infoCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col1 decl" id="281c" title='c' data-type='redisClient *' data-ref="281c">c</dfn>) {</td></tr>
<tr><th id="3036">3036</th><td>    <em>char</em> *<dfn class="local col2 decl" id="282section" title='section' data-type='char *' data-ref="282section">section</dfn> = <a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> == <var>2</var> ? <a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argv" title='redisClient::argv' data-ref="redisClient::argv">argv</a>[<var>1</var>]-&gt;<a class="ref field" href="redis.h.html#redisObject::ptr" title='redisObject::ptr' data-ref="redisObject::ptr">ptr</a> : <q>"default"</q>;</td></tr>
<tr><th id="3037">3037</th><td></td></tr>
<tr><th id="3038">3038</th><td>    <b>if</b> (<a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::argc" title='redisClient::argc' data-ref="redisClient::argc">argc</a> &gt; <var>2</var>) {</td></tr>
<tr><th id="3039">3039</th><td>        <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::syntaxerr" title='sharedObjectsStruct::syntaxerr' data-ref="sharedObjectsStruct::syntaxerr">syntaxerr</a>);</td></tr>
<tr><th id="3040">3040</th><td>        <b>return</b>;</td></tr>
<tr><th id="3041">3041</th><td>    }</td></tr>
<tr><th id="3042">3042</th><td>    <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col3 decl" id="283info" title='info' data-type='sds' data-ref="283info">info</dfn> = <a class="ref fn" href="#genRedisInfoString" title='genRedisInfoString' data-ref="genRedisInfoString">genRedisInfoString</a>(<a class="local col2 ref" href="#282section" title='section' data-ref="282section">section</a>);</td></tr>
<tr><th id="3043">3043</th><td>    <a class="ref fn" href="redis.h.html#addReplySds" title='addReplySds' data-ref="addReplySds">addReplySds</a>(<a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>,<a class="ref fn" href="sds.h.html#sdscatprintf" title='sdscatprintf' data-ref="sdscatprintf">sdscatprintf</a>(<a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>(),<q>"$%lu\r\n"</q>,</td></tr>
<tr><th id="3044">3044</th><td>        (<em>unsigned</em> <em>long</em>)<a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>(<a class="local col3 ref" href="#283info" title='info' data-ref="283info">info</a>)));</td></tr>
<tr><th id="3045">3045</th><td>    <a class="ref fn" href="redis.h.html#addReplySds" title='addReplySds' data-ref="addReplySds">addReplySds</a>(<a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>,<a class="local col3 ref" href="#283info" title='info' data-ref="283info">info</a>);</td></tr>
<tr><th id="3046">3046</th><td>    <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col1 ref" href="#281c" title='c' data-ref="281c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::crlf" title='sharedObjectsStruct::crlf' data-ref="sharedObjectsStruct::crlf">crlf</a>);</td></tr>
<tr><th id="3047">3047</th><td>}</td></tr>
<tr><th id="3048">3048</th><td></td></tr>
<tr><th id="3049">3049</th><td><em>void</em> <dfn class="decl def fn" id="monitorCommand" title='monitorCommand' data-ref="monitorCommand">monitorCommand</dfn>(<a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col4 decl" id="284c" title='c' data-type='redisClient *' data-ref="284c">c</dfn>) {</td></tr>
<tr><th id="3050">3050</th><td>    <i>/* ignore MONITOR if already slave or in monitor mode */</i></td></tr>
<tr><th id="3051">3051</th><td>    <b>if</b> (<a class="local col4 ref" href="#284c" title='c' data-ref="284c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> &amp; <a class="macro" href="redis.h.html#232" title="(1&lt;&lt;0)" data-ref="_M/REDIS_SLAVE">REDIS_SLAVE</a>) <b>return</b>;</td></tr>
<tr><th id="3052">3052</th><td></td></tr>
<tr><th id="3053">3053</th><td>    <a class="local col4 ref" href="#284c" title='c' data-ref="284c">c</a>-&gt;<a class="ref field" href="redis.h.html#redisClient::flags" title='redisClient::flags' data-ref="redisClient::flags">flags</a> |= (<a class="macro" href="redis.h.html#232" title="(1&lt;&lt;0)" data-ref="_M/REDIS_SLAVE">REDIS_SLAVE</a>|<a class="macro" href="redis.h.html#234" title="(1&lt;&lt;2)" data-ref="_M/REDIS_MONITOR">REDIS_MONITOR</a>);</td></tr>
<tr><th id="3054">3054</th><td>    <a class="ref fn" href="adlist.h.html#listAddNodeTail" title='listAddNodeTail' data-ref="listAddNodeTail">listAddNodeTail</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::monitors" title='redisServer::monitors' data-ref="redisServer::monitors">monitors</a>,<a class="local col4 ref" href="#284c" title='c' data-ref="284c">c</a>);</td></tr>
<tr><th id="3055">3055</th><td>    <a class="ref fn" href="redis.h.html#addReply" title='addReply' data-ref="addReply">addReply</a>(<a class="local col4 ref" href="#284c" title='c' data-ref="284c">c</a>,<a class="ref" href="redis.h.html#shared" title='shared' data-ref="shared">shared</a>.<a class="ref field" href="redis.h.html#sharedObjectsStruct::ok" title='sharedObjectsStruct::ok' data-ref="sharedObjectsStruct::ok">ok</a>);</td></tr>
<tr><th id="3056">3056</th><td>}</td></tr>
<tr><th id="3057">3057</th><td></td></tr>
<tr><th id="3058">3058</th><td><i>/* ============================ Maxmemory directive  ======================== */</i></td></tr>
<tr><th id="3059">3059</th><td></td></tr>
<tr><th id="3060">3060</th><td><i>/* freeMemoryIfNeeded() gets called when 'maxmemory' is set on the config</i></td></tr>
<tr><th id="3061">3061</th><td><i> * file to limit the max memory used by the server, before processing a</i></td></tr>
<tr><th id="3062">3062</th><td><i> * command.</i></td></tr>
<tr><th id="3063">3063</th><td><i> *</i></td></tr>
<tr><th id="3064">3064</th><td><i> * The goal of the function is to free enough memory to keep Redis under the</i></td></tr>
<tr><th id="3065">3065</th><td><i> * configured memory limit.</i></td></tr>
<tr><th id="3066">3066</th><td><i> *</i></td></tr>
<tr><th id="3067">3067</th><td><i> * The function starts calculating how many bytes should be freed to keep</i></td></tr>
<tr><th id="3068">3068</th><td><i> * Redis under the limit, and enters a loop selecting the best keys to</i></td></tr>
<tr><th id="3069">3069</th><td><i> * evict accordingly to the configured policy.</i></td></tr>
<tr><th id="3070">3070</th><td><i> *</i></td></tr>
<tr><th id="3071">3071</th><td><i> * If all the bytes needed to return back under the limit were freed the</i></td></tr>
<tr><th id="3072">3072</th><td><i> * function returns REDIS_OK, otherwise REDIS_ERR is returned, and the caller</i></td></tr>
<tr><th id="3073">3073</th><td><i> * should block the execution of commands that will result in more memory</i></td></tr>
<tr><th id="3074">3074</th><td><i> * used by the server.</i></td></tr>
<tr><th id="3075">3075</th><td><i> *</i></td></tr>
<tr><th id="3076">3076</th><td><i> * ------------------------------------------------------------------------</i></td></tr>
<tr><th id="3077">3077</th><td><i> *</i></td></tr>
<tr><th id="3078">3078</th><td><i> * LRU approximation algorithm</i></td></tr>
<tr><th id="3079">3079</th><td><i> *</i></td></tr>
<tr><th id="3080">3080</th><td><i> * Redis uses an approximation of the LRU algorithm that runs in constant</i></td></tr>
<tr><th id="3081">3081</th><td><i> * memory. Every time there is a key to expire, we sample N keys (with</i></td></tr>
<tr><th id="3082">3082</th><td><i> * N very small, usually in around 5) to populate a pool of best keys to</i></td></tr>
<tr><th id="3083">3083</th><td><i> * evict of M keys (the pool size is defined by REDIS_EVICTION_POOL_SIZE).</i></td></tr>
<tr><th id="3084">3084</th><td><i> *</i></td></tr>
<tr><th id="3085">3085</th><td><i> * The N keys sampled are added in the pool of good keys to expire (the one</i></td></tr>
<tr><th id="3086">3086</th><td><i> * with an old access time) if they are better than one of the current keys</i></td></tr>
<tr><th id="3087">3087</th><td><i> * in the pool.</i></td></tr>
<tr><th id="3088">3088</th><td><i> *</i></td></tr>
<tr><th id="3089">3089</th><td><i> * After the pool is populated, the best key we have in the pool is expired.</i></td></tr>
<tr><th id="3090">3090</th><td><i> * However note that we don't remove keys from the pool when they are deleted</i></td></tr>
<tr><th id="3091">3091</th><td><i> * so the pool may contain keys that no longer exist.</i></td></tr>
<tr><th id="3092">3092</th><td><i> *</i></td></tr>
<tr><th id="3093">3093</th><td><i> * When we try to evict a key, and all the entries in the pool don't exist</i></td></tr>
<tr><th id="3094">3094</th><td><i> * we populate it again. This time we'll be sure that the pool has at least</i></td></tr>
<tr><th id="3095">3095</th><td><i> * one key that can be evicted, if there is at least one key that can be</i></td></tr>
<tr><th id="3096">3096</th><td><i> * evicted in the whole database. */</i></td></tr>
<tr><th id="3097">3097</th><td></td></tr>
<tr><th id="3098">3098</th><td><i>/* Create a new eviction pool. */</i></td></tr>
<tr><th id="3099">3099</th><td><b>struct</b> <a class="type" href="redis.h.html#evictionPoolEntry" title='evictionPoolEntry' data-ref="evictionPoolEntry">evictionPoolEntry</a> *<dfn class="decl def fn" id="evictionPoolAlloc" title='evictionPoolAlloc' data-ref="evictionPoolAlloc">evictionPoolAlloc</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3100">3100</th><td>    <b>struct</b> <a class="type" href="redis.h.html#evictionPoolEntry" title='evictionPoolEntry' data-ref="evictionPoolEntry">evictionPoolEntry</a> *<dfn class="local col5 decl" id="285ep" title='ep' data-type='struct evictionPoolEntry *' data-ref="285ep">ep</dfn>;</td></tr>
<tr><th id="3101">3101</th><td>    <em>int</em> <dfn class="local col6 decl" id="286j" title='j' data-type='int' data-ref="286j">j</dfn>;</td></tr>
<tr><th id="3102">3102</th><td></td></tr>
<tr><th id="3103">3103</th><td>    <a class="local col5 ref" href="#285ep" title='ep' data-ref="285ep">ep</a> = <a class="ref fn" href="zmalloc.h.html#zmalloc" title='zmalloc' data-ref="zmalloc">zmalloc</a>(<b>sizeof</b>(*<a class="local col5 ref" href="#285ep" title='ep' data-ref="285ep">ep</a>)*<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>);</td></tr>
<tr><th id="3104">3104</th><td>    <b>for</b> (<a class="local col6 ref" href="#286j" title='j' data-ref="286j">j</a> = <var>0</var>; <a class="local col6 ref" href="#286j" title='j' data-ref="286j">j</a> &lt; <a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>; <a class="local col6 ref" href="#286j" title='j' data-ref="286j">j</a>++) {</td></tr>
<tr><th id="3105">3105</th><td>        <a class="local col5 ref" href="#285ep" title='ep' data-ref="285ep">ep</a>[<a class="local col6 ref" href="#286j" title='j' data-ref="286j">j</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::idle" title='evictionPoolEntry::idle' data-ref="evictionPoolEntry::idle">idle</a> = <var>0</var>;</td></tr>
<tr><th id="3106">3106</th><td>        <a class="local col5 ref" href="#285ep" title='ep' data-ref="285ep">ep</a>[<a class="local col6 ref" href="#286j" title='j' data-ref="286j">j</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3107">3107</th><td>    }</td></tr>
<tr><th id="3108">3108</th><td>    <b>return</b> <a class="local col5 ref" href="#285ep" title='ep' data-ref="285ep">ep</a>;</td></tr>
<tr><th id="3109">3109</th><td>}</td></tr>
<tr><th id="3110">3110</th><td></td></tr>
<tr><th id="3111">3111</th><td><i>/* This is an helper function for freeMemoryIfNeeded(), it is used in order</i></td></tr>
<tr><th id="3112">3112</th><td><i> * to populate the evictionPool with a few entries every time we want to</i></td></tr>
<tr><th id="3113">3113</th><td><i> * expire a key. Keys with idle time smaller than one of the current</i></td></tr>
<tr><th id="3114">3114</th><td><i> * keys are added. Keys are always added if there are free entries.</i></td></tr>
<tr><th id="3115">3115</th><td><i> *</i></td></tr>
<tr><th id="3116">3116</th><td><i> * We insert keys on place in ascending order, so keys with the smaller</i></td></tr>
<tr><th id="3117">3117</th><td><i> * idle time are on the left, and keys with the higher idle time on the</i></td></tr>
<tr><th id="3118">3118</th><td><i> * right. */</i></td></tr>
<tr><th id="3119">3119</th><td></td></tr>
<tr><th id="3120">3120</th><td><u>#define <dfn class="macro" id="_M/EVICTION_SAMPLES_ARRAY_SIZE" data-ref="_M/EVICTION_SAMPLES_ARRAY_SIZE">EVICTION_SAMPLES_ARRAY_SIZE</dfn> 16</u></td></tr>
<tr><th id="3121">3121</th><td><em>void</em> <dfn class="decl def fn" id="evictionPoolPopulate" title='evictionPoolPopulate' data-ref="evictionPoolPopulate">evictionPoolPopulate</dfn>(<a class="typedef" href="dict.h.html#dict" title='dict' data-type='struct dict' data-ref="dict">dict</a> *<dfn class="local col7 decl" id="287sampledict" title='sampledict' data-type='dict *' data-ref="287sampledict">sampledict</dfn>, <a class="typedef" href="dict.h.html#dict" title='dict' data-type='struct dict' data-ref="dict">dict</a> *<dfn class="local col8 decl" id="288keydict" title='keydict' data-type='dict *' data-ref="288keydict">keydict</dfn>, <b>struct</b> <a class="type" href="redis.h.html#evictionPoolEntry" title='evictionPoolEntry' data-ref="evictionPoolEntry">evictionPoolEntry</a> *<dfn class="local col9 decl" id="289pool" title='pool' data-type='struct evictionPoolEntry *' data-ref="289pool">pool</dfn>) {</td></tr>
<tr><th id="3122">3122</th><td>    <em>int</em> <dfn class="local col0 decl" id="290j" title='j' data-type='int' data-ref="290j">j</dfn>, <dfn class="local col1 decl" id="291k" title='k' data-type='int' data-ref="291k">k</dfn>, <dfn class="local col2 decl" id="292count" title='count' data-type='int' data-ref="292count">count</dfn>;</td></tr>
<tr><th id="3123">3123</th><td>    <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> *<dfn class="local col3 decl" id="293_samples" title='_samples' data-type='dictEntry *[16]' data-ref="293_samples">_samples</dfn>[<a class="macro" href="#3120" title="16" data-ref="_M/EVICTION_SAMPLES_ARRAY_SIZE">EVICTION_SAMPLES_ARRAY_SIZE</a>];</td></tr>
<tr><th id="3124">3124</th><td>    <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> **<dfn class="local col4 decl" id="294samples" title='samples' data-type='dictEntry **' data-ref="294samples">samples</dfn>;</td></tr>
<tr><th id="3125">3125</th><td></td></tr>
<tr><th id="3126">3126</th><td>    <i>/* Try to use a static buffer: this function is a big hit...</i></td></tr>
<tr><th id="3127">3127</th><td><i>     * Note: it was actually measured that this helps. */</i></td></tr>
<tr><th id="3128">3128</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_samples" title='redisServer::maxmemory_samples' data-ref="redisServer::maxmemory_samples">maxmemory_samples</a> &lt;= <a class="macro" href="#3120" title="16" data-ref="_M/EVICTION_SAMPLES_ARRAY_SIZE">EVICTION_SAMPLES_ARRAY_SIZE</a>) {</td></tr>
<tr><th id="3129">3129</th><td>        <a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a> = <a class="local col3 ref" href="#293_samples" title='_samples' data-ref="293_samples">_samples</a>;</td></tr>
<tr><th id="3130">3130</th><td>    } <b>else</b> {</td></tr>
<tr><th id="3131">3131</th><td>        <a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a> = <a class="ref fn" href="zmalloc.h.html#zmalloc" title='zmalloc' data-ref="zmalloc">zmalloc</a>(<b>sizeof</b>(<a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a>[<var>0</var>])*<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_samples" title='redisServer::maxmemory_samples' data-ref="redisServer::maxmemory_samples">maxmemory_samples</a>);</td></tr>
<tr><th id="3132">3132</th><td>    }</td></tr>
<tr><th id="3133">3133</th><td></td></tr>
<tr><th id="3134">3134</th><td>    <a class="local col2 ref" href="#292count" title='count' data-ref="292count">count</a> = <a class="ref fn" href="dict.h.html#dictGetSomeKeys" title='dictGetSomeKeys' data-ref="dictGetSomeKeys">dictGetSomeKeys</a>(<a class="local col7 ref" href="#287sampledict" title='sampledict' data-ref="287sampledict">sampledict</a>,<a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a>,<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_samples" title='redisServer::maxmemory_samples' data-ref="redisServer::maxmemory_samples">maxmemory_samples</a>);</td></tr>
<tr><th id="3135">3135</th><td>    <b>for</b> (<a class="local col0 ref" href="#290j" title='j' data-ref="290j">j</a> = <var>0</var>; <a class="local col0 ref" href="#290j" title='j' data-ref="290j">j</a> &lt; <a class="local col2 ref" href="#292count" title='count' data-ref="292count">count</a>; <a class="local col0 ref" href="#290j" title='j' data-ref="290j">j</a>++) {</td></tr>
<tr><th id="3136">3136</th><td>        <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col5 decl" id="295idle" title='idle' data-type='unsigned long long' data-ref="295idle">idle</dfn>;</td></tr>
<tr><th id="3137">3137</th><td>        <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col6 decl" id="296key" title='key' data-type='sds' data-ref="296key">key</dfn>;</td></tr>
<tr><th id="3138">3138</th><td>        <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col7 decl" id="297o" title='o' data-type='robj *' data-ref="297o">o</dfn>;</td></tr>
<tr><th id="3139">3139</th><td>        <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> *<dfn class="local col8 decl" id="298de" title='de' data-type='dictEntry *' data-ref="298de">de</dfn>;</td></tr>
<tr><th id="3140">3140</th><td></td></tr>
<tr><th id="3141">3141</th><td>        <a class="local col8 ref" href="#298de" title='de' data-ref="298de">de</a> = <a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a>[<a class="local col0 ref" href="#290j" title='j' data-ref="290j">j</a>];</td></tr>
<tr><th id="3142">3142</th><td>        <a class="local col6 ref" href="#296key" title='key' data-ref="296key">key</a> = <a class="macro" href="dict.h.html#140" title="((de)-&gt;key)" data-ref="_M/dictGetKey">dictGetKey</a>(<a class="local col8 ref" href="#298de" title='de' data-ref="298de">de</a>);</td></tr>
<tr><th id="3143">3143</th><td>        <i>/* If the dictionary we are sampling from is not the main</i></td></tr>
<tr><th id="3144">3144</th><td><i>         * dictionary (but the expires one) we need to lookup the key</i></td></tr>
<tr><th id="3145">3145</th><td><i>         * again in the key dictionary to obtain the value object. */</i></td></tr>
<tr><th id="3146">3146</th><td>        <b>if</b> (<a class="local col7 ref" href="#287sampledict" title='sampledict' data-ref="287sampledict">sampledict</a> != <a class="local col8 ref" href="#288keydict" title='keydict' data-ref="288keydict">keydict</a>) <a class="local col8 ref" href="#298de" title='de' data-ref="298de">de</a> = <a class="ref fn" href="dict.h.html#dictFind" title='dictFind' data-ref="dictFind">dictFind</a>(<a class="local col8 ref" href="#288keydict" title='keydict' data-ref="288keydict">keydict</a>, <a class="local col6 ref" href="#296key" title='key' data-ref="296key">key</a>);</td></tr>
<tr><th id="3147">3147</th><td>        <a class="local col7 ref" href="#297o" title='o' data-ref="297o">o</a> = <a class="macro" href="dict.h.html#141" title="((de)-&gt;v.val)" data-ref="_M/dictGetVal">dictGetVal</a>(<a class="local col8 ref" href="#298de" title='de' data-ref="298de">de</a>);</td></tr>
<tr><th id="3148">3148</th><td>        <a class="local col5 ref" href="#295idle" title='idle' data-ref="295idle">idle</a> = <a class="ref fn" href="redis.h.html#estimateObjectIdleTime" title='estimateObjectIdleTime' data-ref="estimateObjectIdleTime">estimateObjectIdleTime</a>(<a class="local col7 ref" href="#297o" title='o' data-ref="297o">o</a>);</td></tr>
<tr><th id="3149">3149</th><td></td></tr>
<tr><th id="3150">3150</th><td>        <i>/* Insert the element inside the pool.</i></td></tr>
<tr><th id="3151">3151</th><td><i>         * First, find the first empty bucket or the first populated</i></td></tr>
<tr><th id="3152">3152</th><td><i>         * bucket that has an idle time smaller than our idle time. */</i></td></tr>
<tr><th id="3153">3153</th><td>        <a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a> = <var>0</var>;</td></tr>
<tr><th id="3154">3154</th><td>        <b>while</b> (<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a> &lt; <a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a> &amp;&amp;</td></tr>
<tr><th id="3155">3155</th><td>               <a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> &amp;&amp;</td></tr>
<tr><th id="3156">3156</th><td>               <a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::idle" title='evictionPoolEntry::idle' data-ref="evictionPoolEntry::idle">idle</a> &lt; <a class="local col5 ref" href="#295idle" title='idle' data-ref="295idle">idle</a>) <a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>++;</td></tr>
<tr><th id="3157">3157</th><td>        <b>if</b> (<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a> == <var>0</var> &amp;&amp; <a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<var>1</var>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3158">3158</th><td>            <i>/* Can't insert if the element is &lt; the worst element we have</i></td></tr>
<tr><th id="3159">3159</th><td><i>             * and there are no empty buckets. */</i></td></tr>
<tr><th id="3160">3160</th><td>            <b>continue</b>;</td></tr>
<tr><th id="3161">3161</th><td>        } <b>else</b> <b>if</b> (<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a> &lt; <a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a> &amp;&amp; <a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3162">3162</th><td>            <i>/* Inserting into empty position. No setup needed before insert. */</i></td></tr>
<tr><th id="3163">3163</th><td>        } <b>else</b> {</td></tr>
<tr><th id="3164">3164</th><td>            <i>/* Inserting in the middle. Now k points to the first element</i></td></tr>
<tr><th id="3165">3165</th><td><i>             * greater than the element to insert.  */</i></td></tr>
<tr><th id="3166">3166</th><td>            <b>if</b> (<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<var>1</var>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3167">3167</th><td>                <i>/* Free space on the right? Insert at k shifting</i></td></tr>
<tr><th id="3168">3168</th><td><i>                 * all the elements from k to end to the right. */</i></td></tr>
<tr><th id="3169">3169</th><td>                <a class="ref fn" href="../../include/string.h.html#memmove" title='memmove' data-ref="memmove">memmove</a>(<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>+<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>+<var>1</var>,<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>+<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>,</td></tr>
<tr><th id="3170">3170</th><td>                    <b>sizeof</b>(<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<var>0</var>])*(<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>-<var>1</var>));</td></tr>
<tr><th id="3171">3171</th><td>            } <b>else</b> {</td></tr>
<tr><th id="3172">3172</th><td>                <i>/* No free space on right? Insert at k-1 */</i></td></tr>
<tr><th id="3173">3173</th><td>                <a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>--;</td></tr>
<tr><th id="3174">3174</th><td>                <i>/* Shift all elements on the left of k (included) to the</i></td></tr>
<tr><th id="3175">3175</th><td><i>                 * left, so we discard the element with smaller idle time. */</i></td></tr>
<tr><th id="3176">3176</th><td>                <a class="ref fn" href="sds.h.html#sdsfree" title='sdsfree' data-ref="sdsfree">sdsfree</a>(<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<var>0</var>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a>);</td></tr>
<tr><th id="3177">3177</th><td>                <a class="ref fn" href="../../include/string.h.html#memmove" title='memmove' data-ref="memmove">memmove</a>(<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>,<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>+<var>1</var>,<b>sizeof</b>(<a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<var>0</var>])*<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>);</td></tr>
<tr><th id="3178">3178</th><td>            }</td></tr>
<tr><th id="3179">3179</th><td>        }</td></tr>
<tr><th id="3180">3180</th><td>        <a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> = <a class="ref fn" href="sds.h.html#sdsdup" title='sdsdup' data-ref="sdsdup">sdsdup</a>(<a class="local col6 ref" href="#296key" title='key' data-ref="296key">key</a>);</td></tr>
<tr><th id="3181">3181</th><td>        <a class="local col9 ref" href="#289pool" title='pool' data-ref="289pool">pool</a>[<a class="local col1 ref" href="#291k" title='k' data-ref="291k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::idle" title='evictionPoolEntry::idle' data-ref="evictionPoolEntry::idle">idle</a> = <a class="local col5 ref" href="#295idle" title='idle' data-ref="295idle">idle</a>;</td></tr>
<tr><th id="3182">3182</th><td>    }</td></tr>
<tr><th id="3183">3183</th><td>    <b>if</b> (<a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a> != <a class="local col3 ref" href="#293_samples" title='_samples' data-ref="293_samples">_samples</a>) <a class="ref fn" href="zmalloc.h.html#zfree" title='zfree' data-ref="zfree">zfree</a>(<a class="local col4 ref" href="#294samples" title='samples' data-ref="294samples">samples</a>);</td></tr>
<tr><th id="3184">3184</th><td>}</td></tr>
<tr><th id="3185">3185</th><td></td></tr>
<tr><th id="3186">3186</th><td><em>int</em> <dfn class="decl def fn" id="freeMemoryIfNeeded" title='freeMemoryIfNeeded' data-ref="freeMemoryIfNeeded">freeMemoryIfNeeded</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3187">3187</th><td>    <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col9 decl" id="299mem_used" title='mem_used' data-type='size_t' data-ref="299mem_used">mem_used</dfn>, <dfn class="local col0 decl" id="300mem_tofree" title='mem_tofree' data-type='size_t' data-ref="300mem_tofree">mem_tofree</dfn>, <dfn class="local col1 decl" id="301mem_freed" title='mem_freed' data-type='size_t' data-ref="301mem_freed">mem_freed</dfn>;</td></tr>
<tr><th id="3188">3188</th><td>    <em>int</em> <dfn class="local col2 decl" id="302slaves" title='slaves' data-type='int' data-ref="302slaves">slaves</dfn> = <a class="macro" href="adlist.h.html#57" title="((server.slaves)-&gt;len)" data-ref="_M/listLength">listLength</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>);</td></tr>
<tr><th id="3189">3189</th><td>    <a class="typedef" href="redis.h.html#mstime_t" title='mstime_t' data-type='long long' data-ref="mstime_t">mstime_t</a> <dfn class="local col3 decl" id="303latency" title='latency' data-type='mstime_t' data-ref="303latency">latency</dfn>, <dfn class="local col4 decl" id="304eviction_latency" title='eviction_latency' data-type='mstime_t' data-ref="304eviction_latency">eviction_latency</dfn>;</td></tr>
<tr><th id="3190">3190</th><td></td></tr>
<tr><th id="3191">3191</th><td>    <i>/* Remove the size of slaves output buffers and AOF buffer from the</i></td></tr>
<tr><th id="3192">3192</th><td><i>     * count of used memory. */</i></td></tr>
<tr><th id="3193">3193</th><td>    <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> = <a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>();</td></tr>
<tr><th id="3194">3194</th><td>    <b>if</b> (<a class="local col2 ref" href="#302slaves" title='slaves' data-ref="302slaves">slaves</a>) {</td></tr>
<tr><th id="3195">3195</th><td>        <a class="typedef" href="adlist.h.html#listIter" title='listIter' data-type='struct listIter' data-ref="listIter">listIter</a> <dfn class="local col5 decl" id="305li" title='li' data-type='listIter' data-ref="305li">li</dfn>;</td></tr>
<tr><th id="3196">3196</th><td>        <a class="typedef" href="adlist.h.html#listNode" title='listNode' data-type='struct listNode' data-ref="listNode">listNode</a> *<dfn class="local col6 decl" id="306ln" title='ln' data-type='listNode *' data-ref="306ln">ln</dfn>;</td></tr>
<tr><th id="3197">3197</th><td></td></tr>
<tr><th id="3198">3198</th><td>        <a class="ref fn" href="adlist.h.html#listRewind" title='listRewind' data-ref="listRewind">listRewind</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::slaves" title='redisServer::slaves' data-ref="redisServer::slaves">slaves</a>,&amp;<a class="local col5 ref" href="#305li" title='li' data-ref="305li">li</a>);</td></tr>
<tr><th id="3199">3199</th><td>        <b>while</b>((<a class="local col6 ref" href="#306ln" title='ln' data-ref="306ln">ln</a> = <a class="ref fn" href="adlist.h.html#listNext" title='listNext' data-ref="listNext">listNext</a>(&amp;<a class="local col5 ref" href="#305li" title='li' data-ref="305li">li</a>))) {</td></tr>
<tr><th id="3200">3200</th><td>            <a class="typedef" href="redis.h.html#redisClient" title='redisClient' data-type='struct redisClient' data-ref="redisClient">redisClient</a> *<dfn class="local col7 decl" id="307slave" title='slave' data-type='redisClient *' data-ref="307slave">slave</dfn> = <a class="macro" href="adlist.h.html#62" title="((ln)-&gt;value)" data-ref="_M/listNodeValue">listNodeValue</a>(<a class="local col6 ref" href="#306ln" title='ln' data-ref="306ln">ln</a>);</td></tr>
<tr><th id="3201">3201</th><td>            <em>unsigned</em> <em>long</em> <dfn class="local col8 decl" id="308obuf_bytes" title='obuf_bytes' data-type='unsigned long' data-ref="308obuf_bytes">obuf_bytes</dfn> = <a class="ref fn" href="redis.h.html#getClientOutputBufferMemoryUsage" title='getClientOutputBufferMemoryUsage' data-ref="getClientOutputBufferMemoryUsage">getClientOutputBufferMemoryUsage</a>(<a class="local col7 ref" href="#307slave" title='slave' data-ref="307slave">slave</a>);</td></tr>
<tr><th id="3202">3202</th><td>            <b>if</b> (<a class="local col8 ref" href="#308obuf_bytes" title='obuf_bytes' data-ref="308obuf_bytes">obuf_bytes</a> &gt; <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a>)</td></tr>
<tr><th id="3203">3203</th><td>                <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> = <var>0</var>;</td></tr>
<tr><th id="3204">3204</th><td>            <b>else</b></td></tr>
<tr><th id="3205">3205</th><td>                <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> -= <a class="local col8 ref" href="#308obuf_bytes" title='obuf_bytes' data-ref="308obuf_bytes">obuf_bytes</a>;</td></tr>
<tr><th id="3206">3206</th><td>        }</td></tr>
<tr><th id="3207">3207</th><td>    }</td></tr>
<tr><th id="3208">3208</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> != <a class="macro" href="redis.h.html#227" title="0" data-ref="_M/REDIS_AOF_OFF">REDIS_AOF_OFF</a>) {</td></tr>
<tr><th id="3209">3209</th><td>        <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> -= <a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_buf" title='redisServer::aof_buf' data-ref="redisServer::aof_buf">aof_buf</a>);</td></tr>
<tr><th id="3210">3210</th><td>        <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> -= <a class="ref fn" href="redis.h.html#aofRewriteBufferSize" title='aofRewriteBufferSize' data-ref="aofRewriteBufferSize">aofRewriteBufferSize</a>();</td></tr>
<tr><th id="3211">3211</th><td>    }</td></tr>
<tr><th id="3212">3212</th><td></td></tr>
<tr><th id="3213">3213</th><td>    <i>/* Check if we are over the memory limit. */</i></td></tr>
<tr><th id="3214">3214</th><td>    <b>if</b> (<a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> &lt;= <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a>) <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="3215">3215</th><td></td></tr>
<tr><th id="3216">3216</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#343" title="5" data-ref="_M/REDIS_MAXMEMORY_NO_EVICTION">REDIS_MAXMEMORY_NO_EVICTION</a>)</td></tr>
<tr><th id="3217">3217</th><td>        <b>return</b> <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>; <i>/* We need to free memory, but policy forbids. */</i></td></tr>
<tr><th id="3218">3218</th><td></td></tr>
<tr><th id="3219">3219</th><td>    <i>/* Compute how much memory we need to free. */</i></td></tr>
<tr><th id="3220">3220</th><td>    <a class="local col0 ref" href="#300mem_tofree" title='mem_tofree' data-ref="300mem_tofree">mem_tofree</a> = <a class="local col9 ref" href="#299mem_used" title='mem_used' data-ref="299mem_used">mem_used</a> - <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a>;</td></tr>
<tr><th id="3221">3221</th><td>    <a class="local col1 ref" href="#301mem_freed" title='mem_freed' data-ref="301mem_freed">mem_freed</a> = <var>0</var>;</td></tr>
<tr><th id="3222">3222</th><td>    <a class="macro" href="latency.h.html#71" title="if (server.latency_monitor_threshold) { latency = mstime(); } else { latency = 0; }" data-ref="_M/latencyStartMonitor">latencyStartMonitor</a>(<a class="local col3 ref" href="#303latency" title='latency' data-ref="303latency">latency</a>);</td></tr>
<tr><th id="3223">3223</th><td>    <b>while</b> (<a class="local col1 ref" href="#301mem_freed" title='mem_freed' data-ref="301mem_freed">mem_freed</a> &lt; <a class="local col0 ref" href="#300mem_tofree" title='mem_tofree' data-ref="300mem_tofree">mem_tofree</a>) {</td></tr>
<tr><th id="3224">3224</th><td>        <em>int</em> <dfn class="local col9 decl" id="309j" title='j' data-type='int' data-ref="309j">j</dfn>, <dfn class="local col0 decl" id="310k" title='k' data-type='int' data-ref="310k">k</dfn>, <dfn class="local col1 decl" id="311keys_freed" title='keys_freed' data-type='int' data-ref="311keys_freed">keys_freed</dfn> = <var>0</var>;</td></tr>
<tr><th id="3225">3225</th><td></td></tr>
<tr><th id="3226">3226</th><td>        <b>for</b> (<a class="local col9 ref" href="#309j" title='j' data-ref="309j">j</a> = <var>0</var>; <a class="local col9 ref" href="#309j" title='j' data-ref="309j">j</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::dbnum" title='redisServer::dbnum' data-ref="redisServer::dbnum">dbnum</a>; <a class="local col9 ref" href="#309j" title='j' data-ref="309j">j</a>++) {</td></tr>
<tr><th id="3227">3227</th><td>            <em>long</em> <dfn class="local col2 decl" id="312bestval" title='bestval' data-type='long' data-ref="312bestval">bestval</dfn> = <var>0</var>; <i>/* just to prevent warning */</i></td></tr>
<tr><th id="3228">3228</th><td>            <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col3 decl" id="313bestkey" title='bestkey' data-type='sds' data-ref="313bestkey">bestkey</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3229">3229</th><td>            <a class="typedef" href="dict.h.html#dictEntry" title='dictEntry' data-type='struct dictEntry' data-ref="dictEntry">dictEntry</a> *<dfn class="local col4 decl" id="314de" title='de' data-type='dictEntry *' data-ref="314de">de</dfn>;</td></tr>
<tr><th id="3230">3230</th><td>            <a class="typedef" href="redis.h.html#redisDb" title='redisDb' data-type='struct redisDb' data-ref="redisDb">redisDb</a> *<dfn class="local col5 decl" id="315db" title='db' data-type='redisDb *' data-ref="315db">db</dfn> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>+<a class="local col9 ref" href="#309j" title='j' data-ref="309j">j</a>;</td></tr>
<tr><th id="3231">3231</th><td>            <a class="typedef" href="dict.h.html#dict" title='dict' data-type='struct dict' data-ref="dict">dict</a> *<dfn class="local col6 decl" id="316dict" title='dict' data-type='dict *' data-ref="316dict">dict</dfn>;</td></tr>
<tr><th id="3232">3232</th><td></td></tr>
<tr><th id="3233">3233</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#341" title="3" data-ref="_M/REDIS_MAXMEMORY_ALLKEYS_LRU">REDIS_MAXMEMORY_ALLKEYS_LRU</a> ||</td></tr>
<tr><th id="3234">3234</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#342" title="4" data-ref="_M/REDIS_MAXMEMORY_ALLKEYS_RANDOM">REDIS_MAXMEMORY_ALLKEYS_RANDOM</a>)</td></tr>
<tr><th id="3235">3235</th><td>            {</td></tr>
<tr><th id="3236">3236</th><td>                <a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col9 ref" href="#309j" title='j' data-ref="309j">j</a>].<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>;</td></tr>
<tr><th id="3237">3237</th><td>            } <b>else</b> {</td></tr>
<tr><th id="3238">3238</th><td>                <a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a> = <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::db" title='redisServer::db' data-ref="redisServer::db">db</a>[<a class="local col9 ref" href="#309j" title='j' data-ref="309j">j</a>].<a class="ref field" href="redis.h.html#redisDb::expires" title='redisDb::expires' data-ref="redisDb::expires">expires</a>;</td></tr>
<tr><th id="3239">3239</th><td>            }</td></tr>
<tr><th id="3240">3240</th><td>            <b>if</b> (<a class="macro" href="dict.h.html#146" title="((dict)-&gt;ht[0].used+(dict)-&gt;ht[1].used)" data-ref="_M/dictSize">dictSize</a>(<a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a>) == <var>0</var>) <b>continue</b>;</td></tr>
<tr><th id="3241">3241</th><td></td></tr>
<tr><th id="3242">3242</th><td>            <i>/* volatile-random and allkeys-random policy */</i></td></tr>
<tr><th id="3243">3243</th><td>            <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#342" title="4" data-ref="_M/REDIS_MAXMEMORY_ALLKEYS_RANDOM">REDIS_MAXMEMORY_ALLKEYS_RANDOM</a> ||</td></tr>
<tr><th id="3244">3244</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#340" title="2" data-ref="_M/REDIS_MAXMEMORY_VOLATILE_RANDOM">REDIS_MAXMEMORY_VOLATILE_RANDOM</a>)</td></tr>
<tr><th id="3245">3245</th><td>            {</td></tr>
<tr><th id="3246">3246</th><td>                <a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a> = <a class="ref fn" href="dict.h.html#dictGetRandomKey" title='dictGetRandomKey' data-ref="dictGetRandomKey">dictGetRandomKey</a>(<a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a>);</td></tr>
<tr><th id="3247">3247</th><td>                <a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a> = <a class="macro" href="dict.h.html#140" title="((de)-&gt;key)" data-ref="_M/dictGetKey">dictGetKey</a>(<a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a>);</td></tr>
<tr><th id="3248">3248</th><td>            }</td></tr>
<tr><th id="3249">3249</th><td></td></tr>
<tr><th id="3250">3250</th><td>            <i>/* volatile-lru and allkeys-lru policy */</i></td></tr>
<tr><th id="3251">3251</th><td>            <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#341" title="3" data-ref="_M/REDIS_MAXMEMORY_ALLKEYS_LRU">REDIS_MAXMEMORY_ALLKEYS_LRU</a> ||</td></tr>
<tr><th id="3252">3252</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#338" title="0" data-ref="_M/REDIS_MAXMEMORY_VOLATILE_LRU">REDIS_MAXMEMORY_VOLATILE_LRU</a>)</td></tr>
<tr><th id="3253">3253</th><td>            {</td></tr>
<tr><th id="3254">3254</th><td>                <b>struct</b> <a class="type" href="redis.h.html#evictionPoolEntry" title='evictionPoolEntry' data-ref="evictionPoolEntry">evictionPoolEntry</a> *<dfn class="local col7 decl" id="317pool" title='pool' data-type='struct evictionPoolEntry *' data-ref="317pool">pool</dfn> = <a class="local col5 ref" href="#315db" title='db' data-ref="315db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::eviction_pool" title='redisDb::eviction_pool' data-ref="redisDb::eviction_pool">eviction_pool</a>;</td></tr>
<tr><th id="3255">3255</th><td></td></tr>
<tr><th id="3256">3256</th><td>                <b>while</b>(<a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3257">3257</th><td>                    <a class="ref fn" href="#evictionPoolPopulate" title='evictionPoolPopulate' data-ref="evictionPoolPopulate">evictionPoolPopulate</a>(<a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a>, <a class="local col5 ref" href="#315db" title='db' data-ref="315db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::dict" title='redisDb::dict' data-ref="redisDb::dict">dict</a>, <a class="local col5 ref" href="#315db" title='db' data-ref="315db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::eviction_pool" title='redisDb::eviction_pool' data-ref="redisDb::eviction_pool">eviction_pool</a>);</td></tr>
<tr><th id="3258">3258</th><td>                    <i>/* Go backward from best to worst element to evict. */</i></td></tr>
<tr><th id="3259">3259</th><td>                    <b>for</b> (<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a> = <a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<var>1</var>; <a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a> &gt;= <var>0</var>; <a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>--) {</td></tr>
<tr><th id="3260">3260</th><td>                        <b>if</b> (<a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>[<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) <b>continue</b>;</td></tr>
<tr><th id="3261">3261</th><td>                        <a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a> = <a class="ref fn" href="dict.h.html#dictFind" title='dictFind' data-ref="dictFind">dictFind</a>(<a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a>,<a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>[<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a>);</td></tr>
<tr><th id="3262">3262</th><td></td></tr>
<tr><th id="3263">3263</th><td>                        <i>/* Remove the entry from the pool. */</i></td></tr>
<tr><th id="3264">3264</th><td>                        <a class="ref fn" href="sds.h.html#sdsfree" title='sdsfree' data-ref="sdsfree">sdsfree</a>(<a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>[<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a>);</td></tr>
<tr><th id="3265">3265</th><td>                        <i>/* Shift all elements on its right to left. */</i></td></tr>
<tr><th id="3266">3266</th><td>                        <a class="ref fn" href="../../include/string.h.html#memmove" title='memmove' data-ref="memmove">memmove</a>(<a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>+<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>,<a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>+<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>+<var>1</var>,</td></tr>
<tr><th id="3267">3267</th><td>                            <b>sizeof</b>(<a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>[<var>0</var>])*(<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>-<var>1</var>));</td></tr>
<tr><th id="3268">3268</th><td>                        <i>/* Clear the element on the right which is empty</i></td></tr>
<tr><th id="3269">3269</th><td><i>                         * since we shifted one position to the left.  */</i></td></tr>
<tr><th id="3270">3270</th><td>                        <a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>[<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<var>1</var>].<a class="ref field" href="redis.h.html#evictionPoolEntry::key" title='evictionPoolEntry::key' data-ref="evictionPoolEntry::key">key</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3271">3271</th><td>                        <a class="local col7 ref" href="#317pool" title='pool' data-ref="317pool">pool</a>[<a class="macro" href="redis.h.html#444" title="16" data-ref="_M/REDIS_EVICTION_POOL_SIZE">REDIS_EVICTION_POOL_SIZE</a>-<var>1</var>].<a class="ref field" href="redis.h.html#evictionPoolEntry::idle" title='evictionPoolEntry::idle' data-ref="evictionPoolEntry::idle">idle</a> = <var>0</var>;</td></tr>
<tr><th id="3272">3272</th><td></td></tr>
<tr><th id="3273">3273</th><td>                        <i>/* If the key exists, is our pick. Otherwise it is</i></td></tr>
<tr><th id="3274">3274</th><td><i>                         * a ghost and we need to try the next element. */</i></td></tr>
<tr><th id="3275">3275</th><td>                        <b>if</b> (<a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a>) {</td></tr>
<tr><th id="3276">3276</th><td>                            <a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a> = <a class="macro" href="dict.h.html#140" title="((de)-&gt;key)" data-ref="_M/dictGetKey">dictGetKey</a>(<a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a>);</td></tr>
<tr><th id="3277">3277</th><td>                            <b>break</b>;</td></tr>
<tr><th id="3278">3278</th><td>                        } <b>else</b> {</td></tr>
<tr><th id="3279">3279</th><td>                            <i>/* Ghost... */</i></td></tr>
<tr><th id="3280">3280</th><td>                            <b>continue</b>;</td></tr>
<tr><th id="3281">3281</th><td>                        }</td></tr>
<tr><th id="3282">3282</th><td>                    }</td></tr>
<tr><th id="3283">3283</th><td>                }</td></tr>
<tr><th id="3284">3284</th><td>            }</td></tr>
<tr><th id="3285">3285</th><td></td></tr>
<tr><th id="3286">3286</th><td>            <i>/* volatile-ttl */</i></td></tr>
<tr><th id="3287">3287</th><td>            <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_policy" title='redisServer::maxmemory_policy' data-ref="redisServer::maxmemory_policy">maxmemory_policy</a> == <a class="macro" href="redis.h.html#339" title="1" data-ref="_M/REDIS_MAXMEMORY_VOLATILE_TTL">REDIS_MAXMEMORY_VOLATILE_TTL</a>) {</td></tr>
<tr><th id="3288">3288</th><td>                <b>for</b> (<a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a> = <var>0</var>; <a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a> &lt; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory_samples" title='redisServer::maxmemory_samples' data-ref="redisServer::maxmemory_samples">maxmemory_samples</a>; <a class="local col0 ref" href="#310k" title='k' data-ref="310k">k</a>++) {</td></tr>
<tr><th id="3289">3289</th><td>                    <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col8 decl" id="318thiskey" title='thiskey' data-type='sds' data-ref="318thiskey">thiskey</dfn>;</td></tr>
<tr><th id="3290">3290</th><td>                    <em>long</em> <dfn class="local col9 decl" id="319thisval" title='thisval' data-type='long' data-ref="319thisval">thisval</dfn>;</td></tr>
<tr><th id="3291">3291</th><td></td></tr>
<tr><th id="3292">3292</th><td>                    <a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a> = <a class="ref fn" href="dict.h.html#dictGetRandomKey" title='dictGetRandomKey' data-ref="dictGetRandomKey">dictGetRandomKey</a>(<a class="local col6 ref" href="#316dict" title='dict' data-ref="316dict">dict</a>);</td></tr>
<tr><th id="3293">3293</th><td>                    <a class="local col8 ref" href="#318thiskey" title='thiskey' data-ref="318thiskey">thiskey</a> = <a class="macro" href="dict.h.html#140" title="((de)-&gt;key)" data-ref="_M/dictGetKey">dictGetKey</a>(<a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a>);</td></tr>
<tr><th id="3294">3294</th><td>                    <a class="local col9 ref" href="#319thisval" title='thisval' data-ref="319thisval">thisval</a> = (<em>long</em>) <a class="macro" href="dict.h.html#141" title="((de)-&gt;v.val)" data-ref="_M/dictGetVal">dictGetVal</a>(<a class="local col4 ref" href="#314de" title='de' data-ref="314de">de</a>);</td></tr>
<tr><th id="3295">3295</th><td></td></tr>
<tr><th id="3296">3296</th><td>                    <i>/* Expire sooner (minor expire unix timestamp) is better</i></td></tr>
<tr><th id="3297">3297</th><td><i>                     * candidate for deletion */</i></td></tr>
<tr><th id="3298">3298</th><td>                    <b>if</b> (<a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> || <a class="local col9 ref" href="#319thisval" title='thisval' data-ref="319thisval">thisval</a> &lt; <a class="local col2 ref" href="#312bestval" title='bestval' data-ref="312bestval">bestval</a>) {</td></tr>
<tr><th id="3299">3299</th><td>                        <a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a> = <a class="local col8 ref" href="#318thiskey" title='thiskey' data-ref="318thiskey">thiskey</a>;</td></tr>
<tr><th id="3300">3300</th><td>                        <a class="local col2 ref" href="#312bestval" title='bestval' data-ref="312bestval">bestval</a> = <a class="local col9 ref" href="#319thisval" title='thisval' data-ref="319thisval">thisval</a>;</td></tr>
<tr><th id="3301">3301</th><td>                    }</td></tr>
<tr><th id="3302">3302</th><td>                }</td></tr>
<tr><th id="3303">3303</th><td>            }</td></tr>
<tr><th id="3304">3304</th><td></td></tr>
<tr><th id="3305">3305</th><td>            <i>/* Finally remove the selected key. */</i></td></tr>
<tr><th id="3306">3306</th><td>            <b>if</b> (<a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a>) {</td></tr>
<tr><th id="3307">3307</th><td>                <em>long</em> <em>long</em> <dfn class="local col0 decl" id="320delta" title='delta' data-type='long long' data-ref="320delta">delta</dfn>;</td></tr>
<tr><th id="3308">3308</th><td></td></tr>
<tr><th id="3309">3309</th><td>                <a class="typedef" href="redis.h.html#robj" title='robj' data-type='struct redisObject' data-ref="robj">robj</a> *<dfn class="local col1 decl" id="321keyobj" title='keyobj' data-type='robj *' data-ref="321keyobj">keyobj</dfn> = <a class="ref fn" href="redis.h.html#createStringObject" title='createStringObject' data-ref="createStringObject">createStringObject</a>(<a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a>,<a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>(<a class="local col3 ref" href="#313bestkey" title='bestkey' data-ref="313bestkey">bestkey</a>));</td></tr>
<tr><th id="3310">3310</th><td>                <a class="ref fn" href="redis.h.html#propagateExpire" title='propagateExpire' data-ref="propagateExpire">propagateExpire</a>(<a class="local col5 ref" href="#315db" title='db' data-ref="315db">db</a>,<a class="local col1 ref" href="#321keyobj" title='keyobj' data-ref="321keyobj">keyobj</a>);</td></tr>
<tr><th id="3311">3311</th><td>                <i>/* We compute the amount of memory freed by dbDelete() alone.</i></td></tr>
<tr><th id="3312">3312</th><td><i>                 * It is possible that actually the memory needed to propagate</i></td></tr>
<tr><th id="3313">3313</th><td><i>                 * the DEL in AOF and replication link is greater than the one</i></td></tr>
<tr><th id="3314">3314</th><td><i>                 * we are freeing removing the key, but we can't account for</i></td></tr>
<tr><th id="3315">3315</th><td><i>                 * that otherwise we would never exit the loop.</i></td></tr>
<tr><th id="3316">3316</th><td><i>                 *</i></td></tr>
<tr><th id="3317">3317</th><td><i>                 * AOF and Output buffer memory will be freed eventually so</i></td></tr>
<tr><th id="3318">3318</th><td><i>                 * we only care about memory used by the key space. */</i></td></tr>
<tr><th id="3319">3319</th><td>                <a class="local col0 ref" href="#320delta" title='delta' data-ref="320delta">delta</a> = (<em>long</em> <em>long</em>) <a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>();</td></tr>
<tr><th id="3320">3320</th><td>                <a class="macro" href="latency.h.html#71" title="if (server.latency_monitor_threshold) { eviction_latency = mstime(); } else { eviction_latency = 0; }" data-ref="_M/latencyStartMonitor">latencyStartMonitor</a>(<a class="local col4 ref" href="#304eviction_latency" title='eviction_latency' data-ref="304eviction_latency">eviction_latency</a>);</td></tr>
<tr><th id="3321">3321</th><td>                <a class="ref fn" href="redis.h.html#dbDelete" title='dbDelete' data-ref="dbDelete">dbDelete</a>(<a class="local col5 ref" href="#315db" title='db' data-ref="315db">db</a>,<a class="local col1 ref" href="#321keyobj" title='keyobj' data-ref="321keyobj">keyobj</a>);</td></tr>
<tr><th id="3322">3322</th><td>                <a class="macro" href="latency.h.html#79" title="if (server.latency_monitor_threshold) { eviction_latency = mstime() - eviction_latency; }" data-ref="_M/latencyEndMonitor">latencyEndMonitor</a>(<a class="local col4 ref" href="#304eviction_latency" title='eviction_latency' data-ref="304eviction_latency">eviction_latency</a>);</td></tr>
<tr><th id="3323">3323</th><td>                <a class="macro" href="latency.h.html#84" title="if (server.latency_monitor_threshold &amp;&amp; (eviction_latency) &gt;= server.latency_monitor_threshold) latencyAddSample((&quot;eviction-del&quot;),(eviction_latency));" data-ref="_M/latencyAddSampleIfNeeded">latencyAddSampleIfNeeded</a>(<q>"eviction-del"</q>,<a class="local col4 ref" href="#304eviction_latency" title='eviction_latency' data-ref="304eviction_latency">eviction_latency</a>);</td></tr>
<tr><th id="3324">3324</th><td>                <a class="macro" href="latency.h.html#90" title="latency += eviction_latency;" data-ref="_M/latencyRemoveNestedEvent">latencyRemoveNestedEvent</a>(<a class="local col3 ref" href="#303latency" title='latency' data-ref="303latency">latency</a>,<a class="local col4 ref" href="#304eviction_latency" title='eviction_latency' data-ref="304eviction_latency">eviction_latency</a>);</td></tr>
<tr><th id="3325">3325</th><td>                <a class="local col0 ref" href="#320delta" title='delta' data-ref="320delta">delta</a> -= (<em>long</em> <em>long</em>) <a class="ref fn" href="zmalloc.h.html#zmalloc_used_memory" title='zmalloc_used_memory' data-ref="zmalloc_used_memory">zmalloc_used_memory</a>();</td></tr>
<tr><th id="3326">3326</th><td>                <a class="local col1 ref" href="#301mem_freed" title='mem_freed' data-ref="301mem_freed">mem_freed</a> += <a class="local col0 ref" href="#320delta" title='delta' data-ref="320delta">delta</a>;</td></tr>
<tr><th id="3327">3327</th><td>                <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::stat_evictedkeys" title='redisServer::stat_evictedkeys' data-ref="redisServer::stat_evictedkeys">stat_evictedkeys</a>++;</td></tr>
<tr><th id="3328">3328</th><td>                <a class="ref fn" href="redis.h.html#notifyKeyspaceEvent" title='notifyKeyspaceEvent' data-ref="notifyKeyspaceEvent">notifyKeyspaceEvent</a>(<a class="macro" href="redis.h.html#386" title="(1&lt;&lt;9)" data-ref="_M/REDIS_NOTIFY_EVICTED">REDIS_NOTIFY_EVICTED</a>, <q>"evicted"</q>,</td></tr>
<tr><th id="3329">3329</th><td>                    <a class="local col1 ref" href="#321keyobj" title='keyobj' data-ref="321keyobj">keyobj</a>, <a class="local col5 ref" href="#315db" title='db' data-ref="315db">db</a>-&gt;<a class="ref field" href="redis.h.html#redisDb::id" title='redisDb::id' data-ref="redisDb::id">id</a>);</td></tr>
<tr><th id="3330">3330</th><td>                <a class="ref fn" href="redis.h.html#decrRefCount" title='decrRefCount' data-ref="decrRefCount">decrRefCount</a>(<a class="local col1 ref" href="#321keyobj" title='keyobj' data-ref="321keyobj">keyobj</a>);</td></tr>
<tr><th id="3331">3331</th><td>                <a class="local col1 ref" href="#311keys_freed" title='keys_freed' data-ref="311keys_freed">keys_freed</a>++;</td></tr>
<tr><th id="3332">3332</th><td></td></tr>
<tr><th id="3333">3333</th><td>                <i>/* When the memory to free starts to be big enough, we may</i></td></tr>
<tr><th id="3334">3334</th><td><i>                 * start spending so much time here that is impossible to</i></td></tr>
<tr><th id="3335">3335</th><td><i>                 * deliver data to the slaves fast enough, so we force the</i></td></tr>
<tr><th id="3336">3336</th><td><i>                 * transmission here inside the loop. */</i></td></tr>
<tr><th id="3337">3337</th><td>                <b>if</b> (<a class="local col2 ref" href="#302slaves" title='slaves' data-ref="302slaves">slaves</a>) <a class="ref fn" href="redis.h.html#flushSlavesOutputBuffers" title='flushSlavesOutputBuffers' data-ref="flushSlavesOutputBuffers">flushSlavesOutputBuffers</a>();</td></tr>
<tr><th id="3338">3338</th><td>            }</td></tr>
<tr><th id="3339">3339</th><td>        }</td></tr>
<tr><th id="3340">3340</th><td>        <b>if</b> (!<a class="local col1 ref" href="#311keys_freed" title='keys_freed' data-ref="311keys_freed">keys_freed</a>) {</td></tr>
<tr><th id="3341">3341</th><td>            <a class="macro" href="latency.h.html#79" title="if (server.latency_monitor_threshold) { latency = mstime() - latency; }" data-ref="_M/latencyEndMonitor">latencyEndMonitor</a>(<a class="local col3 ref" href="#303latency" title='latency' data-ref="303latency">latency</a>);</td></tr>
<tr><th id="3342">3342</th><td>            <a class="macro" href="latency.h.html#84" title="if (server.latency_monitor_threshold &amp;&amp; (latency) &gt;= server.latency_monitor_threshold) latencyAddSample((&quot;eviction-cycle&quot;),(latency));" data-ref="_M/latencyAddSampleIfNeeded">latencyAddSampleIfNeeded</a>(<q>"eviction-cycle"</q>,<a class="local col3 ref" href="#303latency" title='latency' data-ref="303latency">latency</a>);</td></tr>
<tr><th id="3343">3343</th><td>            <b>return</b> <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>; <i>/* nothing to free... */</i></td></tr>
<tr><th id="3344">3344</th><td>        }</td></tr>
<tr><th id="3345">3345</th><td>    }</td></tr>
<tr><th id="3346">3346</th><td>    <a class="macro" href="latency.h.html#79" title="if (server.latency_monitor_threshold) { latency = mstime() - latency; }" data-ref="_M/latencyEndMonitor">latencyEndMonitor</a>(<a class="local col3 ref" href="#303latency" title='latency' data-ref="303latency">latency</a>);</td></tr>
<tr><th id="3347">3347</th><td>    <a class="macro" href="latency.h.html#84" title="if (server.latency_monitor_threshold &amp;&amp; (latency) &gt;= server.latency_monitor_threshold) latencyAddSample((&quot;eviction-cycle&quot;),(latency));" data-ref="_M/latencyAddSampleIfNeeded">latencyAddSampleIfNeeded</a>(<q>"eviction-cycle"</q>,<a class="local col3 ref" href="#303latency" title='latency' data-ref="303latency">latency</a>);</td></tr>
<tr><th id="3348">3348</th><td>    <b>return</b> <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>;</td></tr>
<tr><th id="3349">3349</th><td>}</td></tr>
<tr><th id="3350">3350</th><td></td></tr>
<tr><th id="3351">3351</th><td><i>/* =================================== Main! ================================ */</i></td></tr>
<tr><th id="3352">3352</th><td></td></tr>
<tr><th id="3353">3353</th><td><u>#<span data-ppcond="3353">ifdef</span> <span class="macro" data-ref="_M/__linux__">__linux__</span></u></td></tr>
<tr><th id="3354">3354</th><td><em>int</em> <dfn class="decl def fn" id="linuxOvercommitMemoryValue" title='linuxOvercommitMemoryValue' data-ref="linuxOvercommitMemoryValue">linuxOvercommitMemoryValue</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3355">3355</th><td>    <a class="typedef" href="../../include/stdio.h.html#FILE" title='FILE' data-type='struct _IO_FILE' data-ref="FILE">FILE</a> *<dfn class="local col2 decl" id="322fp" title='fp' data-type='FILE *' data-ref="322fp">fp</dfn> = <a class="ref fn" href="../../include/stdio.h.html#283" title='fopen' data-ref="fopen64">fopen</a>(<q>"/proc/sys/vm/overcommit_memory"</q>,<q>"r"</q>);</td></tr>
<tr><th id="3356">3356</th><td>    <em>char</em> <dfn class="local col3 decl" id="323buf" title='buf' data-type='char [64]' data-ref="323buf">buf</dfn>[<var>64</var>];</td></tr>
<tr><th id="3357">3357</th><td></td></tr>
<tr><th id="3358">3358</th><td>    <b>if</b> (!<a class="local col2 ref" href="#322fp" title='fp' data-ref="322fp">fp</a>) <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="3359">3359</th><td>    <b>if</b> (<a class="ref fn" href="../../include/stdio.h.html#fgets" title='fgets' data-ref="fgets">fgets</a>(<a class="local col3 ref" href="#323buf" title='buf' data-ref="323buf">buf</a>,<var>64</var>,<a class="local col2 ref" href="#322fp" title='fp' data-ref="322fp">fp</a>) == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3360">3360</th><td>        <a class="ref fn" href="../../include/stdio.h.html#fclose" title='fclose' data-ref="fclose">fclose</a>(<a class="local col2 ref" href="#322fp" title='fp' data-ref="322fp">fp</a>);</td></tr>
<tr><th id="3361">3361</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="3362">3362</th><td>    }</td></tr>
<tr><th id="3363">3363</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fclose" title='fclose' data-ref="fclose">fclose</a>(<a class="local col2 ref" href="#322fp" title='fp' data-ref="322fp">fp</a>);</td></tr>
<tr><th id="3364">3364</th><td></td></tr>
<tr><th id="3365">3365</th><td>    <b>return</b> <a class="ref fn" href="../../include/stdlib.h.html#atoi" title='atoi' data-ref="atoi">atoi</a>(<a class="local col3 ref" href="#323buf" title='buf' data-ref="323buf">buf</a>);</td></tr>
<tr><th id="3366">3366</th><td>}</td></tr>
<tr><th id="3367">3367</th><td></td></tr>
<tr><th id="3368">3368</th><td><em>void</em> <dfn class="decl def fn" id="linuxMemoryWarnings" title='linuxMemoryWarnings' data-ref="linuxMemoryWarnings">linuxMemoryWarnings</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3369">3369</th><td>    <b>if</b> (<a class="ref fn" href="#linuxOvercommitMemoryValue" title='linuxOvercommitMemoryValue' data-ref="linuxOvercommitMemoryValue">linuxOvercommitMemoryValue</a>() == <var>0</var>) {</td></tr>
<tr><th id="3370">3370</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect."</q>);</td></tr>
<tr><th id="3371">3371</th><td>    }</td></tr>
<tr><th id="3372">3372</th><td>    <b>if</b> (<a class="ref fn" href="latency.h.html#THPIsEnabled" title='THPIsEnabled' data-ref="THPIsEnabled">THPIsEnabled</a>()) {</td></tr>
<tr><th id="3373">3373</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled."</q>);</td></tr>
<tr><th id="3374">3374</th><td>    }</td></tr>
<tr><th id="3375">3375</th><td>}</td></tr>
<tr><th id="3376">3376</th><td><u>#<span data-ppcond="3353">endif</span> /* __linux__ */</u></td></tr>
<tr><th id="3377">3377</th><td></td></tr>
<tr><th id="3378">3378</th><td><em>void</em> <dfn class="decl def fn" id="createPidFile" title='createPidFile' data-ref="createPidFile">createPidFile</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3379">3379</th><td>    <i>/* Try to write the pid file in a best-effort way. */</i></td></tr>
<tr><th id="3380">3380</th><td>    <a class="typedef" href="../../include/stdio.h.html#FILE" title='FILE' data-type='struct _IO_FILE' data-ref="FILE">FILE</a> *<dfn class="local col4 decl" id="324fp" title='fp' data-type='FILE *' data-ref="324fp">fp</dfn> = <a class="ref fn" href="../../include/stdio.h.html#283" title='fopen' data-ref="fopen64">fopen</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::pidfile" title='redisServer::pidfile' data-ref="redisServer::pidfile">pidfile</a>,<q>"w"</q>);</td></tr>
<tr><th id="3381">3381</th><td>    <b>if</b> (<a class="local col4 ref" href="#324fp" title='fp' data-ref="324fp">fp</a>) {</td></tr>
<tr><th id="3382">3382</th><td>        <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="local col4 ref" href="#324fp" title='fp' data-ref="324fp">fp</a>,<q>"%d\n"</q>,(<em>int</em>)<a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>());</td></tr>
<tr><th id="3383">3383</th><td>        <a class="ref fn" href="../../include/stdio.h.html#fclose" title='fclose' data-ref="fclose">fclose</a>(<a class="local col4 ref" href="#324fp" title='fp' data-ref="324fp">fp</a>);</td></tr>
<tr><th id="3384">3384</th><td>    }</td></tr>
<tr><th id="3385">3385</th><td>}</td></tr>
<tr><th id="3386">3386</th><td></td></tr>
<tr><th id="3387">3387</th><td><em>void</em> <dfn class="decl def fn" id="daemonize" title='daemonize' data-ref="daemonize">daemonize</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3388">3388</th><td>    <em>int</em> <dfn class="local col5 decl" id="325fd" title='fd' data-type='int' data-ref="325fd">fd</dfn>;</td></tr>
<tr><th id="3389">3389</th><td></td></tr>
<tr><th id="3390">3390</th><td>    <b>if</b> (<a class="ref fn" href="../../include/unistd.h.html#fork" title='fork' data-ref="fork">fork</a>() != <var>0</var>) <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>0</var>); <i>/* parent exits */</i></td></tr>
<tr><th id="3391">3391</th><td>    <a class="ref fn" href="../../include/unistd.h.html#setsid" title='setsid' data-ref="setsid">setsid</a>(); <i>/* create a new session */</i></td></tr>
<tr><th id="3392">3392</th><td></td></tr>
<tr><th id="3393">3393</th><td>    <i>/* Every output goes to /dev/null. If Redis is daemonized but</i></td></tr>
<tr><th id="3394">3394</th><td><i>     * the 'logfile' is set to 'stdout' in the configuration file</i></td></tr>
<tr><th id="3395">3395</th><td><i>     * it will not log at all. */</i></td></tr>
<tr><th id="3396">3396</th><td>    <b>if</b> ((<a class="local col5 ref" href="#325fd" title='fd' data-ref="325fd">fd</a> = <a class="ref fn" href="../../include/fcntl.h.html#159" title='open' data-ref="open64">open</a>(<q>"/dev/null"</q>, <a class="macro" href="../../include/x86_64-linux-gnu/bits/fcntl-linux.h.html#45" title="02" data-ref="_M/O_RDWR">O_RDWR</a>, <var>0</var>)) != -<var>1</var>) {</td></tr>
<tr><th id="3397">3397</th><td>        <a class="ref fn" href="../../include/unistd.h.html#dup2" title='dup2' data-ref="dup2">dup2</a>(<a class="local col5 ref" href="#325fd" title='fd' data-ref="325fd">fd</a>, <a class="macro" href="../../include/unistd.h.html#213" title="0" data-ref="_M/STDIN_FILENO">STDIN_FILENO</a>);</td></tr>
<tr><th id="3398">3398</th><td>        <a class="ref fn" href="../../include/unistd.h.html#dup2" title='dup2' data-ref="dup2">dup2</a>(<a class="local col5 ref" href="#325fd" title='fd' data-ref="325fd">fd</a>, <a class="macro" href="../../include/unistd.h.html#214" title="1" data-ref="_M/STDOUT_FILENO">STDOUT_FILENO</a>);</td></tr>
<tr><th id="3399">3399</th><td>        <a class="ref fn" href="../../include/unistd.h.html#dup2" title='dup2' data-ref="dup2">dup2</a>(<a class="local col5 ref" href="#325fd" title='fd' data-ref="325fd">fd</a>, <a class="macro" href="../../include/unistd.h.html#215" title="2" data-ref="_M/STDERR_FILENO">STDERR_FILENO</a>);</td></tr>
<tr><th id="3400">3400</th><td>        <b>if</b> (<a class="local col5 ref" href="#325fd" title='fd' data-ref="325fd">fd</a> &gt; <a class="macro" href="../../include/unistd.h.html#215" title="2" data-ref="_M/STDERR_FILENO">STDERR_FILENO</a>) <a class="ref fn" href="../../include/unistd.h.html#close" title='close' data-ref="close">close</a>(<a class="local col5 ref" href="#325fd" title='fd' data-ref="325fd">fd</a>);</td></tr>
<tr><th id="3401">3401</th><td>    }</td></tr>
<tr><th id="3402">3402</th><td>}</td></tr>
<tr><th id="3403">3403</th><td></td></tr>
<tr><th id="3404">3404</th><td><em>void</em> <dfn class="decl def fn" id="version" title='version' data-ref="version">version</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3405">3405</th><td>    <a class="ref fn" href="../../include/stdio.h.html#printf" title='printf' data-ref="printf">printf</a>(<q>"Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\n"</q>,</td></tr>
<tr><th id="3406">3406</th><td>        <a class="macro" href="version.h.html#1" title="&quot;3.0.0&quot;" data-ref="_M/REDIS_VERSION">REDIS_VERSION</a>,</td></tr>
<tr><th id="3407">3407</th><td>        <a class="ref fn" href="redis.h.html#redisGitSHA1" title='redisGitSHA1' data-ref="redisGitSHA1">redisGitSHA1</a>(),</td></tr>
<tr><th id="3408">3408</th><td>        <a class="ref fn" href="../../include/stdlib.h.html#atoi" title='atoi' data-ref="atoi">atoi</a>(<a class="ref fn" href="redis.h.html#redisGitDirty" title='redisGitDirty' data-ref="redisGitDirty">redisGitDirty</a>()) &gt; <var>0</var>,</td></tr>
<tr><th id="3409">3409</th><td>        <a class="macro" href="zmalloc.h.html#65" title="&quot;libc&quot;" data-ref="_M/ZMALLOC_LIB">ZMALLOC_LIB</a>,</td></tr>
<tr><th id="3410">3410</th><td>        <b>sizeof</b>(<em>long</em>) == <var>4</var> ? <var>32</var> : <var>64</var>,</td></tr>
<tr><th id="3411">3411</th><td>        (<em>unsigned</em> <em>long</em> <em>long</em>) <a class="ref fn" href="redis.h.html#redisBuildId" title='redisBuildId' data-ref="redisBuildId">redisBuildId</a>());</td></tr>
<tr><th id="3412">3412</th><td>    <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>0</var>);</td></tr>
<tr><th id="3413">3413</th><td>}</td></tr>
<tr><th id="3414">3414</th><td></td></tr>
<tr><th id="3415">3415</th><td><em>void</em> <dfn class="decl def fn" id="usage" title='usage' data-ref="usage">usage</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3416">3416</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"Usage: ./redis-server [/path/to/redis.conf] [options]\n"</q>);</td></tr>
<tr><th id="3417">3417</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server - (read config from stdin)\n"</q>);</td></tr>
<tr><th id="3418">3418</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server -v or --version\n"</q>);</td></tr>
<tr><th id="3419">3419</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server -h or --help\n"</q>);</td></tr>
<tr><th id="3420">3420</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server --test-memory &lt;megabytes&gt;\n\n"</q>);</td></tr>
<tr><th id="3421">3421</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"Examples:\n"</q>);</td></tr>
<tr><th id="3422">3422</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server (run the server with default conf)\n"</q>);</td></tr>
<tr><th id="3423">3423</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server /etc/redis/6379.conf\n"</q>);</td></tr>
<tr><th id="3424">3424</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server --port 7777\n"</q>);</td></tr>
<tr><th id="3425">3425</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server --port 7777 --slaveof 127.0.0.1 8888\n"</q>);</td></tr>
<tr><th id="3426">3426</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server /etc/myredis.conf --loglevel verbose\n\n"</q>);</td></tr>
<tr><th id="3427">3427</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"Sentinel mode:\n"</q>);</td></tr>
<tr><th id="3428">3428</th><td>    <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"       ./redis-server /etc/sentinel.conf --sentinel\n"</q>);</td></tr>
<tr><th id="3429">3429</th><td>    <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="3430">3430</th><td>}</td></tr>
<tr><th id="3431">3431</th><td></td></tr>
<tr><th id="3432">3432</th><td><em>void</em> <dfn class="decl def fn" id="redisAsciiArt" title='redisAsciiArt' data-ref="redisAsciiArt">redisAsciiArt</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3433">3433</th><td><u>#include <a href="asciilogo.h.html">"asciilogo.h"</a></u></td></tr>
<tr><th id="3434">3434</th><td>    <em>char</em> *<dfn class="local col7 decl" id="327buf" title='buf' data-type='char *' data-ref="327buf">buf</dfn> = <a class="ref fn" href="zmalloc.h.html#zmalloc" title='zmalloc' data-ref="zmalloc">zmalloc</a>(<var>1024</var>*<var>16</var>);</td></tr>
<tr><th id="3435">3435</th><td>    <em>char</em> *<dfn class="local col8 decl" id="328mode" title='mode' data-type='char *' data-ref="328mode">mode</dfn>;</td></tr>
<tr><th id="3436">3436</th><td></td></tr>
<tr><th id="3437">3437</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) <a class="local col8 ref" href="#328mode" title='mode' data-ref="328mode">mode</a> = <q>"cluster"</q>;</td></tr>
<tr><th id="3438">3438</th><td>    <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) <a class="local col8 ref" href="#328mode" title='mode' data-ref="328mode">mode</a> = <q>"sentinel"</q>;</td></tr>
<tr><th id="3439">3439</th><td>    <b>else</b> <a class="local col8 ref" href="#328mode" title='mode' data-ref="328mode">mode</a> = <q>"standalone"</q>;</td></tr>
<tr><th id="3440">3440</th><td></td></tr>
<tr><th id="3441">3441</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::syslog_enabled" title='redisServer::syslog_enabled' data-ref="redisServer::syslog_enabled">syslog_enabled</a>) {</td></tr>
<tr><th id="3442">3442</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,</td></tr>
<tr><th id="3443">3443</th><td>            <q>"Redis %s (%s/%d) %s bit, %s mode, port %d, pid %ld ready to start."</q>,</td></tr>
<tr><th id="3444">3444</th><td>            <a class="macro" href="version.h.html#1" title="&quot;3.0.0&quot;" data-ref="_M/REDIS_VERSION">REDIS_VERSION</a>,</td></tr>
<tr><th id="3445">3445</th><td>            <a class="ref fn" href="redis.h.html#redisGitSHA1" title='redisGitSHA1' data-ref="redisGitSHA1">redisGitSHA1</a>(),</td></tr>
<tr><th id="3446">3446</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#strtol" title='strtol' data-ref="strtol">strtol</a>(<a class="ref fn" href="redis.h.html#redisGitDirty" title='redisGitDirty' data-ref="redisGitDirty">redisGitDirty</a>(),<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>10</var>) &gt; <var>0</var>,</td></tr>
<tr><th id="3447">3447</th><td>            (<b>sizeof</b>(<em>long</em>) == <var>8</var>) ? <q>"64"</q> : <q>"32"</q>,</td></tr>
<tr><th id="3448">3448</th><td>            <a class="local col8 ref" href="#328mode" title='mode' data-ref="328mode">mode</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a>,</td></tr>
<tr><th id="3449">3449</th><td>            (<em>long</em>) <a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>()</td></tr>
<tr><th id="3450">3450</th><td>        );</td></tr>
<tr><th id="3451">3451</th><td>    } <b>else</b> {</td></tr>
<tr><th id="3452">3452</th><td>        <a class="ref fn" href="../../include/stdio.h.html#snprintf" title='snprintf' data-ref="snprintf">snprintf</a>(<a class="local col7 ref" href="#327buf" title='buf' data-ref="327buf">buf</a>,<var>1024</var>*<var>16</var>,<a class="local col6 ref" href="asciilogo.h.html#326ascii_logo" title='ascii_logo' data-ref="326ascii_logo">ascii_logo</a>,</td></tr>
<tr><th id="3453">3453</th><td>            <a class="macro" href="version.h.html#1" title="&quot;3.0.0&quot;" data-ref="_M/REDIS_VERSION">REDIS_VERSION</a>,</td></tr>
<tr><th id="3454">3454</th><td>            <a class="ref fn" href="redis.h.html#redisGitSHA1" title='redisGitSHA1' data-ref="redisGitSHA1">redisGitSHA1</a>(),</td></tr>
<tr><th id="3455">3455</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#strtol" title='strtol' data-ref="strtol">strtol</a>(<a class="ref fn" href="redis.h.html#redisGitDirty" title='redisGitDirty' data-ref="redisGitDirty">redisGitDirty</a>(),<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,<var>10</var>) &gt; <var>0</var>,</td></tr>
<tr><th id="3456">3456</th><td>            (<b>sizeof</b>(<em>long</em>) == <var>8</var>) ? <q>"64"</q> : <q>"32"</q>,</td></tr>
<tr><th id="3457">3457</th><td>            <a class="local col8 ref" href="#328mode" title='mode' data-ref="328mode">mode</a>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a>,</td></tr>
<tr><th id="3458">3458</th><td>            (<em>long</em>) <a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>()</td></tr>
<tr><th id="3459">3459</th><td>        );</td></tr>
<tr><th id="3460">3460</th><td>        <a class="ref fn" href="#redisLogRaw" title='redisLogRaw' data-ref="redisLogRaw">redisLogRaw</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>|<a class="macro" href="redis.h.html#305" title="(1&lt;&lt;10)" data-ref="_M/REDIS_LOG_RAW">REDIS_LOG_RAW</a>,<a class="local col7 ref" href="#327buf" title='buf' data-ref="327buf">buf</a>);</td></tr>
<tr><th id="3461">3461</th><td>    }</td></tr>
<tr><th id="3462">3462</th><td>    <a class="ref fn" href="zmalloc.h.html#zfree" title='zfree' data-ref="zfree">zfree</a>(<a class="local col7 ref" href="#327buf" title='buf' data-ref="327buf">buf</a>);</td></tr>
<tr><th id="3463">3463</th><td>}</td></tr>
<tr><th id="3464">3464</th><td></td></tr>
<tr><th id="3465">3465</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="sigShutdownHandler" title='sigShutdownHandler' data-type='void sigShutdownHandler(int sig)' data-ref="sigShutdownHandler">sigShutdownHandler</dfn>(<em>int</em> <dfn class="local col9 decl" id="329sig" title='sig' data-type='int' data-ref="329sig">sig</dfn>) {</td></tr>
<tr><th id="3466">3466</th><td>    <em>char</em> *<dfn class="local col0 decl" id="330msg" title='msg' data-type='char *' data-ref="330msg">msg</dfn>;</td></tr>
<tr><th id="3467">3467</th><td></td></tr>
<tr><th id="3468">3468</th><td>    <b>switch</b> (<a class="local col9 ref" href="#329sig" title='sig' data-ref="329sig">sig</a>) {</td></tr>
<tr><th id="3469">3469</th><td>    <b>case</b> <a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#33" title="2" data-ref="_M/SIGINT">SIGINT</a>:</td></tr>
<tr><th id="3470">3470</th><td>        <a class="local col0 ref" href="#330msg" title='msg' data-ref="330msg">msg</a> = <q>"Received SIGINT scheduling shutdown..."</q>;</td></tr>
<tr><th id="3471">3471</th><td>        <b>break</b>;</td></tr>
<tr><th id="3472">3472</th><td>    <b>case</b> <a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#47" title="15" data-ref="_M/SIGTERM">SIGTERM</a>:</td></tr>
<tr><th id="3473">3473</th><td>        <a class="local col0 ref" href="#330msg" title='msg' data-ref="330msg">msg</a> = <q>"Received SIGTERM scheduling shutdown..."</q>;</td></tr>
<tr><th id="3474">3474</th><td>        <b>break</b>;</td></tr>
<tr><th id="3475">3475</th><td>    <b>default</b>:</td></tr>
<tr><th id="3476">3476</th><td>        <a class="local col0 ref" href="#330msg" title='msg' data-ref="330msg">msg</a> = <q>"Received shutdown signal, scheduling shutdown..."</q>;</td></tr>
<tr><th id="3477">3477</th><td>    };</td></tr>
<tr><th id="3478">3478</th><td></td></tr>
<tr><th id="3479">3479</th><td>    <i>/* SIGINT is often delivered via Ctrl+C in an interactive session.</i></td></tr>
<tr><th id="3480">3480</th><td><i>     * If we receive the signal the second time, we interpret this as</i></td></tr>
<tr><th id="3481">3481</th><td><i>     * the user really wanting to quit ASAP without waiting to persist</i></td></tr>
<tr><th id="3482">3482</th><td><i>     * on disk. */</i></td></tr>
<tr><th id="3483">3483</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::shutdown_asap" title='redisServer::shutdown_asap' data-ref="redisServer::shutdown_asap">shutdown_asap</a> &amp;&amp; <a class="local col9 ref" href="#329sig" title='sig' data-ref="329sig">sig</a> == <a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#33" title="2" data-ref="_M/SIGINT">SIGINT</a>) {</td></tr>
<tr><th id="3484">3484</th><td>        <a class="ref fn" href="#redisLogFromHandler" title='redisLogFromHandler' data-ref="redisLogFromHandler">redisLogFromHandler</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <q>"You insist... exiting now."</q>);</td></tr>
<tr><th id="3485">3485</th><td>        <a class="ref fn" href="rdb.h.html#rdbRemoveTempFile" title='rdbRemoveTempFile' data-ref="rdbRemoveTempFile">rdbRemoveTempFile</a>(<a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>());</td></tr>
<tr><th id="3486">3486</th><td>        <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>); <i>/* Exit with an error since this was not a clean shutdown. */</i></td></tr>
<tr><th id="3487">3487</th><td>    } <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::loading" title='redisServer::loading' data-ref="redisServer::loading">loading</a>) {</td></tr>
<tr><th id="3488">3488</th><td>        <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>0</var>);</td></tr>
<tr><th id="3489">3489</th><td>    }</td></tr>
<tr><th id="3490">3490</th><td></td></tr>
<tr><th id="3491">3491</th><td>    <a class="ref fn" href="#redisLogFromHandler" title='redisLogFromHandler' data-ref="redisLogFromHandler">redisLogFromHandler</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <a class="local col0 ref" href="#330msg" title='msg' data-ref="330msg">msg</a>);</td></tr>
<tr><th id="3492">3492</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::shutdown_asap" title='redisServer::shutdown_asap' data-ref="redisServer::shutdown_asap">shutdown_asap</a> = <var>1</var>;</td></tr>
<tr><th id="3493">3493</th><td>}</td></tr>
<tr><th id="3494">3494</th><td></td></tr>
<tr><th id="3495">3495</th><td><em>void</em> <dfn class="decl def fn" id="setupSignalHandlers" title='setupSignalHandlers' data-ref="setupSignalHandlers">setupSignalHandlers</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3496">3496</th><td>    <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a> <dfn class="local col1 decl" id="331act" title='act' data-type='struct sigaction' data-ref="331act">act</dfn>;</td></tr>
<tr><th id="3497">3497</th><td></td></tr>
<tr><th id="3498">3498</th><td>    <i>/* When the SA_SIGINFO flag is set in sa_flags then sa_sigaction is used.</i></td></tr>
<tr><th id="3499">3499</th><td><i>     * Otherwise, sa_handler is used. */</i></td></tr>
<tr><th id="3500">3500</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigemptyset" title='sigemptyset' data-ref="sigemptyset">sigemptyset</a>(&amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#sigaction::sa_mask" title='sigaction::sa_mask' data-ref="sigaction::sa_mask">sa_mask</a>);</td></tr>
<tr><th id="3501">3501</th><td>    <a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#sigaction::sa_flags" title='sigaction::sa_flags' data-ref="sigaction::sa_flags">sa_flags</a> = <var>0</var>;</td></tr>
<tr><th id="3502">3502</th><td>    <a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>.<a class="macro" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#36" title="__sigaction_handler.sa_handler" data-ref="_M/sa_handler">sa_handler</a> = <a class="tu ref fn" href="#sigShutdownHandler" title='sigShutdownHandler' data-use='r' data-ref="sigShutdownHandler">sigShutdownHandler</a>;</td></tr>
<tr><th id="3503">3503</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#47" title="15" data-ref="_M/SIGTERM">SIGTERM</a>, &amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3504">3504</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#33" title="2" data-ref="_M/SIGINT">SIGINT</a>, &amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3505">3505</th><td></td></tr>
<tr><th id="3506">3506</th><td><u>#<span data-ppcond="3506">ifdef</span> <a class="macro" href="config.h.html#66" data-ref="_M/HAVE_BACKTRACE">HAVE_BACKTRACE</a></u></td></tr>
<tr><th id="3507">3507</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigemptyset" title='sigemptyset' data-ref="sigemptyset">sigemptyset</a>(&amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#sigaction::sa_mask" title='sigaction::sa_mask' data-ref="sigaction::sa_mask">sa_mask</a>);</td></tr>
<tr><th id="3508">3508</th><td>    <a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#sigaction::sa_flags" title='sigaction::sa_flags' data-ref="sigaction::sa_flags">sa_flags</a> = <a class="macro" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#62" title="0x40000000" data-ref="_M/SA_NODEFER">SA_NODEFER</a> | <a class="macro" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#64" title="0x80000000" data-ref="_M/SA_RESETHAND">SA_RESETHAND</a> | <a class="macro" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#55" title="4" data-ref="_M/SA_SIGINFO">SA_SIGINFO</a>;</td></tr>
<tr><th id="3509">3509</th><td>    <a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>.<a class="macro" href="../../include/x86_64-linux-gnu/bits/sigaction.h.html#37" title="__sigaction_handler.sa_sigaction" data-ref="_M/sa_sigaction">sa_sigaction</a> = <a class="ref fn" href="redis.h.html#sigsegvHandler" title='sigsegvHandler' data-ref="sigsegvHandler">sigsegvHandler</a>;</td></tr>
<tr><th id="3510">3510</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#43" title="11" data-ref="_M/SIGSEGV">SIGSEGV</a>, &amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3511">3511</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#39" title="7" data-ref="_M/SIGBUS">SIGBUS</a>, &amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3512">3512</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#40" title="8" data-ref="_M/SIGFPE">SIGFPE</a>, &amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3513">3513</th><td>    <a class="ref fn" href="../../include/signal.h.html#sigaction" title='sigaction' data-ref="sigaction">sigaction</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/signum.h.html#35" title="4" data-ref="_M/SIGILL">SIGILL</a>, &amp;<a class="local col1 ref" href="#331act" title='act' data-ref="331act">act</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3514">3514</th><td><u>#<span data-ppcond="3506">endif</span></u></td></tr>
<tr><th id="3515">3515</th><td>    <b>return</b>;</td></tr>
<tr><th id="3516">3516</th><td>}</td></tr>
<tr><th id="3517">3517</th><td></td></tr>
<tr><th id="3518">3518</th><td><em>void</em> <dfn class="decl fn" id="memtest" title='memtest' data-ref="memtest">memtest</dfn>(<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col2 decl" id="332megabytes" title='megabytes' data-type='size_t' data-ref="332megabytes">megabytes</dfn>, <em>int</em> <dfn class="local col3 decl" id="333passes" title='passes' data-type='int' data-ref="333passes">passes</dfn>);</td></tr>
<tr><th id="3519">3519</th><td></td></tr>
<tr><th id="3520">3520</th><td><i>/* Returns 1 if there is --sentinel among the arguments or if</i></td></tr>
<tr><th id="3521">3521</th><td><i> * argv[0] is exactly "redis-sentinel". */</i></td></tr>
<tr><th id="3522">3522</th><td><em>int</em> <dfn class="decl def fn" id="checkForSentinelMode" title='checkForSentinelMode' data-ref="checkForSentinelMode">checkForSentinelMode</dfn>(<em>int</em> <dfn class="local col4 decl" id="334argc" title='argc' data-type='int' data-ref="334argc">argc</dfn>, <em>char</em> **<dfn class="local col5 decl" id="335argv" title='argv' data-type='char **' data-ref="335argv">argv</dfn>) {</td></tr>
<tr><th id="3523">3523</th><td>    <em>int</em> <dfn class="local col6 decl" id="336j" title='j' data-type='int' data-ref="336j">j</dfn>;</td></tr>
<tr><th id="3524">3524</th><td></td></tr>
<tr><th id="3525">3525</th><td>    <b>if</b> (<a class="ref fn" href="../../include/string.h.html#strstr" title='strstr' data-ref="strstr">strstr</a>(<a class="local col5 ref" href="#335argv" title='argv' data-ref="335argv">argv</a>[<var>0</var>],<q>"redis-sentinel"</q>) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) <b>return</b> <var>1</var>;</td></tr>
<tr><th id="3526">3526</th><td>    <b>for</b> (<a class="local col6 ref" href="#336j" title='j' data-ref="336j">j</a> = <var>1</var>; <a class="local col6 ref" href="#336j" title='j' data-ref="336j">j</a> &lt; <a class="local col4 ref" href="#334argc" title='argc' data-ref="334argc">argc</a>; <a class="local col6 ref" href="#336j" title='j' data-ref="336j">j</a>++)</td></tr>
<tr><th id="3527">3527</th><td>        <b>if</b> (!<a class="ref fn" href="../../include/string.h.html#strcmp" title='strcmp' data-ref="strcmp">strcmp</a>(<a class="local col5 ref" href="#335argv" title='argv' data-ref="335argv">argv</a>[<a class="local col6 ref" href="#336j" title='j' data-ref="336j">j</a>],<q>"--sentinel"</q>)) <b>return</b> <var>1</var>;</td></tr>
<tr><th id="3528">3528</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3529">3529</th><td>}</td></tr>
<tr><th id="3530">3530</th><td></td></tr>
<tr><th id="3531">3531</th><td><i>/* Function called at startup to load RDB or AOF file in memory. */</i></td></tr>
<tr><th id="3532">3532</th><td><em>void</em> <dfn class="decl def fn" id="loadDataFromDisk" title='loadDataFromDisk' data-ref="loadDataFromDisk">loadDataFromDisk</dfn>(<em>void</em>) {</td></tr>
<tr><th id="3533">3533</th><td>    <em>long</em> <em>long</em> <dfn class="local col7 decl" id="337start" title='start' data-type='long long' data-ref="337start">start</dfn> = <a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>();</td></tr>
<tr><th id="3534">3534</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_state" title='redisServer::aof_state' data-ref="redisServer::aof_state">aof_state</a> == <a class="macro" href="redis.h.html#228" title="1" data-ref="_M/REDIS_AOF_ON">REDIS_AOF_ON</a>) {</td></tr>
<tr><th id="3535">3535</th><td>        <b>if</b> (<a class="ref fn" href="redis.h.html#loadAppendOnlyFile" title='loadAppendOnlyFile' data-ref="loadAppendOnlyFile">loadAppendOnlyFile</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::aof_filename" title='redisServer::aof_filename' data-ref="redisServer::aof_filename">aof_filename</a>) == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>)</td></tr>
<tr><th id="3536">3536</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"DB loaded from append only file: %.3f seconds"</q>,(<em>float</em>)(<a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>()-<a class="local col7 ref" href="#337start" title='start' data-ref="337start">start</a>)/<var>1000000</var>);</td></tr>
<tr><th id="3537">3537</th><td>    } <b>else</b> {</td></tr>
<tr><th id="3538">3538</th><td>        <b>if</b> (<a class="ref fn" href="rdb.h.html#rdbLoad" title='rdbLoad' data-ref="rdbLoad">rdbLoad</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::rdb_filename" title='redisServer::rdb_filename' data-ref="redisServer::rdb_filename">rdb_filename</a>) == <a class="macro" href="redis.h.html#67" title="0" data-ref="_M/REDIS_OK">REDIS_OK</a>) {</td></tr>
<tr><th id="3539">3539</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"DB loaded from disk: %.3f seconds"</q>,</td></tr>
<tr><th id="3540">3540</th><td>                (<em>float</em>)(<a class="ref fn" href="#ustime" title='ustime' data-ref="ustime">ustime</a>()-<a class="local col7 ref" href="#337start" title='start' data-ref="337start">start</a>)/<var>1000000</var>);</td></tr>
<tr><th id="3541">3541</th><td>        } <b>else</b> <b>if</b> (<a class="macro" href="../../include/x86_64-linux-gnu/bits/errno.h.html#54" title="(*__errno_location ())" data-ref="_M/errno">errno</a> != <a class="macro" href="../../include/asm-generic/errno-base.h.html#5" title="2" data-ref="_M/ENOENT">ENOENT</a>) {</td></tr>
<tr><th id="3542">3542</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Fatal error loading the DB: %s. Exiting."</q>,<a class="ref fn" href="../../include/string.h.html#strerror" title='strerror' data-ref="strerror">strerror</a>(<a class="macro" href="../../include/x86_64-linux-gnu/bits/errno.h.html#54" title="(*__errno_location ())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="3543">3543</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="3544">3544</th><td>        }</td></tr>
<tr><th id="3545">3545</th><td>    }</td></tr>
<tr><th id="3546">3546</th><td>}</td></tr>
<tr><th id="3547">3547</th><td></td></tr>
<tr><th id="3548">3548</th><td><em>void</em> <dfn class="decl def fn" id="redisOutOfMemoryHandler" title='redisOutOfMemoryHandler' data-ref="redisOutOfMemoryHandler">redisOutOfMemoryHandler</dfn>(<span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t">size_t</span> <dfn class="local col8 decl" id="338allocation_size" title='allocation_size' data-type='size_t' data-ref="338allocation_size">allocation_size</dfn>) {</td></tr>
<tr><th id="3549">3549</th><td>    <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Out Of Memory allocating %zu bytes!"</q>,</td></tr>
<tr><th id="3550">3550</th><td>        <a class="local col8 ref" href="#338allocation_size" title='allocation_size' data-ref="338allocation_size">allocation_size</a>);</td></tr>
<tr><th id="3551">3551</th><td>    <a class="macro" href="redis.h.html#400" title="_redisPanic(&quot;\&quot;Redis aborting for OUT OF MEMORY\&quot;&quot;,&quot;/vagrant/data/redis-v3.0.0/src/redis.c&quot;,3551),_exit(1)" data-ref="_M/redisPanic">redisPanic</a>(<q>"Redis aborting for OUT OF MEMORY"</q>);</td></tr>
<tr><th id="3552">3552</th><td>}</td></tr>
<tr><th id="3553">3553</th><td></td></tr>
<tr><th id="3554">3554</th><td><em>void</em> <dfn class="decl def fn" id="redisSetProcTitle" title='redisSetProcTitle' data-ref="redisSetProcTitle">redisSetProcTitle</dfn>(<em>char</em> *<dfn class="local col9 decl" id="339title" title='title' data-type='char *' data-ref="339title">title</dfn>) {</td></tr>
<tr><th id="3555">3555</th><td><u>#<span data-ppcond="3555">ifdef</span> <a class="macro" href="config.h.html#120" data-ref="_M/USE_SETPROCTITLE">USE_SETPROCTITLE</a></u></td></tr>
<tr><th id="3556">3556</th><td>    <em>char</em> *<dfn class="local col0 decl" id="340server_mode" title='server_mode' data-type='char *' data-ref="340server_mode">server_mode</dfn> = <q>""</q>;</td></tr>
<tr><th id="3557">3557</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) <a class="local col0 ref" href="#340server_mode" title='server_mode' data-ref="340server_mode">server_mode</a> = <q>" [cluster]"</q>;</td></tr>
<tr><th id="3558">3558</th><td>    <b>else</b> <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) <a class="local col0 ref" href="#340server_mode" title='server_mode' data-ref="340server_mode">server_mode</a> = <q>" [sentinel]"</q>;</td></tr>
<tr><th id="3559">3559</th><td></td></tr>
<tr><th id="3560">3560</th><td>    <a class="ref fn" href="config.h.html#setproctitle" title='setproctitle' data-ref="setproctitle">setproctitle</a>(<q>"%s %s:%d%s"</q>,</td></tr>
<tr><th id="3561">3561</th><td>        <a class="local col9 ref" href="#339title" title='title' data-ref="339title">title</a>,</td></tr>
<tr><th id="3562">3562</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr_count" title='redisServer::bindaddr_count' data-ref="redisServer::bindaddr_count">bindaddr_count</a> ? <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::bindaddr" title='redisServer::bindaddr' data-ref="redisServer::bindaddr">bindaddr</a>[<var>0</var>] : <q>"*"</q>,</td></tr>
<tr><th id="3563">3563</th><td>        <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a>,</td></tr>
<tr><th id="3564">3564</th><td>        <a class="local col0 ref" href="#340server_mode" title='server_mode' data-ref="340server_mode">server_mode</a>);</td></tr>
<tr><th id="3565">3565</th><td><u>#<span data-ppcond="3555">else</span></u></td></tr>
<tr><th id="3566">3566</th><td>    REDIS_NOTUSED(title);</td></tr>
<tr><th id="3567">3567</th><td><u>#<span data-ppcond="3555">endif</span></u></td></tr>
<tr><th id="3568">3568</th><td>}</td></tr>
<tr><th id="3569">3569</th><td></td></tr>
<tr><th id="3570">3570</th><td><em>int</em> <dfn class="decl def fn" id="main" title='main' data-ref="main">main</dfn>(<em>int</em> <dfn class="local col1 decl" id="341argc" title='argc' data-type='int' data-ref="341argc">argc</dfn>, <em>char</em> **<dfn class="local col2 decl" id="342argv" title='argv' data-type='char **' data-ref="342argv">argv</dfn>) {</td></tr>
<tr><th id="3571">3571</th><td>    <b>struct</b> <a class="type" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval" title='timeval' data-ref="timeval">timeval</a> <dfn class="local col3 decl" id="343tv" title='tv' data-type='struct timeval' data-ref="343tv">tv</dfn>;</td></tr>
<tr><th id="3572">3572</th><td></td></tr>
<tr><th id="3573">3573</th><td>    <i>/* We need to initialize our libraries, and the server configuration. */</i></td></tr>
<tr><th id="3574">3574</th><td><u>#<span data-ppcond="3574">ifdef</span> <a class="macro" href="config.h.html#121" data-ref="_M/INIT_SETPROCTITLE_REPLACEMENT">INIT_SETPROCTITLE_REPLACEMENT</a></u></td></tr>
<tr><th id="3575">3575</th><td>    <a class="ref fn" href="config.h.html#spt_init" title='spt_init' data-ref="spt_init">spt_init</a>(<a class="local col1 ref" href="#341argc" title='argc' data-ref="341argc">argc</a>, <a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>);</td></tr>
<tr><th id="3576">3576</th><td><u>#<span data-ppcond="3574">endif</span></u></td></tr>
<tr><th id="3577">3577</th><td>    <a class="ref fn" href="../../include/locale.h.html#setlocale" title='setlocale' data-ref="setlocale">setlocale</a>(<a class="macro" href="../../include/locale.h.html#38" title="3" data-ref="_M/LC_COLLATE">LC_COLLATE</a>,<q>""</q>);</td></tr>
<tr><th id="3578">3578</th><td>    <a class="ref fn" href="zmalloc.h.html#zmalloc_enable_thread_safeness" title='zmalloc_enable_thread_safeness' data-ref="zmalloc_enable_thread_safeness">zmalloc_enable_thread_safeness</a>();</td></tr>
<tr><th id="3579">3579</th><td>    <a class="ref fn" href="zmalloc.h.html#zmalloc_set_oom_handler" title='zmalloc_set_oom_handler' data-ref="zmalloc_set_oom_handler">zmalloc_set_oom_handler</a>(<a class="ref fn" href="#redisOutOfMemoryHandler" title='redisOutOfMemoryHandler' data-ref="redisOutOfMemoryHandler">redisOutOfMemoryHandler</a>);</td></tr>
<tr><th id="3580">3580</th><td>    <a class="ref fn" href="../../include/stdlib.h.html#srand" title='srand' data-ref="srand">srand</a>(<a class="ref fn" href="../../include/time.h.html#time" title='time' data-ref="time">time</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)^<a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>());</td></tr>
<tr><th id="3581">3581</th><td>    <a class="ref fn" href="../../include/x86_64-linux-gnu/sys/time.h.html#gettimeofday" title='gettimeofday' data-ref="gettimeofday">gettimeofday</a>(&amp;<a class="local col3 ref" href="#343tv" title='tv' data-ref="343tv">tv</a>,<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3582">3582</th><td>    <a class="ref fn" href="dict.h.html#dictSetHashFunctionSeed" title='dictSetHashFunctionSeed' data-ref="dictSetHashFunctionSeed">dictSetHashFunctionSeed</a>(<a class="local col3 ref" href="#343tv" title='tv' data-ref="343tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec">tv_sec</a>^<a class="local col3 ref" href="#343tv" title='tv' data-ref="343tv">tv</a>.<a class="ref field" href="../../include/x86_64-linux-gnu/bits/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec">tv_usec</a>^<a class="ref fn" href="../../include/unistd.h.html#getpid" title='getpid' data-ref="getpid">getpid</a>());</td></tr>
<tr><th id="3583">3583</th><td>    <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a> = <a class="ref fn" href="#checkForSentinelMode" title='checkForSentinelMode' data-ref="checkForSentinelMode">checkForSentinelMode</a>(<a class="local col1 ref" href="#341argc" title='argc' data-ref="341argc">argc</a>,<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>);</td></tr>
<tr><th id="3584">3584</th><td>    <a class="ref fn" href="#initServerConfig" title='initServerConfig' data-ref="initServerConfig">initServerConfig</a>();</td></tr>
<tr><th id="3585">3585</th><td></td></tr>
<tr><th id="3586">3586</th><td>    <i>/* We need to init sentinel right now as parsing the configuration file</i></td></tr>
<tr><th id="3587">3587</th><td><i>     * in sentinel mode will have the effect of populating the sentinel</i></td></tr>
<tr><th id="3588">3588</th><td><i>     * data structures with master nodes to monitor. */</i></td></tr>
<tr><th id="3589">3589</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) {</td></tr>
<tr><th id="3590">3590</th><td>        <a class="ref fn" href="redis.h.html#initSentinelConfig" title='initSentinelConfig' data-ref="initSentinelConfig">initSentinelConfig</a>();</td></tr>
<tr><th id="3591">3591</th><td>        <a class="ref fn" href="redis.h.html#initSentinel" title='initSentinel' data-ref="initSentinel">initSentinel</a>();</td></tr>
<tr><th id="3592">3592</th><td>    }</td></tr>
<tr><th id="3593">3593</th><td></td></tr>
<tr><th id="3594">3594</th><td>    <b>if</b> (<a class="local col1 ref" href="#341argc" title='argc' data-ref="341argc">argc</a> &gt;= <var>2</var>) {</td></tr>
<tr><th id="3595">3595</th><td>        <em>int</em> <dfn class="local col4 decl" id="344j" title='j' data-type='int' data-ref="344j">j</dfn> = <var>1</var>; <i>/* First option to parse in argv[] */</i></td></tr>
<tr><th id="3596">3596</th><td>        <a class="typedef" href="sds.h.html#sds" title='sds' data-type='char *' data-ref="sds">sds</a> <dfn class="local col5 decl" id="345options" title='options' data-type='sds' data-ref="345options">options</dfn> = <a class="ref fn" href="sds.h.html#sdsempty" title='sdsempty' data-ref="sdsempty">sdsempty</a>();</td></tr>
<tr><th id="3597">3597</th><td>        <em>char</em> *<dfn class="local col6 decl" id="346configfile" title='configfile' data-type='char *' data-ref="346configfile">configfile</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3598">3598</th><td></td></tr>
<tr><th id="3599">3599</th><td>        <i>/* Handle special options --help and --version */</i></td></tr>
<tr><th id="3600">3600</th><td>        <b>if</b> (<a class="ref fn" href="../../include/string.h.html#strcmp" title='strcmp' data-ref="strcmp">strcmp</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>1</var>], <q>"-v"</q>) == <var>0</var> ||</td></tr>
<tr><th id="3601">3601</th><td>            <a class="ref fn" href="../../include/string.h.html#strcmp" title='strcmp' data-ref="strcmp">strcmp</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>1</var>], <q>"--version"</q>) == <var>0</var>) <a class="ref fn" href="#version" title='version' data-ref="version">version</a>();</td></tr>
<tr><th id="3602">3602</th><td>        <b>if</b> (<a class="ref fn" href="../../include/string.h.html#strcmp" title='strcmp' data-ref="strcmp">strcmp</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>1</var>], <q>"--help"</q>) == <var>0</var> ||</td></tr>
<tr><th id="3603">3603</th><td>            <a class="ref fn" href="../../include/string.h.html#strcmp" title='strcmp' data-ref="strcmp">strcmp</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>1</var>], <q>"-h"</q>) == <var>0</var>) <a class="ref fn" href="#usage" title='usage' data-ref="usage">usage</a>();</td></tr>
<tr><th id="3604">3604</th><td>        <b>if</b> (<a class="ref fn" href="../../include/string.h.html#strcmp" title='strcmp' data-ref="strcmp">strcmp</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>1</var>], <q>"--test-memory"</q>) == <var>0</var>) {</td></tr>
<tr><th id="3605">3605</th><td>            <b>if</b> (<a class="local col1 ref" href="#341argc" title='argc' data-ref="341argc">argc</a> == <var>3</var>) {</td></tr>
<tr><th id="3606">3606</th><td>                <a class="ref fn" href="#memtest" title='memtest' data-ref="memtest">memtest</a>(<a class="ref fn" href="../../include/stdlib.h.html#atoi" title='atoi' data-ref="atoi">atoi</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>2</var>]),<var>50</var>);</td></tr>
<tr><th id="3607">3607</th><td>                <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>0</var>);</td></tr>
<tr><th id="3608">3608</th><td>            } <b>else</b> {</td></tr>
<tr><th id="3609">3609</th><td>                <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"Please specify the amount of memory to test in megabytes.\n"</q>);</td></tr>
<tr><th id="3610">3610</th><td>                <a class="ref fn" href="../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a>(<a class="macro" href="../../include/stdio.h.html#174" title="stderr" data-ref="_M/stderr">stderr</a>,<q>"Example: ./redis-server --test-memory 4096\n\n"</q>);</td></tr>
<tr><th id="3611">3611</th><td>                <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="3612">3612</th><td>            }</td></tr>
<tr><th id="3613">3613</th><td>        }</td></tr>
<tr><th id="3614">3614</th><td></td></tr>
<tr><th id="3615">3615</th><td>        <i>/* First argument is the config file name? */</i></td></tr>
<tr><th id="3616">3616</th><td>        <b>if</b> (<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>][<var>0</var>] != <kbd>'-'</kbd> || <a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>][<var>1</var>] != <kbd>'-'</kbd>)</td></tr>
<tr><th id="3617">3617</th><td>            <a class="local col6 ref" href="#346configfile" title='configfile' data-ref="346configfile">configfile</a> = <a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>++];</td></tr>
<tr><th id="3618">3618</th><td>        <i>/* All the other options are parsed and conceptually appended to the</i></td></tr>
<tr><th id="3619">3619</th><td><i>         * configuration file. For instance --port 6380 will generate the</i></td></tr>
<tr><th id="3620">3620</th><td><i>         * string "port 6380\n" to be parsed after the actual file name</i></td></tr>
<tr><th id="3621">3621</th><td><i>         * is parsed, if any. */</i></td></tr>
<tr><th id="3622">3622</th><td>        <b>while</b>(<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a> != <a class="local col1 ref" href="#341argc" title='argc' data-ref="341argc">argc</a>) {</td></tr>
<tr><th id="3623">3623</th><td>            <b>if</b> (<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>][<var>0</var>] == <kbd>'-'</kbd> &amp;&amp; <a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>][<var>1</var>] == <kbd>'-'</kbd>) {</td></tr>
<tr><th id="3624">3624</th><td>                <i>/* Option name */</i></td></tr>
<tr><th id="3625">3625</th><td>                <b>if</b> (<a class="ref fn" href="sds.h.html#sdslen" title='sdslen' data-ref="sdslen">sdslen</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>)) <a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>,<q>"\n"</q>);</td></tr>
<tr><th id="3626">3626</th><td>                <a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>,<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>]+<var>2</var>);</td></tr>
<tr><th id="3627">3627</th><td>                <a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>,<q>" "</q>);</td></tr>
<tr><th id="3628">3628</th><td>            } <b>else</b> {</td></tr>
<tr><th id="3629">3629</th><td>                <i>/* Option argument */</i></td></tr>
<tr><th id="3630">3630</th><td>                <a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a> = <a class="ref fn" href="sds.h.html#sdscatrepr" title='sdscatrepr' data-ref="sdscatrepr">sdscatrepr</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>,<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>],<a class="ref fn" href="../../include/string.h.html#strlen" title='strlen' data-ref="strlen">strlen</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>]));</td></tr>
<tr><th id="3631">3631</th><td>                <a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a> = <a class="ref fn" href="sds.h.html#sdscat" title='sdscat' data-ref="sdscat">sdscat</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>,<q>" "</q>);</td></tr>
<tr><th id="3632">3632</th><td>            }</td></tr>
<tr><th id="3633">3633</th><td>            <a class="local col4 ref" href="#344j" title='j' data-ref="344j">j</a>++;</td></tr>
<tr><th id="3634">3634</th><td>        }</td></tr>
<tr><th id="3635">3635</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a> &amp;&amp; <a class="local col6 ref" href="#346configfile" title='configfile' data-ref="346configfile">configfile</a> &amp;&amp; *<a class="local col6 ref" href="#346configfile" title='configfile' data-ref="346configfile">configfile</a> == <kbd>'-'</kbd>) {</td></tr>
<tr><th id="3636">3636</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,</td></tr>
<tr><th id="3637">3637</th><td>                <q>"Sentinel config from STDIN not allowed."</q>);</td></tr>
<tr><th id="3638">3638</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,</td></tr>
<tr><th id="3639">3639</th><td>                <q>"Sentinel needs config file on disk to save state.  Exiting..."</q>);</td></tr>
<tr><th id="3640">3640</th><td>            <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="3641">3641</th><td>        }</td></tr>
<tr><th id="3642">3642</th><td>        <b>if</b> (<a class="local col6 ref" href="#346configfile" title='configfile' data-ref="346configfile">configfile</a>) <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::configfile" title='redisServer::configfile' data-ref="redisServer::configfile">configfile</a> = <a class="ref fn" href="util.h.html#getAbsolutePath" title='getAbsolutePath' data-ref="getAbsolutePath">getAbsolutePath</a>(<a class="local col6 ref" href="#346configfile" title='configfile' data-ref="346configfile">configfile</a>);</td></tr>
<tr><th id="3643">3643</th><td>        <a class="ref fn" href="redis.h.html#resetServerSaveParams" title='resetServerSaveParams' data-ref="resetServerSaveParams">resetServerSaveParams</a>();</td></tr>
<tr><th id="3644">3644</th><td>        <a class="ref fn" href="redis.h.html#loadServerConfig" title='loadServerConfig' data-ref="loadServerConfig">loadServerConfig</a>(<a class="local col6 ref" href="#346configfile" title='configfile' data-ref="346configfile">configfile</a>,<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>);</td></tr>
<tr><th id="3645">3645</th><td>        <a class="ref fn" href="sds.h.html#sdsfree" title='sdsfree' data-ref="sdsfree">sdsfree</a>(<a class="local col5 ref" href="#345options" title='options' data-ref="345options">options</a>);</td></tr>
<tr><th id="3646">3646</th><td>    } <b>else</b> {</td></tr>
<tr><th id="3647">3647</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>, <q>"Warning: no config file specified, using the default config. In order to specify a config file use %s /path/to/%s.conf"</q>, <a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>0</var>], <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a> ? <q>"sentinel"</q> : <q>"redis"</q>);</td></tr>
<tr><th id="3648">3648</th><td>    }</td></tr>
<tr><th id="3649">3649</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::daemonize" title='redisServer::daemonize' data-ref="redisServer::daemonize">daemonize</a>) <a class="ref fn" href="#daemonize" title='daemonize' data-ref="daemonize">daemonize</a>();</td></tr>
<tr><th id="3650">3650</th><td>    <a class="ref fn" href="#initServer" title='initServer' data-ref="initServer">initServer</a>();</td></tr>
<tr><th id="3651">3651</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::daemonize" title='redisServer::daemonize' data-ref="redisServer::daemonize">daemonize</a>) <a class="ref fn" href="#createPidFile" title='createPidFile' data-ref="createPidFile">createPidFile</a>();</td></tr>
<tr><th id="3652">3652</th><td>    <a class="ref fn" href="#redisSetProcTitle" title='redisSetProcTitle' data-ref="redisSetProcTitle">redisSetProcTitle</a>(<a class="local col2 ref" href="#342argv" title='argv' data-ref="342argv">argv</a>[<var>0</var>]);</td></tr>
<tr><th id="3653">3653</th><td>    <a class="ref fn" href="#redisAsciiArt" title='redisAsciiArt' data-ref="redisAsciiArt">redisAsciiArt</a>();</td></tr>
<tr><th id="3654">3654</th><td></td></tr>
<tr><th id="3655">3655</th><td>    <b>if</b> (!<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sentinel_mode" title='redisServer::sentinel_mode' data-ref="redisServer::sentinel_mode">sentinel_mode</a>) {</td></tr>
<tr><th id="3656">3656</th><td>        <i>/* Things not needed when running in Sentinel mode. */</i></td></tr>
<tr><th id="3657">3657</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"Server started, Redis version "</q> <a class="macro" href="version.h.html#1" title="&quot;3.0.0&quot;" data-ref="_M/REDIS_VERSION">REDIS_VERSION</a>);</td></tr>
<tr><th id="3658">3658</th><td>    <u>#<span data-ppcond="3658">ifdef</span> <span class="macro" data-ref="_M/__linux__">__linux__</span></u></td></tr>
<tr><th id="3659">3659</th><td>        <a class="ref fn" href="#linuxMemoryWarnings" title='linuxMemoryWarnings' data-ref="linuxMemoryWarnings">linuxMemoryWarnings</a>();</td></tr>
<tr><th id="3660">3660</th><td>    <u>#<span data-ppcond="3658">endif</span></u></td></tr>
<tr><th id="3661">3661</th><td>        <a class="ref fn" href="#checkTcpBacklogSettings" title='checkTcpBacklogSettings' data-ref="checkTcpBacklogSettings">checkTcpBacklogSettings</a>();</td></tr>
<tr><th id="3662">3662</th><td>        <a class="ref fn" href="#loadDataFromDisk" title='loadDataFromDisk' data-ref="loadDataFromDisk">loadDataFromDisk</a>();</td></tr>
<tr><th id="3663">3663</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::cluster_enabled" title='redisServer::cluster_enabled' data-ref="redisServer::cluster_enabled">cluster_enabled</a>) {</td></tr>
<tr><th id="3664">3664</th><td>            <b>if</b> (<a class="ref fn" href="redis.h.html#verifyClusterConfigWithData" title='verifyClusterConfigWithData' data-ref="verifyClusterConfigWithData">verifyClusterConfigWithData</a>() == <a class="macro" href="redis.h.html#68" title="-1" data-ref="_M/REDIS_ERR">REDIS_ERR</a>) {</td></tr>
<tr><th id="3665">3665</th><td>                <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,</td></tr>
<tr><th id="3666">3666</th><td>                    <q>"You can't have keys in a DB different than DB 0 when in "</q></td></tr>
<tr><th id="3667">3667</th><td>                    <q>"Cluster mode. Exiting."</q>);</td></tr>
<tr><th id="3668">3668</th><td>                <a class="ref fn" href="../../include/stdlib.h.html#exit" title='exit' data-ref="exit">exit</a>(<var>1</var>);</td></tr>
<tr><th id="3669">3669</th><td>            }</td></tr>
<tr><th id="3670">3670</th><td>        }</td></tr>
<tr><th id="3671">3671</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::ipfd_count" title='redisServer::ipfd_count' data-ref="redisServer::ipfd_count">ipfd_count</a> &gt; <var>0</var>)</td></tr>
<tr><th id="3672">3672</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"The server is now ready to accept connections on port %d"</q>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::port" title='redisServer::port' data-ref="redisServer::port">port</a>);</td></tr>
<tr><th id="3673">3673</th><td>        <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::sofd" title='redisServer::sofd' data-ref="redisServer::sofd">sofd</a> &gt; <var>0</var>)</td></tr>
<tr><th id="3674">3674</th><td>            <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#303" title="2" data-ref="_M/REDIS_NOTICE">REDIS_NOTICE</a>,<q>"The server is now ready to accept connections at %s"</q>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::unixsocket" title='redisServer::unixsocket' data-ref="redisServer::unixsocket">unixsocket</a>);</td></tr>
<tr><th id="3675">3675</th><td>    } <b>else</b> {</td></tr>
<tr><th id="3676">3676</th><td>        <a class="ref fn" href="redis.h.html#sentinelIsRunning" title='sentinelIsRunning' data-ref="sentinelIsRunning">sentinelIsRunning</a>();</td></tr>
<tr><th id="3677">3677</th><td>    }</td></tr>
<tr><th id="3678">3678</th><td></td></tr>
<tr><th id="3679">3679</th><td>    <i>/* Warning the user about suspicious maxmemory setting. */</i></td></tr>
<tr><th id="3680">3680</th><td>    <b>if</b> (<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a> &gt; <var>0</var> &amp;&amp; <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a> &lt; <var>1024</var>*<var>1024</var>) {</td></tr>
<tr><th id="3681">3681</th><td>        <a class="ref fn" href="#redisLog" title='redisLog' data-ref="redisLog">redisLog</a>(<a class="macro" href="redis.h.html#304" title="3" data-ref="_M/REDIS_WARNING">REDIS_WARNING</a>,<q>"WARNING: You specified a maxmemory value that is less than 1MB (current value is %llu bytes). Are you sure this is what you really want?"</q>, <a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::maxmemory" title='redisServer::maxmemory' data-ref="redisServer::maxmemory">maxmemory</a>);</td></tr>
<tr><th id="3682">3682</th><td>    }</td></tr>
<tr><th id="3683">3683</th><td></td></tr>
<tr><th id="3684">3684</th><td>    <a class="ref fn" href="ae.h.html#aeSetBeforeSleepProc" title='aeSetBeforeSleepProc' data-ref="aeSetBeforeSleepProc">aeSetBeforeSleepProc</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a>,<a class="ref fn" href="#beforeSleep" title='beforeSleep' data-ref="beforeSleep">beforeSleep</a>);</td></tr>
<tr><th id="3685">3685</th><td>    <a class="ref fn" href="ae.h.html#aeMain" title='aeMain' data-ref="aeMain">aeMain</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a>);</td></tr>
<tr><th id="3686">3686</th><td>    <a class="ref fn" href="ae.h.html#aeDeleteEventLoop" title='aeDeleteEventLoop' data-ref="aeDeleteEventLoop">aeDeleteEventLoop</a>(<a class="ref" href="redis.h.html#server" title='server' data-ref="server">server</a>.<a class="ref field" href="redis.h.html#redisServer::el" title='redisServer::el' data-ref="redisServer::el">el</a>);</td></tr>
<tr><th id="3687">3687</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3688">3688</th><td>}</td></tr>
<tr><th id="3689">3689</th><td></td></tr>
<tr><th id="3690">3690</th><td><i>/* The End */</i></td></tr>
<tr><th id="3691">3691</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Apr-06</em> from project redis revision <em>77d3b16</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
